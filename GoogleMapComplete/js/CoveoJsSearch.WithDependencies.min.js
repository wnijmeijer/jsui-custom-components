if( window.jstz === undefined) {
(function(e){var t=function(){"use strict";var e="s",n=2011,r=function(e){var t=-e.getTimezoneOffset();return t!==null?t:0},i=function(e,t,n){var r=new Date;return e!==undefined&&r.setFullYear(e),r.setDate(n),r.setMonth(t),r},s=function(e){return r(i(e,0,2))},o=function(e){return r(i(e,5,2))},u=function(e){var t=e.getMonth()>7?o(e.getFullYear()):s(e.getFullYear()),n=r(e);return t-n!==0},a=function(){var t=s(n),r=o(n),i=t-r;return i<0?t+",1":i>0?r+",1,"+e:t+",0"},f=function(){var e=a();return new t.TimeZone(t.olson.timezones[e])},l=function(e){var t=new Date(2010,6,15,1,0,0,0),n={"America/Denver":new Date(2011,2,13,3,0,0,0),"America/Mazatlan":new Date(2011,3,3,3,0,0,0),"America/Chicago":new Date(2011,2,13,3,0,0,0),"America/Mexico_City":new Date(2011,3,3,3,0,0,0),"America/Asuncion":new Date(2012,9,7,3,0,0,0),"America/Santiago":new Date(2012,9,3,3,0,0,0),"America/Campo_Grande":new Date(2012,9,21,5,0,0,0),"America/Montevideo":new Date(2011,9,2,3,0,0,0),"America/Sao_Paulo":new Date(2011,9,16,5,0,0,0),"America/Los_Angeles":new Date(2011,2,13,8,0,0,0),"America/Santa_Isabel":new Date(2011,3,5,8,0,0,0),"America/Havana":new Date(2012,2,10,2,0,0,0),"America/New_York":new Date(2012,2,10,7,0,0,0),"Asia/Beirut":new Date(2011,2,27,1,0,0,0),"Europe/Helsinki":new Date(2011,2,27,4,0,0,0),"Europe/Istanbul":new Date(2011,2,28,5,0,0,0),"Asia/Damascus":new Date(2011,3,1,2,0,0,0),"Asia/Jerusalem":new Date(2011,3,1,6,0,0,0),"Asia/Gaza":new Date(2009,2,28,0,30,0,0),"Africa/Cairo":new Date(2009,3,25,0,30,0,0),"Pacific/Auckland":new Date(2011,8,26,7,0,0,0),"Pacific/Fiji":new Date(2010,10,29,23,0,0,0),"America/Halifax":new Date(2011,2,13,6,0,0,0),"America/Goose_Bay":new Date(2011,2,13,2,1,0,0),"America/Miquelon":new Date(2011,2,13,5,0,0,0),"America/Godthab":new Date(2011,2,27,1,0,0,0),"Europe/Moscow":t,"Asia/Yekaterinburg":t,"Asia/Omsk":t,"Asia/Krasnoyarsk":t,"Asia/Irkutsk":t,"Asia/Yakutsk":t,"Asia/Vladivostok":t,"Asia/Kamchatka":t,"Europe/Minsk":t,"Pacific/Apia":new Date(2010,10,1,1,0,0,0),"Australia/Perth":new Date(2008,10,1,1,0,0,0)};return n[e]};return{determine:f,date_is_dst:u,dst_start_for:l}}();t.TimeZone=function(e){"use strict";var n={"America/Denver":["America/Denver","America/Mazatlan"],"America/Chicago":["America/Chicago","America/Mexico_City"],"America/Santiago":["America/Santiago","America/Asuncion","America/Campo_Grande"],"America/Montevideo":["America/Montevideo","America/Sao_Paulo"],"Asia/Beirut":["Asia/Beirut","Europe/Helsinki","Europe/Istanbul","Asia/Damascus","Asia/Jerusalem","Asia/Gaza"],"Pacific/Auckland":["Pacific/Auckland","Pacific/Fiji"],"America/Los_Angeles":["America/Los_Angeles","America/Santa_Isabel"],"America/New_York":["America/Havana","America/New_York"],"America/Halifax":["America/Goose_Bay","America/Halifax"],"America/Godthab":["America/Miquelon","America/Godthab"],"Asia/Dubai":["Europe/Moscow"],"Asia/Dhaka":["Asia/Yekaterinburg"],"Asia/Jakarta":["Asia/Omsk"],"Asia/Shanghai":["Asia/Krasnoyarsk","Australia/Perth"],"Asia/Tokyo":["Asia/Irkutsk"],"Australia/Brisbane":["Asia/Yakutsk"],"Pacific/Noumea":["Asia/Vladivostok"],"Pacific/Tarawa":["Asia/Kamchatka"],"Pacific/Tongatapu":["Pacific/Apia"],"Africa/Johannesburg":["Asia/Gaza","Africa/Cairo"],"Asia/Baghdad":["Europe/Minsk"]},r=e,i=function(){var e=n[r],i=e.length,s=0,o=e[0];for(;s<i;s+=1){o=e[s];if(t.date_is_dst(t.dst_start_for(o))){r=o;return}}},s=function(){return typeof n[r]!="undefined"};return s()&&i(),{name:function(){return r}}},t.olson={},t.olson.timezones={"-720,0":"Pacific/Majuro","-660,0":"Pacific/Pago_Pago","-600,1":"America/Adak","-600,0":"Pacific/Honolulu","-570,0":"Pacific/Marquesas","-540,0":"Pacific/Gambier","-540,1":"America/Anchorage","-480,1":"America/Los_Angeles","-480,0":"Pacific/Pitcairn","-420,0":"America/Phoenix","-420,1":"America/Denver","-360,0":"America/Guatemala","-360,1":"America/Chicago","-360,1,s":"Pacific/Easter","-300,0":"America/Bogota","-300,1":"America/New_York","-270,0":"America/Caracas","-240,1":"America/Halifax","-240,0":"America/Santo_Domingo","-240,1,s":"America/Santiago","-210,1":"America/St_Johns","-180,1":"America/Godthab","-180,0":"America/Argentina/Buenos_Aires","-180,1,s":"America/Montevideo","-120,0":"America/Noronha","-120,1":"America/Noronha","-60,1":"Atlantic/Azores","-60,0":"Atlantic/Cape_Verde","0,0":"UTC","0,1":"Europe/London","60,1":"Europe/Berlin","60,0":"Africa/Lagos","60,1,s":"Africa/Windhoek","120,1":"Asia/Beirut","120,0":"Africa/Johannesburg","180,0":"Asia/Baghdad","180,1":"Europe/Moscow","210,1":"Asia/Tehran","240,0":"Asia/Dubai","240,1":"Asia/Baku","270,0":"Asia/Kabul","300,1":"Asia/Yekaterinburg","300,0":"Asia/Karachi","330,0":"Asia/Kolkata","345,0":"Asia/Kathmandu","360,0":"Asia/Dhaka","360,1":"Asia/Omsk","390,0":"Asia/Rangoon","420,1":"Asia/Krasnoyarsk","420,0":"Asia/Jakarta","480,0":"Asia/Shanghai","480,1":"Asia/Irkutsk","525,0":"Australia/Eucla","525,1,s":"Australia/Eucla","540,1":"Asia/Yakutsk","540,0":"Asia/Tokyo","570,0":"Australia/Darwin","570,1,s":"Australia/Adelaide","600,0":"Australia/Brisbane","600,1":"Asia/Vladivostok","600,1,s":"Australia/Sydney","630,1,s":"Australia/Lord_Howe","660,1":"Asia/Kamchatka","660,0":"Pacific/Noumea","690,0":"Pacific/Norfolk","720,1,s":"Pacific/Auckland","720,0":"Pacific/Tarawa","765,1,s":"Pacific/Chatham","780,0":"Pacific/Tongatapu","780,1,s":"Pacific/Apia","840,0":"Pacific/Kiritimati"},typeof exports!="undefined"?exports.jstz=t:e.jstz=t})(this);
}
if( window.Coveo === undefined) {
/*! jQuery v1.9.1 | (c) 2005, 2012 jQuery Foundation, Inc. | jquery.org/license
//@ sourceMappingURL=jquery.min.map
*/(function(e,t){var n,r,i=typeof t,o=e.document,a=e.location,s=e.jQuery,u=e.$,l={},c=[],p="1.9.1",f=c.concat,d=c.push,h=c.slice,g=c.indexOf,m=l.toString,y=l.hasOwnProperty,v=p.trim,b=function(e,t){return new b.fn.init(e,t,r)},x=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,w=/\S+/g,T=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,N=/^(?:(<[\w\W]+>)[^>]*|#([\w-]*))$/,C=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,k=/^[\],:{}\s]*$/,E=/(?:^|:|,)(?:\s*\[)+/g,S=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,A=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,j=/^-ms-/,D=/-([\da-z])/gi,L=function(e,t){return t.toUpperCase()},H=function(e){(o.addEventListener||"load"===e.type||"complete"===o.readyState)&&(q(),b.ready())},q=function(){o.addEventListener?(o.removeEventListener("DOMContentLoaded",H,!1),e.removeEventListener("load",H,!1)):(o.detachEvent("onreadystatechange",H),e.detachEvent("onload",H))};b.fn=b.prototype={jquery:p,constructor:b,init:function(e,n,r){var i,a;if(!e)return this;if("string"==typeof e){if(i="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:N.exec(e),!i||!i[1]&&n)return!n||n.jquery?(n||r).find(e):this.constructor(n).find(e);if(i[1]){if(n=n instanceof b?n[0]:n,b.merge(this,b.parseHTML(i[1],n&&n.nodeType?n.ownerDocument||n:o,!0)),C.test(i[1])&&b.isPlainObject(n))for(i in n)b.isFunction(this[i])?this[i](n[i]):this.attr(i,n[i]);return this}if(a=o.getElementById(i[2]),a&&a.parentNode){if(a.id!==i[2])return r.find(e);this.length=1,this[0]=a}return this.context=o,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):b.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),b.makeArray(e,this))},selector:"",length:0,size:function(){return this.length},toArray:function(){return h.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=b.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return b.each(this,e,t)},ready:function(e){return b.ready.promise().done(e),this},slice:function(){return this.pushStack(h.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},map:function(e){return this.pushStack(b.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:d,sort:[].sort,splice:[].splice},b.fn.init.prototype=b.fn,b.extend=b.fn.extend=function(){var e,n,r,i,o,a,s=arguments[0]||{},u=1,l=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[1]||{},u=2),"object"==typeof s||b.isFunction(s)||(s={}),l===u&&(s=this,--u);l>u;u++)if(null!=(o=arguments[u]))for(i in o)e=s[i],r=o[i],s!==r&&(c&&r&&(b.isPlainObject(r)||(n=b.isArray(r)))?(n?(n=!1,a=e&&b.isArray(e)?e:[]):a=e&&b.isPlainObject(e)?e:{},s[i]=b.extend(c,a,r)):r!==t&&(s[i]=r));return s},b.extend({noConflict:function(t){return e.$===b&&(e.$=u),t&&e.jQuery===b&&(e.jQuery=s),b},isReady:!1,readyWait:1,holdReady:function(e){e?b.readyWait++:b.ready(!0)},ready:function(e){if(e===!0?!--b.readyWait:!b.isReady){if(!o.body)return setTimeout(b.ready);b.isReady=!0,e!==!0&&--b.readyWait>0||(n.resolveWith(o,[b]),b.fn.trigger&&b(o).trigger("ready").off("ready"))}},isFunction:function(e){return"function"===b.type(e)},isArray:Array.isArray||function(e){return"array"===b.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[m.call(e)]||"object":typeof e},isPlainObject:function(e){if(!e||"object"!==b.type(e)||e.nodeType||b.isWindow(e))return!1;try{if(e.constructor&&!y.call(e,"constructor")&&!y.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}var r;for(r in e);return r===t||y.call(e,r)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||o;var r=C.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=b.buildFragment([e],t,i),i&&b(i).remove(),b.merge([],r.childNodes))},parseJSON:function(n){return e.JSON&&e.JSON.parse?e.JSON.parse(n):null===n?n:"string"==typeof n&&(n=b.trim(n),n&&k.test(n.replace(S,"@").replace(A,"]").replace(E,"")))?Function("return "+n)():(b.error("Invalid JSON: "+n),t)},parseXML:function(n){var r,i;if(!n||"string"!=typeof n)return null;try{e.DOMParser?(i=new DOMParser,r=i.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))}catch(o){r=t}return r&&r.documentElement&&!r.getElementsByTagName("parsererror").length||b.error("Invalid XML: "+n),r},noop:function(){},globalEval:function(t){t&&b.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(j,"ms-").replace(D,L)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,o=e.length,a=M(e);if(n){if(a){for(;o>i;i++)if(r=t.apply(e[i],n),r===!1)break}else for(i in e)if(r=t.apply(e[i],n),r===!1)break}else if(a){for(;o>i;i++)if(r=t.call(e[i],i,e[i]),r===!1)break}else for(i in e)if(r=t.call(e[i],i,e[i]),r===!1)break;return e},trim:v&&!v.call("\ufeff\u00a0")?function(e){return null==e?"":v.call(e)}:function(e){return null==e?"":(e+"").replace(T,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(M(Object(e))?b.merge(n,"string"==typeof e?[e]:e):d.call(n,e)),n},inArray:function(e,t,n){var r;if(t){if(g)return g.call(t,e,n);for(r=t.length,n=n?0>n?Math.max(0,r+n):n:0;r>n;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var r=n.length,i=e.length,o=0;if("number"==typeof r)for(;r>o;o++)e[i++]=n[o];else while(n[o]!==t)e[i++]=n[o++];return e.length=i,e},grep:function(e,t,n){var r,i=[],o=0,a=e.length;for(n=!!n;a>o;o++)r=!!t(e[o],o),n!==r&&i.push(e[o]);return i},map:function(e,t,n){var r,i=0,o=e.length,a=M(e),s=[];if(a)for(;o>i;i++)r=t(e[i],i,n),null!=r&&(s[s.length]=r);else for(i in e)r=t(e[i],i,n),null!=r&&(s[s.length]=r);return f.apply([],s)},guid:1,proxy:function(e,n){var r,i,o;return"string"==typeof n&&(o=e[n],n=e,e=o),b.isFunction(e)?(r=h.call(arguments,2),i=function(){return e.apply(n||this,r.concat(h.call(arguments)))},i.guid=e.guid=e.guid||b.guid++,i):t},access:function(e,n,r,i,o,a,s){var u=0,l=e.length,c=null==r;if("object"===b.type(r)){o=!0;for(u in r)b.access(e,n,u,r[u],!0,a,s)}else if(i!==t&&(o=!0,b.isFunction(i)||(s=!0),c&&(s?(n.call(e,i),n=null):(c=n,n=function(e,t,n){return c.call(b(e),n)})),n))for(;l>u;u++)n(e[u],r,s?i:i.call(e[u],u,n(e[u],r)));return o?e:c?n.call(e):l?n(e[0],r):a},now:function(){return(new Date).getTime()}}),b.ready.promise=function(t){if(!n)if(n=b.Deferred(),"complete"===o.readyState)setTimeout(b.ready);else if(o.addEventListener)o.addEventListener("DOMContentLoaded",H,!1),e.addEventListener("load",H,!1);else{o.attachEvent("onreadystatechange",H),e.attachEvent("onload",H);var r=!1;try{r=null==e.frameElement&&o.documentElement}catch(i){}r&&r.doScroll&&function a(){if(!b.isReady){try{r.doScroll("left")}catch(e){return setTimeout(a,50)}q(),b.ready()}}()}return n.promise(t)},b.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){l["[object "+t+"]"]=t.toLowerCase()});function M(e){var t=e.length,n=b.type(e);return b.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||"function"!==n&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}r=b(o);var _={};function F(e){var t=_[e]={};return b.each(e.match(w)||[],function(e,n){t[n]=!0}),t}b.Callbacks=function(e){e="string"==typeof e?_[e]||F(e):b.extend({},e);var n,r,i,o,a,s,u=[],l=!e.once&&[],c=function(t){for(r=e.memory&&t,i=!0,a=s||0,s=0,o=u.length,n=!0;u&&o>a;a++)if(u[a].apply(t[0],t[1])===!1&&e.stopOnFalse){r=!1;break}n=!1,u&&(l?l.length&&c(l.shift()):r?u=[]:p.disable())},p={add:function(){if(u){var t=u.length;(function i(t){b.each(t,function(t,n){var r=b.type(n);"function"===r?e.unique&&p.has(n)||u.push(n):n&&n.length&&"string"!==r&&i(n)})})(arguments),n?o=u.length:r&&(s=t,c(r))}return this},remove:function(){return u&&b.each(arguments,function(e,t){var r;while((r=b.inArray(t,u,r))>-1)u.splice(r,1),n&&(o>=r&&o--,a>=r&&a--)}),this},has:function(e){return e?b.inArray(e,u)>-1:!(!u||!u.length)},empty:function(){return u=[],this},disable:function(){return u=l=r=t,this},disabled:function(){return!u},lock:function(){return l=t,r||p.disable(),this},locked:function(){return!l},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],!u||i&&!l||(n?l.push(t):c(t)),this},fire:function(){return p.fireWith(this,arguments),this},fired:function(){return!!i}};return p},b.extend({Deferred:function(e){var t=[["resolve","done",b.Callbacks("once memory"),"resolved"],["reject","fail",b.Callbacks("once memory"),"rejected"],["notify","progress",b.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return b.Deferred(function(n){b.each(t,function(t,o){var a=o[0],s=b.isFunction(e[t])&&e[t];i[o[1]](function(){var e=s&&s.apply(this,arguments);e&&b.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[a+"With"](this===r?n.promise():this,s?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?b.extend(e,r):r}},i={};return r.pipe=r.then,b.each(t,function(e,o){var a=o[2],s=o[3];r[o[1]]=a.add,s&&a.add(function(){n=s},t[1^e][2].disable,t[2][2].lock),i[o[0]]=function(){return i[o[0]+"With"](this===i?r:this,arguments),this},i[o[0]+"With"]=a.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=h.call(arguments),r=n.length,i=1!==r||e&&b.isFunction(e.promise)?r:0,o=1===i?e:b.Deferred(),a=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?h.call(arguments):r,n===s?o.notifyWith(t,n):--i||o.resolveWith(t,n)}},s,u,l;if(r>1)for(s=Array(r),u=Array(r),l=Array(r);r>t;t++)n[t]&&b.isFunction(n[t].promise)?n[t].promise().done(a(t,l,n)).fail(o.reject).progress(a(t,u,s)):--i;return i||o.resolveWith(l,n),o.promise()}}),b.support=function(){var t,n,r,a,s,u,l,c,p,f,d=o.createElement("div");if(d.setAttribute("className","t"),d.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=d.getElementsByTagName("*"),r=d.getElementsByTagName("a")[0],!n||!r||!n.length)return{};s=o.createElement("select"),l=s.appendChild(o.createElement("option")),a=d.getElementsByTagName("input")[0],r.style.cssText="top:1px;float:left;opacity:.5",t={getSetAttribute:"t"!==d.className,leadingWhitespace:3===d.firstChild.nodeType,tbody:!d.getElementsByTagName("tbody").length,htmlSerialize:!!d.getElementsByTagName("link").length,style:/top/.test(r.getAttribute("style")),hrefNormalized:"/a"===r.getAttribute("href"),opacity:/^0.5/.test(r.style.opacity),cssFloat:!!r.style.cssFloat,checkOn:!!a.value,optSelected:l.selected,enctype:!!o.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==o.createElement("nav").cloneNode(!0).outerHTML,boxModel:"CSS1Compat"===o.compatMode,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},a.checked=!0,t.noCloneChecked=a.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!l.disabled;try{delete d.test}catch(h){t.deleteExpando=!1}a=o.createElement("input"),a.setAttribute("value",""),t.input=""===a.getAttribute("value"),a.value="t",a.setAttribute("type","radio"),t.radioValue="t"===a.value,a.setAttribute("checked","t"),a.setAttribute("name","t"),u=o.createDocumentFragment(),u.appendChild(a),t.appendChecked=a.checked,t.checkClone=u.cloneNode(!0).cloneNode(!0).lastChild.checked,d.attachEvent&&(d.attachEvent("onclick",function(){t.noCloneEvent=!1}),d.cloneNode(!0).click());for(f in{submit:!0,change:!0,focusin:!0})d.setAttribute(c="on"+f,"t"),t[f+"Bubbles"]=c in e||d.attributes[c].expando===!1;return d.style.backgroundClip="content-box",d.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===d.style.backgroundClip,b(function(){var n,r,a,s="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",u=o.getElementsByTagName("body")[0];u&&(n=o.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",u.appendChild(n).appendChild(d),d.innerHTML="<table><tr><td></td><td>t</td></tr></table>",a=d.getElementsByTagName("td"),a[0].style.cssText="padding:0;margin:0;border:0;display:none",p=0===a[0].offsetHeight,a[0].style.display="",a[1].style.display="none",t.reliableHiddenOffsets=p&&0===a[0].offsetHeight,d.innerHTML="",d.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",t.boxSizing=4===d.offsetWidth,t.doesNotIncludeMarginInBodyOffset=1!==u.offsetTop,e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(d,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(d,null)||{width:"4px"}).width,r=d.appendChild(o.createElement("div")),r.style.cssText=d.style.cssText=s,r.style.marginRight=r.style.width="0",d.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),typeof d.style.zoom!==i&&(d.innerHTML="",d.style.cssText=s+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=3===d.offsetWidth,d.style.display="block",d.innerHTML="<div></div>",d.firstChild.style.width="5px",t.shrinkWrapBlocks=3!==d.offsetWidth,t.inlineBlockNeedsLayout&&(u.style.zoom=1)),u.removeChild(n),n=d=a=r=null)}),n=s=u=l=r=a=null,t}();var O=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,B=/([A-Z])/g;function P(e,n,r,i){if(b.acceptData(e)){var o,a,s=b.expando,u="string"==typeof n,l=e.nodeType,p=l?b.cache:e,f=l?e[s]:e[s]&&s;if(f&&p[f]&&(i||p[f].data)||!u||r!==t)return f||(l?e[s]=f=c.pop()||b.guid++:f=s),p[f]||(p[f]={},l||(p[f].toJSON=b.noop)),("object"==typeof n||"function"==typeof n)&&(i?p[f]=b.extend(p[f],n):p[f].data=b.extend(p[f].data,n)),o=p[f],i||(o.data||(o.data={}),o=o.data),r!==t&&(o[b.camelCase(n)]=r),u?(a=o[n],null==a&&(a=o[b.camelCase(n)])):a=o,a}}function R(e,t,n){if(b.acceptData(e)){var r,i,o,a=e.nodeType,s=a?b.cache:e,u=a?e[b.expando]:b.expando;if(s[u]){if(t&&(o=n?s[u]:s[u].data)){b.isArray(t)?t=t.concat(b.map(t,b.camelCase)):t in o?t=[t]:(t=b.camelCase(t),t=t in o?[t]:t.split(" "));for(r=0,i=t.length;i>r;r++)delete o[t[r]];if(!(n?$:b.isEmptyObject)(o))return}(n||(delete s[u].data,$(s[u])))&&(a?b.cleanData([e],!0):b.support.deleteExpando||s!=s.window?delete s[u]:s[u]=null)}}}b.extend({cache:{},expando:"jQuery"+(p+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return e=e.nodeType?b.cache[e[b.expando]]:e[b.expando],!!e&&!$(e)},data:function(e,t,n){return P(e,t,n)},removeData:function(e,t){return R(e,t)},_data:function(e,t,n){return P(e,t,n,!0)},_removeData:function(e,t){return R(e,t,!0)},acceptData:function(e){if(e.nodeType&&1!==e.nodeType&&9!==e.nodeType)return!1;var t=e.nodeName&&b.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),b.fn.extend({data:function(e,n){var r,i,o=this[0],a=0,s=null;if(e===t){if(this.length&&(s=b.data(o),1===o.nodeType&&!b._data(o,"parsedAttrs"))){for(r=o.attributes;r.length>a;a++)i=r[a].name,i.indexOf("data-")||(i=b.camelCase(i.slice(5)),W(o,i,s[i]));b._data(o,"parsedAttrs",!0)}return s}return"object"==typeof e?this.each(function(){b.data(this,e)}):b.access(this,function(n){return n===t?o?W(o,e,b.data(o,e)):null:(this.each(function(){b.data(this,e,n)}),t)},null,n,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){b.removeData(this,e)})}});function W(e,n,r){if(r===t&&1===e.nodeType){var i="data-"+n.replace(B,"-$1").toLowerCase();if(r=e.getAttribute(i),"string"==typeof r){try{r="true"===r?!0:"false"===r?!1:"null"===r?null:+r+""===r?+r:O.test(r)?b.parseJSON(r):r}catch(o){}b.data(e,n,r)}else r=t}return r}function $(e){var t;for(t in e)if(("data"!==t||!b.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}b.extend({queue:function(e,n,r){var i;return e?(n=(n||"fx")+"queue",i=b._data(e,n),r&&(!i||b.isArray(r)?i=b._data(e,n,b.makeArray(r)):i.push(r)),i||[]):t},dequeue:function(e,t){t=t||"fx";var n=b.queue(e,t),r=n.length,i=n.shift(),o=b._queueHooks(e,t),a=function(){b.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),o.cur=i,i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,a,o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return b._data(e,n)||b._data(e,n,{empty:b.Callbacks("once memory").add(function(){b._removeData(e,t+"queue"),b._removeData(e,n)})})}}),b.fn.extend({queue:function(e,n){var r=2;return"string"!=typeof e&&(n=e,e="fx",r--),r>arguments.length?b.queue(this[0],e):n===t?this:this.each(function(){var t=b.queue(this,e,n);b._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&b.dequeue(this,e)})},dequeue:function(e){return this.each(function(){b.dequeue(this,e)})},delay:function(e,t){return e=b.fx?b.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var r,i=1,o=b.Deferred(),a=this,s=this.length,u=function(){--i||o.resolveWith(a,[a])};"string"!=typeof e&&(n=e,e=t),e=e||"fx";while(s--)r=b._data(a[s],e+"queueHooks"),r&&r.empty&&(i++,r.empty.add(u));return u(),o.promise(n)}});var I,z,X=/[\t\r\n]/g,U=/\r/g,V=/^(?:input|select|textarea|button|object)$/i,Y=/^(?:a|area)$/i,J=/^(?:checked|selected|autofocus|autoplay|async|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped)$/i,G=/^(?:checked|selected)$/i,Q=b.support.getSetAttribute,K=b.support.input;b.fn.extend({attr:function(e,t){return b.access(this,b.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){b.removeAttr(this,e)})},prop:function(e,t){return b.access(this,b.prop,e,t,arguments.length>1)},removeProp:function(e){return e=b.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,r,i,o,a=0,s=this.length,u="string"==typeof e&&e;if(b.isFunction(e))return this.each(function(t){b(this).addClass(e.call(this,t,this.className))});if(u)for(t=(e||"").match(w)||[];s>a;a++)if(n=this[a],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(X," "):" ")){o=0;while(i=t[o++])0>r.indexOf(" "+i+" ")&&(r+=i+" ");n.className=b.trim(r)}return this},removeClass:function(e){var t,n,r,i,o,a=0,s=this.length,u=0===arguments.length||"string"==typeof e&&e;if(b.isFunction(e))return this.each(function(t){b(this).removeClass(e.call(this,t,this.className))});if(u)for(t=(e||"").match(w)||[];s>a;a++)if(n=this[a],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(X," "):"")){o=0;while(i=t[o++])while(r.indexOf(" "+i+" ")>=0)r=r.replace(" "+i+" "," ");n.className=e?b.trim(r):""}return this},toggleClass:function(e,t){var n=typeof e,r="boolean"==typeof t;return b.isFunction(e)?this.each(function(n){b(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n){var o,a=0,s=b(this),u=t,l=e.match(w)||[];while(o=l[a++])u=r?u:!s.hasClass(o),s[u?"addClass":"removeClass"](o)}else(n===i||"boolean"===n)&&(this.className&&b._data(this,"__className__",this.className),this.className=this.className||e===!1?"":b._data(this,"__className__")||"")})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;r>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(X," ").indexOf(t)>=0)return!0;return!1},val:function(e){var n,r,i,o=this[0];{if(arguments.length)return i=b.isFunction(e),this.each(function(n){var o,a=b(this);1===this.nodeType&&(o=i?e.call(this,n,a.val()):e,null==o?o="":"number"==typeof o?o+="":b.isArray(o)&&(o=b.map(o,function(e){return null==e?"":e+""})),r=b.valHooks[this.type]||b.valHooks[this.nodeName.toLowerCase()],r&&"set"in r&&r.set(this,o,"value")!==t||(this.value=o))});if(o)return r=b.valHooks[o.type]||b.valHooks[o.nodeName.toLowerCase()],r&&"get"in r&&(n=r.get(o,"value"))!==t?n:(n=o.value,"string"==typeof n?n.replace(U,""):null==n?"":n)}}}),b.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,o="select-one"===e.type||0>i,a=o?null:[],s=o?i+1:r.length,u=0>i?s:o?i:0;for(;s>u;u++)if(n=r[u],!(!n.selected&&u!==i||(b.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&b.nodeName(n.parentNode,"optgroup"))){if(t=b(n).val(),o)return t;a.push(t)}return a},set:function(e,t){var n=b.makeArray(t);return b(e).find("option").each(function(){this.selected=b.inArray(b(this).val(),n)>=0}),n.length||(e.selectedIndex=-1),n}}},attr:function(e,n,r){var o,a,s,u=e.nodeType;if(e&&3!==u&&8!==u&&2!==u)return typeof e.getAttribute===i?b.prop(e,n,r):(a=1!==u||!b.isXMLDoc(e),a&&(n=n.toLowerCase(),o=b.attrHooks[n]||(J.test(n)?z:I)),r===t?o&&a&&"get"in o&&null!==(s=o.get(e,n))?s:(typeof e.getAttribute!==i&&(s=e.getAttribute(n)),null==s?t:s):null!==r?o&&a&&"set"in o&&(s=o.set(e,r,n))!==t?s:(e.setAttribute(n,r+""),r):(b.removeAttr(e,n),t))},removeAttr:function(e,t){var n,r,i=0,o=t&&t.match(w);if(o&&1===e.nodeType)while(n=o[i++])r=b.propFix[n]||n,J.test(n)?!Q&&G.test(n)?e[b.camelCase("default-"+n)]=e[r]=!1:e[r]=!1:b.attr(e,n,""),e.removeAttribute(Q?n:r)},attrHooks:{type:{set:function(e,t){if(!b.support.radioValue&&"radio"===t&&b.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,n,r){var i,o,a,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return a=1!==s||!b.isXMLDoc(e),a&&(n=b.propFix[n]||n,o=b.propHooks[n]),r!==t?o&&"set"in o&&(i=o.set(e,r,n))!==t?i:e[n]=r:o&&"get"in o&&null!==(i=o.get(e,n))?i:e[n]},propHooks:{tabIndex:{get:function(e){var n=e.getAttributeNode("tabindex");return n&&n.specified?parseInt(n.value,10):V.test(e.nodeName)||Y.test(e.nodeName)&&e.href?0:t}}}}),z={get:function(e,n){var r=b.prop(e,n),i="boolean"==typeof r&&e.getAttribute(n),o="boolean"==typeof r?K&&Q?null!=i:G.test(n)?e[b.camelCase("default-"+n)]:!!i:e.getAttributeNode(n);return o&&o.value!==!1?n.toLowerCase():t},set:function(e,t,n){return t===!1?b.removeAttr(e,n):K&&Q||!G.test(n)?e.setAttribute(!Q&&b.propFix[n]||n,n):e[b.camelCase("default-"+n)]=e[n]=!0,n}},K&&Q||(b.attrHooks.value={get:function(e,n){var r=e.getAttributeNode(n);return b.nodeName(e,"input")?e.defaultValue:r&&r.specified?r.value:t},set:function(e,n,r){return b.nodeName(e,"input")?(e.defaultValue=n,t):I&&I.set(e,n,r)}}),Q||(I=b.valHooks.button={get:function(e,n){var r=e.getAttributeNode(n);return r&&("id"===n||"name"===n||"coords"===n?""!==r.value:r.specified)?r.value:t},set:function(e,n,r){var i=e.getAttributeNode(r);return i||e.setAttributeNode(i=e.ownerDocument.createAttribute(r)),i.value=n+="","value"===r||n===e.getAttribute(r)?n:t}},b.attrHooks.contenteditable={get:I.get,set:function(e,t,n){I.set(e,""===t?!1:t,n)}},b.each(["width","height"],function(e,n){b.attrHooks[n]=b.extend(b.attrHooks[n],{set:function(e,r){return""===r?(e.setAttribute(n,"auto"),r):t}})})),b.support.hrefNormalized||(b.each(["href","src","width","height"],function(e,n){b.attrHooks[n]=b.extend(b.attrHooks[n],{get:function(e){var r=e.getAttribute(n,2);return null==r?t:r}})}),b.each(["href","src"],function(e,t){b.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}})),b.support.style||(b.attrHooks.style={get:function(e){return e.style.cssText||t},set:function(e,t){return e.style.cssText=t+""}}),b.support.optSelected||(b.propHooks.selected=b.extend(b.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),b.support.enctype||(b.propFix.enctype="encoding"),b.support.checkOn||b.each(["radio","checkbox"],function(){b.valHooks[this]={get:function(e){return null===e.getAttribute("value")?"on":e.value}}}),b.each(["radio","checkbox"],function(){b.valHooks[this]=b.extend(b.valHooks[this],{set:function(e,n){return b.isArray(n)?e.checked=b.inArray(b(e).val(),n)>=0:t}})});var Z=/^(?:input|select|textarea)$/i,et=/^key/,tt=/^(?:mouse|contextmenu)|click/,nt=/^(?:focusinfocus|focusoutblur)$/,rt=/^([^.]*)(?:\.(.+)|)$/;function it(){return!0}function ot(){return!1}b.event={global:{},add:function(e,n,r,o,a){var s,u,l,c,p,f,d,h,g,m,y,v=b._data(e);if(v){r.handler&&(c=r,r=c.handler,a=c.selector),r.guid||(r.guid=b.guid++),(u=v.events)||(u=v.events={}),(f=v.handle)||(f=v.handle=function(e){return typeof b===i||e&&b.event.triggered===e.type?t:b.event.dispatch.apply(f.elem,arguments)},f.elem=e),n=(n||"").match(w)||[""],l=n.length;while(l--)s=rt.exec(n[l])||[],g=y=s[1],m=(s[2]||"").split(".").sort(),p=b.event.special[g]||{},g=(a?p.delegateType:p.bindType)||g,p=b.event.special[g]||{},d=b.extend({type:g,origType:y,data:o,handler:r,guid:r.guid,selector:a,needsContext:a&&b.expr.match.needsContext.test(a),namespace:m.join(".")},c),(h=u[g])||(h=u[g]=[],h.delegateCount=0,p.setup&&p.setup.call(e,o,m,f)!==!1||(e.addEventListener?e.addEventListener(g,f,!1):e.attachEvent&&e.attachEvent("on"+g,f))),p.add&&(p.add.call(e,d),d.handler.guid||(d.handler.guid=r.guid)),a?h.splice(h.delegateCount++,0,d):h.push(d),b.event.global[g]=!0;e=null}},remove:function(e,t,n,r,i){var o,a,s,u,l,c,p,f,d,h,g,m=b.hasData(e)&&b._data(e);if(m&&(c=m.events)){t=(t||"").match(w)||[""],l=t.length;while(l--)if(s=rt.exec(t[l])||[],d=g=s[1],h=(s[2]||"").split(".").sort(),d){p=b.event.special[d]||{},d=(r?p.delegateType:p.bindType)||d,f=c[d]||[],s=s[2]&&RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),u=o=f.length;while(o--)a=f[o],!i&&g!==a.origType||n&&n.guid!==a.guid||s&&!s.test(a.namespace)||r&&r!==a.selector&&("**"!==r||!a.selector)||(f.splice(o,1),a.selector&&f.delegateCount--,p.remove&&p.remove.call(e,a));u&&!f.length&&(p.teardown&&p.teardown.call(e,h,m.handle)!==!1||b.removeEvent(e,d,m.handle),delete c[d])}else for(d in c)b.event.remove(e,d+t[l],n,r,!0);b.isEmptyObject(c)&&(delete m.handle,b._removeData(e,"events"))}},trigger:function(n,r,i,a){var s,u,l,c,p,f,d,h=[i||o],g=y.call(n,"type")?n.type:n,m=y.call(n,"namespace")?n.namespace.split("."):[];if(l=f=i=i||o,3!==i.nodeType&&8!==i.nodeType&&!nt.test(g+b.event.triggered)&&(g.indexOf(".")>=0&&(m=g.split("."),g=m.shift(),m.sort()),u=0>g.indexOf(":")&&"on"+g,n=n[b.expando]?n:new b.Event(g,"object"==typeof n&&n),n.isTrigger=!0,n.namespace=m.join("."),n.namespace_re=n.namespace?RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,n.result=t,n.target||(n.target=i),r=null==r?[n]:b.makeArray(r,[n]),p=b.event.special[g]||{},a||!p.trigger||p.trigger.apply(i,r)!==!1)){if(!a&&!p.noBubble&&!b.isWindow(i)){for(c=p.delegateType||g,nt.test(c+g)||(l=l.parentNode);l;l=l.parentNode)h.push(l),f=l;f===(i.ownerDocument||o)&&h.push(f.defaultView||f.parentWindow||e)}d=0;while((l=h[d++])&&!n.isPropagationStopped())n.type=d>1?c:p.bindType||g,s=(b._data(l,"events")||{})[n.type]&&b._data(l,"handle"),s&&s.apply(l,r),s=u&&l[u],s&&b.acceptData(l)&&s.apply&&s.apply(l,r)===!1&&n.preventDefault();if(n.type=g,!(a||n.isDefaultPrevented()||p._default&&p._default.apply(i.ownerDocument,r)!==!1||"click"===g&&b.nodeName(i,"a")||!b.acceptData(i)||!u||!i[g]||b.isWindow(i))){f=i[u],f&&(i[u]=null),b.event.triggered=g;try{i[g]()}catch(v){}b.event.triggered=t,f&&(i[u]=f)}return n.result}},dispatch:function(e){e=b.event.fix(e);var n,r,i,o,a,s=[],u=h.call(arguments),l=(b._data(this,"events")||{})[e.type]||[],c=b.event.special[e.type]||{};if(u[0]=e,e.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,e)!==!1){s=b.event.handlers.call(this,e,l),n=0;while((o=s[n++])&&!e.isPropagationStopped()){e.currentTarget=o.elem,a=0;while((i=o.handlers[a++])&&!e.isImmediatePropagationStopped())(!e.namespace_re||e.namespace_re.test(i.namespace))&&(e.handleObj=i,e.data=i.data,r=((b.event.special[i.origType]||{}).handle||i.handler).apply(o.elem,u),r!==t&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation()))}return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers:function(e,n){var r,i,o,a,s=[],u=n.delegateCount,l=e.target;if(u&&l.nodeType&&(!e.button||"click"!==e.type))for(;l!=this;l=l.parentNode||this)if(1===l.nodeType&&(l.disabled!==!0||"click"!==e.type)){for(o=[],a=0;u>a;a++)i=n[a],r=i.selector+" ",o[r]===t&&(o[r]=i.needsContext?b(r,this).index(l)>=0:b.find(r,this,null,[l]).length),o[r]&&o.push(i);o.length&&s.push({elem:l,handlers:o})}return n.length>u&&s.push({elem:this,handlers:n.slice(u)}),s},fix:function(e){if(e[b.expando])return e;var t,n,r,i=e.type,a=e,s=this.fixHooks[i];s||(this.fixHooks[i]=s=tt.test(i)?this.mouseHooks:et.test(i)?this.keyHooks:{}),r=s.props?this.props.concat(s.props):this.props,e=new b.Event(a),t=r.length;while(t--)n=r[t],e[n]=a[n];return e.target||(e.target=a.srcElement||o),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,s.filter?s.filter(e,a):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var r,i,a,s=n.button,u=n.fromElement;return null==e.pageX&&null!=n.clientX&&(i=e.target.ownerDocument||o,a=i.documentElement,r=i.body,e.pageX=n.clientX+(a&&a.scrollLeft||r&&r.scrollLeft||0)-(a&&a.clientLeft||r&&r.clientLeft||0),e.pageY=n.clientY+(a&&a.scrollTop||r&&r.scrollTop||0)-(a&&a.clientTop||r&&r.clientTop||0)),!e.relatedTarget&&u&&(e.relatedTarget=u===e.target?n.toElement:u),e.which||s===t||(e.which=1&s?1:2&s?3:4&s?2:0),e}},special:{load:{noBubble:!0},click:{trigger:function(){return b.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):t}},focus:{trigger:function(){if(this!==o.activeElement&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===o.activeElement&&this.blur?(this.blur(),!1):t},delegateType:"focusout"},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=b.extend(new b.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?b.event.trigger(i,null,t):b.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},b.removeEvent=o.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&(typeof e[r]===i&&(e[r]=null),e.detachEvent(r,n))},b.Event=function(e,n){return this instanceof b.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?it:ot):this.type=e,n&&b.extend(this,n),this.timeStamp=e&&e.timeStamp||b.now(),this[b.expando]=!0,t):new b.Event(e,n)},b.Event.prototype={isDefaultPrevented:ot,isPropagationStopped:ot,isImmediatePropagationStopped:ot,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=it,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=it,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=it,this.stopPropagation()}},b.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){b.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,o=e.handleObj;
return(!i||i!==r&&!b.contains(r,i))&&(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),b.support.submitBubbles||(b.event.special.submit={setup:function(){return b.nodeName(this,"form")?!1:(b.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,r=b.nodeName(n,"input")||b.nodeName(n,"button")?n.form:t;r&&!b._data(r,"submitBubbles")&&(b.event.add(r,"submit._submit",function(e){e._submit_bubble=!0}),b._data(r,"submitBubbles",!0))}),t)},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&b.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return b.nodeName(this,"form")?!1:(b.event.remove(this,"._submit"),t)}}),b.support.changeBubbles||(b.event.special.change={setup:function(){return Z.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(b.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),b.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),b.event.simulate("change",this,e,!0)})),!1):(b.event.add(this,"beforeactivate._change",function(e){var t=e.target;Z.test(t.nodeName)&&!b._data(t,"changeBubbles")&&(b.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||b.event.simulate("change",this.parentNode,e,!0)}),b._data(t,"changeBubbles",!0))}),t)},handle:function(e){var n=e.target;return this!==n||e.isSimulated||e.isTrigger||"radio"!==n.type&&"checkbox"!==n.type?e.handleObj.handler.apply(this,arguments):t},teardown:function(){return b.event.remove(this,"._change"),!Z.test(this.nodeName)}}),b.support.focusinBubbles||b.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){b.event.simulate(t,e.target,b.event.fix(e),!0)};b.event.special[t]={setup:function(){0===n++&&o.addEventListener(e,r,!0)},teardown:function(){0===--n&&o.removeEventListener(e,r,!0)}}}),b.fn.extend({on:function(e,n,r,i,o){var a,s;if("object"==typeof e){"string"!=typeof n&&(r=r||n,n=t);for(a in e)this.on(a,n,r,e[a],o);return this}if(null==r&&null==i?(i=n,r=n=t):null==i&&("string"==typeof n?(i=r,r=t):(i=r,r=n,n=t)),i===!1)i=ot;else if(!i)return this;return 1===o&&(s=i,i=function(e){return b().off(e),s.apply(this,arguments)},i.guid=s.guid||(s.guid=b.guid++)),this.each(function(){b.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,n,r){var i,o;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,b(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(o in e)this.off(o,n,e[o]);return this}return(n===!1||"function"==typeof n)&&(r=n,n=t),r===!1&&(r=ot),this.each(function(){b.event.remove(this,e,r,n)})},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},trigger:function(e,t){return this.each(function(){b.event.trigger(e,t,this)})},triggerHandler:function(e,n){var r=this[0];return r?b.event.trigger(e,n,r,!0):t}}),function(e,t){var n,r,i,o,a,s,u,l,c,p,f,d,h,g,m,y,v,x="sizzle"+-new Date,w=e.document,T={},N=0,C=0,k=it(),E=it(),S=it(),A=typeof t,j=1<<31,D=[],L=D.pop,H=D.push,q=D.slice,M=D.indexOf||function(e){var t=0,n=this.length;for(;n>t;t++)if(this[t]===e)return t;return-1},_="[\\x20\\t\\r\\n\\f]",F="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",O=F.replace("w","w#"),B="([*^$|!~]?=)",P="\\["+_+"*("+F+")"+_+"*(?:"+B+_+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+O+")|)|)"+_+"*\\]",R=":("+F+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+P.replace(3,8)+")*)|.*)\\)|)",W=RegExp("^"+_+"+|((?:^|[^\\\\])(?:\\\\.)*)"+_+"+$","g"),$=RegExp("^"+_+"*,"+_+"*"),I=RegExp("^"+_+"*([\\x20\\t\\r\\n\\f>+~])"+_+"*"),z=RegExp(R),X=RegExp("^"+O+"$"),U={ID:RegExp("^#("+F+")"),CLASS:RegExp("^\\.("+F+")"),NAME:RegExp("^\\[name=['\"]?("+F+")['\"]?\\]"),TAG:RegExp("^("+F.replace("w","w*")+")"),ATTR:RegExp("^"+P),PSEUDO:RegExp("^"+R),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+_+"*(even|odd|(([+-]|)(\\d*)n|)"+_+"*(?:([+-]|)"+_+"*(\\d+)|))"+_+"*\\)|)","i"),needsContext:RegExp("^"+_+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+_+"*((?:-\\d)?\\d*)"+_+"*\\)|)(?=[^-]|$)","i")},V=/[\x20\t\r\n\f]*[+~]/,Y=/^[^{]+\{\s*\[native code/,J=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,G=/^(?:input|select|textarea|button)$/i,Q=/^h\d$/i,K=/'|\\/g,Z=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,et=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,tt=function(e,t){var n="0x"+t-65536;return n!==n?t:0>n?String.fromCharCode(n+65536):String.fromCharCode(55296|n>>10,56320|1023&n)};try{q.call(w.documentElement.childNodes,0)[0].nodeType}catch(nt){q=function(e){var t,n=[];while(t=this[e++])n.push(t);return n}}function rt(e){return Y.test(e+"")}function it(){var e,t=[];return e=function(n,r){return t.push(n+=" ")>i.cacheLength&&delete e[t.shift()],e[n]=r}}function ot(e){return e[x]=!0,e}function at(e){var t=p.createElement("div");try{return e(t)}catch(n){return!1}finally{t=null}}function st(e,t,n,r){var i,o,a,s,u,l,f,g,m,v;if((t?t.ownerDocument||t:w)!==p&&c(t),t=t||p,n=n||[],!e||"string"!=typeof e)return n;if(1!==(s=t.nodeType)&&9!==s)return[];if(!d&&!r){if(i=J.exec(e))if(a=i[1]){if(9===s){if(o=t.getElementById(a),!o||!o.parentNode)return n;if(o.id===a)return n.push(o),n}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(a))&&y(t,o)&&o.id===a)return n.push(o),n}else{if(i[2])return H.apply(n,q.call(t.getElementsByTagName(e),0)),n;if((a=i[3])&&T.getByClassName&&t.getElementsByClassName)return H.apply(n,q.call(t.getElementsByClassName(a),0)),n}if(T.qsa&&!h.test(e)){if(f=!0,g=x,m=t,v=9===s&&e,1===s&&"object"!==t.nodeName.toLowerCase()){l=ft(e),(f=t.getAttribute("id"))?g=f.replace(K,"\\$&"):t.setAttribute("id",g),g="[id='"+g+"'] ",u=l.length;while(u--)l[u]=g+dt(l[u]);m=V.test(e)&&t.parentNode||t,v=l.join(",")}if(v)try{return H.apply(n,q.call(m.querySelectorAll(v),0)),n}catch(b){}finally{f||t.removeAttribute("id")}}}return wt(e.replace(W,"$1"),t,n,r)}a=st.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},c=st.setDocument=function(e){var n=e?e.ownerDocument||e:w;return n!==p&&9===n.nodeType&&n.documentElement?(p=n,f=n.documentElement,d=a(n),T.tagNameNoComments=at(function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length}),T.attributes=at(function(e){e.innerHTML="<select></select>";var t=typeof e.lastChild.getAttribute("multiple");return"boolean"!==t&&"string"!==t}),T.getByClassName=at(function(e){return e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",e.getElementsByClassName&&e.getElementsByClassName("e").length?(e.lastChild.className="e",2===e.getElementsByClassName("e").length):!1}),T.getByName=at(function(e){e.id=x+0,e.innerHTML="<a name='"+x+"'></a><div name='"+x+"'></div>",f.insertBefore(e,f.firstChild);var t=n.getElementsByName&&n.getElementsByName(x).length===2+n.getElementsByName(x+0).length;return T.getIdNotName=!n.getElementById(x),f.removeChild(e),t}),i.attrHandle=at(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!==A&&"#"===e.firstChild.getAttribute("href")})?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},T.getIdNotName?(i.find.ID=function(e,t){if(typeof t.getElementById!==A&&!d){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},i.filter.ID=function(e){var t=e.replace(et,tt);return function(e){return e.getAttribute("id")===t}}):(i.find.ID=function(e,n){if(typeof n.getElementById!==A&&!d){var r=n.getElementById(e);return r?r.id===e||typeof r.getAttributeNode!==A&&r.getAttributeNode("id").value===e?[r]:t:[]}},i.filter.ID=function(e){var t=e.replace(et,tt);return function(e){var n=typeof e.getAttributeNode!==A&&e.getAttributeNode("id");return n&&n.value===t}}),i.find.TAG=T.tagNameNoComments?function(e,n){return typeof n.getElementsByTagName!==A?n.getElementsByTagName(e):t}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){while(n=o[i++])1===n.nodeType&&r.push(n);return r}return o},i.find.NAME=T.getByName&&function(e,n){return typeof n.getElementsByName!==A?n.getElementsByName(name):t},i.find.CLASS=T.getByClassName&&function(e,n){return typeof n.getElementsByClassName===A||d?t:n.getElementsByClassName(e)},g=[],h=[":focus"],(T.qsa=rt(n.querySelectorAll))&&(at(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||h.push("\\["+_+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),e.querySelectorAll(":checked").length||h.push(":checked")}),at(function(e){e.innerHTML="<input type='hidden' i=''/>",e.querySelectorAll("[i^='']").length&&h.push("[*^$]="+_+"*(?:\"\"|'')"),e.querySelectorAll(":enabled").length||h.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),h.push(",.*:")})),(T.matchesSelector=rt(m=f.matchesSelector||f.mozMatchesSelector||f.webkitMatchesSelector||f.oMatchesSelector||f.msMatchesSelector))&&at(function(e){T.disconnectedMatch=m.call(e,"div"),m.call(e,"[s!='']:x"),g.push("!=",R)}),h=RegExp(h.join("|")),g=RegExp(g.join("|")),y=rt(f.contains)||f.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},v=f.compareDocumentPosition?function(e,t){var r;return e===t?(u=!0,0):(r=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t))?1&r||e.parentNode&&11===e.parentNode.nodeType?e===n||y(w,e)?-1:t===n||y(w,t)?1:0:4&r?-1:1:e.compareDocumentPosition?-1:1}:function(e,t){var r,i=0,o=e.parentNode,a=t.parentNode,s=[e],l=[t];if(e===t)return u=!0,0;if(!o||!a)return e===n?-1:t===n?1:o?-1:a?1:0;if(o===a)return ut(e,t);r=e;while(r=r.parentNode)s.unshift(r);r=t;while(r=r.parentNode)l.unshift(r);while(s[i]===l[i])i++;return i?ut(s[i],l[i]):s[i]===w?-1:l[i]===w?1:0},u=!1,[0,0].sort(v),T.detectDuplicates=u,p):p},st.matches=function(e,t){return st(e,null,null,t)},st.matchesSelector=function(e,t){if((e.ownerDocument||e)!==p&&c(e),t=t.replace(Z,"='$1']"),!(!T.matchesSelector||d||g&&g.test(t)||h.test(t)))try{var n=m.call(e,t);if(n||T.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(r){}return st(t,p,null,[e]).length>0},st.contains=function(e,t){return(e.ownerDocument||e)!==p&&c(e),y(e,t)},st.attr=function(e,t){var n;return(e.ownerDocument||e)!==p&&c(e),d||(t=t.toLowerCase()),(n=i.attrHandle[t])?n(e):d||T.attributes?e.getAttribute(t):((n=e.getAttributeNode(t))||e.getAttribute(t))&&e[t]===!0?t:n&&n.specified?n.value:null},st.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},st.uniqueSort=function(e){var t,n=[],r=1,i=0;if(u=!T.detectDuplicates,e.sort(v),u){for(;t=e[r];r++)t===e[r-1]&&(i=n.push(r));while(i--)e.splice(n[i],1)}return e};function ut(e,t){var n=t&&e,r=n&&(~t.sourceIndex||j)-(~e.sourceIndex||j);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function lt(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function ct(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function pt(e){return ot(function(t){return t=+t,ot(function(n,r){var i,o=e([],n.length,t),a=o.length;while(a--)n[i=o[a]]&&(n[i]=!(r[i]=n[i]))})})}o=st.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r];r++)n+=o(t);return n},i=st.selectors={cacheLength:50,createPseudo:ot,match:U,find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(et,tt),e[3]=(e[4]||e[5]||"").replace(et,tt),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||st.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&st.error(e[0]),e},PSEUDO:function(e){var t,n=!e[5]&&e[2];return U.CHILD.test(e[0])?null:(e[4]?e[2]=e[4]:n&&z.test(n)&&(t=ft(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){return"*"===e?function(){return!0}:(e=e.replace(et,tt).toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===e})},CLASS:function(e){var t=k[e+" "];return t||(t=RegExp("(^|"+_+")"+e+"("+_+"|$)"))&&k(e,function(e){return t.test(e.className||typeof e.getAttribute!==A&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=st.attr(r,e);return null==i?"!="===t:t?(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i+" ").indexOf(n)>-1:"|="===t?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,u){var l,c,p,f,d,h,g=o!==a?"nextSibling":"previousSibling",m=t.parentNode,y=s&&t.nodeName.toLowerCase(),v=!u&&!s;if(m){if(o){while(g){p=t;while(p=p[g])if(s?p.nodeName.toLowerCase()===y:1===p.nodeType)return!1;h=g="only"===e&&!h&&"nextSibling"}return!0}if(h=[a?m.firstChild:m.lastChild],a&&v){c=m[x]||(m[x]={}),l=c[e]||[],d=l[0]===N&&l[1],f=l[0]===N&&l[2],p=d&&m.childNodes[d];while(p=++d&&p&&p[g]||(f=d=0)||h.pop())if(1===p.nodeType&&++f&&p===t){c[e]=[N,d,f];break}}else if(v&&(l=(t[x]||(t[x]={}))[e])&&l[0]===N)f=l[1];else while(p=++d&&p&&p[g]||(f=d=0)||h.pop())if((s?p.nodeName.toLowerCase()===y:1===p.nodeType)&&++f&&(v&&((p[x]||(p[x]={}))[e]=[N,f]),p===t))break;return f-=i,f===r||0===f%r&&f/r>=0}}},PSEUDO:function(e,t){var n,r=i.pseudos[e]||i.setFilters[e.toLowerCase()]||st.error("unsupported pseudo: "+e);return r[x]?r(t):r.length>1?(n=[e,e,"",t],i.setFilters.hasOwnProperty(e.toLowerCase())?ot(function(e,n){var i,o=r(e,t),a=o.length;while(a--)i=M.call(e,o[a]),e[i]=!(n[i]=o[a])}):function(e){return r(e,0,n)}):r}},pseudos:{not:ot(function(e){var t=[],n=[],r=s(e.replace(W,"$1"));return r[x]?ot(function(e,t,n,i){var o,a=r(e,null,i,[]),s=e.length;while(s--)(o=a[s])&&(e[s]=!(t[s]=o))}):function(e,i,o){return t[0]=e,r(t,null,o,n),!n.pop()}}),has:ot(function(e){return function(t){return st(e,t).length>0}}),contains:ot(function(e){return function(t){return(t.textContent||t.innerText||o(t)).indexOf(e)>-1}}),lang:ot(function(e){return X.test(e||"")||st.error("unsupported lang: "+e),e=e.replace(et,tt).toLowerCase(),function(t){var n;do if(n=d?t.getAttribute("xml:lang")||t.getAttribute("lang"):t.lang)return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===f},focus:function(e){return e===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!i.pseudos.empty(e)},header:function(e){return Q.test(e.nodeName)},input:function(e){return G.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:pt(function(){return[0]}),last:pt(function(e,t){return[t-1]}),eq:pt(function(e,t,n){return[0>n?n+t:n]}),even:pt(function(e,t){var n=0;for(;t>n;n+=2)e.push(n);return e}),odd:pt(function(e,t){var n=1;for(;t>n;n+=2)e.push(n);return e}),lt:pt(function(e,t,n){var r=0>n?n+t:n;for(;--r>=0;)e.push(r);return e}),gt:pt(function(e,t,n){var r=0>n?n+t:n;for(;t>++r;)e.push(r);return e})}};for(n in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[n]=lt(n);for(n in{submit:!0,reset:!0})i.pseudos[n]=ct(n);function ft(e,t){var n,r,o,a,s,u,l,c=E[e+" "];if(c)return t?0:c.slice(0);s=e,u=[],l=i.preFilter;while(s){(!n||(r=$.exec(s)))&&(r&&(s=s.slice(r[0].length)||s),u.push(o=[])),n=!1,(r=I.exec(s))&&(n=r.shift(),o.push({value:n,type:r[0].replace(W," ")}),s=s.slice(n.length));for(a in i.filter)!(r=U[a].exec(s))||l[a]&&!(r=l[a](r))||(n=r.shift(),o.push({value:n,type:a,matches:r}),s=s.slice(n.length));if(!n)break}return t?s.length:s?st.error(e):E(e,u).slice(0)}function dt(e){var t=0,n=e.length,r="";for(;n>t;t++)r+=e[t].value;return r}function ht(e,t,n){var i=t.dir,o=n&&"parentNode"===i,a=C++;return t.first?function(t,n,r){while(t=t[i])if(1===t.nodeType||o)return e(t,n,r)}:function(t,n,s){var u,l,c,p=N+" "+a;if(s){while(t=t[i])if((1===t.nodeType||o)&&e(t,n,s))return!0}else while(t=t[i])if(1===t.nodeType||o)if(c=t[x]||(t[x]={}),(l=c[i])&&l[0]===p){if((u=l[1])===!0||u===r)return u===!0}else if(l=c[i]=[p],l[1]=e(t,n,s)||r,l[1]===!0)return!0}}function gt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function mt(e,t,n,r,i){var o,a=[],s=0,u=e.length,l=null!=t;for(;u>s;s++)(o=e[s])&&(!n||n(o,r,i))&&(a.push(o),l&&t.push(s));return a}function yt(e,t,n,r,i,o){return r&&!r[x]&&(r=yt(r)),i&&!i[x]&&(i=yt(i,o)),ot(function(o,a,s,u){var l,c,p,f=[],d=[],h=a.length,g=o||xt(t||"*",s.nodeType?[s]:s,[]),m=!e||!o&&t?g:mt(g,f,e,s,u),y=n?i||(o?e:h||r)?[]:a:m;if(n&&n(m,y,s,u),r){l=mt(y,d),r(l,[],s,u),c=l.length;while(c--)(p=l[c])&&(y[d[c]]=!(m[d[c]]=p))}if(o){if(i||e){if(i){l=[],c=y.length;while(c--)(p=y[c])&&l.push(m[c]=p);i(null,y=[],l,u)}c=y.length;while(c--)(p=y[c])&&(l=i?M.call(o,p):f[c])>-1&&(o[l]=!(a[l]=p))}}else y=mt(y===a?y.splice(h,y.length):y),i?i(null,a,y,u):H.apply(a,y)})}function vt(e){var t,n,r,o=e.length,a=i.relative[e[0].type],s=a||i.relative[" "],u=a?1:0,c=ht(function(e){return e===t},s,!0),p=ht(function(e){return M.call(t,e)>-1},s,!0),f=[function(e,n,r){return!a&&(r||n!==l)||((t=n).nodeType?c(e,n,r):p(e,n,r))}];for(;o>u;u++)if(n=i.relative[e[u].type])f=[ht(gt(f),n)];else{if(n=i.filter[e[u].type].apply(null,e[u].matches),n[x]){for(r=++u;o>r;r++)if(i.relative[e[r].type])break;return yt(u>1&&gt(f),u>1&&dt(e.slice(0,u-1)).replace(W,"$1"),n,r>u&&vt(e.slice(u,r)),o>r&&vt(e=e.slice(r)),o>r&&dt(e))}f.push(n)}return gt(f)}function bt(e,t){var n=0,o=t.length>0,a=e.length>0,s=function(s,u,c,f,d){var h,g,m,y=[],v=0,b="0",x=s&&[],w=null!=d,T=l,C=s||a&&i.find.TAG("*",d&&u.parentNode||u),k=N+=null==T?1:Math.random()||.1;for(w&&(l=u!==p&&u,r=n);null!=(h=C[b]);b++){if(a&&h){g=0;while(m=e[g++])if(m(h,u,c)){f.push(h);break}w&&(N=k,r=++n)}o&&((h=!m&&h)&&v--,s&&x.push(h))}if(v+=b,o&&b!==v){g=0;while(m=t[g++])m(x,y,u,c);if(s){if(v>0)while(b--)x[b]||y[b]||(y[b]=L.call(f));y=mt(y)}H.apply(f,y),w&&!s&&y.length>0&&v+t.length>1&&st.uniqueSort(f)}return w&&(N=k,l=T),x};return o?ot(s):s}s=st.compile=function(e,t){var n,r=[],i=[],o=S[e+" "];if(!o){t||(t=ft(e)),n=t.length;while(n--)o=vt(t[n]),o[x]?r.push(o):i.push(o);o=S(e,bt(i,r))}return o};function xt(e,t,n){var r=0,i=t.length;for(;i>r;r++)st(e,t[r],n);return n}function wt(e,t,n,r){var o,a,u,l,c,p=ft(e);if(!r&&1===p.length){if(a=p[0]=p[0].slice(0),a.length>2&&"ID"===(u=a[0]).type&&9===t.nodeType&&!d&&i.relative[a[1].type]){if(t=i.find.ID(u.matches[0].replace(et,tt),t)[0],!t)return n;e=e.slice(a.shift().value.length)}o=U.needsContext.test(e)?0:a.length;while(o--){if(u=a[o],i.relative[l=u.type])break;if((c=i.find[l])&&(r=c(u.matches[0].replace(et,tt),V.test(a[0].type)&&t.parentNode||t))){if(a.splice(o,1),e=r.length&&dt(a),!e)return H.apply(n,q.call(r,0)),n;break}}}return s(e,p)(r,t,d,n,V.test(e)),n}i.pseudos.nth=i.pseudos.eq;function Tt(){}i.filters=Tt.prototype=i.pseudos,i.setFilters=new Tt,c(),st.attr=b.attr,b.find=st,b.expr=st.selectors,b.expr[":"]=b.expr.pseudos,b.unique=st.uniqueSort,b.text=st.getText,b.isXMLDoc=st.isXML,b.contains=st.contains}(e);var at=/Until$/,st=/^(?:parents|prev(?:Until|All))/,ut=/^.[^:#\[\.,]*$/,lt=b.expr.match.needsContext,ct={children:!0,contents:!0,next:!0,prev:!0};b.fn.extend({find:function(e){var t,n,r,i=this.length;if("string"!=typeof e)return r=this,this.pushStack(b(e).filter(function(){for(t=0;i>t;t++)if(b.contains(r[t],this))return!0}));for(n=[],t=0;i>t;t++)b.find(e,this[t],n);return n=this.pushStack(i>1?b.unique(n):n),n.selector=(this.selector?this.selector+" ":"")+e,n},has:function(e){var t,n=b(e,this),r=n.length;return this.filter(function(){for(t=0;r>t;t++)if(b.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(ft(this,e,!1))},filter:function(e){return this.pushStack(ft(this,e,!0))},is:function(e){return!!e&&("string"==typeof e?lt.test(e)?b(e,this.context).index(this[0])>=0:b.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){var n,r=0,i=this.length,o=[],a=lt.test(e)||"string"!=typeof e?b(e,t||this.context):0;for(;i>r;r++){n=this[r];while(n&&n.ownerDocument&&n!==t&&11!==n.nodeType){if(a?a.index(n)>-1:b.find.matchesSelector(n,e)){o.push(n);break}n=n.parentNode}}return this.pushStack(o.length>1?b.unique(o):o)},index:function(e){return e?"string"==typeof e?b.inArray(this[0],b(e)):b.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n="string"==typeof e?b(e,t):b.makeArray(e&&e.nodeType?[e]:e),r=b.merge(this.get(),n);return this.pushStack(b.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),b.fn.andSelf=b.fn.addBack;function pt(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}b.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return b.dir(e,"parentNode")},parentsUntil:function(e,t,n){return b.dir(e,"parentNode",n)},next:function(e){return pt(e,"nextSibling")},prev:function(e){return pt(e,"previousSibling")},nextAll:function(e){return b.dir(e,"nextSibling")},prevAll:function(e){return b.dir(e,"previousSibling")},nextUntil:function(e,t,n){return b.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return b.dir(e,"previousSibling",n)},siblings:function(e){return b.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return b.sibling(e.firstChild)},contents:function(e){return b.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:b.merge([],e.childNodes)}},function(e,t){b.fn[e]=function(n,r){var i=b.map(this,t,n);return at.test(e)||(r=n),r&&"string"==typeof r&&(i=b.filter(r,i)),i=this.length>1&&!ct[e]?b.unique(i):i,this.length>1&&st.test(e)&&(i=i.reverse()),this.pushStack(i)}}),b.extend({filter:function(e,t,n){return n&&(e=":not("+e+")"),1===t.length?b.find.matchesSelector(t[0],e)?[t[0]]:[]:b.find.matches(e,t)},dir:function(e,n,r){var i=[],o=e[n];while(o&&9!==o.nodeType&&(r===t||1!==o.nodeType||!b(o).is(r)))1===o.nodeType&&i.push(o),o=o[n];return i},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});function ft(e,t,n){if(t=t||0,b.isFunction(t))return b.grep(e,function(e,r){var i=!!t.call(e,r,e);return i===n});if(t.nodeType)return b.grep(e,function(e){return e===t===n});if("string"==typeof t){var r=b.grep(e,function(e){return 1===e.nodeType});if(ut.test(t))return b.filter(t,r,!n);t=b.filter(t,r)}return b.grep(e,function(e){return b.inArray(e,t)>=0===n})}function dt(e){var t=ht.split("|"),n=e.createDocumentFragment();if(n.createElement)while(t.length)n.createElement(t.pop());return n}var ht="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",gt=/ jQuery\d+="(?:null|\d+)"/g,mt=RegExp("<(?:"+ht+")[\\s/>]","i"),yt=/^\s+/,vt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,bt=/<([\w:]+)/,xt=/<tbody/i,wt=/<|&#?\w+;/,Tt=/<(?:script|style|link)/i,Nt=/^(?:checkbox|radio)$/i,Ct=/checked\s*(?:[^=]|=\s*.checked.)/i,kt=/^$|\/(?:java|ecma)script/i,Et=/^true\/(.*)/,St=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,At={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:b.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},jt=dt(o),Dt=jt.appendChild(o.createElement("div"));At.optgroup=At.option,At.tbody=At.tfoot=At.colgroup=At.caption=At.thead,At.th=At.td,b.fn.extend({text:function(e){return b.access(this,function(e){return e===t?b.text(this):this.empty().append((this[0]&&this[0].ownerDocument||o).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(b.isFunction(e))return this.each(function(t){b(this).wrapAll(e.call(this,t))});if(this[0]){var t=b(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstChild&&1===e.firstChild.nodeType)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return b.isFunction(e)?this.each(function(t){b(this).wrapInner(e.call(this,t))}):this.each(function(){var t=b(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=b.isFunction(e);return this.each(function(n){b(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){b.nodeName(this,"body")||b(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.insertBefore(e,this.firstChild)})},before:function(){return this.domManip(arguments,!1,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,!1,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=0;for(;null!=(n=this[r]);r++)(!e||b.filter(e,[n]).length>0)&&(t||1!==n.nodeType||b.cleanData(Ot(n)),n.parentNode&&(t&&b.contains(n.ownerDocument,n)&&Mt(Ot(n,"script")),n.parentNode.removeChild(n)));return this},empty:function(){var e,t=0;for(;null!=(e=this[t]);t++){1===e.nodeType&&b.cleanData(Ot(e,!1));while(e.firstChild)e.removeChild(e.firstChild);e.options&&b.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return b.clone(this,e,t)})},html:function(e){return b.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t)return 1===n.nodeType?n.innerHTML.replace(gt,""):t;if(!("string"!=typeof e||Tt.test(e)||!b.support.htmlSerialize&&mt.test(e)||!b.support.leadingWhitespace&&yt.test(e)||At[(bt.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(vt,"<$1></$2>");try{for(;i>r;r++)n=this[r]||{},1===n.nodeType&&(b.cleanData(Ot(n,!1)),n.innerHTML=e);n=0}catch(o){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){var t=b.isFunction(e);return t||"string"==typeof e||(e=b(e).not(this).detach()),this.domManip([e],!0,function(e){var t=this.nextSibling,n=this.parentNode;n&&(b(this).remove(),n.insertBefore(e,t))})},detach:function(e){return this.remove(e,!0)},domManip:function(e,n,r){e=f.apply([],e);var i,o,a,s,u,l,c=0,p=this.length,d=this,h=p-1,g=e[0],m=b.isFunction(g);if(m||!(1>=p||"string"!=typeof g||b.support.checkClone)&&Ct.test(g))return this.each(function(i){var o=d.eq(i);m&&(e[0]=g.call(this,i,n?o.html():t)),o.domManip(e,n,r)});if(p&&(l=b.buildFragment(e,this[0].ownerDocument,!1,this),i=l.firstChild,1===l.childNodes.length&&(l=i),i)){for(n=n&&b.nodeName(i,"tr"),s=b.map(Ot(l,"script"),Ht),a=s.length;p>c;c++)o=l,c!==h&&(o=b.clone(o,!0,!0),a&&b.merge(s,Ot(o,"script"))),r.call(n&&b.nodeName(this[c],"table")?Lt(this[c],"tbody"):this[c],o,c);if(a)for(u=s[s.length-1].ownerDocument,b.map(s,qt),c=0;a>c;c++)o=s[c],kt.test(o.type||"")&&!b._data(o,"globalEval")&&b.contains(u,o)&&(o.src?b.ajax({url:o.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):b.globalEval((o.text||o.textContent||o.innerHTML||"").replace(St,"")));l=i=null}return this}});function Lt(e,t){return e.getElementsByTagName(t)[0]||e.appendChild(e.ownerDocument.createElement(t))}function Ht(e){var t=e.getAttributeNode("type");return e.type=(t&&t.specified)+"/"+e.type,e}function qt(e){var t=Et.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function Mt(e,t){var n,r=0;for(;null!=(n=e[r]);r++)b._data(n,"globalEval",!t||b._data(t[r],"globalEval"))}function _t(e,t){if(1===t.nodeType&&b.hasData(e)){var n,r,i,o=b._data(e),a=b._data(t,o),s=o.events;if(s){delete a.handle,a.events={};for(n in s)for(r=0,i=s[n].length;i>r;r++)b.event.add(t,n,s[n][r])}a.data&&(a.data=b.extend({},a.data))}}function Ft(e,t){var n,r,i;if(1===t.nodeType){if(n=t.nodeName.toLowerCase(),!b.support.noCloneEvent&&t[b.expando]){i=b._data(t);for(r in i.events)b.removeEvent(t,r,i.handle);t.removeAttribute(b.expando)}"script"===n&&t.text!==e.text?(Ht(t).text=e.text,qt(t)):"object"===n?(t.parentNode&&(t.outerHTML=e.outerHTML),b.support.html5Clone&&e.innerHTML&&!b.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===n&&Nt.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===n?t.defaultSelected=t.selected=e.defaultSelected:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}}b.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){b.fn[e]=function(e){var n,r=0,i=[],o=b(e),a=o.length-1;for(;a>=r;r++)n=r===a?this:this.clone(!0),b(o[r])[t](n),d.apply(i,n.get());return this.pushStack(i)}});function Ot(e,n){var r,o,a=0,s=typeof e.getElementsByTagName!==i?e.getElementsByTagName(n||"*"):typeof e.querySelectorAll!==i?e.querySelectorAll(n||"*"):t;if(!s)for(s=[],r=e.childNodes||e;null!=(o=r[a]);a++)!n||b.nodeName(o,n)?s.push(o):b.merge(s,Ot(o,n));return n===t||n&&b.nodeName(e,n)?b.merge([e],s):s}function Bt(e){Nt.test(e.type)&&(e.defaultChecked=e.checked)}b.extend({clone:function(e,t,n){var r,i,o,a,s,u=b.contains(e.ownerDocument,e);if(b.support.html5Clone||b.isXMLDoc(e)||!mt.test("<"+e.nodeName+">")?o=e.cloneNode(!0):(Dt.innerHTML=e.outerHTML,Dt.removeChild(o=Dt.firstChild)),!(b.support.noCloneEvent&&b.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||b.isXMLDoc(e)))for(r=Ot(o),s=Ot(e),a=0;null!=(i=s[a]);++a)r[a]&&Ft(i,r[a]);if(t)if(n)for(s=s||Ot(e),r=r||Ot(o),a=0;null!=(i=s[a]);a++)_t(i,r[a]);else _t(e,o);return r=Ot(o,"script"),r.length>0&&Mt(r,!u&&Ot(e,"script")),r=s=i=null,o},buildFragment:function(e,t,n,r){var i,o,a,s,u,l,c,p=e.length,f=dt(t),d=[],h=0;for(;p>h;h++)if(o=e[h],o||0===o)if("object"===b.type(o))b.merge(d,o.nodeType?[o]:o);else if(wt.test(o)){s=s||f.appendChild(t.createElement("div")),u=(bt.exec(o)||["",""])[1].toLowerCase(),c=At[u]||At._default,s.innerHTML=c[1]+o.replace(vt,"<$1></$2>")+c[2],i=c[0];while(i--)s=s.lastChild;if(!b.support.leadingWhitespace&&yt.test(o)&&d.push(t.createTextNode(yt.exec(o)[0])),!b.support.tbody){o="table"!==u||xt.test(o)?"<table>"!==c[1]||xt.test(o)?0:s:s.firstChild,i=o&&o.childNodes.length;while(i--)b.nodeName(l=o.childNodes[i],"tbody")&&!l.childNodes.length&&o.removeChild(l)
}b.merge(d,s.childNodes),s.textContent="";while(s.firstChild)s.removeChild(s.firstChild);s=f.lastChild}else d.push(t.createTextNode(o));s&&f.removeChild(s),b.support.appendChecked||b.grep(Ot(d,"input"),Bt),h=0;while(o=d[h++])if((!r||-1===b.inArray(o,r))&&(a=b.contains(o.ownerDocument,o),s=Ot(f.appendChild(o),"script"),a&&Mt(s),n)){i=0;while(o=s[i++])kt.test(o.type||"")&&n.push(o)}return s=null,f},cleanData:function(e,t){var n,r,o,a,s=0,u=b.expando,l=b.cache,p=b.support.deleteExpando,f=b.event.special;for(;null!=(n=e[s]);s++)if((t||b.acceptData(n))&&(o=n[u],a=o&&l[o])){if(a.events)for(r in a.events)f[r]?b.event.remove(n,r):b.removeEvent(n,r,a.handle);l[o]&&(delete l[o],p?delete n[u]:typeof n.removeAttribute!==i?n.removeAttribute(u):n[u]=null,c.push(o))}}});var Pt,Rt,Wt,$t=/alpha\([^)]*\)/i,It=/opacity\s*=\s*([^)]*)/,zt=/^(top|right|bottom|left)$/,Xt=/^(none|table(?!-c[ea]).+)/,Ut=/^margin/,Vt=RegExp("^("+x+")(.*)$","i"),Yt=RegExp("^("+x+")(?!px)[a-z%]+$","i"),Jt=RegExp("^([+-])=("+x+")","i"),Gt={BODY:"block"},Qt={position:"absolute",visibility:"hidden",display:"block"},Kt={letterSpacing:0,fontWeight:400},Zt=["Top","Right","Bottom","Left"],en=["Webkit","O","Moz","ms"];function tn(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=en.length;while(i--)if(t=en[i]+n,t in e)return t;return r}function nn(e,t){return e=t||e,"none"===b.css(e,"display")||!b.contains(e.ownerDocument,e)}function rn(e,t){var n,r,i,o=[],a=0,s=e.length;for(;s>a;a++)r=e[a],r.style&&(o[a]=b._data(r,"olddisplay"),n=r.style.display,t?(o[a]||"none"!==n||(r.style.display=""),""===r.style.display&&nn(r)&&(o[a]=b._data(r,"olddisplay",un(r.nodeName)))):o[a]||(i=nn(r),(n&&"none"!==n||!i)&&b._data(r,"olddisplay",i?n:b.css(r,"display"))));for(a=0;s>a;a++)r=e[a],r.style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?o[a]||"":"none"));return e}b.fn.extend({css:function(e,n){return b.access(this,function(e,n,r){var i,o,a={},s=0;if(b.isArray(n)){for(o=Rt(e),i=n.length;i>s;s++)a[n[s]]=b.css(e,n[s],!1,o);return a}return r!==t?b.style(e,n,r):b.css(e,n)},e,n,arguments.length>1)},show:function(){return rn(this,!0)},hide:function(){return rn(this)},toggle:function(e){var t="boolean"==typeof e;return this.each(function(){(t?e:nn(this))?b(this).show():b(this).hide()})}}),b.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Wt(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":b.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,r,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,a,s,u=b.camelCase(n),l=e.style;if(n=b.cssProps[u]||(b.cssProps[u]=tn(l,u)),s=b.cssHooks[n]||b.cssHooks[u],r===t)return s&&"get"in s&&(o=s.get(e,!1,i))!==t?o:l[n];if(a=typeof r,"string"===a&&(o=Jt.exec(r))&&(r=(o[1]+1)*o[2]+parseFloat(b.css(e,n)),a="number"),!(null==r||"number"===a&&isNaN(r)||("number"!==a||b.cssNumber[u]||(r+="px"),b.support.clearCloneStyle||""!==r||0!==n.indexOf("background")||(l[n]="inherit"),s&&"set"in s&&(r=s.set(e,r,i))===t)))try{l[n]=r}catch(c){}}},css:function(e,n,r,i){var o,a,s,u=b.camelCase(n);return n=b.cssProps[u]||(b.cssProps[u]=tn(e.style,u)),s=b.cssHooks[n]||b.cssHooks[u],s&&"get"in s&&(a=s.get(e,!0,r)),a===t&&(a=Wt(e,n,i)),"normal"===a&&n in Kt&&(a=Kt[n]),""===r||r?(o=parseFloat(a),r===!0||b.isNumeric(o)?o||0:a):a},swap:function(e,t,n,r){var i,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];i=n.apply(e,r||[]);for(o in t)e.style[o]=a[o];return i}}),e.getComputedStyle?(Rt=function(t){return e.getComputedStyle(t,null)},Wt=function(e,n,r){var i,o,a,s=r||Rt(e),u=s?s.getPropertyValue(n)||s[n]:t,l=e.style;return s&&(""!==u||b.contains(e.ownerDocument,e)||(u=b.style(e,n)),Yt.test(u)&&Ut.test(n)&&(i=l.width,o=l.minWidth,a=l.maxWidth,l.minWidth=l.maxWidth=l.width=u,u=s.width,l.width=i,l.minWidth=o,l.maxWidth=a)),u}):o.documentElement.currentStyle&&(Rt=function(e){return e.currentStyle},Wt=function(e,n,r){var i,o,a,s=r||Rt(e),u=s?s[n]:t,l=e.style;return null==u&&l&&l[n]&&(u=l[n]),Yt.test(u)&&!zt.test(n)&&(i=l.left,o=e.runtimeStyle,a=o&&o.left,a&&(o.left=e.currentStyle.left),l.left="fontSize"===n?"1em":u,u=l.pixelLeft+"px",l.left=i,a&&(o.left=a)),""===u?"auto":u});function on(e,t,n){var r=Vt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function an(e,t,n,r,i){var o=n===(r?"border":"content")?4:"width"===t?1:0,a=0;for(;4>o;o+=2)"margin"===n&&(a+=b.css(e,n+Zt[o],!0,i)),r?("content"===n&&(a-=b.css(e,"padding"+Zt[o],!0,i)),"margin"!==n&&(a-=b.css(e,"border"+Zt[o]+"Width",!0,i))):(a+=b.css(e,"padding"+Zt[o],!0,i),"padding"!==n&&(a+=b.css(e,"border"+Zt[o]+"Width",!0,i)));return a}function sn(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,o=Rt(e),a=b.support.boxSizing&&"border-box"===b.css(e,"boxSizing",!1,o);if(0>=i||null==i){if(i=Wt(e,t,o),(0>i||null==i)&&(i=e.style[t]),Yt.test(i))return i;r=a&&(b.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+an(e,t,n||(a?"border":"content"),r,o)+"px"}function un(e){var t=o,n=Gt[e];return n||(n=ln(e,t),"none"!==n&&n||(Pt=(Pt||b("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(Pt[0].contentWindow||Pt[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=ln(e,t),Pt.detach()),Gt[e]=n),n}function ln(e,t){var n=b(t.createElement(e)).appendTo(t.body),r=b.css(n[0],"display");return n.remove(),r}b.each(["height","width"],function(e,n){b.cssHooks[n]={get:function(e,r,i){return r?0===e.offsetWidth&&Xt.test(b.css(e,"display"))?b.swap(e,Qt,function(){return sn(e,n,i)}):sn(e,n,i):t},set:function(e,t,r){var i=r&&Rt(e);return on(e,t,r?an(e,n,r,b.support.boxSizing&&"border-box"===b.css(e,"boxSizing",!1,i),i):0)}}}),b.support.opacity||(b.cssHooks.opacity={get:function(e,t){return It.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=b.isNumeric(t)?"alpha(opacity="+100*t+")":"",o=r&&r.filter||n.filter||"";n.zoom=1,(t>=1||""===t)&&""===b.trim(o.replace($t,""))&&n.removeAttribute&&(n.removeAttribute("filter"),""===t||r&&!r.filter)||(n.filter=$t.test(o)?o.replace($t,i):o+" "+i)}}),b(function(){b.support.reliableMarginRight||(b.cssHooks.marginRight={get:function(e,n){return n?b.swap(e,{display:"inline-block"},Wt,[e,"marginRight"]):t}}),!b.support.pixelPosition&&b.fn.position&&b.each(["top","left"],function(e,n){b.cssHooks[n]={get:function(e,r){return r?(r=Wt(e,n),Yt.test(r)?b(e).position()[n]+"px":r):t}}})}),b.expr&&b.expr.filters&&(b.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight||!b.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||b.css(e,"display"))},b.expr.filters.visible=function(e){return!b.expr.filters.hidden(e)}),b.each({margin:"",padding:"",border:"Width"},function(e,t){b.cssHooks[e+t]={expand:function(n){var r=0,i={},o="string"==typeof n?n.split(" "):[n];for(;4>r;r++)i[e+Zt[r]+t]=o[r]||o[r-2]||o[0];return i}},Ut.test(e)||(b.cssHooks[e+t].set=on)});var cn=/%20/g,pn=/\[\]$/,fn=/\r?\n/g,dn=/^(?:submit|button|image|reset|file)$/i,hn=/^(?:input|select|textarea|keygen)/i;b.fn.extend({serialize:function(){return b.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=b.prop(this,"elements");return e?b.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!b(this).is(":disabled")&&hn.test(this.nodeName)&&!dn.test(e)&&(this.checked||!Nt.test(e))}).map(function(e,t){var n=b(this).val();return null==n?null:b.isArray(n)?b.map(n,function(e){return{name:t.name,value:e.replace(fn,"\r\n")}}):{name:t.name,value:n.replace(fn,"\r\n")}}).get()}}),b.param=function(e,n){var r,i=[],o=function(e,t){t=b.isFunction(t)?t():null==t?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(n===t&&(n=b.ajaxSettings&&b.ajaxSettings.traditional),b.isArray(e)||e.jquery&&!b.isPlainObject(e))b.each(e,function(){o(this.name,this.value)});else for(r in e)gn(r,e[r],n,o);return i.join("&").replace(cn,"+")};function gn(e,t,n,r){var i;if(b.isArray(t))b.each(t,function(t,i){n||pn.test(e)?r(e,i):gn(e+"["+("object"==typeof i?t:"")+"]",i,n,r)});else if(n||"object"!==b.type(t))r(e,t);else for(i in t)gn(e+"["+i+"]",t[i],n,r)}b.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){b.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),b.fn.hover=function(e,t){return this.mouseenter(e).mouseleave(t||e)};var mn,yn,vn=b.now(),bn=/\?/,xn=/#.*$/,wn=/([?&])_=[^&]*/,Tn=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Nn=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Cn=/^(?:GET|HEAD)$/,kn=/^\/\//,En=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,Sn=b.fn.load,An={},jn={},Dn="*/".concat("*");try{yn=a.href}catch(Ln){yn=o.createElement("a"),yn.href="",yn=yn.href}mn=En.exec(yn.toLowerCase())||[];function Hn(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,o=t.toLowerCase().match(w)||[];if(b.isFunction(n))while(r=o[i++])"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function qn(e,n,r,i){var o={},a=e===jn;function s(u){var l;return o[u]=!0,b.each(e[u]||[],function(e,u){var c=u(n,r,i);return"string"!=typeof c||a||o[c]?a?!(l=c):t:(n.dataTypes.unshift(c),s(c),!1)}),l}return s(n.dataTypes[0])||!o["*"]&&s("*")}function Mn(e,n){var r,i,o=b.ajaxSettings.flatOptions||{};for(i in n)n[i]!==t&&((o[i]?e:r||(r={}))[i]=n[i]);return r&&b.extend(!0,e,r),e}b.fn.load=function(e,n,r){if("string"!=typeof e&&Sn)return Sn.apply(this,arguments);var i,o,a,s=this,u=e.indexOf(" ");return u>=0&&(i=e.slice(u,e.length),e=e.slice(0,u)),b.isFunction(n)?(r=n,n=t):n&&"object"==typeof n&&(a="POST"),s.length>0&&b.ajax({url:e,type:a,dataType:"html",data:n}).done(function(e){o=arguments,s.html(i?b("<div>").append(b.parseHTML(e)).find(i):e)}).complete(r&&function(e,t){s.each(r,o||[e.responseText,t,e])}),this},b.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){b.fn[t]=function(e){return this.on(t,e)}}),b.each(["get","post"],function(e,n){b[n]=function(e,r,i,o){return b.isFunction(r)&&(o=o||i,i=r,r=t),b.ajax({url:e,type:n,dataType:o,data:r,success:i})}}),b.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:yn,type:"GET",isLocal:Nn.test(mn[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Dn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":b.parseJSON,"text xml":b.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Mn(Mn(e,b.ajaxSettings),t):Mn(b.ajaxSettings,e)},ajaxPrefilter:Hn(An),ajaxTransport:Hn(jn),ajax:function(e,n){"object"==typeof e&&(n=e,e=t),n=n||{};var r,i,o,a,s,u,l,c,p=b.ajaxSetup({},n),f=p.context||p,d=p.context&&(f.nodeType||f.jquery)?b(f):b.event,h=b.Deferred(),g=b.Callbacks("once memory"),m=p.statusCode||{},y={},v={},x=0,T="canceled",N={readyState:0,getResponseHeader:function(e){var t;if(2===x){if(!c){c={};while(t=Tn.exec(a))c[t[1].toLowerCase()]=t[2]}t=c[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===x?a:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return x||(e=v[n]=v[n]||e,y[e]=t),this},overrideMimeType:function(e){return x||(p.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>x)for(t in e)m[t]=[m[t],e[t]];else N.always(e[N.status]);return this},abort:function(e){var t=e||T;return l&&l.abort(t),k(0,t),this}};if(h.promise(N).complete=g.add,N.success=N.done,N.error=N.fail,p.url=((e||p.url||yn)+"").replace(xn,"").replace(kn,mn[1]+"//"),p.type=n.method||n.type||p.method||p.type,p.dataTypes=b.trim(p.dataType||"*").toLowerCase().match(w)||[""],null==p.crossDomain&&(r=En.exec(p.url.toLowerCase()),p.crossDomain=!(!r||r[1]===mn[1]&&r[2]===mn[2]&&(r[3]||("http:"===r[1]?80:443))==(mn[3]||("http:"===mn[1]?80:443)))),p.data&&p.processData&&"string"!=typeof p.data&&(p.data=b.param(p.data,p.traditional)),qn(An,p,n,N),2===x)return N;u=p.global,u&&0===b.active++&&b.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Cn.test(p.type),o=p.url,p.hasContent||(p.data&&(o=p.url+=(bn.test(o)?"&":"?")+p.data,delete p.data),p.cache===!1&&(p.url=wn.test(o)?o.replace(wn,"$1_="+vn++):o+(bn.test(o)?"&":"?")+"_="+vn++)),p.ifModified&&(b.lastModified[o]&&N.setRequestHeader("If-Modified-Since",b.lastModified[o]),b.etag[o]&&N.setRequestHeader("If-None-Match",b.etag[o])),(p.data&&p.hasContent&&p.contentType!==!1||n.contentType)&&N.setRequestHeader("Content-Type",p.contentType),N.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+Dn+"; q=0.01":""):p.accepts["*"]);for(i in p.headers)N.setRequestHeader(i,p.headers[i]);if(p.beforeSend&&(p.beforeSend.call(f,N,p)===!1||2===x))return N.abort();T="abort";for(i in{success:1,error:1,complete:1})N[i](p[i]);if(l=qn(jn,p,n,N)){N.readyState=1,u&&d.trigger("ajaxSend",[N,p]),p.async&&p.timeout>0&&(s=setTimeout(function(){N.abort("timeout")},p.timeout));try{x=1,l.send(y,k)}catch(C){if(!(2>x))throw C;k(-1,C)}}else k(-1,"No Transport");function k(e,n,r,i){var c,y,v,w,T,C=n;2!==x&&(x=2,s&&clearTimeout(s),l=t,a=i||"",N.readyState=e>0?4:0,r&&(w=_n(p,N,r)),e>=200&&300>e||304===e?(p.ifModified&&(T=N.getResponseHeader("Last-Modified"),T&&(b.lastModified[o]=T),T=N.getResponseHeader("etag"),T&&(b.etag[o]=T)),204===e?(c=!0,C="nocontent"):304===e?(c=!0,C="notmodified"):(c=Fn(p,w),C=c.state,y=c.data,v=c.error,c=!v)):(v=C,(e||!C)&&(C="error",0>e&&(e=0))),N.status=e,N.statusText=(n||C)+"",c?h.resolveWith(f,[y,C,N]):h.rejectWith(f,[N,C,v]),N.statusCode(m),m=t,u&&d.trigger(c?"ajaxSuccess":"ajaxError",[N,p,c?y:v]),g.fireWith(f,[N,C]),u&&(d.trigger("ajaxComplete",[N,p]),--b.active||b.event.trigger("ajaxStop")))}return N},getScript:function(e,n){return b.get(e,t,n,"script")},getJSON:function(e,t,n){return b.get(e,t,n,"json")}});function _n(e,n,r){var i,o,a,s,u=e.contents,l=e.dataTypes,c=e.responseFields;for(s in c)s in r&&(n[c[s]]=r[s]);while("*"===l[0])l.shift(),o===t&&(o=e.mimeType||n.getResponseHeader("Content-Type"));if(o)for(s in u)if(u[s]&&u[s].test(o)){l.unshift(s);break}if(l[0]in r)a=l[0];else{for(s in r){if(!l[0]||e.converters[s+" "+l[0]]){a=s;break}i||(i=s)}a=a||i}return a?(a!==l[0]&&l.unshift(a),r[a]):t}function Fn(e,t){var n,r,i,o,a={},s=0,u=e.dataTypes.slice(),l=u[0];if(e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u[1])for(i in e.converters)a[i.toLowerCase()]=e.converters[i];for(;r=u[++s];)if("*"!==r){if("*"!==l&&l!==r){if(i=a[l+" "+r]||a["* "+r],!i)for(n in a)if(o=n.split(" "),o[1]===r&&(i=a[l+" "+o[0]]||a["* "+o[0]])){i===!0?i=a[n]:a[n]!==!0&&(r=o[0],u.splice(s--,0,r));break}if(i!==!0)if(i&&e["throws"])t=i(t);else try{t=i(t)}catch(c){return{state:"parsererror",error:i?c:"No conversion from "+l+" to "+r}}}l=r}return{state:"success",data:t}}b.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return b.globalEval(e),e}}}),b.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),b.ajaxTransport("script",function(e){if(e.crossDomain){var n,r=o.head||b("head")[0]||o.documentElement;return{send:function(t,i){n=o.createElement("script"),n.async=!0,e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,t){(t||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),n=null,t||i(200,"success"))},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(t,!0)}}}});var On=[],Bn=/(=)\?(?=&|$)|\?\?/;b.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=On.pop()||b.expando+"_"+vn++;return this[e]=!0,e}}),b.ajaxPrefilter("json jsonp",function(n,r,i){var o,a,s,u=n.jsonp!==!1&&(Bn.test(n.url)?"url":"string"==typeof n.data&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&Bn.test(n.data)&&"data");return u||"jsonp"===n.dataTypes[0]?(o=n.jsonpCallback=b.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,u?n[u]=n[u].replace(Bn,"$1"+o):n.jsonp!==!1&&(n.url+=(bn.test(n.url)?"&":"?")+n.jsonp+"="+o),n.converters["script json"]=function(){return s||b.error(o+" was not called"),s[0]},n.dataTypes[0]="json",a=e[o],e[o]=function(){s=arguments},i.always(function(){e[o]=a,n[o]&&(n.jsonpCallback=r.jsonpCallback,On.push(o)),s&&b.isFunction(a)&&a(s[0]),s=a=t}),"script"):t});var Pn,Rn,Wn=0,$n=e.ActiveXObject&&function(){var e;for(e in Pn)Pn[e](t,!0)};function In(){try{return new e.XMLHttpRequest}catch(t){}}function zn(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}b.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&In()||zn()}:In,Rn=b.ajaxSettings.xhr(),b.support.cors=!!Rn&&"withCredentials"in Rn,Rn=b.support.ajax=!!Rn,Rn&&b.ajaxTransport(function(n){if(!n.crossDomain||b.support.cors){var r;return{send:function(i,o){var a,s,u=n.xhr();if(n.username?u.open(n.type,n.url,n.async,n.username,n.password):u.open(n.type,n.url,n.async),n.xhrFields)for(s in n.xhrFields)u[s]=n.xhrFields[s];n.mimeType&&u.overrideMimeType&&u.overrideMimeType(n.mimeType),n.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");try{for(s in i)u.setRequestHeader(s,i[s])}catch(l){}u.send(n.hasContent&&n.data||null),r=function(e,i){var s,l,c,p;try{if(r&&(i||4===u.readyState))if(r=t,a&&(u.onreadystatechange=b.noop,$n&&delete Pn[a]),i)4!==u.readyState&&u.abort();else{p={},s=u.status,l=u.getAllResponseHeaders(),"string"==typeof u.responseText&&(p.text=u.responseText);try{c=u.statusText}catch(f){c=""}s||!n.isLocal||n.crossDomain?1223===s&&(s=204):s=p.text?200:404}}catch(d){i||o(-1,d)}p&&o(s,c,p,l)},n.async?4===u.readyState?setTimeout(r):(a=++Wn,$n&&(Pn||(Pn={},b(e).unload($n)),Pn[a]=r),u.onreadystatechange=r):r()},abort:function(){r&&r(t,!0)}}}});var Xn,Un,Vn=/^(?:toggle|show|hide)$/,Yn=RegExp("^(?:([+-])=|)("+x+")([a-z%]*)$","i"),Jn=/queueHooks$/,Gn=[nr],Qn={"*":[function(e,t){var n,r,i=this.createTween(e,t),o=Yn.exec(t),a=i.cur(),s=+a||0,u=1,l=20;if(o){if(n=+o[2],r=o[3]||(b.cssNumber[e]?"":"px"),"px"!==r&&s){s=b.css(i.elem,e,!0)||n||1;do u=u||".5",s/=u,b.style(i.elem,e,s+r);while(u!==(u=i.cur()/a)&&1!==u&&--l)}i.unit=r,i.start=s,i.end=o[1]?s+(o[1]+1)*n:n}return i}]};function Kn(){return setTimeout(function(){Xn=t}),Xn=b.now()}function Zn(e,t){b.each(t,function(t,n){var r=(Qn[t]||[]).concat(Qn["*"]),i=0,o=r.length;for(;o>i;i++)if(r[i].call(e,t,n))return})}function er(e,t,n){var r,i,o=0,a=Gn.length,s=b.Deferred().always(function(){delete u.elem}),u=function(){if(i)return!1;var t=Xn||Kn(),n=Math.max(0,l.startTime+l.duration-t),r=n/l.duration||0,o=1-r,a=0,u=l.tweens.length;for(;u>a;a++)l.tweens[a].run(o);return s.notifyWith(e,[l,o,n]),1>o&&u?n:(s.resolveWith(e,[l]),!1)},l=s.promise({elem:e,props:b.extend({},t),opts:b.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Xn||Kn(),duration:n.duration,tweens:[],createTween:function(t,n){var r=b.Tween(e,l.opts,t,n,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(r),r},stop:function(t){var n=0,r=t?l.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)l.tweens[n].run(1);return t?s.resolveWith(e,[l,t]):s.rejectWith(e,[l,t]),this}}),c=l.props;for(tr(c,l.opts.specialEasing);a>o;o++)if(r=Gn[o].call(l,e,c,l.opts))return r;return Zn(l,c),b.isFunction(l.opts.start)&&l.opts.start.call(e,l),b.fx.timer(b.extend(u,{elem:e,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function tr(e,t){var n,r,i,o,a;for(i in e)if(r=b.camelCase(i),o=t[r],n=e[i],b.isArray(n)&&(o=n[1],n=e[i]=n[0]),i!==r&&(e[r]=n,delete e[i]),a=b.cssHooks[r],a&&"expand"in a){n=a.expand(n),delete e[r];for(i in n)i in e||(e[i]=n[i],t[i]=o)}else t[r]=o}b.Animation=b.extend(er,{tweener:function(e,t){b.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;i>r;r++)n=e[r],Qn[n]=Qn[n]||[],Qn[n].unshift(t)},prefilter:function(e,t){t?Gn.unshift(e):Gn.push(e)}});function nr(e,t,n){var r,i,o,a,s,u,l,c,p,f=this,d=e.style,h={},g=[],m=e.nodeType&&nn(e);n.queue||(c=b._queueHooks(e,"fx"),null==c.unqueued&&(c.unqueued=0,p=c.empty.fire,c.empty.fire=function(){c.unqueued||p()}),c.unqueued++,f.always(function(){f.always(function(){c.unqueued--,b.queue(e,"fx").length||c.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[d.overflow,d.overflowX,d.overflowY],"inline"===b.css(e,"display")&&"none"===b.css(e,"float")&&(b.support.inlineBlockNeedsLayout&&"inline"!==un(e.nodeName)?d.zoom=1:d.display="inline-block")),n.overflow&&(d.overflow="hidden",b.support.shrinkWrapBlocks||f.always(function(){d.overflow=n.overflow[0],d.overflowX=n.overflow[1],d.overflowY=n.overflow[2]}));for(i in t)if(a=t[i],Vn.exec(a)){if(delete t[i],u=u||"toggle"===a,a===(m?"hide":"show"))continue;g.push(i)}if(o=g.length){s=b._data(e,"fxshow")||b._data(e,"fxshow",{}),"hidden"in s&&(m=s.hidden),u&&(s.hidden=!m),m?b(e).show():f.done(function(){b(e).hide()}),f.done(function(){var t;b._removeData(e,"fxshow");for(t in h)b.style(e,t,h[t])});for(i=0;o>i;i++)r=g[i],l=f.createTween(r,m?s[r]:0),h[r]=s[r]||b.style(e,r),r in s||(s[r]=l.start,m&&(l.end=l.start,l.start="width"===r||"height"===r?1:0))}}function rr(e,t,n,r,i){return new rr.prototype.init(e,t,n,r,i)}b.Tween=rr,rr.prototype={constructor:rr,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(b.cssNumber[n]?"":"px")},cur:function(){var e=rr.propHooks[this.prop];return e&&e.get?e.get(this):rr.propHooks._default.get(this)},run:function(e){var t,n=rr.propHooks[this.prop];return this.pos=t=this.options.duration?b.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):rr.propHooks._default.set(this),this}},rr.prototype.init.prototype=rr.prototype,rr.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=b.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){b.fx.step[e.prop]?b.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[b.cssProps[e.prop]]||b.cssHooks[e.prop])?b.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},rr.propHooks.scrollTop=rr.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},b.each(["toggle","show","hide"],function(e,t){var n=b.fn[t];b.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(ir(t,!0),e,r,i)}}),b.fn.extend({fadeTo:function(e,t,n,r){return this.filter(nn).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=b.isEmptyObject(e),o=b.speed(t,n,r),a=function(){var t=er(this,b.extend({},e),o);a.finish=function(){t.stop(!0)},(i||b._data(this,"finish"))&&t.stop(!0)};return a.finish=a,i||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(e,n,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return"string"!=typeof e&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=null!=e&&e+"queueHooks",o=b.timers,a=b._data(this);if(n)a[n]&&a[n].stop&&i(a[n]);else for(n in a)a[n]&&a[n].stop&&Jn.test(n)&&i(a[n]);for(n=o.length;n--;)o[n].elem!==this||null!=e&&o[n].queue!==e||(o[n].anim.stop(r),t=!1,o.splice(n,1));(t||!r)&&b.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=b._data(this),r=n[e+"queue"],i=n[e+"queueHooks"],o=b.timers,a=r?r.length:0;for(n.finish=!0,b.queue(this,e,[]),i&&i.cur&&i.cur.finish&&i.cur.finish.call(this),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;a>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}});function ir(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t)n=Zt[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}b.each({slideDown:ir("show"),slideUp:ir("hide"),slideToggle:ir("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){b.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),b.speed=function(e,t,n){var r=e&&"object"==typeof e?b.extend({},e):{complete:n||!n&&t||b.isFunction(e)&&e,duration:e,easing:n&&t||t&&!b.isFunction(t)&&t};return r.duration=b.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in b.fx.speeds?b.fx.speeds[r.duration]:b.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){b.isFunction(r.old)&&r.old.call(this),r.queue&&b.dequeue(this,r.queue)},r},b.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},b.timers=[],b.fx=rr.prototype.init,b.fx.tick=function(){var e,n=b.timers,r=0;for(Xn=b.now();n.length>r;r++)e=n[r],e()||n[r]!==e||n.splice(r--,1);n.length||b.fx.stop(),Xn=t},b.fx.timer=function(e){e()&&b.timers.push(e)&&b.fx.start()},b.fx.interval=13,b.fx.start=function(){Un||(Un=setInterval(b.fx.tick,b.fx.interval))},b.fx.stop=function(){clearInterval(Un),Un=null},b.fx.speeds={slow:600,fast:200,_default:400},b.fx.step={},b.expr&&b.expr.filters&&(b.expr.filters.animated=function(e){return b.grep(b.timers,function(t){return e===t.elem}).length}),b.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){b.offset.setOffset(this,e,t)});var n,r,o={top:0,left:0},a=this[0],s=a&&a.ownerDocument;if(s)return n=s.documentElement,b.contains(n,a)?(typeof a.getBoundingClientRect!==i&&(o=a.getBoundingClientRect()),r=or(s),{top:o.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:o.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)}):o},b.offset={setOffset:function(e,t,n){var r=b.css(e,"position");"static"===r&&(e.style.position="relative");var i=b(e),o=i.offset(),a=b.css(e,"top"),s=b.css(e,"left"),u=("absolute"===r||"fixed"===r)&&b.inArray("auto",[a,s])>-1,l={},c={},p,f;u?(c=i.position(),p=c.top,f=c.left):(p=parseFloat(a)||0,f=parseFloat(s)||0),b.isFunction(t)&&(t=t.call(e,n,o)),null!=t.top&&(l.top=t.top-o.top+p),null!=t.left&&(l.left=t.left-o.left+f),"using"in t?t.using.call(e,l):i.css(l)}},b.fn.extend({position:function(){if(this[0]){var e,t,n={top:0,left:0},r=this[0];return"fixed"===b.css(r,"position")?t=r.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),b.nodeName(e[0],"html")||(n=e.offset()),n.top+=b.css(e[0],"borderTopWidth",!0),n.left+=b.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-b.css(r,"marginTop",!0),left:t.left-n.left-b.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||o.documentElement;while(e&&!b.nodeName(e,"html")&&"static"===b.css(e,"position"))e=e.offsetParent;return e||o.documentElement})}}),b.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var r=/Y/.test(n);b.fn[e]=function(i){return b.access(this,function(e,i,o){var a=or(e);return o===t?a?n in a?a[n]:a.document.documentElement[i]:e[i]:(a?a.scrollTo(r?b(a).scrollLeft():o,r?o:b(a).scrollTop()):e[i]=o,t)},e,i,arguments.length,null)}});function or(e){return b.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}b.each({Height:"height",Width:"width"},function(e,n){b.each({padding:"inner"+e,content:n,"":"outer"+e},function(r,i){b.fn[i]=function(i,o){var a=arguments.length&&(r||"boolean"!=typeof i),s=r||(i===!0||o===!0?"margin":"border");return b.access(this,function(n,r,i){var o;return b.isWindow(n)?n.document.documentElement["client"+e]:9===n.nodeType?(o=n.documentElement,Math.max(n.body["scroll"+e],o["scroll"+e],n.body["offset"+e],o["offset"+e],o["client"+e])):i===t?b.css(n,r,s):b.style(n,r,i,s)},n,a?i:t,a,null)}})}),e.jQuery=e.$=b,"function"==typeof define&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return b})})(window);
}
if( window._ === undefined) {
//     Underscore.js 1.6.0
//     http://underscorejs.org
//     (c) 2009-2014 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.
(function(){var n=this,t=n._,r={},e=Array.prototype,u=Object.prototype,i=Function.prototype,a=e.push,o=e.slice,c=e.concat,l=u.toString,f=u.hasOwnProperty,s=e.forEach,p=e.map,h=e.reduce,v=e.reduceRight,g=e.filter,d=e.every,m=e.some,y=e.indexOf,b=e.lastIndexOf,x=Array.isArray,w=Object.keys,_=i.bind,j=function(n){return n instanceof j?n:this instanceof j?void(this._wrapped=n):new j(n)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=j),exports._=j):n._=j,j.VERSION="1.6.0";var A=j.each=j.forEach=function(n,t,e){if(null==n)return n;if(s&&n.forEach===s)n.forEach(t,e);else if(n.length===+n.length){for(var u=0,i=n.length;i>u;u++)if(t.call(e,n[u],u,n)===r)return}else for(var a=j.keys(n),u=0,i=a.length;i>u;u++)if(t.call(e,n[a[u]],a[u],n)===r)return;return n};j.map=j.collect=function(n,t,r){var e=[];return null==n?e:p&&n.map===p?n.map(t,r):(A(n,function(n,u,i){e.push(t.call(r,n,u,i))}),e)};var O="Reduce of empty array with no initial value";j.reduce=j.foldl=j.inject=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),h&&n.reduce===h)return e&&(t=j.bind(t,e)),u?n.reduce(t,r):n.reduce(t);if(A(n,function(n,i,a){u?r=t.call(e,r,n,i,a):(r=n,u=!0)}),!u)throw new TypeError(O);return r},j.reduceRight=j.foldr=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),v&&n.reduceRight===v)return e&&(t=j.bind(t,e)),u?n.reduceRight(t,r):n.reduceRight(t);var i=n.length;if(i!==+i){var a=j.keys(n);i=a.length}if(A(n,function(o,c,l){c=a?a[--i]:--i,u?r=t.call(e,r,n[c],c,l):(r=n[c],u=!0)}),!u)throw new TypeError(O);return r},j.find=j.detect=function(n,t,r){var e;return k(n,function(n,u,i){return t.call(r,n,u,i)?(e=n,!0):void 0}),e},j.filter=j.select=function(n,t,r){var e=[];return null==n?e:g&&n.filter===g?n.filter(t,r):(A(n,function(n,u,i){t.call(r,n,u,i)&&e.push(n)}),e)},j.reject=function(n,t,r){return j.filter(n,function(n,e,u){return!t.call(r,n,e,u)},r)},j.every=j.all=function(n,t,e){t||(t=j.identity);var u=!0;return null==n?u:d&&n.every===d?n.every(t,e):(A(n,function(n,i,a){return(u=u&&t.call(e,n,i,a))?void 0:r}),!!u)};var k=j.some=j.any=function(n,t,e){t||(t=j.identity);var u=!1;return null==n?u:m&&n.some===m?n.some(t,e):(A(n,function(n,i,a){return u||(u=t.call(e,n,i,a))?r:void 0}),!!u)};j.contains=j.include=function(n,t){return null==n?!1:y&&n.indexOf===y?n.indexOf(t)!=-1:k(n,function(n){return n===t})},j.invoke=function(n,t){var r=o.call(arguments,2),e=j.isFunction(t);return j.map(n,function(n){return(e?t:n[t]).apply(n,r)})},j.pluck=function(n,t){return j.map(n,j.property(t))},j.where=function(n,t){return j.filter(n,j.matches(t))},j.findWhere=function(n,t){return j.find(n,j.matches(t))},j.max=function(n,t,r){if(!t&&j.isArray(n)&&n[0]===+n[0]&&n.length<65535)return Math.max.apply(Math,n);var e=-1/0,u=-1/0;return A(n,function(n,i,a){var o=t?t.call(r,n,i,a):n;o>u&&(e=n,u=o)}),e},j.min=function(n,t,r){if(!t&&j.isArray(n)&&n[0]===+n[0]&&n.length<65535)return Math.min.apply(Math,n);var e=1/0,u=1/0;return A(n,function(n,i,a){var o=t?t.call(r,n,i,a):n;u>o&&(e=n,u=o)}),e},j.shuffle=function(n){var t,r=0,e=[];return A(n,function(n){t=j.random(r++),e[r-1]=e[t],e[t]=n}),e},j.sample=function(n,t,r){return null==t||r?(n.length!==+n.length&&(n=j.values(n)),n[j.random(n.length-1)]):j.shuffle(n).slice(0,Math.max(0,t))};var E=function(n){return null==n?j.identity:j.isFunction(n)?n:j.property(n)};j.sortBy=function(n,t,r){return t=E(t),j.pluck(j.map(n,function(n,e,u){return{value:n,index:e,criteria:t.call(r,n,e,u)}}).sort(function(n,t){var r=n.criteria,e=t.criteria;if(r!==e){if(r>e||r===void 0)return 1;if(e>r||e===void 0)return-1}return n.index-t.index}),"value")};var F=function(n){return function(t,r,e){var u={};return r=E(r),A(t,function(i,a){var o=r.call(e,i,a,t);n(u,o,i)}),u}};j.groupBy=F(function(n,t,r){j.has(n,t)?n[t].push(r):n[t]=[r]}),j.indexBy=F(function(n,t,r){n[t]=r}),j.countBy=F(function(n,t){j.has(n,t)?n[t]++:n[t]=1}),j.sortedIndex=function(n,t,r,e){r=E(r);for(var u=r.call(e,t),i=0,a=n.length;a>i;){var o=i+a>>>1;r.call(e,n[o])<u?i=o+1:a=o}return i},j.toArray=function(n){return n?j.isArray(n)?o.call(n):n.length===+n.length?j.map(n,j.identity):j.values(n):[]},j.size=function(n){return null==n?0:n.length===+n.length?n.length:j.keys(n).length},j.first=j.head=j.take=function(n,t,r){return null==n?void 0:null==t||r?n[0]:0>t?[]:o.call(n,0,t)},j.initial=function(n,t,r){return o.call(n,0,n.length-(null==t||r?1:t))},j.last=function(n,t,r){return null==n?void 0:null==t||r?n[n.length-1]:o.call(n,Math.max(n.length-t,0))},j.rest=j.tail=j.drop=function(n,t,r){return o.call(n,null==t||r?1:t)},j.compact=function(n){return j.filter(n,j.identity)};var M=function(n,t,r){return t&&j.every(n,j.isArray)?c.apply(r,n):(A(n,function(n){j.isArray(n)||j.isArguments(n)?t?a.apply(r,n):M(n,t,r):r.push(n)}),r)};j.flatten=function(n,t){return M(n,t,[])},j.without=function(n){return j.difference(n,o.call(arguments,1))},j.partition=function(n,t){var r=[],e=[];return A(n,function(n){(t(n)?r:e).push(n)}),[r,e]},j.uniq=j.unique=function(n,t,r,e){j.isFunction(t)&&(e=r,r=t,t=!1);var u=r?j.map(n,r,e):n,i=[],a=[];return A(u,function(r,e){(t?e&&a[a.length-1]===r:j.contains(a,r))||(a.push(r),i.push(n[e]))}),i},j.union=function(){return j.uniq(j.flatten(arguments,!0))},j.intersection=function(n){var t=o.call(arguments,1);return j.filter(j.uniq(n),function(n){return j.every(t,function(t){return j.contains(t,n)})})},j.difference=function(n){var t=c.apply(e,o.call(arguments,1));return j.filter(n,function(n){return!j.contains(t,n)})},j.zip=function(){for(var n=j.max(j.pluck(arguments,"length").concat(0)),t=new Array(n),r=0;n>r;r++)t[r]=j.pluck(arguments,""+r);return t},j.object=function(n,t){if(null==n)return{};for(var r={},e=0,u=n.length;u>e;e++)t?r[n[e]]=t[e]:r[n[e][0]]=n[e][1];return r},j.indexOf=function(n,t,r){if(null==n)return-1;var e=0,u=n.length;if(r){if("number"!=typeof r)return e=j.sortedIndex(n,t),n[e]===t?e:-1;e=0>r?Math.max(0,u+r):r}if(y&&n.indexOf===y)return n.indexOf(t,r);for(;u>e;e++)if(n[e]===t)return e;return-1},j.lastIndexOf=function(n,t,r){if(null==n)return-1;var e=null!=r;if(b&&n.lastIndexOf===b)return e?n.lastIndexOf(t,r):n.lastIndexOf(t);for(var u=e?r:n.length;u--;)if(n[u]===t)return u;return-1},j.range=function(n,t,r){arguments.length<=1&&(t=n||0,n=0),r=arguments[2]||1;for(var e=Math.max(Math.ceil((t-n)/r),0),u=0,i=new Array(e);e>u;)i[u++]=n,n+=r;return i};var R=function(){};j.bind=function(n,t){var r,e;if(_&&n.bind===_)return _.apply(n,o.call(arguments,1));if(!j.isFunction(n))throw new TypeError;return r=o.call(arguments,2),e=function(){if(!(this instanceof e))return n.apply(t,r.concat(o.call(arguments)));R.prototype=n.prototype;var u=new R;R.prototype=null;var i=n.apply(u,r.concat(o.call(arguments)));return Object(i)===i?i:u}},j.partial=function(n){var t=o.call(arguments,1);return function(){for(var r=0,e=t.slice(),u=0,i=e.length;i>u;u++)e[u]===j&&(e[u]=arguments[r++]);for(;r<arguments.length;)e.push(arguments[r++]);return n.apply(this,e)}},j.bindAll=function(n){var t=o.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return A(t,function(t){n[t]=j.bind(n[t],n)}),n},j.memoize=function(n,t){var r={};return t||(t=j.identity),function(){var e=t.apply(this,arguments);return j.has(r,e)?r[e]:r[e]=n.apply(this,arguments)}},j.delay=function(n,t){var r=o.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},t)},j.defer=function(n){return j.delay.apply(j,[n,1].concat(o.call(arguments,1)))},j.throttle=function(n,t,r){var e,u,i,a=null,o=0;r||(r={});var c=function(){o=r.leading===!1?0:j.now(),a=null,i=n.apply(e,u),e=u=null};return function(){var l=j.now();o||r.leading!==!1||(o=l);var f=t-(l-o);return e=this,u=arguments,0>=f?(clearTimeout(a),a=null,o=l,i=n.apply(e,u),e=u=null):a||r.trailing===!1||(a=setTimeout(c,f)),i}},j.debounce=function(n,t,r){var e,u,i,a,o,c=function(){var l=j.now()-a;t>l?e=setTimeout(c,t-l):(e=null,r||(o=n.apply(i,u),i=u=null))};return function(){i=this,u=arguments,a=j.now();var l=r&&!e;return e||(e=setTimeout(c,t)),l&&(o=n.apply(i,u),i=u=null),o}},j.once=function(n){var t,r=!1;return function(){return r?t:(r=!0,t=n.apply(this,arguments),n=null,t)}},j.wrap=function(n,t){return j.partial(t,n)},j.compose=function(){var n=arguments;return function(){for(var t=arguments,r=n.length-1;r>=0;r--)t=[n[r].apply(this,t)];return t[0]}},j.after=function(n,t){return function(){return--n<1?t.apply(this,arguments):void 0}},j.keys=function(n){if(!j.isObject(n))return[];if(w)return w(n);var t=[];for(var r in n)j.has(n,r)&&t.push(r);return t},j.values=function(n){for(var t=j.keys(n),r=t.length,e=new Array(r),u=0;r>u;u++)e[u]=n[t[u]];return e},j.pairs=function(n){for(var t=j.keys(n),r=t.length,e=new Array(r),u=0;r>u;u++)e[u]=[t[u],n[t[u]]];return e},j.invert=function(n){for(var t={},r=j.keys(n),e=0,u=r.length;u>e;e++)t[n[r[e]]]=r[e];return t},j.functions=j.methods=function(n){var t=[];for(var r in n)j.isFunction(n[r])&&t.push(r);return t.sort()},j.extend=function(n){return A(o.call(arguments,1),function(t){if(t)for(var r in t)n[r]=t[r]}),n},j.pick=function(n){var t={},r=c.apply(e,o.call(arguments,1));return A(r,function(r){r in n&&(t[r]=n[r])}),t},j.omit=function(n){var t={},r=c.apply(e,o.call(arguments,1));for(var u in n)j.contains(r,u)||(t[u]=n[u]);return t},j.defaults=function(n){return A(o.call(arguments,1),function(t){if(t)for(var r in t)n[r]===void 0&&(n[r]=t[r])}),n},j.clone=function(n){return j.isObject(n)?j.isArray(n)?n.slice():j.extend({},n):n},j.tap=function(n,t){return t(n),n};var S=function(n,t,r,e){if(n===t)return 0!==n||1/n==1/t;if(null==n||null==t)return n===t;n instanceof j&&(n=n._wrapped),t instanceof j&&(t=t._wrapped);var u=l.call(n);if(u!=l.call(t))return!1;switch(u){case"[object String]":return n==String(t);case"[object Number]":return n!=+n?t!=+t:0==n?1/n==1/t:n==+t;case"[object Date]":case"[object Boolean]":return+n==+t;case"[object RegExp]":return n.source==t.source&&n.global==t.global&&n.multiline==t.multiline&&n.ignoreCase==t.ignoreCase}if("object"!=typeof n||"object"!=typeof t)return!1;for(var i=r.length;i--;)if(r[i]==n)return e[i]==t;var a=n.constructor,o=t.constructor;if(a!==o&&!(j.isFunction(a)&&a instanceof a&&j.isFunction(o)&&o instanceof o)&&"constructor"in n&&"constructor"in t)return!1;r.push(n),e.push(t);var c=0,f=!0;if("[object Array]"==u){if(c=n.length,f=c==t.length)for(;c--&&(f=S(n[c],t[c],r,e)););}else{for(var s in n)if(j.has(n,s)&&(c++,!(f=j.has(t,s)&&S(n[s],t[s],r,e))))break;if(f){for(s in t)if(j.has(t,s)&&!c--)break;f=!c}}return r.pop(),e.pop(),f};j.isEqual=function(n,t){return S(n,t,[],[])},j.isEmpty=function(n){if(null==n)return!0;if(j.isArray(n)||j.isString(n))return 0===n.length;for(var t in n)if(j.has(n,t))return!1;return!0},j.isElement=function(n){return!(!n||1!==n.nodeType)},j.isArray=x||function(n){return"[object Array]"==l.call(n)},j.isObject=function(n){return n===Object(n)},A(["Arguments","Function","String","Number","Date","RegExp"],function(n){j["is"+n]=function(t){return l.call(t)=="[object "+n+"]"}}),j.isArguments(arguments)||(j.isArguments=function(n){return!(!n||!j.has(n,"callee"))}),"function"!=typeof/./&&(j.isFunction=function(n){return"function"==typeof n}),j.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},j.isNaN=function(n){return j.isNumber(n)&&n!=+n},j.isBoolean=function(n){return n===!0||n===!1||"[object Boolean]"==l.call(n)},j.isNull=function(n){return null===n},j.isUndefined=function(n){return n===void 0},j.has=function(n,t){return f.call(n,t)},j.noConflict=function(){return n._=t,this},j.identity=function(n){return n},j.constant=function(n){return function(){return n}},j.property=function(n){return function(t){return t[n]}},j.matches=function(n){return function(t){if(t===n)return!0;for(var r in n)if(n[r]!==t[r])return!1;return!0}},j.times=function(n,t,r){for(var e=Array(Math.max(0,n)),u=0;n>u;u++)e[u]=t.call(r,u);return e},j.random=function(n,t){return null==t&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))},j.now=Date.now||function(){return(new Date).getTime()};var T={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};T.unescape=j.invert(T.escape);var I={escape:new RegExp("["+j.keys(T.escape).join("")+"]","g"),unescape:new RegExp("("+j.keys(T.unescape).join("|")+")","g")};j.each(["escape","unescape"],function(n){j[n]=function(t){return null==t?"":(""+t).replace(I[n],function(t){return T[n][t]})}}),j.result=function(n,t){if(null==n)return void 0;var r=n[t];return j.isFunction(r)?r.call(n):r},j.mixin=function(n){A(j.functions(n),function(t){var r=j[t]=n[t];j.prototype[t]=function(){var n=[this._wrapped];return a.apply(n,arguments),z.call(this,r.apply(j,n))}})};var N=0;j.uniqueId=function(n){var t=++N+"";return n?n+t:t},j.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var q=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},D=/\\|'|\r|\n|\t|\u2028|\u2029/g;j.template=function(n,t,r){var e;r=j.defaults({},r,j.templateSettings);var u=new RegExp([(r.escape||q).source,(r.interpolate||q).source,(r.evaluate||q).source].join("|")+"|$","g"),i=0,a="__p+='";n.replace(u,function(t,r,e,u,o){return a+=n.slice(i,o).replace(D,function(n){return"\\"+B[n]}),r&&(a+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'"),e&&(a+="'+\n((__t=("+e+"))==null?'':__t)+\n'"),u&&(a+="';\n"+u+"\n__p+='"),i=o+t.length,t}),a+="';\n",r.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{e=new Function(r.variable||"obj","_",a)}catch(o){throw o.source=a,o}if(t)return e(t,j);var c=function(n){return e.call(this,n,j)};return c.source="function("+(r.variable||"obj")+"){\n"+a+"}",c},j.chain=function(n){return j(n).chain()};var z=function(n){return this._chain?j(n).chain():n};j.mixin(j),A(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var t=e[n];j.prototype[n]=function(){var r=this._wrapped;return t.apply(r,arguments),"shift"!=n&&"splice"!=n||0!==r.length||delete r[0],z.call(this,r)}}),A(["concat","join","slice"],function(n){var t=e[n];j.prototype[n]=function(){return z.call(this,t.apply(this._wrapped,arguments))}}),j.extend(j.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return j})}).call(this);
//# sourceMappingURL=underscore-min.map
}
if( window.Globalize === undefined) {
/*! globalize - v0.1.1 - 2013-04-30
* https://github.com/jquery/globalize
* Copyright 2013 ; Licensed MIT */
var Globalize = (function(e,r){var t,n,a,s,u,l,i,c,o,f,d,p,h,g,b,m,y,M,v,k,z,F,A,x;t=function(e){return new t.prototype.init(e)},"undefined"!=typeof require&&"undefined"!=typeof exports&&"undefined"!=typeof module?module.exports=t:e.Globalize=t,t.cultures={},t.prototype={constructor:t,init:function(e){return this.cultures=t.cultures,this.cultureSelector=e,this}},t.prototype.init.prototype=t.prototype,t.cultures["default"]={name:"en",englishName:"English",nativeName:"English",isRTL:!1,language:"en",numberFormat:{pattern:["-n"],decimals:2,",":",",".":".",groupSizes:[3],"+":"+","-":"-",NaN:"NaN",negativeInfinity:"-Infinity",positiveInfinity:"Infinity",percent:{pattern:["-n %","n %"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"%"},currency:{pattern:["($n)","$n"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"$"}},calendars:{standard:{name:"Gregorian_USEnglish","/":"/",":":":",firstDay:0,days:{names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],namesAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],namesShort:["Su","Mo","Tu","We","Th","Fr","Sa"]},months:{names:["January","February","March","April","May","June","July","August","September","October","November","December",""],namesAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""]},AM:["AM","am","AM"],PM:["PM","pm","PM"],eras:[{name:"A.D.",start:null,offset:0}],twoDigitYearMax:2029,patterns:{d:"M/d/yyyy",D:"dddd, MMMM dd, yyyy",t:"h:mm tt",T:"h:mm:ss tt",f:"dddd, MMMM dd, yyyy h:mm tt",F:"dddd, MMMM dd, yyyy h:mm:ss tt",M:"MMMM dd",Y:"yyyy MMMM",S:"yyyy'-'MM'-'dd'T'HH':'mm':'ss"}}},messages:{}},t.cultures["default"].calendar=t.cultures["default"].calendars.standard,t.cultures.en=t.cultures["default"],t.cultureSelector="en",n=/^0x[a-f0-9]+$/i,a=/^[+\-]?infinity$/i,s=/^[+\-]?\d*\.?\d*(e[+\-]?\d+)?$/,u=/^\s+|\s+$/g,l=function(e,r){if(e.indexOf)return e.indexOf(r);for(var t=0,n=e.length;n>t;t++)if(e[t]===r)return t;return-1},i=function(e,r){return e.substr(e.length-r.length)===r},c=function(){var e,t,n,a,s,u,l=arguments[0]||{},i=1,p=arguments.length,h=!1;for("boolean"==typeof l&&(h=l,l=arguments[1]||{},i=2),"object"==typeof l||f(l)||(l={});p>i;i++)if(null!=(e=arguments[i]))for(t in e)n=l[t],a=e[t],l!==a&&(h&&a&&(d(a)||(s=o(a)))?(s?(s=!1,u=n&&o(n)?n:[]):u=n&&d(n)?n:{},l[t]=c(h,u,a)):a!==r&&(l[t]=a));return l},o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},f=function(e){return"[object Function]"===Object.prototype.toString.call(e)},d=function(e){return"[object Object]"===Object.prototype.toString.call(e)},p=function(e,r){return 0===e.indexOf(r)},h=function(e){return(e+"").replace(u,"")},g=function(e){return isNaN(e)?0/0:Math[0>e?"ceil":"floor"](e)},b=function(e,r,t){var n;for(n=e.length;r>n;n+=1)e=t?"0"+e:e+"0";return e},m=function(e,r){for(var t=0,n=!1,a=0,s=e.length;s>a;a++){var u=e.charAt(a);switch(u){case"'":n?r.push("'"):t++,n=!1;break;case"\\":n&&r.push("\\"),n=!n;break;default:r.push(u),n=!1}}return t},y=function(e,r){r=r||"F";var t,n=e.patterns,a=r.length;if(1===a){if(t=n[r],!t)throw"Invalid date format string '"+r+"'.";r=t}else 2===a&&"%"===r.charAt(0)&&(r=r.charAt(1));return r},M=function(e,r,t){function n(e,r){var t,n=e+"";return r>1&&r>n.length?(t=v[r-2]+n,t.substr(t.length-r,r)):t=n}function a(){return h||g?h:(h=A.test(r),g=!0,h)}function s(e,r){if(b)return b[r];switch(r){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate();default:throw"Invalid part value "+r}}var u,l=t.calendar,i=l.convert;if(!r||!r.length||"i"===r){if(t&&t.name.length)if(i)u=M(e,l.patterns.F,t);else{var c=new Date(e.getTime()),o=z(e,l.eras);c.setFullYear(F(e,l,o)),u=c.toLocaleString()}else u=""+e;return u}var f=l.eras,d="s"===r;r=y(l,r),u=[];var p,h,g,b,v=["0","00","000"],A=/([^d]|^)(d|dd)([^d]|$)/g,x=0,I=k();for(!d&&i&&(b=i.fromGregorian(e));;){var S=I.lastIndex,w=I.exec(r),C=r.slice(S,w?w.index:r.length);if(x+=m(C,u),!w)break;if(x%2)u.push(w[0]);else{var D=w[0],H=D.length;switch(D){case"ddd":case"dddd":var O=3===H?l.days.namesAbbr:l.days.names;u.push(O[e.getDay()]);break;case"d":case"dd":h=!0,u.push(n(s(e,2),H));break;case"MMM":case"MMMM":var N=s(e,1);u.push(l.monthsGenitive&&a()?l.monthsGenitive[3===H?"namesAbbr":"names"][N]:l.months[3===H?"namesAbbr":"names"][N]);break;case"M":case"MM":u.push(n(s(e,1)+1,H));break;case"y":case"yy":case"yyyy":N=b?b[0]:F(e,l,z(e,f),d),4>H&&(N%=100),u.push(n(N,H));break;case"h":case"hh":p=e.getHours()%12,0===p&&(p=12),u.push(n(p,H));break;case"H":case"HH":u.push(n(e.getHours(),H));break;case"m":case"mm":u.push(n(e.getMinutes(),H));break;case"s":case"ss":u.push(n(e.getSeconds(),H));break;case"t":case"tt":N=12>e.getHours()?l.AM?l.AM[0]:" ":l.PM?l.PM[0]:" ",u.push(1===H?N.charAt(0):N);break;case"f":case"ff":case"fff":u.push(n(e.getMilliseconds(),3).substr(0,H));break;case"z":case"zz":p=e.getTimezoneOffset()/60,u.push((0>=p?"+":"-")+n(Math.floor(Math.abs(p)),H));break;case"zzz":p=e.getTimezoneOffset()/60,u.push((0>=p?"+":"-")+n(Math.floor(Math.abs(p)),2)+":"+n(Math.abs(e.getTimezoneOffset()%60),2));break;case"g":case"gg":l.eras&&u.push(l.eras[z(e,f)].name);break;case"/":u.push(l["/"]);break;default:throw"Invalid date format pattern '"+D+"'."}}}return u.join("")},function(){var e;e=function(e,r,t){var n=t.groupSizes,a=n[0],s=1,u=Math.pow(10,r),l=Math.round(e*u)/u;isFinite(l)||(l=e),e=l;var i=e+"",c="",o=i.split(/e/i),f=o.length>1?parseInt(o[1],10):0;i=o[0],o=i.split("."),i=o[0],c=o.length>1?o[1]:"",f>0?(c=b(c,f,!1),i+=c.slice(0,f),c=c.substr(f)):0>f&&(f=-f,i=b(i,f+1,!0),c=i.slice(-f,i.length)+c,i=i.slice(0,-f)),c=r>0?t["."]+(c.length>r?c.slice(0,r):b(c,r)):"";for(var d=i.length-1,p=t[","],h="";d>=0;){if(0===a||a>d)return i.slice(0,d+1)+(h.length?p+h+c:c);h=i.slice(d-a+1,d+1)+(h.length?p+h:""),d-=a,n.length>s&&(a=n[s],s++)}return i.slice(0,d+1)+p+h+c},v=function(r,t,n){if(!isFinite(r))return 1/0===r?n.numberFormat.positiveInfinity:r===-1/0?n.numberFormat.negativeInfinity:n.numberFormat.NaN;if(!t||"i"===t)return n.name.length?r.toLocaleString():""+r;t=t||"D";var a,s=n.numberFormat,u=Math.abs(r),l=-1;t.length>1&&(l=parseInt(t.slice(1),10));var i,c=t.charAt(0).toUpperCase();switch(c){case"D":a="n",u=g(u),-1!==l&&(u=b(""+u,l,!0)),0>r&&(u="-"+u);break;case"N":i=s;case"C":i=i||s.currency;case"P":i=i||s.percent,a=0>r?i.pattern[0]:i.pattern[1]||"n",-1===l&&(l=i.decimals),u=e(u*("P"===c?100:1),l,i);break;default:throw"Bad number format specifier: "+c}for(var o=/n|\$|-|%/g,f="";;){var d=o.lastIndex,p=o.exec(a);if(f+=a.slice(d,p?p.index:a.length),!p)break;switch(p[0]){case"n":f+=u;break;case"$":f+=s.currency.symbol;break;case"-":/[1-9]/.test(u)&&(f+=s["-"]);break;case"%":f+=s.percent.symbol}}return f}}(),k=function(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|gg|g/g},z=function(e,r){if(!r)return 0;for(var t,n=e.getTime(),a=0,s=r.length;s>a;a++)if(t=r[a].start,null===t||n>=t)return a;return 0},F=function(e,r,t,n){var a=e.getFullYear();return!n&&r.eras&&(a-=r.eras[t].offset),a},function(){var e,r,t,n,a,s,u;e=function(e,r){if(100>r){var t=new Date,n=z(t),a=F(t,e,n),s=e.twoDigitYearMax;s="string"==typeof s?(new Date).getFullYear()%100+parseInt(s,10):s,r+=a-a%100,r>s&&(r-=100)}return r},r=function(e,r,t){var n,a=e.days,i=e._upperDays;return i||(e._upperDays=i=[u(a.names),u(a.namesAbbr),u(a.namesShort)]),r=s(r),t?(n=l(i[1],r),-1===n&&(n=l(i[2],r))):n=l(i[0],r),n},t=function(e,r,t){var n=e.months,a=e.monthsGenitive||e.months,i=e._upperMonths,c=e._upperMonthsGen;i||(e._upperMonths=i=[u(n.names),u(n.namesAbbr)],e._upperMonthsGen=c=[u(a.names),u(a.namesAbbr)]),r=s(r);var o=l(t?i[1]:i[0],r);return 0>o&&(o=l(t?c[1]:c[0],r)),o},n=function(e,r){var t=e._parseRegExp;if(t){var n=t[r];if(n)return n}else e._parseRegExp=t={};for(var a,s=y(e,r).replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1"),u=["^"],l=[],i=0,c=0,o=k();null!==(a=o.exec(s));){var f=s.slice(i,a.index);if(i=o.lastIndex,c+=m(f,u),c%2)u.push(a[0]);else{var d,p=a[0],h=p.length;switch(p){case"dddd":case"ddd":case"MMMM":case"MMM":case"gg":case"g":d="(\\D+)";break;case"tt":case"t":d="(\\D*)";break;case"yyyy":case"fff":case"ff":case"f":d="(\\d{"+h+"})";break;case"dd":case"d":case"MM":case"M":case"yy":case"y":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":d="(\\d\\d?)";break;case"zzz":d="([+-]?\\d\\d?:\\d{2})";break;case"zz":case"z":d="([+-]?\\d\\d?)";break;case"/":d="(\\/)";break;default:throw"Invalid date format pattern '"+p+"'."}d&&u.push(d),l.push(a[0])}}m(s.slice(i),u),u.push("$");var g=u.join("").replace(/\s+/g,"\\s+"),b={regExp:g,groups:l};return t[r]=b},a=function(e,r,t){return r>e||e>t},s=function(e){return e.split("\u00a0").join(" ").toUpperCase()},u=function(e){for(var r=[],t=0,n=e.length;n>t;t++)r[t]=s(e[t]);return r},A=function(s,u,l){s=h(s);var i=l.calendar,c=n(i,u),o=RegExp(c.regExp).exec(s);if(null===o)return null;for(var f,d=c.groups,g=null,b=null,m=null,y=null,M=null,v=0,k=0,z=0,F=0,A=null,x=!1,I=0,S=d.length;S>I;I++){var w=o[I+1];if(w){var C=d[I],D=C.length,H=parseInt(w,10);switch(C){case"dd":case"d":if(y=H,a(y,1,31))return null;break;case"MMM":case"MMMM":if(m=t(i,w,3===D),a(m,0,11))return null;break;case"M":case"MM":if(m=H-1,a(m,0,11))return null;break;case"y":case"yy":case"yyyy":if(b=4>D?e(i,H):H,a(b,0,9999))return null;break;case"h":case"hh":if(v=H,12===v&&(v=0),a(v,0,11))return null;break;case"H":case"HH":if(v=H,a(v,0,23))return null;break;case"m":case"mm":if(k=H,a(k,0,59))return null;break;case"s":case"ss":if(z=H,a(z,0,59))return null;break;case"tt":case"t":if(x=i.PM&&(w===i.PM[0]||w===i.PM[1]||w===i.PM[2]),!x&&(!i.AM||w!==i.AM[0]&&w!==i.AM[1]&&w!==i.AM[2]))return null;break;case"f":case"ff":case"fff":if(F=H*Math.pow(10,3-D),a(F,0,999))return null;break;case"ddd":case"dddd":if(M=r(i,w,3===D),a(M,0,6))return null;break;case"zzz":var O=w.split(/:/);if(2!==O.length)return null;if(f=parseInt(O[0],10),a(f,-12,13))return null;var N=parseInt(O[1],10);if(a(N,0,59))return null;A=60*f+(p(w,"-")?-N:N);break;case"z":case"zz":if(f=H,a(f,-12,13))return null;A=60*f;break;case"g":case"gg":var T=w;if(!T||!i.eras)return null;T=h(T.toLowerCase());for(var j=0,$=i.eras.length;$>j;j++)if(T===i.eras[j].name.toLowerCase()){g=j;break}if(null===g)return null}}}var P,G=new Date,E=i.convert;if(P=E?E.fromGregorian(G)[0]:G.getFullYear(),null===b?b=P:i.eras&&(b+=i.eras[g||0].offset),null===m&&(m=0),null===y&&(y=1),E){if(G=E.toGregorian(b,m,y),null===G)return null}else{if(G.setFullYear(b,m,y),G.getDate()!==y)return null;if(null!==M&&G.getDay()!==M)return null}if(x&&12>v&&(v+=12),G.setHours(v,k,z,F),null!==A){var Y=G.getMinutes()-(A+G.getTimezoneOffset());G.setHours(G.getHours()+parseInt(Y/60,10),Y%60)}return G}}(),x=function(e,r,t){var n,a=r["-"],s=r["+"];switch(t){case"n -":a=" "+a,s=" "+s;case"n-":i(e,a)?n=["-",e.substr(0,e.length-a.length)]:i(e,s)&&(n=["+",e.substr(0,e.length-s.length)]);break;case"- n":a+=" ",s+=" ";case"-n":p(e,a)?n=["-",e.substr(a.length)]:p(e,s)&&(n=["+",e.substr(s.length)]);break;case"(n)":p(e,"(")&&i(e,")")&&(n=["-",e.substr(1,e.length-2)])}return n||["",e]},t.prototype.findClosestCulture=function(e){return t.findClosestCulture.call(this,e)},t.prototype.format=function(e,r,n){return t.format.call(this,e,r,n)},t.prototype.localize=function(e,r){return t.localize.call(this,e,r)},t.prototype.parseInt=function(e,r,n){return t.parseInt.call(this,e,r,n)},t.prototype.parseFloat=function(e,r,n){return t.parseFloat.call(this,e,r,n)},t.prototype.culture=function(e){return t.culture.call(this,e)},t.addCultureInfo=function(e,r,t){var n={},a=!1;"string"!=typeof e?(t=e,e=this.culture().name,n=this.cultures[e]):"string"!=typeof r?(t=r,a=null==this.cultures[e],n=this.cultures[e]||this.cultures["default"]):(a=!0,n=this.cultures[r]),this.cultures[e]=c(!0,{},n,t),a&&(this.cultures[e].calendar=this.cultures[e].calendars.standard)},t.findClosestCulture=function(e){var r;if(!e)return this.findClosestCulture(this.cultureSelector)||this.cultures["default"];if("string"==typeof e&&(e=e.split(",")),o(e)){var t,n,a=this.cultures,s=e,u=s.length,l=[];for(n=0;u>n;n++){e=h(s[n]);var i,c=e.split(";");t=h(c[0]),1===c.length?i=1:(e=h(c[1]),0===e.indexOf("q=")?(e=e.substr(2),i=parseFloat(e),i=isNaN(i)?0:i):i=1),l.push({lang:t,pri:i})}for(l.sort(function(e,r){return e.pri<r.pri?1:e.pri>r.pri?-1:0}),n=0;u>n;n++)if(t=l[n].lang,r=a[t])return r;for(n=0;u>n;n++)for(t=l[n].lang;;){var f=t.lastIndexOf("-");if(-1===f)break;if(t=t.substr(0,f),r=a[t])return r}for(n=0;u>n;n++){t=l[n].lang;for(var d in a){var p=a[d];if(p.language===t)return p}}}else if("object"==typeof e)return e;return r||null},t.format=function(e,r,t){var n=this.findClosestCulture(t);return e instanceof Date?e=M(e,r,n):"number"==typeof e&&(e=v(e,r,n)),e},t.localize=function(e,r){return this.findClosestCulture(r).messages[e]||this.cultures["default"].messages[e]},t.parseDate=function(e,r,t){t=this.findClosestCulture(t);var n,a,s;if(r){if("string"==typeof r&&(r=[r]),r.length)for(var u=0,l=r.length;l>u;u++){var i=r[u];if(i&&(n=A(e,i,t)))break}}else{s=t.calendar.patterns;for(a in s)if(n=A(e,s[a],t))break}return n||null},t.parseInt=function(e,r,n){return g(t.parseFloat(e,r,n))},t.parseFloat=function(e,r,t){"number"!=typeof r&&(t=r,r=10);var u=this.findClosestCulture(t),l=0/0,i=u.numberFormat;if(e.indexOf(u.numberFormat.currency.symbol)>-1&&(e=e.replace(u.numberFormat.currency.symbol,""),e=e.replace(u.numberFormat.currency["."],u.numberFormat["."])),e.indexOf(u.numberFormat.percent.symbol)>-1&&(e=e.replace(u.numberFormat.percent.symbol,"")),e=e.replace(/ /g,""),a.test(e))l=parseFloat(e);else if(!r&&n.test(e))l=parseInt(e,16);else{var c=x(e,i,i.pattern[0]),o=c[0],f=c[1];""===o&&"(n)"!==i.pattern[0]&&(c=x(e,i,"(n)"),o=c[0],f=c[1]),""===o&&"-n"!==i.pattern[0]&&(c=x(e,i,"-n"),o=c[0],f=c[1]),o=o||"+";var d,p,h=f.indexOf("e");0>h&&(h=f.indexOf("E")),0>h?(p=f,d=null):(p=f.substr(0,h),d=f.substr(h+1));var g,b,m=i["."],y=p.indexOf(m);0>y?(g=p,b=null):(g=p.substr(0,y),b=p.substr(y+m.length));var M=i[","];g=g.split(M).join("");var v=M.replace(/\u00A0/g," ");M!==v&&(g=g.split(v).join(""));var k=o+g;if(null!==b&&(k+="."+b),null!==d){var z=x(d,i,"-n");k+="e"+(z[0]||"+")+z[1]}s.test(k)&&(l=parseFloat(k))}return l},t.culture=function(e){return e!==r&&(this.cultureSelector=e),this.findClosestCulture(e)||this.cultures["default"]}; return Globalize;}(this));
}
if( window.Coveo === undefined) {
/*
 * l10n.js
 * 2013-04-18
 * 
 * By Eli Grey, http://eligrey.com
 * Licensed under the X11/MIT License
 *   See LICENSE.md
 */

/*global XMLHttpRequest, setTimeout, document, navigator, ActiveXObject*/

/*! @source http://purl.eligrey.com/github/l10n.js/blob/master/l10n.js*/

(function () {
"use strict";

var
  undef_type = "undefined"
, string_type = "string"
, nav = self.navigator
, String_ctr = String
, has_own_prop = Object.prototype.hasOwnProperty
, load_queues = {}
, localizations = {}
, FALSE = !1
, TRUE = !0
// the official format is application/vnd.oftn.l10n+json, though l10n.js will also
// accept application/x-l10n+json and application/l10n+json
, l10n_js_media_type = /^\s*application\/(?:vnd\.oftn\.|x-)?l10n\+json\s*(?:$|;)/i
, XHR

// property minification aids
, $locale = "locale"
, $default_locale = "defaultLocale"
, $to_locale_string = "toLocaleString"
, $to_lowercase = "toLowerCase"

, array_index_of = Array.prototype.indexOf || function (item) {
	var
	  len = this.length
	, i   = 0
	;
	
	for (; i < len; i++) {
		if (i in this && this[i] === item) {
			return i;
		}
	}
	
	return -1;
}
, request_JSON = function (uri) {
	var req = new XHR();
	
	// sadly, this has to be blocking to allow for a graceful degrading API
	req.open("GET", uri, FALSE);
	req.send(null);
	
	if (req.status !== 200) {
		// warn about error without stopping execution
		setTimeout(function () {
			// Error messages are not localized as not to cause an infinite loop
			var l10n_err = new Error("Unable to load localization data: " + uri);
			l10n_err.name = "Localization Error";
			throw l10n_err;
		}, 0);
		
		return {};
	} else {
		return JSON.parse(req.responseText);
	}
}
, load = String_ctr[$to_locale_string] = function (data) {
	// don't handle function[$to_locale_string](indentationAmount:Number)
	if (arguments.length > 0 && typeof data !== "number") {
		if (typeof data === string_type) {
			load(request_JSON(data));
		} else if (data === FALSE) {
			// reset all localizations
			localizations = {};
		} else {
			// Extend current localizations instead of completely overwriting them
			var locale, localization, message;
			for (locale in data) {
				if (has_own_prop.call(data, locale)) {
					localization = data[locale];
					locale = locale[$to_lowercase]();
					
					if (!(locale in localizations) || localization === FALSE) {
						// reset locale if not existing or reset flag is specified
						localizations[locale] = {};
					}
					
					if (localization === FALSE) {
						continue;
					}
					
					// URL specified
					if (typeof localization === string_type) {
						if (String_ctr[$locale][$to_lowercase]().indexOf(locale) === 0) {
							localization = request_JSON(localization);
						} else {
							// queue loading locale if not needed
							if (!(locale in load_queues)) {
								load_queues[locale] = [];
							}
							load_queues[locale].push(localization);
							continue;
						}
					}
					
					for (message in localization) {
						if (has_own_prop.call(localization, message)) {
							localizations[locale][message] = localization[message];
						}
					}
				}
			}
		}
	}
	// Return what function[$to_locale_string]() normally returns
	return Function.prototype[$to_locale_string].apply(String_ctr, arguments);
}
, process_load_queue = function (locale) {
	var
	  queue = load_queues[locale]
	, i = 0
	, len = queue.length
	, localization
	;
	
	for (; i < len; i++) {
		localization = {};
		localization[locale] = request_JSON(queue[i]);
		load(localization);
	}
	
	delete load_queues[locale];
}
, use_default
, localize = String_ctr.prototype[$to_locale_string] = function () {
	var
	  using_default = use_default
	, current_locale = String_ctr[using_default ? $default_locale : $locale]
	, parts = current_locale[$to_lowercase]().split("-")
	, i = parts.length
	, this_val = this.valueOf()
	, locale
	;

	use_default = FALSE;
	
	// Iterate through locales starting at most-specific until a localization is found
	do {
		locale = parts.slice(0, i).join("-");
		// load locale if not loaded
		if (locale in load_queues) {
			process_load_queue(locale);
		}
		if (locale in localizations && this_val in localizations[locale]) {
			return localizations[locale][this_val];
		}
	}
	while (i --> 1);
	
	if (!using_default && String_ctr[$default_locale]) {
		use_default = TRUE;
		return localize.call(this_val);
	}

	return this_val;
}
;

if (typeof XMLHttpRequest === undef_type && typeof ActiveXObject !== undef_type) {
	var AXO = ActiveXObject;
	
	XHR = function () {
		try {
			return new AXO("Msxml2.XMLHTTP.6.0");
		} catch (xhrEx1) {}
		try {
			return new AXO("Msxml2.XMLHTTP.3.0");
		} catch (xhrEx2) {}
		try {
			return new AXO("Msxml2.XMLHTTP");
		} catch (xhrEx3) {}
	
		throw new Error("XMLHttpRequest not supported by this browser.");
	};
} else {
	XHR = XMLHttpRequest;
}

String_ctr[$default_locale] = String_ctr[$default_locale] || "";
String_ctr[$locale] = nav && (nav.language || nav.userLanguage) || "";

if (typeof document !== undef_type) {
	var
	  elts = document.getElementsByTagName("link")
	, i = elts.length
	, localization
	;
	
	while (i--) {
		var
		  elt = elts[i]
		, rel = (elt.getAttribute("rel") || "")[$to_lowercase]().split(/\s+/)
		;
		
		if (l10n_js_media_type.test(elt.type)) {
			if (array_index_of.call(rel, "localizations") !== -1) {
				// multiple localizations
				load(elt.getAttribute("href"));
			} else if (array_index_of.call(rel, "localization") !== -1) {
				// single localization
				localization = {};
				localization[(elt.getAttribute("hreflang") || "")[$to_lowercase]()] =
					elt.getAttribute("href");
				load(localization);
			}
		}
	}
}

}());

}
if( window.$.jsonp === undefined) {
// jquery.jsonp 2.4.0 (c)2012 Julian Aubourg | MIT License
// https://github.com/jaubourg/jquery-jsonp
(function(e){function t(){}function n(e){C=[e]}function r(e,t,n){return e&&e.apply&&e.apply(t.context||t,n)}function i(e){return/\?/.test(e)?"&":"?"}function O(c){function Y(e){z++||(W(),j&&(T[I]={s:[e]}),D&&(e=D.apply(c,[e])),r(O,c,[e,b,c]),r(_,c,[c,b]))}function Z(e){z++||(W(),j&&e!=w&&(T[I]=e),r(M,c,[c,e]),r(_,c,[c,e]))}c=e.extend({},k,c);var O=c.success,M=c.error,_=c.complete,D=c.dataFilter,P=c.callbackParameter,H=c.callback,B=c.cache,j=c.pageCache,F=c.charset,I=c.url,q=c.data,R=c.timeout,U,z=0,W=t,X,V,J,K,Q,G;return S&&S(function(e){e.done(O).fail(M),O=e.resolve,M=e.reject}).promise(c),c.abort=function(){!(z++)&&W()},r(c.beforeSend,c,[c])===!1||z?c:(I=I||u,q=q?typeof q=="string"?q:e.param(q,c.traditional):u,I+=q?i(I)+q:u,P&&(I+=i(I)+encodeURIComponent(P)+"=?"),!B&&!j&&(I+=i(I)+"_"+(new Date).getTime()+"="),I=I.replace(/=\?(&|$)/,"="+H+"$1"),j&&(U=T[I])?U.s?Y(U.s[0]):Z(U):(E[H]=n,K=e(y)[0],K.id=l+N++,F&&(K[o]=F),L&&L.version()<11.6?(Q=e(y)[0]).text="document.getElementById('"+K.id+"')."+p+"()":K[s]=s,A&&(K.htmlFor=K.id,K.event=h),K[d]=K[p]=K[v]=function(e){if(!K[m]||!/i/.test(K[m])){try{K[h]&&K[h]()}catch(t){}e=C,C=0,e?Y(e[0]):Z(a)}},K.src=I,W=function(e){G&&clearTimeout(G),K[v]=K[d]=K[p]=null,x[g](K),Q&&x[g](Q)},x[f](K,J=x.firstChild),Q&&x[f](Q,J),G=R>0&&setTimeout(function(){Z(w)},R)),c)}var s="async",o="charset",u="",a="error",f="insertBefore",l="_jqjsp",c="on",h=c+"click",p=c+a,d=c+"load",v=c+"readystatechange",m="readyState",g="removeChild",y="<script>",b="success",w="timeout",E=window,S=e.Deferred,x=e("head")[0]||document.documentElement,T={},N=0,C,k={callback:l,url:location.href},L=E.opera,A=!!e("<div>").html("<!--[if IE]><i><![endif]-->").find("i").length;O.setup=function(t){e.extend(k,t)},e.jsonp=O})(jQuery)
}
if( window.Coveo === undefined || window.Coveo['ModalBox'] === undefined) {
/// <reference path="../lib/jquery.d.ts"/>
var Coveo;
(function (Coveo) {
    var ModalBox;
    (function (ModalBox) {
        (function (BUTTON) {
            BUTTON[BUTTON["OK"] = 1] = "OK";
            BUTTON[BUTTON["APPLY"] = 2] = "APPLY";
            BUTTON[BUTTON["YES"] = 4] = "YES";
            BUTTON[BUTTON["NO"] = 8] = "NO";
            BUTTON[BUTTON["CANCEL"] = 16] = "CANCEL";
        })(ModalBox.BUTTON || (ModalBox.BUTTON = {}));
        var BUTTON = ModalBox.BUTTON;
        var closeFunctions = [];
        function open(content, options) {
            if (options === void 0) { options = {}; }
            $(document.body).addClass('coveo-modalBox-opened');
            var modalBox = $('<div class="coveo-modalBox" />').appendTo(document.body);
            if (options.fullscreen === true) {
                modalBox.addClass('coveo-fullscreen');
            }
            var overlay = $('<div class="coveo-overlay" />').appendTo(modalBox);
            var wrapper = $('<div class="coveo-wrapper" />').appendTo(modalBox);
            if (options.title != null) {
                var title = $('<div class="coveo-title" />').html(options.title).appendTo(wrapper);
                if (options.titleClose === true) {
                    title.click(function () { return close(); });
                }
            }
            if (content.length > 1) {
                content = $('<div />').append(content);
            }
            wrapper.append(content.addClass('coveo-body'));
            var close = function (button, forceClose) {
                if (button === void 0) { button = 0; }
                if (forceClose === void 0) { forceClose = false; }
                var valid = options.validation == null || options.validation(button);
                if (valid !== false || forceClose) {
                    modalBox.detach();
                    var index = $.inArray(close, closeFunctions);
                    if (index >= 0) {
                        closeFunctions.splice(index, 1);
                    }
                    if (closeFunctions.length == 0) {
                        $(document.body).removeClass('coveo-modalBox-opened');
                    }
                    return true;
                }
                return false;
            };
            var buttonsContainer;
            if (options.buttons != null) {
                var buttonClick = function (button) { return function () { return close(button); }; };
                buttonsContainer = $('<div class="coveo-buttons" />').appendTo(wrapper);
                if (options.buttons & 1 /* OK */) {
                    $('<div class="coveo-button">Ok</div>').click(buttonClick(1 /* OK */)).appendTo(buttonsContainer);
                }
                if (options.buttons & 2 /* APPLY */) {
                    $('<div class="coveo-button">Apply</div>').click(buttonClick(2 /* APPLY */)).appendTo(buttonsContainer);
                }
                if (options.buttons & 4 /* YES */) {
                    $('<div class="coveo-button">Yes</div>').click(buttonClick(4 /* YES */)).appendTo(buttonsContainer);
                }
                if (options.buttons & 8 /* NO */) {
                    $('<div class="coveo-button">No</div>').click(buttonClick(8 /* NO */)).appendTo(buttonsContainer);
                }
                if (options.buttons & 16 /* CANCEL */) {
                    $('<div class="coveo-button">Cancel</div>').click(buttonClick(16 /* CANCEL */)).appendTo(buttonsContainer);
                }
            }
            closeFunctions.push(close);
            if (options.overlayClose === true) {
                overlay.click(function () { return close(); });
            }
            if (options.className != null) {
                modalBox.addClass(options.className);
            }
            return {
                modalBox: modalBox,
                overlay: overlay,
                wrapper: wrapper,
                buttons: buttonsContainer,
                content: content,
                close: close
            };
        }
        ModalBox.open = open;
        function close(forceClose) {
            if (forceClose === void 0) { forceClose = false; }
            var i = 0;
            while (closeFunctions.length > i) {
                var closed = closeFunctions[i](0, forceClose);
                if (!closed) {
                    i++;
                }
            }
        }
        ModalBox.close = close;
    })(ModalBox = Coveo.ModalBox || (Coveo.ModalBox = {}));
})(Coveo || (Coveo = {}));

}
var secretFeatureVariable1309=!1,Coveo;!function(e){e.version={lib : "0.9.993.8",product:"0.0.0.0"}}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){function i(){for(var t=[],i=0;i<arguments.length;i++)t[i-0]=arguments[i];return e.L10N.format.apply(this,arguments)}t.l=i}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={})),function(){var e={Unknown:"Unknown",And:"AND",Authenticating:"Authenticating {0}...",Clear:"Clear {0}",CompleteQuery:"Complete Query",Exclude:"Exclude {0}",EnterTag:"Add Tag",Next:"Next",Last:"Last",Link:"Link",Or:"OR",Previous:"Previous",QueryDidntMatchAnyDocuments:"Your query did not match any documents.",QueryException:"Your query has an error: {0}.",Me:"Me",Remove:"Remove",Search:"Search",SearchFor:"Search for {0}",ShareQuery:"Share Query",Preferences:"Preferences",LinkOpeningSettings:"Link Opening Settings",Reauthenticate:"Reauthenticate {0}",ResultsFilteringExpression:"Results Filtering Expressions",FiltersInYourPreferences:"Filters in your preferences",Create:"Create",SearchIn:"Search in {0}",Seconds:"in {0} second<pl>s</pl>",ShowingResultsOf:"Result<pl>s</pl> {0}<pl>-{1}</pl> of {2}",SwitchTo:"Switch to {0}",Unexclude:"Unexclude {0}",ClearAllFilters:"Clear All Filters",SkipLogin:"Skip login",LoginInProgress:"Login in progress, please wait ...",Login:"Log In",GetStarted:"Get Started",More:"More",Less:"Fewer",Settings:"Settings",Score:"Score",ScoreDescription:"The score is computed from the number of occurrences as well as from the position in the result set.",Occurrences:"Occurrences",OccurrencesDescription:"Sort by number of occurrences, with values having the highest number appearing first.",Label:"Label",Of:"of",LabelDescription:"Sort alphabetically on the field values.",Value:"Value",ValueDescription:"Sort on the values of the first computed field",AlphaAscending:"Value Ascending",AlphaDescending:"Value Descending",ChiSquare:"Chi Square",Nosort:"No Sort",RelativeFrequency:"Relative Frequency",RelativeFrequencyDescription:"Sort based on the relative frequency of values. Less common values will appear higher",Custom:"Custom",CustomDescription:"Sort based on a custom order",ComputedField:"Computed Field",Ascending:"Ascending",Descending:"Descending",noResultFor:"No results for {0}",autoCorrectedQueryTo:"Query was automatically corrected to {0}",didYouMean:"Did you mean: {0}",SuggestedResults:"Suggested Results",SuggestedQueries:"Suggested Queries",MostRelevantItems:"Most relevant items:",AllItems:"All items:",ShowLess:"Show less",ShowMore:"Show more",HideFacet:"Hide Facet",ShowFacet:"Show Facet",AndOthers:"and {0} other<pl>s</pl>",MostRelevantPosts:"Most Relevant Posts:",CompleteThread:"Complete Thread:",ShowCompleteThread:"Show Complete Thread",ShowOnlyTopMatchingPosts:"Show Only Top Matching Posts",MostRelevantReplies:"Most Relevant Replies:",AllConversation:"All Conversation:",ShowAllConversation:"Show All Conversation",ShowAllReplies:"Show All Replies",ShowOnlyMostRelevantReplies:"Show Only Most Relevant Replies",Close:"Close",Open:"Open",OpenInOutlookWhenPossible:"Open in Outlook (when possible)",AlwaysOpenInNewWindow:"Always open results in new window",QuickView:"Quick View",ErrorReport:"Error Report",OopsError:"Oops! Something went wrong on the server.",ProblemPersists:"If the problem persists contact the administrator.",GoBack:"Go Back",Reset:"Reset",Retry:"Retry",MoreInfo:"More Information",Username:"Username",Password:"Password",CannotConnect:"Cannot connect to the server address.",BadUserPass:"Password does not match with user name.",PleaseEnterYourCredentials:"Please enter your credentials for {0}.",PleaseEnterYourSearchPage:"Please enter your search page URL",Collapse:"Collapse",Expand:"Expand",Today:"Today",Yesterday:"Yesterday",Tomorrow:"Tomorrow",Duration:"Duration: {0}",IndexDuration:"Index Duration: {0}",ProxyDuration:"Proxy Duration: {0}",ClientDuration:"Client Duration: {0}",Unavailable:"Unavailable",Reply:"Reply",ReplyAll:"Reply All",Forward:"Forward",From:"From",Caption:"Caption",Expression:"Expression",Tab:"Tab",Tabs:"Tabs",EnterExpressionName:"Enter Expression Name",EnterExpressionToFilterWith:"Enter Expression To Filter Results With",SelectTab:"Select Tab",SelectAll:"Select All",PageUrl:"Search page URL",ErrorSavingToDevice:"Error while saving the information to your device",ErrorReadingFromDevice:"Error while reading the information from your device",AppIntro:"Speak with a product specialist who can answer your questions about Coveo and help your decide which Coveo solution is right for you. Or, try a live demo !",TryDemo:"Try the demo",ContactUs:"Contact us",NewToCoveo:"New to Coveo ?",LetUsHelpGetStarted:"Let us help you get started",CannotConnectSearchPage:"Cannot connect to your search page",AreYouSureDeleteFilter:"Are you sure you want to delete the filter {0} with the expression {1}",OnlineHelp:"Online Help",Done:"Done",SaveFacetState:"Save this facet state",ClearFacetState:"Clear facet state",DisplayingTheOnlyMessage:"Displaying the only message in this conversation",NoNetworkConnection:"No network connection",UnknownConnection:"Unknown connection",EthernetConnection:"Ethernet connection",WiFi:"WiFi connection",CELL:"Cellular connection",CELL_2G:"Cellular 2G connection",CELL_3G:"Cellular 3G connection",CELL_4G:"Cellular 4G connection",QueryExceptionNoException:"No exception",QueryExceptionInvalidSyntax:"Invalid syntax",QueryExceptionInvalidCustomField:"Invalid custom field",QueryExceptionInvalidDate:"Invalid date",QueryExceptionInvalidExactPhrase:"Invalid exact phrase",QueryExceptionInvalidDateOp:"Invalid date operator",QueryExceptionInvalidNear:"Invalid Near",QueryExceptionInvalidWeightedNear:"Invalid weighted near",QueryExceptionInvalidTerm:"Invalid term",QueryExceptionTooManyTerms:"Too many terms",QueryExceptionWildcardTooGeneral:"Wildcard too general",QueryExceptionInvalidSortField:"Invalid sort field",QueryExceptionInvalidSmallStringOp:"Invalid small string operator",QueryExceptionRequestedResultsMax:"Requested results maximum",QueryExceptionAggregatedMirrorDead:"Aggregated mirror is offline",QueryExceptionAggregatedMirrorQueryTimeOut:"Aggregated mirror query timeout",QueryExceptionAggregatedMirrorInvalidBuildNumber:"Aggregated mirror invalid build number",QueryExceptionAggregatedMirrorCannotConnect:"Aggregated mirror cannot connect",QueryExceptionNotEnoughLeadingCharsWildcard:"Not enough leading character wildcard",QueryExceptionSecurityInverterNotFound:"Security inverter not found",QueryExceptionSecurityInverterAccessDenied:"Security inverter access denied",QueryExceptionAggregatedMirrorCannotImpersonate:"Aggregated mirror cannot impersonate",QueryExceptionUnexpected:"Unexpected",QueryExceptionAccessDenied:"Access denied",QueryExceptionSuperUserTokenInvalid:"Super user token invalid",QueryExceptionSuperUserTokenExpired:"Super user token is expired",QueryExceptionLicenseQueriesExpired:"Queries license expired",QueryExceptionLicenseSuperUserTokenNotSupported:"License super user token not supported",QueryExceptionInvalidSession:"Invalid session",QueryExceptionInvalidDocument:"Invalid document",QueryExceptionSearchDisabled:"Search disabled",objecttype_people:"People",objecttype_message:"Message",objecttype_feed:"RSS Feed",objecttype_thread:"Thread",objecttype_board:"",objecttype_category:"",objecttype_account:"Account",objecttype_campaign:"Campaign",objecttype_case:"Case",objecttype_contact:"Contact",objecttype_contract:"Contract",objecttype_event:"Event",objecttype_lead:"Lead",objecttype_solution:"Solution",objecttype_task:"Task",objecttype_user:"User",objecttype_attachment:"Attachment",objecttype_casecomment:"Case Comment",objecttype_opportunity:"Opportunity",objecttype_note:"Note",objecttype_product:"Product",objecttype_partner:"Partner",objecttype_kbdocumentation:"Documentation",objecttype_kbsolution:"Solution",objecttype_kbknowledgearticle:"Knowledge Article",objecttype_kbattachment:"Attachment",sysfiletype_html:"HTML File",sysfiletype_image:"Image",sysfiletype_folder:"Folder",sysfiletype_txt:"Text",sysfiletype_zip:"Zip File",sysfiletype_pdf:"PDF File",sysfiletype_xml:"XML File",sysfiletype_doc:"Word Document",sysfiletype_xls:"Excel Document",sysfiletype_ppt:"PowerPoint Document",sysfiletype_video:"Video",sysfiletype_exchangemessage:"Message",sysfiletype_exchangeappointment:"Appointment",sysfiletype_exchangenote:"Note",sysfiletype_exchangetask:"Task",sysfiletype_exchangeperson:"Exchange user",sysfiletype_activedirperson:"Active Directory user",sysfiletype_exchangeactivity:"Activity",sysfiletype_exchangecalendarmessage:"Calendar message",sysfiletype_exchangedocument:"Exchange document",sysfiletype_exchangerssfeed:"RSS Feed",sysfiletype_exchangejunkmessage:"Junk email",sysfiletype_exchangeofficecom:"Communications",sysfiletype_spportal:"Portal",sysfiletype_spsite:"Site",sysfiletype_spuserprofile:"SharePoint User",sysfiletype_sparea:"Area",sysfiletype_spannouncement:"Announcement",sysfiletype_spannouncementlist:"Announcements",sysfiletype_spcontact:"Contact",sysfiletype_spcontactlist:"Contacts",sysfiletype_spcustomlist:"Custom Lists",sysfiletype_spdiscussionboard:"Discussion Board",sysfiletype_spdiscussionboardlist:"Discussion Boards",sysfiletype_spdocumentlibrarylist:"Document Library",sysfiletype_spevent:"Event",sysfiletype_speventlist:"Events",sysfiletype_spformlibrarylist:"Form Library",sysfiletype_spissue:"Issue",sysfiletype_spissuelist:"Issues",sysfiletype_splink:"Link",sysfiletype_splinklist:"Links",sysfiletype_sppicturelibrarylist:"Picture Library",sysfiletype_spsurvey:"Survey",sysfiletype_spsurveylist:"Surveys",sysfiletype_sptask:"Task",sysfiletype_sptasklist:"Tasks",sysfiletype_spagenda:"Agenda",sysfiletype_spagendalist:"Agendas",sysfiletype_spattendee:"Attendee",sysfiletype_spattendeelist:"Attendees",sysfiletype_spcustomgridlist:"Custom Grids",sysfiletype_spdecision:"Decision",sysfiletype_spdecisionlist:"Decisions",sysfiletype_spobjective:"Objective",sysfiletype_spobjectivelist:"Objectives",sysfiletype_sptextbox:"Textbox",sysfiletype_sptextboxlist:"Textbox list",sysfiletype_spthingstobring:"Thing To Bring",sysfiletype_spthingstobringlist:"Things To Bring",sysfiletype_sparealisting:"Area Listing",sysfiletype_spmeetingserie:"Meeting series",sysfiletype_spmeetingserielist:"Meeting Series List",sysfiletype_spsitedirectory:"Site Directory Item",sysfiletype_spsitedirectorylist:"Site Directory",sysfiletype_spdatasource:"Data Source",sysfiletype_spdatasourcelist:"Data Source List",sysfiletype_splisttemplatecataloglist:"List Template Catalog List",sysfiletype_spwebpartcataloglist:"WebPart catalog list",sysfiletype_spwebtemplatecataloglist:"Web Template Catalog List",sysfiletype_spworkspacepagelist:"Workspace Page List",sysfiletype_spunknownlist:"Custom List",sysfiletype_spadministratortask:"Administrator Task",sysfiletype_spadministratortasklist:"Administrator Tasks",sysfiletype_spareadocumentlibrarylist:"Area Document Library",sysfiletype_spblogcategory:"Blog Category",sysfiletype_spblogcategorylist:"Blog Category",sysfiletype_spblogcomment:"Blog Comment",sysfiletype_spblogcommentlist:"Blog Comments",sysfiletype_spblogpost:"Blog Post",sysfiletype_spblogpostlist:"Blog Posts",sysfiletype_spdataconnectionlibrarylist:"Data Connection Library",sysfiletype_spdistributiongroup:"Distribution Group",sysfiletype_spdistributiongrouplist:"Distribution Groups",sysfiletype_spipfslist:"InfoPath Form Servers",sysfiletype_spkeyperformanceindicator:"Key Performance Indicator",sysfiletype_spkeyperformanceindicatorlist:"Key Performance Indicators",sysfiletype_splanguagesandtranslator:"Languages and Translator",sysfiletype_splanguagesandtranslatorlist:"Languages and Translators",sysfiletype_spmasterpagescataloglist:"Master Pages Library",sysfiletype_spnocodeworkflowlibrarylist:"No Code Workflow Library",sysfiletype_spprojecttask:"Project Task",sysfiletype_spprojecttasklist:"Project Tasks",sysfiletype_sppublishingpageslibrarylist:"Page Library",sysfiletype_spreportdocumentlibrarylist:"Report Document Library",sysfiletype_spreportlibrarylist:"Report Library",sysfiletype_spslidelibrarylist:"Slide Library",sysfiletype_sptab:"Tabs",sysfiletype_sptablist:"Tabs List",sysfiletype_sptranslationmanagementlibrarylist:"Translation Management Library",sysfiletype_spuserinformation:"User Information",sysfiletype_spuserinformationlist:"User Information List",sysfiletype_spwikipagelibrarylist:"Wiki Page Library",sysfiletype_spworkflowhistory:"Workflow History",sysfiletype_spworkflowhistorylist:"Workflow Histories",sysfiletype_spworkflowprocess:"Custom Workflow Process",sysfiletype_spworkflowprocesslist:"Custom Workflow Processes",sysfiletype_sppublishingimageslibrarylist:"Publishing Image Library",sysfiletype_spcirculation:"Circulation",sysfiletype_spcirculationlist:"Circulations",sysfiletype_spdashboardslibrarylist:"Dashboard Library",sysfiletype_spdataconnectionforperformancepointlibrarylist:"Data Connection for Performance Point Library",sysfiletype_sphealthreport:"Health Report",sysfiletype_sphealthreportlist:"Health Reports",sysfiletype_sphealthrule:"Health Rule",sysfiletype_sphealthrulelist:"Health Rules",sysfiletype_spimedictionary:"IME Dictionary",sysfiletype_spimedictionarylist:"IME Dictionaries",sysfiletype_spperformancepointcontent:"Performance Point Content",sysfiletype_spperformancepointcontentlist:"Performance Point Contents",sysfiletype_spphonecallmemo:"Phone Call Memo",sysfiletype_spphonecallmemolist:"Phone Call Memos",sysfiletype_sprecordlibrarylist:"Record Library",sysfiletype_spresource:"Resource",sysfiletype_spresourcelist:"Resources",sysfiletype_spprocessdiagramslibrarylist:"Process Diagram Library",sysfiletype_spsitethemeslibrarylist:"Site Theme Library",sysfiletype_spsolutionslibrarylist:"Solution Library",sysfiletype_spwfpublibrarylist:"WFPUB Library",sysfiletype_spwhereabout:"Whereabout",sysfiletype_spwhereaboutlist:"Whereabouts",sysfiletype_spdocumentlink:"Link to a Document",sysfiletype_spdocumentset:"Document Set",sysfiletype_spmicrofeedpost:"Microfeed Post",sysfiletype_spmicrofeedlist:"Microfeed",sysfiletype_splistfolder:"List Folder"},t=String.locales||(String.locales={});t.en=e,String.toLocaleString.call(this,{en:e}),String.locale="en",String.defaultLocale="en"}(),function(e){var t;t="undefined"!=typeof e.require&&"undefined"!=typeof e.exports&&"undefined"!=typeof e.module?e.require("globalize"):e.Globalize,t.addCultureInfo("en-US","default",{name:"en-US",englishName:"English (United States)"})}(this);var Coveo;!function(e){var t=/<pl>(((?!<\/pl>).)*)<\/pl>/g,i=/<sn>(((?!<\/sn>).)*)<\/sn>/g;e.L10N={format:function(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];var o=t.toLocaleString();if(i.length>0){var s=e._.last(i);e._.isNumber(s)&&(i.pop(),o=e.L10N.formatPlSn(o,s));for(var r in i)o=o.replace("{"+r+"}",i[r])}return o},formatPlSn:function(e,n){return e=n>1?e.replace(t,"$1").replace(i,""):e.replace(t,"").replace(i,"$1")}}}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(e){this.owner=e}return e.prototype.trace=function(){for(var t=[],i=0;i<arguments.length;i++)t[i-0]=arguments[i];e.level<=e.TRACE&&this.log("TRACE",t)},e.prototype.debug=function(){for(var t=[],i=0;i<arguments.length;i++)t[i-0]=arguments[i];e.level<=e.DEBUG&&this.log("DEBUG",t)},e.prototype.info=function(){for(var t=[],i=0;i<arguments.length;i++)t[i-0]=arguments[i];e.level<=e.INFO&&this.log("INFO",t)},e.prototype.warn=function(){for(var t=[],i=0;i<arguments.length;i++)t[i-0]=arguments[i];e.level<=e.WARN&&this.log("WARN",t)},e.prototype.error=function(){for(var t=[],i=0;i<arguments.length;i++)t[i-0]=arguments[i];e.level<=e.ERROR&&this.log("ERROR",t)},e.prototype.log=function(t,i){window.console&&console.log&&(console.log([t,this.owner].concat(i)),e.executionTime&&(console.timeEnd("Execution time"),console.time("Execution time")))},e.enable=function(){e.level=e.TRACE},e.disable=function(){e.level=e.NOTHING},e.TRACE=1,e.DEBUG=2,e.INFO=3,e.WARN=4,e.ERROR=5,e.NOTHING=6,e.level=e.INFO,e.executionTime=!1,e}();e.Logger=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.fail=function(e){t.failureHandler(e)},t.check=function(e,i){e||t.fail(i)},t.isUndefined=function(i){t.check(e.Utils.isUndefined(i),"Value should be undefined.")},t.isNotUndefined=function(i){t.check(!e.Utils.isUndefined(i),"Value should not be undefined.")},t.isNull=function(i){t.check(e.Utils.isNull(i),"Value should be null.")},t.isNotNull=function(i){t.check(!e.Utils.isNull(i),"Value should not be null.")},t.exists=function(i){t.check(!e.Utils.isNullOrUndefined(i),"Value should not be null or undefined")},t.doesNotExists=function(i){t.check(e.Utils.isNullOrUndefined(i),"Value should be null or undefined")},t.isString=function(i){t.check(e._.isString(i),"Value should be a string.")},t.stringStartsWith=function(e,i){t.isNonEmptyString(e),t.isNonEmptyString(i),t.check(0==e.indexOf(i),"Value should start with "+i)},t.isNonEmptyString=function(i){t.check(e.Utils.isNonEmptyString(i),"Value should be a non-empty string.")},t.isNumber=function(i){t.check(e._.isNumber(i),"Value should be a number.")},t.isLargerThan=function(e,i){t.check(i>e,"Value "+i+" should be larger than "+e)},t.isLargerOrEqualsThan=function(e,i){t.check(i>=e,"Value "+i+" should be larger or equal than "+e)},t.isSmallerThan=function(e,i){t.check(e>i,"Value "+i+" should be smaller than "+e)},t.isSmallerOrEqualsThan=function(e,i){t.check(e>=i,"Value "+i+" should be smaller or equal than "+e)},t.logger=new e.Logger("Assert"),t.failureHandler=function(n){throw t.logger.error("Assertion Failed!",n),void 0!=console.trace&&console.trace(),e.Utils.isNonEmptyString(n)?new i(n):new i("Assertion Failed!")},t}();e.Assert=t;var i=function(){function e(e){this.message=e}return e.prototype.toString=function(){return this.message},e}();e.PreconditionFailedException=i}(Coveo||(Coveo={}));var Coveo;!function(e){e.$=jQuery}(Coveo||(Coveo={}));var Coveo;!function(e){e._=window._}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.defer=function(e){t.functions.push(e),t.arm()},t.flush=function(){for(;t.popOne(););},t.arm=function(){e._.defer(function(){t.popOne()&&t.arm()})},t.popOne=function(){if(t.functions.length>0){var i=t.functions[0];return t.functions=e._.rest(t.functions),i(),t.functions.length>0}return!1},t.functions=[],t}();e.Defer=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(e){this.onEmpty=e,this.cache=[]}return e.prototype.get=function(){return 0==this.cache.length?this.onEmpty():this.cache.pop()},e.prototype.push=function(e){this.cache.push(e)},e}();e.Cache=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(t,i,n,o){void 0===n&&(n=10),void 0===o&&(o=500),this.element=t,this.handler=i,this.distanceThreshold=n,this.timeThreshold=o,t.hasClass(e.Ui.Component.computeCssClassNameForType(e.Ui.SearchInterface.ID))?t.click(i):(this.setTouchHandlers(),this.preventMouseHandlers())}return t.prototype.setTouchHandlers=function(){var e=this;this.element.on("touchstart",function(t){return e.handleTouchStart(t)}),this.element.on("touchmove",function(t){return e.handleTouchMove(t)})},t.prototype.preventMouseHandlers=function(){this.element.on("mousedown",function(e){return e.preventDefault()}),this.element.on("mouseup",function(e){return e.preventDefault()}),this.element.on("click",function(e){return e.preventDefault()})},t.prototype.handleTouchStart=function(e){var t=this;this.reset(),this.initStartVariables(e),this.startTarget=e.target,this.startElement=this.getStartElement(),this.element.one("touchend",function(e){return t.handleTouchEnd(e)})},t.prototype.handleTouchMove=function(e){this.endX=e.originalEvent?e.originalEvent.touches[0].clientX:0,this.endY=e.originalEvent?e.originalEvent.touches[0].clientY:0,this.moved=!0},t.prototype.handleTouchEnd=function(t){this.preventGhostClickIfAndroid(t),this.mustCallHandler(t)&&(this.hideIOSKeyboardIfNecessary(t.target),this.isGhostClick(t)||e.MobileUtils.showClickFeedback(this.element,400),e.MobileUtils.showClickCancelingOverlay(400),t.clientX=this.startX,t.clientY=this.startY,this.handler.call(this,t))},t.prototype.isGhostClick=function(e){return e.originalEvent?!1:!0},t.prototype.initStartVariables=function(e){this.startTime=(new Date).getTime(),this.startX=e.originalEvent?e.originalEvent.touches[0].clientX:0,this.startY=e.originalEvent?e.originalEvent.touches[0].clientY:0,this.endX=this.startX,this.endY=this.startY},t.prototype.getStartElement=function(){return document.elementFromPoint(this.startX,this.startY)},t.prototype.mustCallHandler=function(e){return!this.scrolled(e)&&!this.held()},t.prototype.scrolled=function(e){var t=e.target,i=Math.abs(this.endX-this.startX),n=Math.abs(this.endY-this.startY),o=document.elementFromPoint(this.endX,this.endY);return!(this.startElement==o&&this.startTarget==t&&(!this.moved||i<this.distanceThreshold&&n<this.distanceThreshold))},t.prototype.held=function(){this.endTime=(new Date).getTime();var e=this.endTime-this.startTime;return e>=this.timeThreshold},t.prototype.reset=function(){this.startX=0,this.startY=0,this.endX=0,this.endY=0,this.startTime=0,this.endTime=0,this.moved=!1},t.prototype.hideIOSKeyboardIfNecessary=function(t){e.DeviceUtils.isIos()&&!e.$(t).is("input[type=text]")&&e.$(document.activeElement).is("input[type=text]")&&e.MobileUtils.hideIOSKeyboard(document.activeElement)},t.prototype.preventGhostClickIfAndroid=function(t){e.DeviceUtils.isAndroid()&&t.preventDefault()},t}();e.FastClick=t,e.$.fn.fastClick=function(i){if(i){if(e.DeviceUtils.isMobileDevice()){var n=e.$(this);return new t(n,i),n}return this.filter("a").data("href",this.filter("a").attr("href")).attr("href","javascript:"),this.click(i)}return e.DeviceUtils.isMobileDevice()?(this.trigger("touchstart"),this.trigger("touchend")):this.click()}}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){function i(e){return"undefined"==typeof e}function n(e){return null===e}function o(e){return t.isUndefined(e)||t.isNull(e)}function s(e){return!t.isNullOrUndefined(e)}function r(t){return e._.isString(t)?t:""}function a(e){return e?e.toString():""}function l(e){return t.isNullOrUndefined(e)||!t.isNonEmptyString(e)}function u(t){return e._.isString(t)&&""!==t}function c(e,t){return e.slice(0,t.length)==t}function p(t){return e._.isArray(t)&&t.length>0}function d(e){return!t.isNonEmptyArray(e)}function h(e){return void 0!=window.HTMLElement?e instanceof HTMLElement:e&&e.nodeType&&1==e.nodeType}function f(e){return t.isNonEmptyString(e)?parseInt(e,10):void 0}function v(e){return t.isNonEmptyString(e)?parseFloat(e):void 0}function m(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)}function g(e){if(!t.isNonEmptyString(e))return void 0;switch(e.toLowerCase()){case"true":case"1":case"yes":return!0;case"false":case"0":case"no":return!1;default:return void 0}}function y(e){return null==e?null:e.replace(/^\s+|\s+$/g,"")}function C(t,i,n){if(void 0===n&&(n=!0),n)return e._.isEqual(t,i);var o=[t,i];return e._.all(o,function(t){return t.length==o[0].length&&0==e._.difference(t,o[0]).length})}function b(t,i){return e._.isEqual(t,i)}function S(e){return/^@[a-zA-Z0-9]+$/.test(e)}function x(t){var i=t.match(/^@([a-zA-Z0-9]+)$/);return e.Assert.check(null!=i,t+" is not a vaild field"),i[1].toLowerCase()}function E(e){var t=e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");return t}function A(e,t,i,n,o){void 0===i&&(i={});var s,r=null,a=0,l=function(){a=i.leading===!1?0:(new Date).getTime(),r=null,s=e.apply(n,o)};return function(){var u=(new Date).getTime();a||i.leading!==!1||(a=u);var c=t-(u-a);return n=this,o=arguments,0>=c?(clearTimeout(r),r=null,a=u,s=e.apply(n,o)):r||i.trailing===!1||(r=setTimeout(l,c)),s}}function O(t,i){var n=this,o=e._.isArray(i),s=o&&[]||{};return o?(t=t||[],s=s.concat(t),e._.each(i,function(e,i){"undefined"==typeof t[i]?s[i]=e:"object"==typeof e?s[i]=n.extendDeep(t[i],e):-1===t.indexOf(e)&&s.push(e)})):(t&&"object"==typeof t&&e._.each(e._.keys(t),function(e){s[e]=t[e]}),e._.each(e._.keys(i),function(e){s[e]="object"==typeof i[e]&&i[e]?t[e]?n.extendDeep(t[e],i[e]):i[e]:i[e]})),s}function T(e,t){return void 0===t&&(t=window.location.search),t.replace(new RegExp("^(?:.*[&\\?]"+e.replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1")}t.isUndefined=i,t.isNull=n,t.isNullOrUndefined=o,t.exists=s,t.toNotNullString=r,t.anyTypeToString=a,t.isNullOrEmptyString=l,t.isNonEmptyString=u,t.stringStartsWith=c,t.isNonEmptyArray=p,t.isEmptyArray=d,t.isHtmlElement=h,t.parseIntIfNotUndefined=f,t.parseFloatIfNotUndefined=v,t.round=m,t.parseBooleanIfNotUndefined=g,t.trim=y,t.arrayEqual=C,t.objectEqual=b,t.isCoveoField=S,t.getCoveoFieldKey=x,t.escapeRegexCharacter=E,t.throttle=A,t.extendDeep=O,t.getQueryStringValue=T}(t=e.Utils||(e.Utils={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(e){this.milliseconds=e}return t.prototype.getMilliseconds=function(){return this.milliseconds},t.prototype.getSeconds=function(){return this.getMilliseconds()/1e3},t.prototype.getMinutes=function(){return this.getSeconds()/60},t.prototype.getHours=function(){return this.getMinutes()/60},t.prototype.getDays=function(){return this.getHours()/24},t.prototype.getWeeks=function(){return this.getDays()/7},t.fromDates=function(i,n){return e.Assert.exists(i),e.Assert.exists(n),new t(n.valueOf()-i.valueOf())},t}();e.TimeSpan=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){function t(){var e=navigator.userAgent;return e.match(/Android/i)?"Android":e.match(/BlackBerry/i)?"BlackBerry":e.match(/iPhone/i)?"iPhone":e.match(/iPad/i)?"iPad":e.match(/iPod/i)?"iPod":e.match(/Opera Mini/i)?"Opera Mini":e.match(/IEMobile/i)?"IE Mobile":e.match(/Chrome/i)?"Chrome":e.match(/MSIE/i)||e.match(/Trident/i)?"IE":e.match(/Opera/i)?"Opera":e.match(/Firefox/i)?"Firefox":e.match(/Safari/i)?"Safari":"Others"}function i(){return"Android"==t()}function n(){var e=t();return"iPhone"==e||"iPad"==e||"iPod"==e}function o(){var e=navigator.userAgent.toLowerCase();return-1==e.indexOf("msie")?!1:parseInt(e.split("msie")[1])<10}function s(){return u}function r(){return c}function a(){return screen.width<=480}function l(){return screen.height<=640}var u=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),c=/^file:\/\/\/.*_asset/i.test(document.URL)||/^file:\/\/\/.*var\/mobile/i.test(document.URL)||/^file:\/\/\/.*\/CoreSimulator/.test(document.URL);e.getDeviceName=t,e.isAndroid=i,e.isIos=n,e.isIE8or9=o,e.isMobileDevice=s,e.isPhonegap=r,e.isSmallScreenWidth=a,e.isSmallScreenHeight=l}(t=e.DeviceUtils||(e.DeviceUtils={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.createGuid=function(){return"undefined"!=typeof crypto&&"undefined"!=typeof crypto.getRandomValues?t.generateWithCrypto():t.generateWithRandom()},t.generateWithRandom=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,i="x"==e?t:3&t|8;return i.toString(16)})},t.generateWithCrypto=function(){var e=new Uint16Array(8);crypto.getRandomValues(e);var t=function(e){for(var t=e.toString(16);t.length<4;)t="0"+t;return t};return t(e[0])+t(e[1])+"-"+t(e[2])+"-"+t(e[3])+"-"+t(e[4])+"-"+t(e[5])+t(e[6])+t(e[7])},t.setStateObjectOnQueryResults=function(e,i){t.setPropertyOnResult(i,"state",e)},t.setIndexAndUidOnQueryResults=function(i,n,o){e.Assert.exists(i),e.Assert.exists(n);var s=i.firstResult;t.setPropertyOnResult(n,"queryUid",o),t.setPropertyOnResult(n,"index",s,function(){return++s})},t.setTermsToHighlightOnQueryResults=function(e,i){t.setPropertyOnResult(i,"termsToHighlight",i.termsToHighlight),t.setPropertyOnResult(i,"phrasesToHighlight",i.phrasesToHighlight)},t.splitFlags=function(t,i){return void 0===i&&(i=";"),e.Assert.exists(t),t.split(i)},t.isAttachment=function(i){return e._.contains(t.splitFlags(i.flags),"IsAttachment")},t.containsAttachment=function(i){return e._.contains(t.splitFlags(i.flags),"ContainsAttachment")},t.hasHTMLVersion=function(i){return e._.contains(t.splitFlags(i.flags),"HasHtmlVersion")},t.hasThumbnail=function(i){return e._.contains(t.splitFlags(i.flags),"HasThumbnail")},t.quoteAndEscapeIfNeeded=function(i){return e.Assert.isString(i),t.isAtomicString(i)||t.isRangeString(i)||t.isRangeWithoutOuterBoundsString(i)?i:t.quoteAndEscape(i)},t.quoteAndEscape=function(i){return e.Assert.isString(i),'"'+t.escapeString(i)+'"'},t.escapeString=function(t){return e.Assert.isString(t),t.replace(/"/g," ")},t.isAtomicString=function(t){return e.Assert.isString(t),/^\d+(\.\d+)?$|^[\d\w]+$/.test(t)},t.isRangeString=function(t){return e.Assert.isString(t),/^\d+(\.\d+)?\.\.\d+(\.\d+)?$|^\d{4}\/\d{2}\/\d{2}@\d{2}:\d{2}:\d{2}\.\.\d{4}\/\d{2}\/\d{2}@\d{2}:\d{2}:\d{2}$/.test(t)},t.isRangeWithoutOuterBoundsString=function(t){return e.Assert.isString(t),/^\d+(\.\d+)?$|^\d{4}\/\d{2}\/\d{2}@\d{2}:\d{2}:\d{2}$/.test(t)},t.buildFieldExpression=function(i,n,o){return e.Assert.isNonEmptyString(i),e.Assert.stringStartsWith(i,"@"),e.Assert.isNonEmptyString(n),e.Assert.isLargerOrEqualsThan(1,o.length),1==o.length?i+n+t.quoteAndEscapeIfNeeded(o[0]):i+n+"("+e._.map(o,function(e){return t.quoteAndEscapeIfNeeded(e)}).join(",")+")"},t.buildFieldNotEqualExpression=function(i,n){e.Assert.isNonEmptyString(i),e.Assert.stringStartsWith(i,"@"),e.Assert.isLargerOrEqualsThan(1,n.length);var o;return o=1==n.length?i+"=="+t.quoteAndEscapeIfNeeded(n[0]):i+"==("+e._.map(n,function(e){return t.quoteAndEscapeIfNeeded(e)}).join(",")+")","(NOT "+o+")"},t.mergeQueryString=function(e,t){var i=e.indexOf("?");return e+=-1!=i?"&"+t:"?"+t},t.mergePath=function(e,t){var i=e.split("?");return i[0]+t+"?"+(i[1]||"")},t.setPropertyOnResult=function(t,i,n,o){e._.each(t.results,function(t){t[i]=n,e._.each(t.childResults,function(e){e[i]=n}),e.Utils.isNullOrUndefined(t.parentResult)||(t.parentResult[i]=n),n=o?o():n})},t}();e.QueryUtils=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.javascriptEncode=function(t){return e.Assert.isString(t),t=t.replace(/\\/g,"\\\\"),t=t.replace(/'/g,"\\'"),t=t.replace(/"/g,'\\"')},t.htmlEncode=function(t){return e.Assert.isString(t),e.$("<div/>").text(t).html()},t.splice=function(e,t,i,n){return e.slice(0,t)+n+e.slice(t+Math.abs(i))},t.removeMiddle=function(e,i,n){if(e.length<i)return e;var o=e.length-i,s=Math.floor(i/2);return t.splice(e,s,o,n)},t.regexEncode=function(t){return e.Assert.isString(t),t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},t.wildcardsToRegex=function(i){e.Assert.isString(i);var n=t.regexEncode(i);return n=n.replace(/\\\*/,".*"),n=n.replace(/\\\?/,".")},t.getHighlights=function(t,i,n){for(var o,s=[];o=i.exec(t);){var r=o[2],a=o[1],l=o.index+1;if(0==o.index&&""==a&&(l=0),s.push({offset:l,length:r.length,dataHighlightGroupTerm:n}),!i.global)break}return e._.isEmpty(s)?void 0:s},t}();e.StringUtils=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){function i(e,t,a,c,p,d){void 0===d&&(d=0),e.appendTo(a),p.verticalOffset=p.verticalOffset?p.verticalOffset:0,p.horizontalOffset=p.horizontalOffset?p.horizontalOffset:0;var h=t.offset();o(h,e,t,p),s(h,e,t,p),n(e.offset(),h,e,p);var f=l(e),v=l(c);if(2>d){var m=u(f,v);if("ok"!=m.vertical||"ok"!=m.horizontal){var g=r(p,m);i(e,t,a,c,g,d+1)}}}function n(e,t,i,n){var o=i.position();i.css({position:"absolute",top:o.top+n.verticalOffset-(e.top-t.top)+"px",left:o.left+n.horizontalOffset-(e.left-t.left)+"px"})}function o(e,t,i,n){switch(n.vertical){case 0:e.top-=t.outerHeight();break;case 2:e.top+=i.outerHeight();break;case 1:e.top-=t.outerHeight()/3;case 3:break;case 4:e.top-=t.outerHeight()-i.outerHeight()}}function s(e,t,i,n){switch(n.horizontal){case 0:e.left-=t.outerWidth();break;case 2:e.left+=i.outerWidth();break;case 1:e.left+=a(t,i);break;case 3:break;case 4:e.left-=t.outerWidth()-i.outerWidth()}}function r(e,t){var i=e;return"left"==t.horizontal&&(i.horizontal=2),"right"==t.horizontal&&(i.horizontal=0),"top"==t.vertical&&(i.vertical=2),"bottom"==t.vertical&&(i.vertical=0),i}function a(e,t){return(t.outerWidth()-e.outerWidth())/2
}function l(e){var t=e.offset();return{top:t.top,left:t.left,right:t.left+e.outerWidth(),bottom:t.top+e.outerHeight()}}function u(e,t){var i={vertical:"ok",horizontal:"ok"};return e.top<t.top&&(i.vertical="top"),e.bottom>t.bottom&&(i.vertical="bottom"),e.left<t.left&&(i.horizontal="left"),e.right>t.right&&(i.horizontal="right"),i}function c(e,t){return"<span class='coveo-close-button'><span class='coveo-icon coveo-sprites-quickView-close'></span>"+e+"</span><span class='coveo-pop-up-reminder' >"+t+"</span>"}function p(){var t="coveo-loading-dot";return e.$("<div class='coveo-first-loading-animation' ><div class='coveo-logo' ></div><div class='coveo-loading-container'><div class='"+t+"' ></div><div class='"+t+"' ></div><div class='"+t+"' ></div><div class='"+t+"' ></div></div></div>")}function d(){var t="coveo-loading-dot";return e.$("<div class='coveo-generic-loading-animation coveo-loading-animation'><div class='coveo-loading-container'><div class='"+t+"' ></div><div class='"+t+"' ></div><div class='"+t+"' ></div><div class='"+t+"' ></div></div></div>")}function h(t,i){var n=new RegExp(e.Utils.escapeRegexCharacter(i),"i"),o=t.search(n),s=o+i.length;return e.StringUtils.htmlEncode(t.slice(0,o))+"<span class='coveo-highlight'>"+e.StringUtils.htmlEncode(t.slice(o,s))+"</span>"+e.StringUtils.htmlEncode(t.slice(s))}function f(t){for(var i=e.$(t);!i.is(document)&&0!=i.length;){if(v(i))return i.is("body")?e.$(window).get(0):i.get(0);i=i.parent()}return e.$(window).get(0)}function v(e){return"scroll"==e.css("overflow-y")}function m(t){var i=e.$("<div>").html(t);return 1==i.children().length?i.children().get(0):i.get(0)}!function(e){e[e.top=0]="top",e[e.middle=1]="middle",e[e.bottom=2]="bottom",e[e.innerTop=3]="innerTop",e[e.innerBottom=4]="innerBottom"}(t.VerticalAlignment||(t.VerticalAlignment={}));t.VerticalAlignment;!function(e){e[e.left=0]="left",e[e.center=1]="center",e[e.right=2]="right",e[e.innerLeft=3]="innerLeft",e[e.innerRight=4]="innerRight"}(t.HorizontalAlignment||(t.HorizontalAlignment={}));t.HorizontalAlignment;t.positionPopup=i,t.getPopUpCloseButton=c,t.getBasicLoadingAnimation=p,t.getBasicLoadingDots=d,t.highlightElement=h,t.findScrollingParent=f,t.htmlToDom=m,e.$.fn.fastToggle=function(e){return this.css("display",e?"":"none")}}(t=e.JQueryUtils||(e.JQueryUtils={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.getHash=function(i){void 0===i&&(i=window),e.Assert.exists(i);var n="#"+(i.location.href.split("#")[1]||"");return t.getAjaxcrawlableHash(n)},t.getValue=function(i,n){e.Assert.isNonEmptyString(i),e.Assert.exists(n),n=t.getAjaxcrawlableHash(n);var o=t.getRawValue(i,n);return void 0!=o&&(o=t.getValueDependingOnType(o)),o},t.encodeValues=function(i){var n=[];return e._.each(i,function(i,o){var s="";s=e.Utils.isNonEmptyArray(i)?t.encodeArray(i):e._.isObject(i)&&e.Utils.isNonEmptyArray(e._.keys(i))?t.encodeObject(i):encodeURIComponent(i.toString()),""!=s&&n.push(o+"="+s)}),n.join("&")},t.getAjaxcrawlableHash=function(e){return void 0!=e[1]&&"!"==e[1]?e.substring(0,1)+e.substring(2):e},t.getRawValue=function(t,i){e.Assert.exists(t),e.Assert.exists(i),e.Assert.check(0==i.indexOf("#")||""==i);for(var n=i.substr(1).split("&"),o=0,s=!0,r=void 0;s;){var a=n[o].split("=");a[0]==t?(s=!1,r=a[1]):(o++,o>=n.length&&(o=void 0,s=!1))}return r},t.getValueDependingOnType=function(e){var i,n=t.getValueType(e);return i="object"==n?t.decodeObject(e):"array"==n?t.decodeArray(e):decodeURIComponent(e)},t.getValueType=function(e){return e.substr(0,1)==t.Delimiter.objectStart&&e.substr(e.length-1)==t.Delimiter.objectEnd?"object":e.substr(0,1)==t.Delimiter.arrayStart&&e.substr(e.length-1)==t.Delimiter.arrayEnd?"array":"other"},t.encodeArray=function(i){var n=[];return e._.each(i,function(e){n.push(encodeURIComponent(e))}),t.Delimiter.arrayStart+n.join(",")+t.Delimiter.arrayEnd},t.encodeObject=function(i){var n=t.Delimiter.objectStart,o=[];return e._.each(i,function(i,n){var s="";s+='"'+encodeURIComponent(n)+'" : ',s+=e._.isArray(i)?t.encodeArray(i):e._.isObject(i)?t.encodeObject(i):e._.isNumber(i)||e._.isBoolean(i)?encodeURIComponent(i):'"'+encodeURIComponent(i)+'"',o.push(s)}),n+=o.join(" , "),n+t.Delimiter.objectEnd},t.decodeObject=function(e){return JSON.parse(decodeURIComponent(e))},t.decodeArray=function(t){t=t.substr(1),t=t.substr(0,t.length-1);for(var i=t.split(","),n=0;n<i.length;n++){var o=decodeURIComponent(i[n]),s="0"==o[0]&&o.length>1?0/0:Number(o),r=e.Utils.parseBooleanIfNotUndefined(o);i[n]=o,isNaN(s)?void 0!=r&&(i[n]=r):i[n]=s}return i},t.Delimiter={objectStart:"{",objectEnd:"}",arrayStart:"[",arrayEnd:"]",objectStartRegExp:"^{",objectEndRegExp:"}+$",arrayStartRegExp:"^[",arrayEndRegExp:"]+$"},t}();e.HashUtils=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){function i(e){c.addClass("active"),setTimeout(function(){c.removeClass("active")},e)}function n(e,t){e.addClass("coveo-clicked"),setTimeout(function(){e.removeClass("coveo-clicked")},t)}function o(i,n){void 0===n&&(n=!1);var o="."+e.Ui.Component.computeCssClassNameForType(e.Ui.SearchInterface.ID);e.$(o+",.coveo-glass").addClass("coveo-"+i),e.$(".coveo-glass").addClass("coveo-active-glass"),n&&"Android"==e.DeviceUtils.getDeviceName()&&e.$(document).on("backbutton",e.$.proxy(t.removeToggleClassOnSearchInterface,this,!0))}function s(t){void 0===t&&(t=!1);var i="."+e.Ui.Component.computeCssClassNameForType(e.Ui.SearchInterface.ID);e.$(i+",.coveo-glass").removeClass("coveo-slide-right").removeClass("coveo-slide-left").removeClass("coveo-active-glass"),e.$(".coveo-tab-section").removeClass("coveo-opened-by-current-tab");var n=e.Ui.CurrentTab?e.Ui.CurrentTab.ID:void 0;n&&e.$("."+n).removeClass("coveo-opening-tab-section"),t&&"Android"==e.DeviceUtils.getDeviceName()&&e.$(document).off("backbutton")}function r(){e.$("."+e.Ui.Component.computeCssClassNameForType(e.Ui.SearchInterface.ID)).append(c)}function a(t){e.$(window).focus(),e.$(t).blur()}function l(){e.DeviceUtils.isIos()&&e.$(window).on("touchstart",function(i){!e.$(i.target).is("input")&&e.$(document.activeElement).is("input")&&t.hideIOSKeyboard(document.activeElement)})}function u(){e.DeviceUtils.isMobileDevice()&&(e.$(function(){return r()}),l())}var c=e.$(document.createElement("div")).addClass("coveo-click-canceling-overlay");t.showClickCancelingOverlay=i,t.showClickFeedback=n,t.addToggleClassOnSearchInterface=o,t.removeToggleClassOnSearchInterface=s,t.hideIOSKeyboard=a,u()}(t=e.MobileUtils||(e.MobileUtils={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function t(t,i){this.message=t,this.status=i,e.Assert.exists(t),e.Assert.exists(i),this.type="Ajax Error (status: "+i+")"}return t}();t.AjaxError=i}(t=e.Rest||(e.Rest={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){var t=function(){function e(e){this.provider=e,this.isMissingAuthentication=!0,this.type=this.message="Missing Authentication (provider: "+e+")"}return e}();e.MissingAuthenticationError=t}(t=e.Rest||(e.Rest={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function t(t){this.status=t.statusCode,this.message=t.data.message,this.type=t.data.type,this.queryExecutionReport=t.data.executionReport,e.Assert.isNumber(this.status),e.Assert.isNonEmptyString(this.message),e.Assert.isNonEmptyString(this.type)}return t}();t.QueryError=i}(t=e.Rest||(e.Rest={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i;!function(e){e[e.OPENED=XMLHttpRequest.OPENED||1]="OPENED",e[e.DONE=XMLHttpRequest.DONE||4]="DONE"}(i||(i={}));var n=function(){function t(t){void 0===t&&(t={}),this.options=t,this.useJsonp=!1,this.logger=new e.Logger(this)}return t.prototype.call=function(i){e.Assert.isNonEmptyString(i.url);var n={url:i.url,queryString:i.errorsAsSuccess?i.queryString.concat(["errorsAsSuccess=1"]):i.queryString,requestData:i.requestData,deferred:e.$.Deferred(),begun:new Date,method:i.method};this.logger.trace("Performing REST request",n);var o=t.parseURL(n.url),s=window.location.hostname===o.hostname||""===o.hostname,r=""!=window.location.port?window.location.port:"https:"==window.location.protocol?"443":"80",a=r==o.port,l=!(s&&a);return this.useJsonp?this.callUsingAjaxJsonP(n):this.isCORSSupported()||!l?this.callUsingXMLHttpRequest(n,i.responseType):this.isXDomainRequestSupported()?this.callUsingXDomainRequest(n):this.callUsingAjaxJsonP(n),n.deferred},t.parseURL=function(e){var t=document.createElement("a");return t.href=e,t},t.convertJsonToQueryString=function(t){e.Assert.exists(t);var i=[];return e._.each(t,function(t,n){null!=t&&(e._.isObject(t)?i.push(n+"="+encodeURIComponent(JSON.stringify(t))):i.push(n+"="+encodeURIComponent(t.toString())))}),i},t.convertJsonToFormBody=function(e){return t.convertJsonToQueryString(e).join("&")},t.prototype.callUsingXMLHttpRequest=function(n,o){var s=this;void 0===o&&(o="text");var r=new XMLHttpRequest,a=!1;r.onreadystatechange=function(){if(r.readyState!=i.OPENED||a){if(r.readyState==i.DONE){var l,u=r.status;"text"==o?l=s.tryParseResponseText(r.responseText,r.getResponseHeader("Content-Type")):(l=r.response,void 0==l&&(l=s.tryParseResponseText(r.responseText,r.getResponseHeader("Content-Type")))),s.isSuccessHttpStatus(u)?s.handleSuccessfulResponseThatMightBeAnError(n,l):s.handleError(n,r.status,void 0)}}else a=!0,s.options.anonymous===!1&&(r.withCredentials=!0),s.options.accessToken?r.setRequestHeader("Authorization","Bearer "+s.options.accessToken):s.options.username&&s.options.password&&r.setRequestHeader("Authorization","Basic "+btoa(s.options.username+":"+s.options.password)),e.DeviceUtils.isPhonegap()&&r.setRequestHeader("Basic-Auth-Challenge-Client","Phonegap"),"GET"==n.method?r.send():(r.setRequestHeader("Content-Type",'application/x-www-form-urlencoded; charset="UTF-8"'),r.send(t.convertJsonToFormBody(n.requestData))),r.responseType=o};var l=n.queryString;"GET"==n.method&&(l=l.concat(t.convertJsonToQueryString(n.requestData))),r.open(n.method,this.combineUrlAndQueryString(n.url,l))},t.prototype.callUsingXDomainRequest=function(i){var n=this,o=i.queryString.concat([]);this.options.accessToken&&o.push("access_token="+encodeURIComponent(this.options.accessToken));var s=new XDomainRequest;"GET"==i.method&&(o=o.concat(t.convertJsonToQueryString(i.requestData))),s.open(i.method,this.combineUrlAndQueryString(i.url,o)),s.onload=function(){var e=n.tryParseResponseText(s.responseText,s.contentType);n.handleSuccessfulResponseThatMightBeAnError(i,e)},s.onerror=function(){var e=n.tryParseResponseText(s.responseText,s.contentType);n.handleError(i,0,e)},s.ontimeout=function(){return n.logger.error("Request timeout",s,i.requestData)},s.onprogress=function(){return n.logger.trace("Request progress",s,i.requestData)},e._.defer(function(){"GET"==i.method?s.send():s.send(t.convertJsonToFormBody(i.requestData))})},t.prototype.callUsingAjaxJsonP=function(i){var n=this,o=i.queryString.concat(t.convertJsonToQueryString(i.requestData));this.options.accessToken&&o.push("access_token="+encodeURIComponent(this.options.accessToken)),o.push("callback=?"),e.$.jsonp({url:this.combineUrlAndQueryString(i.url,o),success:function(e){return n.handleSuccessfulResponseThatMightBeAnError(i,e)},error:function(){return n.handleError(i,0,void 0)}})},t.prototype.handleSuccessfulResponseThatMightBeAnError=function(e,t){this.isErrorResponseBody(t)?this.handleError(e,t.statusCode,t):this.handleSuccess(e,t)},t.prototype.handleSuccess=function(t,i){var n={duration:e.TimeSpan.fromDates(t.begun,new Date).getMilliseconds(),data:i};this.logger.trace("REST request successful",i,t),t.deferred.resolve(n)},t.prototype.handleError=function(e,t,i){var n={statusCode:t,data:i};this.logger.error("REST request failed",t,i,e),e.deferred.reject(n)},t.prototype.combineUrlAndQueryString=function(e,t){return e+(t.length>0?"?"+t.join("&"):"")},t.prototype.isXDomainRequestSupported=function(){return"XDomainRequest"in window},t.prototype.isCORSSupported=function(){return"withCredentials"in new XMLHttpRequest},t.prototype.isSuccessHttpStatus=function(e){return e>=200&&300>e||304===e},t.prototype.tryParseResponseText=function(t,i){if(null==i||-1==i.indexOf("application/json"))return t;if(!e.Utils.isNonEmptyString(t))return void 0;try{return JSON.parse(t)}catch(n){return void 0}},t.prototype.isErrorResponseBody=function(e){return e&&e.statusCode?!this.isSuccessHttpStatus(e.statusCode):!1},t}();t.EndpointCaller=n}(t=e.Rest||(e.Rest={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function e(){this.queryStringArguments={},this.anonymous=!1,this.isOldRestAPI=!1}return e}();t.DefaultSearchEndpointOptions=i;var n=function(){function n(t){this.options=t,this._batchListFieldValues=[],e.Assert.exists(t);var n=new i;n.anonymous=e.Utils.isNonEmptyString(t.accessToken),this.options=e.$.extend({},n,t),e.$(window).on("beforeunload",e.$.proxy(this.handleUnload,this)),this.logger=new e.Logger(this),this.createEndpointCaller()}return n.configureSampleEndpoint=function(){n.endpoints["default"]=new n({restUri:"https://cloudplatform.coveo.com/rest/search",accessToken:"52d806a2-0f64-4390-a3f2-e0f41a4a73ec"})},n.configureCloudEndpoint=function(e,t,i,o){void 0===i&&(i="https://cloudplatform.coveo.com/rest/search");var s=n.mergeConfigOptions({restUri:i,accessToken:t,queryStringArguments:{workgroup:e}},o);n.endpoints["default"]=new n(n.removeUndefinedConfigOption(s))},n.configureOnPremiseEndpoint=function(e,t,i){var o=n.mergeConfigOptions({restUri:e,accessToken:t},i);n.endpoints["default"]=new n(n.removeUndefinedConfigOption(o))},n.removeUndefinedConfigOption=function(t){return e._.each(e._.keys(t),function(e){void 0==t[e]&&delete t[e]}),t},n.mergeConfigOptions=function(t,i){return t=n.removeUndefinedConfigOption(t),i=n.removeUndefinedConfigOption(i),e.$.extend({},t,i)},n.prototype.handleUnload=function(){this.isRedirecting=!0},n.prototype.getBaseUri=function(){return this.options.restUri},n.prototype.getAuthenticationProviderUri=function(t,i,n){var o=this.buildBaseUri("/login/"+t)+"?";return e.Utils.isNonEmptyString(i)?o+="redirectUri="+encodeURIComponent(i):e.Utils.isNonEmptyString(n)&&(o+="message="+encodeURIComponent(n)),o},n.prototype.isJsonp=function(){return this.caller.useJsonp},n.prototype.search=function(t,i){var n=this;e.Assert.exists(t),this.logger.info("Performing REST query",t),i=e._.extend({},i);var o={url:this.buildBaseUri("/"),queryString:this.buildBaseQueryString(i),requestData:t,errorsAsSuccess:!0,responseType:"text",method:"POST"},s=this.callWithErrorHandling(o);return s.done(function(i){n.logger.info("REST query successful",i,t),e.Utils.isNullOrEmptyString(i.searchUid)&&(i.searchUid=e.QueryUtils.createGuid())}),s},n.prototype.getRawDataStream=function(t,i,n){var o=this;e.Assert.exists(t),n=e._.extend({},n);var s={url:this.buildBaseUri("/datastream"),queryString:this.buildViewAsHtmlQueryString(t,n).concat(["dataStream="+i]),requestData:{},errorsAsSuccess:!1,method:"GET",responseType:"arraybuffer"},r=this.callWithErrorHandling(s);return this.logger.info("Performing REST query for datastream "+i+" on document uniqueID"+t),r.done(function(e){return o.logger.info("REST query successful",e,t)}),r},n.prototype.getDocumentText=function(t,i){i=e._.extend({},i);var n={url:this.buildBaseUri("/text"),queryString:this.buildViewAsHtmlQueryString(t,i),method:"GET",requestData:{},responseType:"text",errorsAsSuccess:!0};return this.callWithErrorHandling(n)},n.prototype.getDocumentHtml=function(t,i){i=e._.extend({},i);var n={url:this.buildBaseUri("/html"),queryString:this.buildViewAsHtmlQueryString(t,i),method:"GET",requestData:{},responseType:"document",errorsAsSuccess:!0};return this.callWithErrorHandling(n)},n.prototype.getViewAsHtmlUri=function(t,i){return i=e._.extend({},i),this.buildViewAsHtmlUri("/html",t,i)},n.prototype.getViewAsDatastreamUri=function(t,i,n){return n=e._.extend({},n),this.buildViewAsHtmlUri("/datastream",t,n)+"&dataStream="+encodeURIComponent(i)},n.prototype.batchFieldValues=function(t,i){var n=this;e.Assert.exists(t),i=e._.extend({},i),this.logger.info("Listing field values",t);var o=e.$.Deferred(),s={url:this.buildBaseUri("/values"),queryString:this.buildBaseQueryString(i),method:"POST",requestData:t,errorsAsSuccess:!0,responseType:"text"};return this.callWithErrorHandling(s).done(function(e){return o.resolve(e.values)}).fail(function(e,t){return o.reject(null,t)}),o.done(function(e){return n.logger.info("REST list field values successful",e,t)}),o},n.prototype.listFieldValues=function(t,i){var n=this;e.Assert.exists(t),i=e._.extend({},i),this.logger.info("Listing field values",t);var o=e.$.Deferred(),s={url:this.buildBaseUri("/values"),queryString:this.buildBaseQueryString(i),method:"POST",requestData:t,errorsAsSuccess:!0,responseType:"text"};return this.callWithErrorHandling(s).done(function(e){return o.resolve(e.values)}).fail(function(e,t){return o.reject(null,t)}),o.done(function(e){return n.logger.info("REST list field values successful",e,t)}),o},n.prototype.listFields=function(t){t=e._.extend({},t),this.logger.info("Listing fields");var i=e.$.Deferred(),n={url:this.buildBaseUri("/fields"),queryString:this.buildBaseQueryString(t),requestData:{},method:"GET",responseType:"text",errorsAsSuccess:!0};return this.callWithErrorHandling(n).done(function(e){return i.resolve(e.fields)}).fail(function(e,t){return i.reject(null,t)}),i},n.prototype.tagDocument=function(t,i){i=e._.extend({},i),this.logger.info("Tagging a document",t);var n=e.$.Deferred(),o={url:this.buildBaseUri("/tag"),queryString:this.buildBaseQueryString(i),method:"POST",requestData:t,errorsAsSuccess:!1,responseType:"text"};return this.callWithErrorHandling(o).done(function(){return n.resolve(!0)}).fail(function(){return n.reject(!1)}),n},n.prototype.createEndpointCaller=function(){this.caller=new t.EndpointCaller(this.options)},n.prototype.buildBaseUri=function(t){e.Assert.isString(t);var i=this.options.restUri;return i=this.removeTrailingSlash(i),i+=t,this.options.isOldRestAPI&&(i=this.addTrailingSlash(i)),i},n.prototype.buildBaseQueryString=function(t){var i=[];for(var n in this.options.queryStringArguments)i.push(n+"="+encodeURIComponent(this.options.queryStringArguments[n]));return e._.isArray(t.authentication)&&0!=t.authentication.length&&i.push("authentication="+t.authentication.join(",")),i},n.prototype.buildViewAsHtmlUri=function(t,i,n){e.Assert.isNonEmptyString(i);var o=this.buildViewAsHtmlQueryString(i,n);e.Utils.isNonEmptyString(this.options.accessToken)&&o.push("access_token="+encodeURIComponent(this.options.accessToken));var s=this.buildBaseUri(t);return s+"?"+o.join("&")},n.prototype.buildViewAsHtmlQueryString=function(e,t){var i=this.buildBaseQueryString(t);return i.push("uniqueId="+encodeURIComponent(e)),null!=t.query&&(i.push("q="+encodeURIComponent(t.query)),i.push("enableNavigation=true")),t.requestedOutputSize&&i.push("requestedOutputSize="+encodeURIComponent(t.requestedOutputSize.toString())),t.contentType&&i.push("contentType="+encodeURIComponent(t.contentType)),i},n.prototype.callWithErrorHandling=function(t){var i=e.$.Deferred();return this.performOneCall(t,i,!0),i},n.prototype.performOneCall=function(t,i,n){var o=this;this.caller.call(t).done(function(e){e.data.clientDuration=e.duration,i.resolve(e.data,t.requestData)}).fail(function(s){n&&o.canRenewAccessToken()&&o.isAccessTokenExpiredStatus(s.statusCode)?o.renewAccessToken().done(function(){return o.performOneCall(t,i,!1)}).fail(function(){return o.handleErrorResponse(s,i)}):0==s.statusCode&&o.isRedirecting?e._.defer(function(){i.resolve()}):o.handleErrorResponse(s,i)})},n.prototype.handleErrorResponse=function(e,i){this.isMissingAuthenticationProviderStatus(e.statusCode)?i.reject(null,new t.MissingAuthenticationError(e.data.provider)):e.data&&e.data.message?i.reject(null,new t.QueryError(e)):i.reject(null,new t.AjaxError("Request Error",e.statusCode))},n.prototype.canRenewAccessToken=function(){return e.Utils.isNonEmptyString(this.options.accessToken)&&e._.isFunction(this.options.renewAccessToken)},n.prototype.isAccessTokenExpiredStatus=function(e){return 419==e},n.prototype.renewAccessToken=function(){var t=this;return this.logger.info("Renewing expired access token"),this.options.renewAccessToken().done(function(i){e.Assert.isNonEmptyString(i),t.options.accessToken=i,t.createEndpointCaller()}).fail(function(e){t.logger.error("Failed to renew access token",e)})},n.prototype.isMissingAuthenticationProviderStatus=function(e){return 402==e},n.prototype.addTrailingSlash=function(e){return this.hasTrailingSlash(e)||(e+="/"),e},n.prototype.removeTrailingSlash=function(e){return this.hasTrailingSlash(e)&&(e=e.substr(0,e.length-1)),e},n.prototype.hasTrailingSlash=function(e){return"/"==e.charAt(e.length-1)},n.endpoints={},n}();t.SearchEndpoint=n}(t=e.Rest||(e.Rest={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function t(e,t){this.endpoint=e,this.callOptions=t,this.options=e.options}return t.prototype.getBaseUri=function(){return this.endpoint.getBaseUri()},t.prototype.getAuthenticationProviderUri=function(e,t,i){return this.endpoint.getAuthenticationProviderUri(e,t,i)},t.prototype.isJsonp=function(){return this.endpoint.isJsonp()},t.prototype.search=function(e,t){return this.endpoint.search(e,this.enrichCallOptions(t))},t.prototype.tagDocument=function(e){return this.endpoint.tagDocument(e,this.enrichCallOptions(e))},t.prototype.getRawDataStream=function(e,t,i){return this.endpoint.getRawDataStream(e,t,this.enrichCallOptions(i))},t.prototype.getDocumentText=function(e,t){return this.endpoint.getDocumentText(e,this.enrichCallOptions(t))},t.prototype.getDocumentHtml=function(e,t){return this.endpoint.getDocumentHtml(e,this.enrichCallOptions(t))},t.prototype.getViewAsHtmlUri=function(e,t){return this.endpoint.getViewAsHtmlUri(e,this.enrichCallOptions(t))},t.prototype.getViewAsDatastreamUri=function(e,t,i){return this.endpoint.getViewAsDatastreamUri(e,t,this.enrichCallOptions(i))},t.prototype.listFieldValues=function(e,t){return this.endpoint.listFieldValues(e,this.enrichCallOptions(t))},t.prototype.listFields=function(e){return this.endpoint.listFields(this.enrichCallOptions(e))},t.prototype.enrichCallOptions=function(t){return e._.extend({},t,this.callOptions)},t}();t.SearchEndpointWithDefaultCallOptions=i}(t=e.Rest||(e.Rest={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){e._.templateSettings={evaluate:/(?:<%|{{)([\s\S]+?)(?:%>|}})/g,interpolate:/(?:<%|{{)=([\s\S]+?)(?:%>|}})/g,escape:/(?:<%|{{)-([\s\S]+?)(?:%>|}})/g};var i=function(){function t(t){if(this.logger=new e.Logger(this),e.Utils.isHtmlElement(t)){e.Assert.exists(t);var i=e.$(t).html();this.template=e._.template(i)}else t instanceof Function&&(this.template=t)}return t.prototype.instantiateToString=function(i){var n=e._.extend({},i,t.templateHelpers);return this.template(n)},t.prototype.instantiateToElement=function(t){var i=this.instantiateToString(t),n=e.JQueryUtils.htmlToDom(i);return this.logger.trace("Instantiated result template",t,n),n},t.create=function(i){return e.Assert.exists(i),new t(i)},t.registerTemplateHelper=function(e,i){t.templateHelpers[e]=i},t.isLibraryAvailable=function(){return e.Utils.exists(window._)},t.templateHelpers={},t.mimeTypes=["text/underscore","text/underscore-template","text/x-underscore","text/x-underscore-template"],t}();t.UnderscoreTemplate=i}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function t(i){this.template=i,e.Assert.check(t.isLibraryAvailable(),"The JsRender library must be loaded within the page"),e.Assert.exists(i),this.logger=new e.Logger(this)}return t.prototype.instantiateToString=function(t){return e.$(this.template).render(t)},t.prototype.instantiateToElement=function(t){var i=e.$(this.template).render(t),n=e.JQueryUtils.htmlToDom(i);return this.logger.trace("Instantiated result template",t,n),n},t.create=function(i){return e.Assert.exists(i),new t(i)},t.isLibraryAvailable=function(){return e.Utils.exists(e.$.views)},t.mimeTypes=["text/jsrender","text/jsrender-template","text/x-jsrender","text/x-jsrender-template"],t}();t.JsRenderTemplate=i}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function t(i){e.Assert.check(t.isLibraryAvailable(),"The Handlebars library must be loaded within the page"),e.Assert.exists(i),this.logger=new e.Logger(this);var n=e.$(i).html();this.template=Handlebars.compile(n)}return t.prototype.instantiateToString=function(e){return this.template(e)},t.prototype.instantiateToElement=function(t){var i=this.template(t),n=e.JQueryUtils.htmlToDom(i);return this.logger.trace("Instantiated result template",t,n),n},t.create=function(i){return e.Assert.exists(i),new t(i)},t.isLibraryAvailable=function(){return e.Utils.exists(window.Handlebars)},t.mimeTypes=["text/handlebars","text/handlebars-template","text/x-handlebars","text/x-handlebars-template"],t}();t.HandlebarsTemplate=i}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function i(){}return i.registerTemplate=function(t,n){e.Assert.isNonEmptyString(t),e.Assert.exists(n),i.templates[t]=n},i.getTemplate=function(t){return e.Assert.exists(i.templates[t]),i.templates[t]},i.getTemplateNames=function(){return e._.keys(i.templates)},i.scanAndRegisterTemplates=function(){t.UnderscoreTemplate.isLibraryAvailable()&&i.scanAndRegisterUnderscoreTemplates(),t.JsRenderTemplate.isLibraryAvailable()&&(i.scanAndRegisterJsRenderTemplates(),i.scanAndRegisterJsonTemplates()),t.HandlebarsTemplate.isLibraryAvailable()&&i.scanAndRegisterHandlebarsTemplates()},i.scanAndRegisterUnderscoreTemplates=function(){e._.each(t.UnderscoreTemplate.mimeTypes,function(n){e.$("script[id][type='"+n+"']").each(function(n,o){var s=new t.UnderscoreTemplate(o);i.registerTemplate(e.$(o).attr("id"),function(e){return s.instantiateToString(e)})})})},i.scanAndRegisterJsRenderTemplates=function(){e._.each(t.JsRenderTemplate.mimeTypes,function(n){e.$("script[id][type='"+n+"']").each(function(n,o){var s=new t.JsRenderTemplate(o);i.registerTemplate(e.$(o).attr("id"),function(e){return s.instantiateToString(e)})})})},i.scanAndRegisterHandlebarsTemplates=function(){e._.each(t.HandlebarsTemplate.mimeTypes,function(n){e.$("script[id][type='"+n+"']").each(function(n,o){var s=new t.HandlebarsTemplate(o);i.registerTemplate(e.$(o).attr("id"),function(e){return s.instantiateToString(e)})})})},i.scanAndRegisterJsonTemplates=function(){e._.each(t.JsonTemplate.mimeTypes,function(n){e.$("script[id][type='"+n+"']").each(function(n,o){var s=new t.JsonTemplate(o);i.registerTemplate(e.$(o).attr("id"),function(e){return s.instantiateToString(e)})})})},i.templates={},i}();t.TemplateCache=i,e.$(function(){i.scanAndRegisterTemplates()})}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function i(i){var n;if(e.Utils.isHtmlElement(i)){e.Assert.exists(i);var o=e.$(i).html();n=e.Utils.isNullOrEmptyString(o)?null:JSON.parse(o)}else i instanceof Object&&(n=i);this.template=new t.JsRenderTemplate(e.$(this.renderTemplate(n).result).get(0))}return i.prototype.instantiateToString=function(e){return this.template.instantiateToString(e)},i.prototype.instantiateToElement=function(e){return this.template.instantiateToElement(e)},i.prototype.renderTemplate=function(e){if(null==e&&(e={type:"list",containers:[],leftContainers:[],rightContainers:[]}),"list"==e.type){var t='<script type="text/x-jsrender"><div class="item result">';return e.leftContainers&&e.leftContainers.length>0&&(t+='<div style="float: left;">'+this.renderContainers(e.leftContainers)+"</div>"),e.rightContainers&&e.rightContainers.length>0&&(t+='<div style="float: right;">'+this.renderContainers(e.rightContainers)+"</div>"),e.containers.length>0&&(t+='<div style="overflow: hidden;">'+this.renderContainers(e.containers)+"</div>"),t+="</div></script>",{result:t}}for(var i="<thead><tr>",t='<script type="text/x-jsrender"><tr class="item result">',n=0;n<e.containers.length;n++){var o=e.containers[n],s=this.cleanWidth(o.settings.width);i+='<th width="'+s+'">'+this.plainText(o.settings.header)+"</th>";for(var r=[],a=0;a<o.contents.length;a++)r.push(this.renderContent(o.contents[a]));t+='<td width="'+s+'">'+r.join(" ")+"</td>"}return i+="</tr></thead>",t+="</tr></script>",{header:i,result:t}},i.prototype.renderContainers=function(e){for(var t="",i=0;i<e.length;i++){for(var n=e[i],o=[],s=0;s<n.contents.length;s++)o.push(this.renderContent(n.contents[s]));t+="<div>"+o.join(" ")+"</div>"}return t},i.prototype.renderContent=function(e){return"field"==e.type?this.renderField(e):"code"==e.type?this.renderCode(e):"link"==e.type?this.renderLink(e):"thumbnail"==e.type?this.renderThumbnail(e):"badge"==e.type?this.renderBadge(e):"quickview"==e.type?this.renderQuickView(e):"custom_component"==e.type?this.renderCustomComponent(e):"field_table"==e.type?this.renderFieldTable(e):""},i.prototype.renderField=function(e){var t="",i=this.cleanText(e.settings.name);i=this.lowercaseFirstLetter(i);var n="span",o=i.split("."),s={};switch(e.settings.renderAs){case"link":var r=this.cleanText(e.settings.text);""==r&&(r=i),n="a",s.href="{{url:"+i+"}}",s["data-href"]="{{>"+i+"}}",s.target=null!=e.settings.sameTab&&"true"==e.settings.sameTab?"_self":"_blank";var a=this.lowercaseFirstLetter(r);t=a.indexOf("'")>=0?"{{>"+a+"}}":"{{if "+a+"Highlights}}{{:~highlight("+a+", "+a+"Highlights)}}{{else}}{{>"+r+"}}{{/if}}",o.push("CoveoResultLink"),o.push("coveo-link");break;case"email":t="true"==e.settings.toHyperlinks?"{{:~email("+i+")}}":"{{>"+i+"}}",o.push("coveo-email");break;case"date":var l=e.settings.format;"dateToString"==l&&(l="date"),"timeToString"==l&&(l="time"),"dateTimeToString"==l&&(l="dateTime"),"emailDateTimeToString"==l&&(l="emailDateTime"),(null==l||"time"!=l&&"dateTime"!=l&&"emailDateTime"!=l)&&(l="date"),t="{{>~"+l+"("+i+")}}",o.push("coveo-date");break;default:t="true"==e.settings.emailList?"{{:~email("+i+")}}":"{{if "+i+"Highlights}}{{:~highlight("+i+", "+i+"Highlights)}}{{else}}{{>"+i+"}}{{/if}}"}return s["class"]=o.join(" "),t=this.renderStyleSettings(e.settings,t,n,s),t=this.renderEllipsis(e.settings,t),null==e.settings.label||e.settings.label.match("^\\s*$")||(t='<span class="coveo-label">'+this.plainText(e.settings.label)+"</span>"+t),"{{if "+i+"}}"+t+"{{/if}}"},i.prototype.renderEllipsis=function(e,t){return null!=e.ellipsis&&"true"==e.ellipsis?'<div class="coveo-ellipsis">'+t+"</div>":t},i.prototype.renderStyleSettings=function(e,t,i,n){var o={};null!=e.color&&""!=e.color&&(o.color=this.cleanColor(e.color)),null!=e.bold&&"true"==e.bold&&(o["font-weight"]="bold"),null!=e.italic&&"true"==e.italic&&(o["font-style"]="italic"),null!=e.underline&&"true"==e.underline&&(o["text-decoration"]="underline");var s=" ";for(var r in n)s+=r+'="'+n[r]+'" ';var a="";for(var r in o)a+=r+":"+o[r]+";";return"<"+i+s+'style="'+a+'">'+t+"</"+i+">"},i.prototype.renderCustomComponent=function(e){var t="{{if "+this.jsRenderEncode(e.settings.condition)+"}}";return t+='     <span class="'+this.jsRenderEncode(e.settings.component)+'" href="javascript:void(0);"></span>',t+="{{/if}}"},i.prototype.renderCode=function(e){return"<span>{{html:"+this.jsRenderEncode(e.settings.value)+"}}</span>"},i.prototype.renderLink=function(e){var t=this.jsRenderEncode(e.settings.value),i=this.jsRenderEncode(e.settings.text);(null==i||""==i)&&(i=t),i=this.lowercaseFirstLetter(i);var n,o=null!=e.settings.sameTab&&"true"==e.settings.sameTab?"_self":"_blank";return n=i.indexOf("'")>=0?"{{>"+i+"}}":"{{if "+i+"Highlights}}{{:~highlight("+i+", "+i+"Highlights)}}{{else}}{{html:"+i+"}}{{/if}}",'<a href="{{url:'+t+'}}" data-href="{{>'+t+'}}" target="'+o+'">'+n+"</a>"},i.prototype.renderThumbnail=function(e){var t=this.jsRenderEncode(e.settings.url);return'<img class="coveo-sf-thumb" src="{{url:'+t+'}}" style="height: '+e.settings.height+'px"/>'},i.prototype.renderBadge=function(e){var t=this.jsRenderEncode(e.settings.fieldName),i="{{html:"+t+"}}";
return i=this.renderStyleSettings(e.settings,i,"span",{"class":"coveo-badge"}),"{{if "+t+" != undefined}}"+i+"{{/if}}"},i.prototype.renderQuickView=function(e){return'<div class="CoveoQuickView" data-title="{{html:'+this.jsRenderEncode(e.settings.title)+'}}"><div class="CoveoQuickViewDocument"></div></div>'},i.prototype.renderFieldTable=function(t){var i,n=this;try{i=JSON.parse(t.settings.rows)}catch(o){i=[]}return'<table class="CoveoFieldTable">'+e._.map(i,function(e){var t=[];return t.push('data-field="'+n.jsRenderEncode(e.field)+'"'),e.caption&&t.push('data-caption="'+n.jsRenderEncode(e.caption)+'"'),"<tr "+t.join(" ")+"></tr>"}).join("")+"</div>"},i.prototype.cleanText=function(e){return null==e?"":e.replace(/[^A-Za-z0-9_\.]/g,"")},i.prototype.lowercaseFirstLetter=function(e){return e&&e.length>0?e.charAt(0).toLowerCase()+e.slice(1):""},i.prototype.cleanColor=function(e){return null==e?"":e.match(/^#[0-9A-Fa-f]{3,6}$/)||e.match(/^[a-z]+$/)?e:""},i.prototype.cleanWidth=function(e){return null==e?"":e.match(/^[0-9]{1,2}?%|[0-9]+$/)?e:""},i.prototype.plainText=function(e){return this.jsRenderEncode(this.htmlEncode(e))},i.prototype.htmlEncode=function(e){return null==e?"":e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},i.prototype.jsRenderEncode=function(e){return null==e?"":e.replace(/\}\}/g,"}}")},i.create=function(t){return e.Assert.exists(t),new i(t)},i.isLibraryAvailable=function(){return e.Utils.exists(window.TemplateEditorUtils)&&t.JsRenderTemplate.isLibraryAvailable()},i.mimeTypes=["text/json-template"],i}();t.JsonTemplate=i}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function i(){}return i.registerTemplateHelper=function(n,o){e.Assert.isNonEmptyString(n),e.Assert.exists(o),t.UnderscoreTemplate.isLibraryAvailable()&&i.registerTemplateHelperInUnderscore(n,o),t.JsRenderTemplate.isLibraryAvailable()&&i.registerTemplateHelperInJsRender(n,o),t.HandlebarsTemplate.isLibraryAvailable()&&i.registerTemplateHelperInHandlebars(n,o),i.helpers[n]=o},i.getHelper=function(e){return i.helpers[e]},i.registerTemplateHelperInJsRender=function(t,i){e.Assert.isNonEmptyString(t),e.Assert.exists(i);var n={};n[t]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return i.apply(this.data,e)},e.$.views.helpers(n)},i.registerTemplateHelperInHandlebars=function(i,n){e.Assert.isNonEmptyString(i),e.Assert.exists(n),e.Assert.check(t.HandlebarsTemplate.isLibraryAvailable()),Handlebars.registerHelper(i,function(){for(var t=[],i=0;i<arguments.length;i++)t[i-0]=arguments[i];var o=t[t.length-1];return e._.isObject(o)&&e.Utils.exists(o.hash)&&(t[t.length-1]=o.hash),new Handlebars.SafeString(n.apply(this,t))})},i.registerTemplateHelperInUnderscore=function(i,n){e.Assert.isNonEmptyString(i),e.Assert.exists(n),e.Assert.check(t.UnderscoreTemplate.isLibraryAvailable()),t.UnderscoreTemplate.registerTemplateHelper(i,n)},i.helpers={},i}();t.TemplateHelpers=i}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function i(){}return i.registerDefaultOptions=function(t,i){var n=e.$(t).data("CoveoDefaultOptions")||{},o=e.$.extend(!0,{},n,i);e.$(t).data("CoveoDefaultOptions",o)},i.resolveDefaultOptions=function(t,n){var o,s=e.$(t).data("CoveoDefaultOptions");return o=e.Utils.exists(s)?e.$.extend(!0,{},s,n):n,t.parentElement?i.resolveDefaultOptions(t.parentElement,o):o},i.registerAutoCreateComponent=function(t){e.Assert.exists(t),e.Assert.exists(t.ID),e.Assert.doesNotExists(i.autoCreateComponents[t.ID]),e.Assert.doesNotExists(i.namedMethods[t.ID]),i.autoCreateComponents[t.ID]=t},i.isComponentClassIdRegistered=function(t){return e.Utils.exists(i.autoCreateComponents[t])},i.getListOfRegistredComponents=function(){return e._.keys(i.autoCreateComponents)},i.getRegistredComponent=function(e){return i.autoCreateComponents[e]},i.initializeSearchInterface=function(n,o){e.Assert.exists(n),this.logger.info("Internal Coveo JQuery version",e.$.fn.jquery),e.DeviceUtils.isIE8or9()&&e.$("html").addClass("ie8or9"),o=i.resolveDefaultOptions(n,o),i.performInitFunctionsOption(o,e.Events.InitializationEvents.beforeInitialization),e.$(n).trigger(e.Events.InitializationEvents.beforeInitialization),i.initComponents(n,o),i.initExternalComponents(n,o),i.performInitFunctionsOption(o,e.Events.InitializationEvents.afterComponentsInitialization),e.$(n).trigger(e.Events.InitializationEvents.afterComponentsInitialization),e.$(n).trigger(e.Events.InitializationEvents.restoreHistoryState),i.performInitFunctionsOption(o,e.Events.InitializationEvents.afterInitialization),e.$(n).trigger(e.Events.InitializationEvents.afterInitialization);var s=t.Component.get(n,t.SearchInterface);e.$(".coveo-hide-until-loaded").removeClass("coveo-hide-until-loaded").addClass("coveo-show-after-loaded"),s.options.autoTriggerQuery&&t.Component.get(n,e.Controllers.QueryController).executeQuery()},i.initializeSearchInterfaceForSearchBox=function(t,n,o){e.Assert.isNonEmptyString(n);var s={};s.searchPageUri=n,s.autoTriggerQuery=!1,s.hideUntilFirstQuery=!1,s.enableHistory=!1,o=e._.extend({},o,{SearchInterface:s}),i.initializeSearchInterface(t,o)},i.performInitFunctionsOption=function(t,n){e.Utils.exists(t)&&i.performFunctions(t[n])},i.performPreInitFunctions=function(t){e.Utils.exists(t)&&i.performFunctions(t[e.Events.InitializationEvents.beforeInitialization])},i.performPostInitFunction=function(t){e.Utils.exists(t)&&i.performFunctions(t[e.Events.InitializationEvents.afterInitialization])},i.performFunctions=function(t){e.Utils.exists(t)&&e._.each(t,function(e){"function"==typeof e&&e()})},i.initComponents=function(n,o){void 0===o&&(o={}),o.SearchInterface=o.SearchInterface||{},o.SearchInterface.initOptions=o;var s=new t.SearchInterface(n,o.SearchInterface,o.Analytics),r=e.$.extend({},{options:o},s.getBindings());i.automaticallyCreateComponentsInside(n,r)},i.initExternalComponents=function(t,n){if(n&&n.externalComponents){var o=e.$(t).coveo(e.Ui.SearchInterface),s=e.$(t).coveo(e.Models.QueryStateModel),r=e.$(t).coveo(e.Models.ComponentStateModel),a=e.$(t).coveo(e.Controllers.QueryController),l=e.$(t).coveo(e.Models.ComponentOptionsModel),u=o.usageAnalytics;e.Assert.exists(o),e.Assert.exists(s),e.Assert.exists(a),e.Assert.exists(r),e.Assert.exists(u);var c={options:n,searchInterface:o,queryStateModel:s,queryController:a,usageAnalytics:u,componentStateModel:r,componentOptionsModel:l,root:t};e._.each(n.externalComponents,function(t){var n=t;n instanceof e.$&&(n=e.$(n).get(0)),e.Utils.isHtmlElement(n)&&i.automaticallyCreateComponentsInside(n,c)})}},i.automaticallyCreateComponentsInside=function(n,o,s){e.Assert.exists(n);var r=[];for(var a in i.autoCreateComponents)if(!e._.contains(s,a)){var l=i.autoCreateComponents[a],u=t.Component.computeCssClassNameForType(l.ID),c=e.$(n).find("."+u);e.$(n).hasClass(u)&&(c=c.add(n)),0!=c.length&&r.push(i.createFunctionThatInitializesComponentOnElements(c,a,l,o))}e._.each(r,function(e){return e()})},i.createFunctionThatInitializesComponentOnElements=function(t,n,o,s){return function(){t.each(function(t,r){var a=void 0;if(e.Utils.exists(s.options)){var l=s.options[n],u=s.options[r.id],c=s.options.initOptions?s.options.initOptions[n]:{};a=e.$.extend({},l,u,c)}var p=e.$.extend({},s,{options:a});i.createComponentOfThisClassOnElement(o.ID,r,p)})}},i.createComponentOfThisClassOnElement=function(t,n,o){e.Assert.isNonEmptyString(t),e.Assert.exists(n);var s=i.autoCreateComponents[t];e.Assert.exists(s);var r={},a={},l=void 0;return void 0!=o&&(r={queryController:o.queryController,queryStateModel:o.queryStateModel,componentStateModel:o.componentStateModel,root:o.root,searchInterface:o.searchInterface,usageAnalytics:o.usageAnalytics,componentOptionsModel:o.componentOptionsModel},a=o.options,l=o.result),i.logger.trace("Creating component of class "+t,n,a),new s(n,a,r,l)},i.registerNamedMethod=function(t,n){e.Assert.isNonEmptyString(t),e.Assert.doesNotExists(i.autoCreateComponents[t]),e.Assert.doesNotExists(i.namedMethods[t]),e.Assert.exists(n),i.namedMethods[t]=n},i.isNamedMethodRegistered=function(t){return e.Utils.exists(i.namedMethods[t])},i.dispatchNamedMethodCall=function(t,n,o){e.Assert.isNonEmptyString(t),e.Assert.exists(n);var s=i.namedMethods[t];return e.Assert.exists(s),i.logger.trace("Dispatching named method call of "+t,n,o),s.apply(null,[n].concat(o))},i.isThereASingleComponentBoundToThisElement=function(i){return e.Assert.exists(i),e.Utils.exists(t.Component.get(i))},i.dispatchMethodCallOnBoundComponent=function(i,n,o){e.Assert.isNonEmptyString(i),e.Assert.exists(n);var s=t.Component.get(n);e.Assert.exists(s);var r=s[i];return e.Utils.exists(r)?r.apply(s,o):(e.Assert.fail("No method named "+i+" exist on component "+s.type),void 0)},i.dispatchNamedMethodCallOrComponentCreation=function(t,n,o){return e.Assert.isNonEmptyString(t),e.Assert.exists(n),i.isNamedMethodRegistered(t)?i.dispatchNamedMethodCall(t,n,o):i.isComponentClassIdRegistered(t)?i.createComponentOfThisClassOnElement(t,n,o[0]):i.isThereASingleComponentBoundToThisElement(n)?i.dispatchMethodCallOnBoundComponent(t,n,o):(e.Assert.fail("No method or component named "+t+" are registered."),void 0)},i.monkeyPatchComponentMethod=function(i,n,o){e.Assert.isNonEmptyString(i),e.Assert.exists(o);var s;if(i.indexOf(".")>0){var r=i.split(".");e.Assert.check(2==r.length,"Invalid method name, correct syntax is CoveoComponent.methodName."),s=r[0],i=r[1]}var a=t.Component.get(n,s);e.Assert.exists(a),e.Assert.exists(a[i]);var l="__"+i;e.Utils.exists(a[l])||(a[l]=a[i]),a[i]=o},i.noConflict=function(){e.$=jQuery.noConflict(!0),window.$.fn.coveo=e.$.fn.coveo},i.logger=new e.Logger("JQuery"),i.autoCreateComponents={},i.namedMethods={},i}();t.CoveoJQuery=i}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={})),$.fn.coveo=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];var i;return this.each(function(t,n){var o;if(_.isString(e[0])){var s=e[0];o=Coveo.Ui.CoveoJQuery.dispatchNamedMethodCallOrComponentCreation(s,n,e.slice(1))}else o=Coveo.Ui.CoveoJQuery.dispatchNamedMethodCall("get",n,e);i=i||o}),i},Coveo.$.fn.getCursorPosition=function(){var e=this.get(0);if(e){if("selectionStart"in e)return e.selectionStart;if(document.selection){e.focus();var t=document.selection.createRange(),i=document.selection.createRange().text.length;return t.moveStart("character",-e.value.length),t.text.length-i}}},Coveo.Ui.CoveoJQuery.registerNamedMethod("options",function(e,t){Coveo.Ui.CoveoJQuery.registerDefaultOptions(e,t)}),Coveo.Ui.CoveoJQuery.registerNamedMethod("init",function(e,t){Coveo.Ui.CoveoJQuery.initializeSearchInterface(e,t)}),Coveo.Ui.CoveoJQuery.registerNamedMethod("initSearchBox",function(e,t,i){Coveo.Ui.CoveoJQuery.initializeSearchInterfaceForSearchBox(e,t,i)}),Coveo.Ui.CoveoJQuery.registerNamedMethod("patch",function(e,t,i){Coveo.Ui.CoveoJQuery.monkeyPatchComponentMethod(t,e,i)}),Coveo.Ui.CoveoJQuery.registerNamedMethod("noConflict",function(){Coveo.Ui.CoveoJQuery.noConflict()});var Coveo;!function(e){var t;!function(t){var i=function(){function i(n,o,s){var r=this;void 0===s&&(s={}),this.element=n,this.type=o,this.disabled=!1,this.bind=new t.ComponentEvents(this),e.Assert.exists(n),e.Assert.isNonEmptyString(o),i.bindComponentToElement(this.element,this),this.logger=new e.Logger(this),this.root=s.root||this.resolveRoot(),this.queryStateModel=s.queryStateModel||this.resolveQueryStateModel(),this.componentStateModel=s.componentStateModel||this.resolveComponentStateModel(),this.queryController=s.queryController||this.resolveQueryController(),this.searchInterface=s.searchInterface||this.resolveSearchInterface(),this.usageAnalytics=s.usageAnalytics||this.resolveUA(),this.componentOptionsModel=s.componentOptionsModel||this.resolveComponentOptionsModel(),this.ensureDom=e._.once(function(){return r.createDom()}),null!=this.searchInterface&&this.searchInterface.attachComponent(o,this)}return i.prototype.getBindings=function(){return{root:this.root,queryStateModel:this.queryStateModel,queryController:this.queryController,searchInterface:this.searchInterface,componentStateModel:this.componentStateModel,componentOptionsModel:this.componentOptionsModel,usageAnalytics:this.usageAnalytics}},i.prototype.enable=function(){this.disabled=!1},i.prototype.disable=function(){this.disabled=!0},i.prototype.createDom=function(){},i.prototype.resolveSearchInterface=function(){return i.resolveBinding(this.element,t.SearchInterface)},i.prototype.resolveRoot=function(e){var n=i.resolveBinding(this.element,t.SearchInterface);return n?n.element:e},i.prototype.resolveQueryController=function(t){return i.resolveBinding(this.element,e.Controllers.QueryController)||t},i.prototype.resolveComponentStateModel=function(t){return i.resolveBinding(this.element,e.Models.ComponentStateModel)||t},i.prototype.resolveQueryStateModel=function(t){return i.resolveBinding(this.element,e.Models.QueryStateModel)||t},i.prototype.resolveComponentOptionsModel=function(t){return i.resolveBinding(this.element,e.Models.ComponentOptionsModel)||t},i.prototype.resolveUA=function(){var e=this.resolveSearchInterface();return e&&e.usageAnalytics?e.usageAnalytics:new t.NoopAnalyticsClient},i.prototype.resolveResult=function(){var t=e.$(this.element).closest(".CoveoResult");return e.Assert.check(1==t.length),t.get(0).CoveoResult},i.prototype.isInstanceOf=function(t){return i.getComponentRef(t)&&this instanceof e.Ui[t]},i.getComponentRef=function(t){return e.Ui[t]},i.get=function(t,n,o){if(e.Assert.exists(t),e._.isString(n))return t[i.computeMemberNameForType(n)];if(e.Utils.exists(n))return e.Assert.exists(n.ID),t[i.computeMemberNameForType(n.ID)];var s=i.getBoundComponentsForElement(t);return o||e.Assert.check(s.length<=1,"More than one component is bound to this element. You need to specify the component type."),s[0]},i.bindComponentToElement=function(t,n){e.Assert.exists(t),e.Assert.exists(n),e.Assert.isNonEmptyString(n.type),t[i.computeMemberNameForType(n.type)]=n,e.$(t).addClass(i.computeCssClassNameForType(n.type)),i.getBoundComponentsForElement(t).push(n)},i.bindResultToElement=function(t,i){e.Assert.exists(t),e.Assert.exists(i),e.$(t).addClass("CoveoResult"),t.CoveoResult=i},i.resolveBinding=function(t,n){e.Assert.exists(t),e.Assert.exists(n),e.Assert.exists(n.ID);var o=e.$(t).closest("."+i.computeCssClassNameForType(n.ID));return 0==o.length?void 0:o.get(0)[i.computeMemberNameForType(n.ID)]},i.computeCssClassNameForType=function(t){return e.Assert.isNonEmptyString(t),"Coveo"+t},i.computeSelectorForType=function(t){return e.Assert.isNonEmptyString(t),"."+i.computeCssClassNameForType(t)},i.computeMemberNameForType=function(t){return e.Assert.isNonEmptyString(t),"Coveo"+t},i.pointElementsToDummyForm=function(e){e.add(e.find("*")).filter("input").attr("form","coveo-dummy-form")},i.getBoundComponentsForElement=function(t){return e.Assert.exists(t),null==t.CoveoBoundComponents&&(t.CoveoBoundComponents=[]),t.CoveoBoundComponents},i}();t.Component=i,t.CoveoJQuery.registerNamedMethod("get",function(t,n){return e.Assert.exists(t),i.get(t,n)})}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function t(t){this.owner=t,e.Assert.exists(t)}return t.prototype.on=function(e,t,i){e.on(t,this.wrapToCallIfEnabled(i))},t.prototype.onRoot=function(t,i){this.on(e.$(this.owner.root),t,i)},t.prototype.fastClick=function(e,t){e.fastClick(this.wrapToCallIfEnabled(t))},t.prototype.trigger=function(e,t,i){this.wrapToCallIfEnabled(function(){e.trigger(t,i)})},t.prototype.wrapToCallIfEnabled=function(e){var t=this;return function(){for(var i=[],n=0;n<arguments.length;n++)i[n-0]=arguments[n];return t.owner.disabled?void 0:e.apply(t.owner,i)}},t}();t.ComponentEvents=i}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i;!function(i){function n(e){return m(0,T,e)}function o(e){return m(1,A,e)}function s(e){return m(2,S,e)}function r(e){return m(9,S,e)}function a(e){return m(3,E,e)}function l(e){return m(8,x,e)}function u(e){return m(4,w,e)}function c(e){return m(5,_,e)}function p(e){return m(6,F,e)}function d(e){return m(7,V,e)}function h(e,t){var i=function(t,i,n){var o=S(t,i,n);return e(o)};return m(2,i,t)}function f(e,t){var i=function(t,i,n){var o=w(t,i,n);return e(o)};return m(4,i,t)}function v(t){var i=function(i,n){for(var o=e._.keys(t.subOptions),s={},r={},a=0;a<o.length;a++){var l=o[a],u=n+l.substr(0,1).toUpperCase()+l.substr(1);s[u]=t.subOptions[l]}b(i,s,r);for(var c={},a=0;a<o.length;a++){var l=o[a],u=n+l.substr(0,1).toUpperCase()+l.substr(1);null!=r[u]&&(c[l]=r[u])}return e._.keys(c).length>0?c:null};return m(10,i,t)}function m(e,t,i){void 0===i&&(i={});var n=i;return n.type=e,n.load=t,n}function g(e,t){return t.attrName?t.attrName:"data-"+e.replace(/([A-Z])/g,"-$1").toLowerCase()}function y(e){var t=e.split("-");t.shift();for(var i=1;i<t.length;i++)t[i]=t[i].substr(0,1).toUpperCase()+t[i].substr(1);return t.join("")}function C(e,t,i){return b(e,t.options,i)}function b(t,i,n){null==n&&(n={});for(var o=e._.keys(i),s=0;s<o.length;s++){var r,a=o[s],l=i[a],u=(l.attrName||g(a,l),l.load);null!=u&&(r=u(t,a,l)),null==r&&void 0==n[a]&&(null!=l.defaultValue?r=4==l.type?e._.extend([],l.defaultValue):10==l.type?e._.extend({},l.defaultValue):l.defaultValue:null!=l.defaultFunction&&(r=l.defaultFunction(t))),null!=r&&(n[a]=r)}for(var s=0;s<o.length;s++){var a=o[s],l=i[a];l.postProcessing&&(n[a]=l.postProcessing(n[a],n))}return n}function S(t,i,n){return e.$(t).attr(g(i,n))}function x(t,i,n){var o=S(t,i,n);return e.Assert.check(!e.Utils.isNonEmptyString(o)||e.Utils.isCoveoField(o),o+" is not a valid field"),null!=o?o.toLowerCase():null}function E(t,i,n){var o=S(t,i,n),s=String.locale||String.defaultLocale;if(null!=s&&null!=o){var r=s.toLowerCase().split("-"),a=e._.map(r,function(e,t){return r.slice(0,t+1).join("-")}),l=o.match(Q);if(null!=l)for(var u=0;u<l.length;u++){var c=Q.exec(l[u]);if(null!=c){var p=c[1].toLowerCase();if(e._.contains(a,p))return c[2].replace(/^\s+|\s+$/g,"")}}return null!=o?o.toLocaleString():null}return o}function A(t,i,n){return e.Utils.parseIntIfNotUndefined(S(t,i,n))}function O(t,i,n){return e.Utils.parseFloatIfNotUndefined(S(t,i,n))}function T(t,i,n){return e.Utils.parseBooleanIfNotUndefined(S(t,i,n))}function w(t,i,n){var o=n.separator||/\s*,\s*/,s=S(t,i,n);return e.Utils.isNonEmptyString(s)?s.split(o):null}function I(e,t,i,n){var o=S(e,t,i);return null!=o?n[o]:null}function _(t,i,n){var o=S(t,i,n);return e.Utils.isNonEmptyString(o)?e.$(o).get(0):null}function F(t,i,n){var o,s=n.selectorAttr||g(i,n)+"-selector",r=e.$(t).attr(s);if(o=e.$(r).get(0),null==o){var a=n.childSelector;null==a&&(a="."+i),o=U(t,a)}return o}function U(t,i){if(e.Assert.isNonEmptyString(i),e.$(t).is(i))return t;var n=e.$(t).find(i);return 0!=n.length?n.get(0):null}function V(t,i,n){var o,s=n.selectorAttr||g(i,n)+"-selector",r=e.$(t).attr(s),a=e.$(r).get(0);if(null!=a&&(o=B(a)),null==o){var l=n.idAttr||g(i,n)+"-id",u=e.$(t).attr(l);null!=u&&(o=D(u))}if(null==o){var c=n.childSelector;null==c&&(c="."+i.replace(/([A-Z])/g,"-$1").toLowerCase()),o=R(t,c)}return o}function D(i){return e.Utils.isNonEmptyString(i)?new t.UnderscoreTemplate(t.TemplateCache.getTemplate(i)):null}function R(e,t){var i=U(e,t);return null!=i?B(i):null}function M(t){for(var i=e.$(t);!i.is(document)&&0!=i.length;){if($(i))return i.is("body")?e.$(window).get(0):i.get(0);i=i.parent()}return e.$(window).get(0)}function $(e){return"scroll"==e.css("overflow-y")}function B(i){e.Assert.exists(i);var n=e.$(i).attr("type");return e.Assert.check(e.Utils.isNonEmptyString(n),"You must specify the type of template"),-1!=e._.indexOf(t.UnderscoreTemplate.mimeTypes,n)?t.UnderscoreTemplate.create(i):-1!=e._.indexOf(t.JsRenderTemplate.mimeTypes,n)?t.JsRenderTemplate.create(i):-1!=e._.indexOf(t.HandlebarsTemplate.mimeTypes,n)?t.HandlebarsTemplate.create(i):-1!=e._.indexOf(t.JsonTemplate.mimeTypes,n)?t.JsonTemplate.create(i):(e.Assert.fail("Cannot guess template type from attribute: "+n),void 0)}!function(e){e[e.BOOLEAN=0]="BOOLEAN",e[e.NUMBER=1]="NUMBER",e[e.STRING=2]="STRING",e[e.LOCALIZED_STRING=3]="LOCALIZED_STRING",e[e.LIST=4]="LIST",e[e.SELECTOR=5]="SELECTOR",e[e.CHILD_HTML_ELEMENT=6]="CHILD_HTML_ELEMENT",e[e.TEMPLATE=7]="TEMPLATE",e[e.FIELD=8]="FIELD",e[e.ICON=9]="ICON",e[e.OBJECT=10]="OBJECT",e[e.NONE=11]="NONE"}(i.Type||(i.Type={}));i.Type;i.buildBooleanOption=n,i.buildNumberOption=o,i.buildStringOption=s,i.buildIconOption=r,i.buildLocalizedStringOption=a,i.buildFieldOption=l,i.buildListOption=u,i.buildSelectorOption=c,i.buildChildHtmlElementOption=p,i.buildTemplateOption=d,i.buildCustomOption=h,i.buildCustomListOption=f,i.buildObjectOption=v,i.buildOption=m,i.attrNameFromName=g,i.nameFromattrName=y,i.initComponentOptions=C,i.initOptions=b,i.loadStringOption=S,i.loadFieldOption=x;var Q=/([a-zA-Z\-]+)\s*:\s*(([^,]|,\s*(?!([a-zA-Z\-]+)\s*:))+)/g;i.loadLocalizedStringOption=E,i.loadNumberOption=A,i.loadFloatOption=O,i.loadBooleanOption=T,i.loadListOption=w,i.loadEnumOption=I,i.loadSelectorOption=_,i.loadChildHtmlElementOption=F,i.loadChildHtmlElementFromSelector=U,i.loadTemplateOption=V,i.loadResultTemplateFromId=D,i.loadChildResultTemplateFromSelector=R,i.findParentScrolling=M,i.isElementScrollable=$,i.createResultTemplateFromElement=B}(i=t.ComponentOptions||(t.ComponentOptions={}))}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function i(){this.expression=new t.ExpressionBuilder,this.advancedExpression=new t.ExpressionBuilder,this.constantExpression=new t.ExpressionBuilder,this.disjunctionExpression=new t.ExpressionBuilder,this.firstResult=0,this.numberOfResults=10,this.enableDidYouMean=!1,this.enableDebug=!0,this.sortCriteria="relevancy",this.retrieveFirstSentences=!0,this.queryUid=e.QueryUtils.createGuid(),this.queryFunctions=[],this.rankingFunctions=[],this.groupByRequests=[],this.enableDuplicateFiltering=!1}return i.prototype.build=function(){var e={q:this.expression.build(),aq:this.advancedExpression.build(),cq:this.constantExpression.build(),dq:this.disjunctionExpression.build(),wildcards:this.enableWildcards,questionMarks:this.enableQuestionMarks,lowercaseOperators:this.enableLowercaseOperators,partialMatch:this.enablePartialMatch,partialMatchKeywords:this.partialMatchKeywords,partialMatchThreshold:this.partialMatchThreshold,firstResult:this.firstResult,numberOfResults:this.numberOfResults,excerptLength:this.excerptLength,filterField:this.filterField,filterFieldRange:this.filterFieldRange,parentField:this.parentField,childField:this.childField,fieldsToInclude:this.fieldsToInclude,fieldsToExclude:this.fieldsToExclude,enableDidYouMean:this.enableDidYouMean,sortCriteria:this.sortCriteria,sortField:this.sortField,queryFunctions:this.queryFunctions,rankingFunctions:this.rankingFunctions,groupBy:this.groupByRequests,retrieveFirstSentences:this.retrieveFirstSentences,timezone:this.timezone,enableDuplicateFiltering:this.enableDuplicateFiltering};return e},i.prototype.computeCompleteExpression=function(){return this.computeCompleteExpressionParts().full},i.prototype.computeCompleteExpressionParts=function(){var e=t.ExpressionBuilder.merge(this.expression,this.advancedExpression);return{full:t.ExpressionBuilder.mergeUsingOr(t.ExpressionBuilder.merge(e,this.constantExpression),this.disjunctionExpression).build(),withoutConstant:t.ExpressionBuilder.mergeUsingOr(e,this.disjunctionExpression).build(),constant:t.ExpressionBuilder.mergeUsingOr(this.constantExpression,this.disjunctionExpression).build()}},i.prototype.computeCompleteExpressionExcept=function(e){return this.computeCompleteExpressionPartsExcept(e).full},i.prototype.computeCompleteExpressionPartsExcept=function(e){var i=t.ExpressionBuilder.merge(this.expression,this.advancedExpression);return i.remove(e),{full:t.ExpressionBuilder.mergeUsingOr(t.ExpressionBuilder.merge(i,this.constantExpression),this.disjunctionExpression).build(),withoutConstant:t.ExpressionBuilder.mergeUsingOr(i,this.disjunctionExpression).build(),constant:t.ExpressionBuilder.mergeUsingOr(this.constantExpression,this.disjunctionExpression).build()}},i}();t.QueryBuilder=i}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function t(){this.parts=[],this.wrapParts=!0}return t.prototype.add=function(t){e.Assert.isNonEmptyString(t),this.parts.push(t)},t.prototype.addFieldExpression=function(t,i,n){e.Assert.isNonEmptyString(t),e.Assert.stringStartsWith(t,"@"),e.Assert.isNonEmptyString(i),e.Assert.isLargerOrEqualsThan(1,n.length),this.add(e.QueryUtils.buildFieldExpression(t,i,n))},t.prototype.addFieldNotEqualExpression=function(t,i){e.Assert.isNonEmptyString(t),e.Assert.stringStartsWith(t,"@"),e.Assert.isLargerOrEqualsThan(1,i.length),this.add(e.QueryUtils.buildFieldNotEqualExpression(t,i))},t.prototype.remove=function(t){e.Assert.isNonEmptyString(t);var i=e._.indexOf(this.parts,t);-1!=i&&this.parts.splice(e._.indexOf(this.parts,t),1)},t.prototype.isEmpty=function(){return 0==this.parts.length},t.prototype.build=function(){return 0==this.parts.length?void 0:1==this.parts.length?this.parts[0]:this.wrapParts?"("+this.parts.join(") (")+")":this.parts.join(" ")},t.merge=function(){for(var i=[],n=0;n<arguments.length;n++)i[n-0]=arguments[n];var o=new t;return e._.each(i,function(e){o.parts=o.parts.concat(e.parts)}),o},t.mergeUsingOr=function(){for(var i=[],n=0;n<arguments.length;n++)i[n-0]=arguments[n];var o=e._.filter(i,function(e){return!e.isEmpty()}),s=new t;if(1==o.length)s.parts=[].concat(o[0].parts);else if(o.length>1){var r=e._.map(o,function(e){return e.build()});s.add("("+r.join(") OR (")+")")}return s},t}();t.ExpressionBuilder=i}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){e.AnalyticsActionCauseList={interfaceLoad:{name:"interfaceLoad",type:"interface"},interfaceChange:{name:"interfaceChange",type:"interface",metaMap:{interfaceChangeTo:1}},contextRemove:{name:"contextRemove",type:"misc",metaMap:{contextName:1}},didyoumeanAutomatic:{name:"didyoumeanAutomatic",type:"misc"},didyoumeanClick:{name:"didyoumeanClick",type:"misc"},resultsSort:{name:"resultsSort",type:"misc",metaMap:{resultsSortBy:1}},searchboxSubmit:{name:"searchboxSubmit",type:"search box"},searchboxClear:{name:"searchboxClear",type:"search box"},searchboxAsYouType:{name:"searchboxAsYouType",type:"search box"},breadcrumbFacet:{name:"breadcrumbFacet",type:"breadcrumb",metaMap:{facetId:1,facetValue:2}},breadcrumbResetAll:{name:"breadcrumbResetAll",type:"breadcrumb"},documentTag:{name:"documentTag",type:"document",metaMap:{facetId:1,facetValue:2}},documentField:{name:"documentField",type:"document",metaMap:{facetId:1,facetValue:2}},documentQuickView:{name:"documentQuickView",type:"document",metaMap:{documentTitle:1,documentURL:2}},documentOpen:{name:"documentOpen",type:"document",metaMap:{documentTitle:1,documentURL:2}},omniboxFacet:{name:"omniboxFacet",type:"omnibox",metaMap:{facetId:1,facetValue:2}},omniboxAnalytics:{name:"omniboxAnalytics",type:"omnibox"},omniboxField:{name:"omniboxField",type:"omnibox"},facetClearAll:{name:"facetClearAll",type:"facet",metaMap:{facetId:1}},facetSearch:{name:"facetSearch",type:"facet",metaMap:{facetId:1}},facetToggle:{name:"facetToggle",type:"facet",metaMap:{facetId:1,facetOperatorBefore:2,facetOperatorAfter:3}},facetRangeSlider:{name:"facetRangeSlider",type:"facet",metaMap:{facetId:1,facetRangeStart:2,facetRangeEnd:3}},facetRangeGraph:{name:"facetRangeGraph",type:"facet",metaMap:{facetId:1,facetRangeStart:2,facetRangeEnd:3}},facetSelect:{name:"facetSelect",type:"facet",metaMap:{facetId:1,facetValue:2}},facetSelectAll:{name:"facetSelectAll",type:"facet",metaMap:{facetId:1,facetValue:2}},facetDeselect:{name:"facetDeselect",type:"facet",metaMap:{facetId:1,facetValue:2}},facetExclude:{name:"facetExclude",type:"facet",metaMap:{facetId:1,facetValue:2}},facetUnexclude:{name:"facetUnexclude",type:"facet",metaMap:{facetId:1,facetValue:2}},facetSortValues:{name:"facetSortValues",type:"facet",metaMap:{facetId:1,facetSortBy:2}},errorBack:{name:"errorBack",type:"errors"},errorClearQuery:{name:"errorClearQuery",type:"errors"},errorRetry:{name:"errorRetry",type:"errors"},expandToFullUI:{name:"expandToFullUI",type:"interface"},caseCreate:{name:"caseCreate",type:"case"},casecontextAdd:{name:"casecontextAdd",type:"casecontext",metaMap:{caseID:5}},casecontextRemove:{name:"casecontextRemove",type:"casecontext",metaMap:{caseID:5}},preferencesChange:{name:"preferencesChange",type:"preferences",metaMap:{preferenceName:1,preferenceType:2}},caseAttach:{name:"caseAttach",type:"case",metaMap:{documentTitle:1,resultUriHash:3,articleID:4,caseID:5}},caseDetach:{name:"caseDetach",type:"case",metaMap:{documentTitle:1,resultUriHash:3,articleID:4,caseID:5}},customfiltersChange:{name:"customfiltersChange",type:"customfilters",metaMap:{customFilterName:1,customFilterType:2,customFilterExpression:3}},pagerNumber:{name:"pagerNumber",type:"getMoreResults",metaMap:{pagerNumber:1}},pagerNext:{name:"pagerNext",type:"getMoreResults",metaMap:{pagerNumber:1}},pagerPrevious:{name:"pagerPrevious",type:"getMoreResults",metaMap:{pagerNumber:1}},pagerScrolling:{name:"pagerScrolling",type:"getMoreResults"},searchFromLink:{name:"searchFromLink",type:"interface"}}}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function t(){this.isContextual=!1}return t.prototype.isActivated=function(){return!1},t.prototype.getCurrentEventCause=function(){return null},t.prototype.getCurrentEventMeta=function(){return{}},t.prototype.logSearchEvent=function(){},t.prototype.logSearchAsYouType=function(){},t.prototype.logClickEvent=function(){},t.prototype.logCustomEvent=function(){},t.prototype.getTopQueries=function(){var t=e.$.Deferred();return t.resolve([]),t},t.prototype.sendAllPendingEvents=function(){},t}();t.NoopAnalyticsClient=i}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var __extends=this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);i.prototype=t.prototype,e.prototype=new i},Coveo;!function(e){var t;!function(t){var i=function(t){function i(i,n,o,s){t.call(this,i,n,s),this.eventNameSpace=n,this.defaultAttributes=e.$.extend(!0,{},this.defaultAttributes,o),this.attributes=o,this.logger.debug("Creating model")}return __extends(i,t),i.prototype.set=function(e,t,i){var n={};n[e]=t,this.setMultiple(n,i)},i.prototype.setMultiple=function(t,i){var n=this,o=!1;this.preprocessEvent(t),e._.each(t,function(e,t){i&&i.customAttribute||n.checkIfAttributeExists(t),e=n.parseToCorrectType(t,e),(!i||i.validateType)&&n.validateType(t,e),n.checkIfAttributeChanged(t,e)&&(n.attributes[t]=e,o=!0,null!=i&&i.silent||n.attributeHasChangedEvent(t))}),!o||null!=i&&i.silent||(this.attributesHasChangedEvent(),this.anyEvent())},i.prototype.setNewDefault=function(e,t,i){i&&i.customAttribute||this.checkIfAttributeExists(e),this.defaultAttributes[e]=t},i.prototype.setDefault=function(e){this.set(e,this.defaultAttributes[e])},i.prototype.get=function(e){return void 0==e?this.attributes:this.attributes[e]},i.prototype.getDefault=function(e){return void 0==e?this.defaultAttributes:this.defaultAttributes[e]},i.prototype.reset=function(){this.setMultiple(this.defaultAttributes),this.modelWasResetEvent()},i.prototype.registerNewAttribute=function(e,t){this.defaultAttributes[e]=t,this.attributes[e]=t},i.prototype.getEventName=function(e){return this.eventNameSpace+":"+e},i.prototype.attributesHasChangedEvent=function(){e.$(this.element).trigger(this.getEventName(i.eventTypes.change),this.createAttributesChangedArgument())},i.prototype.attributeHasChangedEvent=function(t){e.$(this.element).trigger(this.getEventName(i.eventTypes.changeOne)+t,this.createAttributeChangedArgument(t))},i.prototype.preprocessEvent=function(t){e.$(this.element).trigger(this.getEventName(i.eventTypes.preprocess),t)},i.prototype.modelWasResetEvent=function(){e.$(this.element).trigger(this.getEventName(i.eventTypes.reset),this.createModelChangedArgument())
},i.prototype.anyEvent=function(){e.$(this.element).trigger(this.getEventName(i.eventTypes.all),this.createModelChangedArgument())},i.prototype.createAttributeChangedArgument=function(e){return{attribute:e,value:this.attributes[e]}},i.prototype.createAttributesChangedArgument=function(){return{attributes:this.attributes}},i.prototype.createModelChangedArgument=function(){return{model:this}},i.prototype.checkIfAttributeExists=function(t){e.Assert.check(e._.has(this.attributes,t))},i.prototype.validateType=function(t,i){e.Utils.isNullOrUndefined(this.attributes[t])||e.Utils.isUndefined(i)||(e._.isNumber(this.attributes[t])?e.Assert.check(e._.isNumber(i)&&!isNaN(i),"Non-matching type"):e._.isBoolean(this.attributes[t])?e.Assert.check(e._.isBoolean(i)||void 0!==e.Utils.parseBooleanIfNotUndefined(i),"Non-matching type"):e.Utils.isNullOrUndefined(this.defaultAttributes[t])||e.Assert.check(typeof i==typeof this.defaultAttributes[t],"Non-matching type"))},i.prototype.parseToCorrectType=function(t,i){return e._.isNumber(this.attributes[t])?parseInt(i,10):e._.isBoolean(this.attributes[t])?e._.isBoolean(i)?i:e.Utils.parseBooleanIfNotUndefined(i):i},i.prototype.checkIfAttributeChanged=function(t,i){var n=this.attributes[t];return e._.isNumber(n)||e._.isString(n)||e._.isBoolean(n)?n!==i:e._.isArray(n)?!e.Utils.arrayEqual(n,i):e._.isObject(n)?!e.Utils.objectEqual(n,i):!0},i.eventTypes={preprocess:"preprocess",changeOne:"change:",change:"change",reset:"reset",all:"all"},i}(e.Ui.Component);t.Model=i}(t=e.Models||(e.Models={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(t){function i(n,o,s){var r=e._.extend({},i.defaultAttributes,o);t.call(this,n,i.ID,r,s)}return __extends(i,t),i.getFacetId=function(e,t){return void 0===t&&(t=!0),"f:"+e+(t?"":":not")},i.getFacetOperator=function(e){return"f:"+e+":operator"},i.getFacetLookupValue=function(e){return i.getFacetId(e)+":lookupvalues"},i.prototype.set=function(e,i,n){this.validate(e,i),t.prototype.set.call(this,e,i,n)},i.prototype.validate=function(t,n){t==i.attributesEnum.first&&e.Assert.isLargerOrEqualsThan(0,n)},i.prototype.getAttributes=function(){var t=this,i={};return e._.each(this.queryStateModel.attributes,function(n,o){e._.isObject(n)?e.Utils.objectEqual(n,t.queryStateModel.defaultAttributes[o])||(i[o]=n):n!=t.queryStateModel.defaultAttributes[o]&&(i[o]=n)}),i},i.ID="state",i.defaultAttributes={q:"",first:0,t:"",hd:"",hq:"",sort:"",tg:""},i.attributesEnum={q:"q",first:"first",t:"t",sort:"sort",hd:"hd",hq:"hq",tg:"tg"},i}(t.Model);t.QueryStateModel=i,e.Ui.CoveoJQuery.registerNamedMethod("state",function(t){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];e.Assert.exists(t);var s=e.Ui.Component.resolveBinding(t,i);if(e.Assert.exists(s),0==n.length)return s;if(1==n.length&&e.Utils.isNonEmptyString(n[0]))return s.get(n[0]);if(e._.isObject(n[0])){var r=n[0],a=e.$.extend({customAttribute:!0},n[1]);return s.setMultiple(r,a)}if(n.length>1){var l=n[0],u=n[1],a=e.$.extend({customAttribute:!0},n[2]);return e.Assert.isNonEmptyString(l),s.set(l,u,a)}})}(t=e.Models||(e.Models={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){var t=function(e){function t(i){e.call(this,i,t.ID,{})}return __extends(t,e),t.prototype.registerComponent=function(e,t){var i=this.attributes[e];void 0==i?this.attributes[e]=[t]:this.attributes[e].push(t)},t.ID="ComponentState",t}(e.Model);e.ComponentStateModel=t}(t=e.Models||(e.Models={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(t){function i(n,o){var s=e._.extend({},i.defaultAttributes,o);t.call(this,n,i.ID,s)}return __extends(i,t),i.ID="ComponentOptions",i.defaultAttributes={resultLink:void 0},i.attributesEnum={resultLink:"resultLink"},i}(t.Model);t.ComponentOptionsModel=i}(t=e.Models||(e.Models={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(t){function i(n,o,s,r){var a=this;t.call(this,n,i.ID),this._window=o,this.queryStateModel=s,this.queryController=r,this.ignoreNextHashChange=!1,this.initialHashChange=!1,this.willUpdateHash=!1,this._window=this._window||window,this.queryStateModel=s||this.resolveQueryStateModel(),this.queryController=r||this.resolveQueryController(),e.Assert.exists(this.queryStateModel),e.Assert.exists(this.queryController),e.$(this.element).on(e.Events.InitializationEvents.restoreHistoryState,function(){return a.updateModelFromHash()}),e.$(this.element).on(this.queryStateModel.getEventName(e.Models.Model.eventTypes.all),function(){return a.updateHashFromModel()}),e.$(this._window).on("hashchange",e.$.proxy(this.handleHashChange,this))}return __extends(i,t),i.prototype.handleHashChange=function(){return this.ignoreNextHashChange?(this.ignoreNextHashChange=!1,void 0):(this.updateModelFromHash(),this.queryController.executeQuery(),void 0)},i.prototype.updateHashFromModel=function(){var t=this;this.willUpdateHash||(e.Defer.defer(function(){var e=t.queryStateModel.getAttributes();t.setHashValues(e),t.logger.debug("Saving state to hash",e),t.willUpdateHash=!1}),this.willUpdateHash=!0)},i.prototype.updateModelFromHash=function(){var t=this,i={};e._.each(this.queryStateModel.attributes,function(e,n){var o=t.getHashValue(n);void 0==o&&(o=t.queryStateModel.defaultAttributes[n]),i[n]=o}),this.initialHashChange=!0,this.queryStateModel.setMultiple(i)},i.prototype.getHashValue=function(t){return e.Assert.isNonEmptyString(t),e.HashUtils.getValue(t,e.HashUtils.getHash(this._window))},i.prototype.setHashValues=function(t){var i="#"+e.HashUtils.encodeValues(t);this.ignoreNextHashChange=this._window.location.hash!=i,this.ignoreNextHashChange&&(this.initialHashChange?(this.initialHashChange=!1,this._window.location.replace(i)):this._window.location.hash=i)},i.ID="HistoryController",i}(e.Ui.Component);t.HistoryController=i}(t=e.Controllers||(e.Controllers={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function e(){this.searchAsYouType=!1}return e}(),n=function(t){function n(i,o){t.call(this,i,n.ID),this.options=o,this.showingExecutingQueryAnimation=!1,e.Assert.exists(i),e.Assert.exists(o),this.firstQuery=!0}return __extends(n,t),n.prototype.setEndpoint=function(e){this.overrideEndpoint=e,this.logger.debug("Endpoint set",e)},n.prototype.getEndpoint=function(){var t=this.overrideEndpoint||this.options.endpoint;return new e.Rest.SearchEndpointWithDefaultCallOptions(t,this.getCallOptions())},n.prototype.executeQuery=function(t){var n=this;e.ModalBox.close(!0),this.logger.debug("Executing new query",l);var t=e._.extend(new i,t);if(this.cancelAnyCurrentPendingQuery(),null!=t.beforeExecuteQuery&&t.beforeExecuteQuery(),this.isStandaloneSearchBox()&&!t.searchAsYouType)return this.redirectToSearchPage(),e.$.Deferred();this.showExecutingQueryAnimation();var o=e.$.Deferred();if(this.currentPendingQuery=o,this.firstQuery){var s=e.HashUtils.getValue("firstQueryCause",e.HashUtils.getHash());if(null!=s){var r=e.HashUtils.getValue("firstQueryMeta",e.HashUtils.getHash())||{};this.usageAnalytics.logSearchEvent(e.Ui.AnalyticsActionCauseList[s],r)}else e.Utils.isNonEmptyString(this.getBindings().queryStateModel.get("q"))?this.usageAnalytics.logSearchEvent(e.Ui.AnalyticsActionCauseList.searchFromLink,{}):this.usageAnalytics.logSearchEvent(e.Ui.AnalyticsActionCauseList.interfaceLoad,{})}e.$(this.element).trigger(e.Events.QueryEvents.newQuery,{deferred:o});var a=this.createQueryBuilder(t),l=a.build(),u=this.getEndpoint(),c=u.search(l);c.done(function(i){if(e.Assert.exists(i),n.firstQuery&&(n.firstQuery=!1),o===n.currentPendingQuery){n.logger.debug("Query results received",l,i),n.lastSearchUid=i.searchUid,e.QueryUtils.setIndexAndUidOnQueryResults(l,i,n.lastSearchUid),e.QueryUtils.setStateObjectOnQueryResults(n.queryStateModel.get(),i),e.QueryUtils.setTermsToHighlightOnQueryResults(l,i);var s={queryBuilder:a,query:l,results:i,searchAsYouType:t.searchAsYouType};n.preprocessResultsEvent(s);var r={queryBuilder:a,query:l,results:i,searchAsYouType:t.searchAsYouType,retryTheQuery:!1};if(0==i.results.length&&n.noResultEvent(r),r.retryTheQuery)n.executeQuery().done(function(e){o.resolve(e)}).fail(function(e,t){o.reject(e,t)});else{n.lastQueryBuilder=a,n.currentPendingQuery.resolve(i),n.currentPendingQuery=void 0;var u={queryBuilder:a,query:l,results:i,searchAsYouType:t.searchAsYouType};n.querySuccessEvent(u),e.Defer.defer(function(){n.deferredQuerySuccessEvent(u),n.hideExecutingQueryAnimation()})}}}),c.fail(function(e,i){if(o===n.currentPendingQuery){n.logger.error("Query triggered an error",l,i),n.currentPendingQuery.reject(i),n.currentPendingQuery=void 0;var s={queryBuilder:a,endpoint:u,query:l,error:i,searchAsYouType:t.searchAsYouType};n.queryError(s),n.hideExecutingQueryAnimation()}});var p={queryBuilder:a,query:l,deferred:o,searchAsYouType:t.searchAsYouType};return this.duringQueryEvent(p),o},n.prototype.deferExecuteQuery=function(t){var i=this;this.showExecutingQueryAnimation(),e.Defer.defer(function(){return i.executeQuery(t)})},n.prototype.fetchMore=function(t){var i=this;if(void 0!=this.currentPendingQuery)return void 0;var n=this.currentPendingQuery=e.$.Deferred(),o=new e.Ui.QueryBuilder;this.continueLastQueryBuilder(o,t);var s=o.build();n=this.getEndpoint().search(s);var r={queryBuilder:o,query:s,deferred:n,searchAsYouType:!1};return e.$(this.element).trigger(e.Events.QueryEvents.duringFetchMoreQuery,r),this.lastQueryBuilder=o,n.done(function(t){e.QueryUtils.setIndexAndUidOnQueryResults(s,t,i.lastSearchUid),e.QueryUtils.setStateObjectOnQueryResults(i.queryStateModel.get(),t),e.QueryUtils.setTermsToHighlightOnQueryResults(s,t),i.currentPendingQuery=void 0;var n={queryBuilder:o,query:s,results:t,searchAsYouType:!1};i.preprocessResultsEvent(n)}),n},n.prototype.isStandaloneSearchBox=function(){return e.Utils.isNonEmptyString(this.options.searchPageUri)},n.prototype.continueLastQueryBuilder=function(t,i){e.$.extend(t,this.lastQueryBuilder),t.firstResult=t.firstResult+t.numberOfResults,t.numberOfResults=i},n.prototype.createQueryBuilder=function(t){e.Assert.exists(t);var i=new e.Ui.QueryBuilder;i.firstResult=i.firstResult||0,i.numberOfResults=this.options.resultsPerPage,i.filterField=this.options.filterField,i.excerptLength=this.options.excerptLength,e.Utils.isNonEmptyString(this.options.hiddenExpression)&&i.advancedExpression.add(this.options.hiddenExpression),e.Utils.isNonEmptyString(this.options.timezone)&&(i.timezone=this.options.timezone);var n={queryBuilder:i,searchAsYouType:t.searchAsYouType};this.buildingQueryEvent(n);var o={queryBuilder:i,searchAsYouType:t.searchAsYouType};return this.doneBuildingQueryEvent(o),i},n.prototype.cancelAnyCurrentPendingQuery=function(){return e.Utils.exists(this.currentPendingQuery)?(this.logger.debug("Cancelling current pending query"),this.currentPendingQuery.reject(),this.currentPendingQuery=void 0,!0):!1},n.prototype.showExecutingQueryAnimation=function(){this.showingExecutingQueryAnimation||(e.$(this.root).addClass("coveo-executing-query"),this.showingExecutingQueryAnimation=!0)},n.prototype.hideExecutingQueryAnimation=function(){this.showingExecutingQueryAnimation&&(e.$(this.root).removeClass("coveo-executing-query"),this.showingExecutingQueryAnimation=!1)},n.prototype.redirectToSearchPage=function(){var t=this.queryStateModel.getAttributes(),i=this.usageAnalytics.getCurrentEventCause();null!=i&&(t.firstQueryCause=i);var n=this.usageAnalytics.getCurrentEventMeta();null!=n&&(t.firstQueryMeta=n),window.location.href=this.options.searchPageUri+"#"+e.HashUtils.encodeValues(t)},n.prototype.getCallOptions=function(){var t={options:{authentication:[]}};return e.$(this.element).trigger(e.Events.QueryEvents.buildingCallOptions,t),t.options},n.prototype.buildingQueryEvent=function(t){e.$(this.element).trigger(e.Events.QueryEvents.buildingQuery,t)},n.prototype.doneBuildingQueryEvent=function(t){e.$(this.element).trigger(e.Events.QueryEvents.doneBuildingQuery,t)},n.prototype.duringQueryEvent=function(t){e.$(this.element).trigger(e.Events.QueryEvents.duringQuery,t)},n.prototype.querySuccessEvent=function(t){e.$(this.element).trigger(e.Events.QueryEvents.querySuccess,t)},n.prototype.deferredQuerySuccessEvent=function(t){e.$(this.element).trigger(e.Events.QueryEvents.deferredQuerySuccess,t)},n.prototype.queryError=function(t){e.$(this.element).trigger(e.Events.QueryEvents.queryError,t)},n.prototype.preprocessResultsEvent=function(t){e.$(this.element).trigger(e.Events.QueryEvents.preprocessResults,t)},n.prototype.noResultEvent=function(t){e.$(this.element).trigger(e.Events.QueryEvents.noResults,t)},n.ID="QueryController",n}(e.Ui.Component);t.QueryController=n,e.Ui.CoveoJQuery.registerNamedMethod("executeQuery",function(t){e.Assert.exists(t);var i=e.Ui.Component.resolveBinding(t,n);e.Assert.exists(i),i.executeQuery()})}(t=e.Controllers||(e.Controllers={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){var t=function(){function e(){}return e.newQuery="newQuery",e.buildingQuery="buildingQuery",e.doneBuildingQuery="doneBuildingQuery",e.duringQuery="duringQuery",e.duringFetchMoreQuery="duringFetchMoreQuery",e.querySuccess="querySuccess",e.deferredQuerySuccess="deferredQuerySuccess",e.queryError="queryError",e.preprocessResults="preprocessResults",e.noResults="noResults",e.buildingCallOptions="buildingCallOptions",e}();e.QueryEvents=t}(t=e.Events||(e.Events={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){var t=function(){function e(){}return e.beforeInitialization="beforeInitialization",e.afterComponentsInitialization="afterComponentsInitialization",e.restoreHistoryState="restoreHistoryState",e.afterInitialization="afterInitialization",e}();e.InitializationEvents=t}(t=e.Events||(e.Events={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){var t=function(){function e(){}return e.newResultsDisplayed="newResultsDisplayed",e.newResultDisplayed="newResultDisplayed",e}();e.ResultListEvents=t}(t=e.Events||(e.Events={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){var t=function(){function e(){}return e.imageResultsLayoutComplete="imageResultsLayoutComplete",e}();e.ImageResultListEvents=t}(t=e.Events||(e.Events={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){var t=function(){function e(){}return e.enterOnSearchBox="enterOnSearchBox",e.quickViewLoaded="quickViewLoaded",e}();e.UserActionEvents=t}(t=e.Events||(e.Events={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){var t=function(){function e(){}return e.savePreferences="savePreferences",e.exitPreferencesWithoutSave="exitPreferencesWithoutSave",e}();e.PreferencesPanelEvents=t}(t=e.Events||(e.Events={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r,a){var l=this;void 0===a&&(a=window),i.call(this,o,n.ID),this.element=o,this.options=s,this.analyticsOptions=r,this.options=t.ComponentOptions.initComponentOptions(o,n,s),e.Assert.exists(o),e.Assert.exists(this.options),this.options.hideUntilFirstQuery&&this.showAndHideFirstQueryAnimation(),this.root=o,this.usageAnalytics=this.initializeAnalytics(),this.queryStateModel=new e.Models.QueryStateModel(o),this.componentStateModel=new e.Models.ComponentStateModel(o),this.componentOptionsModel=new e.Models.ComponentOptionsModel(o),this.queryController=new e.Controllers.QueryController(o,this.options),this.searchInterface=this;var u=this.queryStateModel.getEventName(e.Models.Model.eventTypes.preprocess);if(e.$(this.element).on(u,function(e,t){return l.handlePreprocessQueryStateModel(t)}),this.options.enableHistory?new e.Controllers.HistoryController(o,a,this.queryStateModel,this.queryController):e.$(this.element).on(e.Events.InitializationEvents.restoreHistoryState,function(){return l.queryStateModel.setMultiple(l.queryStateModel.defaultAttributes)}),this.options.enableDebugInfo){var c=t.Component.getComponentRef("Debug");c?setTimeout(function(){return new c(o)}):this.logger.warn("Options to enable debug component was true, but not present in the Coveo object (not compiled)")}}return __extends(n,i),n.prototype.initializeAnalytics=function(){var e=t.Component.getComponentRef("Analytics");return e?e.makeSingleton(this.element,this.analyticsOptions,this.getBindings()):new t.NoopAnalyticsClient},n.prototype.showAndHideFirstQueryAnimation=function(){var t=this;this.displayFirstQueryWaitAnimation(),e.$(this.element).one(e.Events.QueryEvents.querySuccess,function(){e._.defer(function(){return t.hideFirstQueryWaitAnimation()})}),e.$(this.element).on(e.Events.QueryEvents.queryError,function(){e._.defer(function(){return t.hideFirstQueryWaitAnimation()})})},n.prototype.displayFirstQueryWaitAnimation=function(){e.$(this.options.firstLoadingAnimation).remove(),e.$(this.element).addClass("coveo-waiting-for-first-query"),e.$(this.element).append(this.options.firstLoadingAnimation)},n.prototype.hideFirstQueryWaitAnimation=function(){e.$(this.options.firstLoadingAnimation).remove(),e.$(this.element).removeClass("coveo-waiting-for-first-query")},n.prototype.handlePreprocessQueryStateModel=function(t){var i=this.queryStateModel.get(e.Models.QueryStateModel.attributesEnum.tg),n=this.queryStateModel.get(e.Models.QueryStateModel.attributesEnum.t),o=i,s=n;void 0!==t.tg&&(t.tg=this.getTabGroupId(t.tg),o!=t.tg&&(t.t=t.t||e.Models.QueryStateModel.defaultAttributes.t,t.sort=t.sort||e.Models.QueryStateModel.defaultAttributes.sort,o=t.tg)),void 0!==t.t&&(t.t=this.getTabId(o,t.t),s!=t.t&&(t.sort=t.sort||e.Models.QueryStateModel.defaultAttributes.sort,s=t.t)),void 0!==t.sort&&(t.sort=this.getSort(s,t.sort))},n.prototype.getTabGroupId=function(i){var n=t.Component.getComponentRef("TabGroup");if(n){var o=this.searchInterface.components(n.ID);if(i!=e.Models.QueryStateModel.defaultAttributes.tg&&e._.any(o,function(e){return!e.disabled&&i==e.options.id}))return i;if(o.length>0)return o[0].options.id}return e.Models.QueryStateModel.defaultAttributes.tg},n.prototype.getTabId=function(i,n){var o=t.Component.getComponentRef("Tab"),s=t.Component.getComponentRef("TabGroup");if(o){var r=this.searchInterface.components(o.ID);if(s&&i!=e.Models.QueryStateModel.defaultAttributes.tg){var a=this.searchInterface.components(s.ID),l=e._.find(a,function(e){return i==e.options.id});if(n!=e.Models.QueryStateModel.defaultAttributes.t&&e._.any(r,function(e){return n==e.options.uniqueId&&l.isElementIncludedInTabGroup(e.element)}))return n;var u=e._.find(r,function(e){return l.isElementIncludedInTabGroup(e.element)});return null!=u?u.options.uniqueId:e.Models.QueryStateModel.defaultAttributes.t}if(n!=e.Models.QueryStateModel.defaultAttributes.t&&e._.any(r,function(e){return n==e.options.uniqueId}))return n;if(r.length>0)return r[0].options.uniqueId}return e.Models.QueryStateModel.defaultAttributes.t},n.prototype.getSort=function(i,n){var o=t.Component.getComponentRef("Sort");if(o){var s=this.searchInterface.components(o.ID),r=t.Component.getComponentRef("Tab");if(r&&i!=e.Models.QueryStateModel.defaultAttributes.t){var a=this.searchInterface.components(r.ID),l=e._.find(a,function(e){return i==e.options.uniqueId}),u=l.options.sort;if(n!=e.Models.QueryStateModel.defaultAttributes.sort&&e._.any(s,function(e){return l.isElementIncludedInTab(e.element)&&e.match(n)}))return n;if(null!=u)return u.toString();var c=e._.find(s,function(e){return l.isElementIncludedInTab(e.element)});return null!=c?c.options.sortCriteria[0].toString():e.Models.QueryStateModel.defaultAttributes.sort}if(n!=e.Models.QueryStateModel.defaultAttributes.sort&&e._.any(s,function(e){return e.match(n)}))return n;if(s.length>0)return s[0].options.sortCriteria[0].toString()}return e.Models.QueryStateModel.defaultAttributes.sort},n.prototype.attachComponent=function(e,t){this.components(e).push(t)},n.prototype.detachComponent=function(t,i){var n=this.components(t),o=e._.indexOf(n,i);o>-1&&n.splice(o,1)},n.prototype.components=function(e){return null==this.attachedComponents&&(this.attachedComponents={}),e in this.attachedComponents||(this.attachedComponents[e]=[]),this.attachedComponents[e]},n.ID="SearchInterface",n.options={searchPageUri:t.ComponentOptions.buildStringOption(),enableHistory:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),resultsPerPage:t.ComponentOptions.buildNumberOption({defaultValue:10}),excerptLength:t.ComponentOptions.buildNumberOption({defaultValue:200}),hiddenExpression:t.ComponentOptions.buildStringOption({defaultValue:""}),filterField:t.ComponentOptions.buildStringOption({defaultValue:""}),hideUntilFirstQuery:t.ComponentOptions.buildBooleanOption({defaultValue:!0}),firstLoadingAnimation:t.ComponentOptions.buildChildHtmlElementOption({childSelector:".coveo-first-loading-animation",defaultFunction:function(){return e.JQueryUtils.getBasicLoadingAnimation().get(0)}}),autoTriggerQuery:t.ComponentOptions.buildBooleanOption({defaultValue:!0}),endpoint:t.ComponentOptions.buildCustomOption(function(t){return null!=t&&t in e.Rest.SearchEndpoint.endpoints?e.Rest.SearchEndpoint.endpoints[t]:null},{defaultFunction:function(){return e.Rest.SearchEndpoint.endpoints["default"]}}),timezone:t.ComponentOptions.buildStringOption({defaultFunction:function(){return jstz.determine().name()}}),enableDebugInfo:t.ComponentOptions.buildBooleanOption({defaultValue:!0})},n}(t.Component);t.SearchInterface=i}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r){i.call(this,o,n.ID,r),this.element=o,this.options=s,this.options=t.ComponentOptions.initComponentOptions(o,n,s),this.bind.onRoot(e.Events.QueryEvents.buildingQuery,this.handleBuildingQuery),this.bind.onRoot(e.Events.QueryEvents.querySuccess,this.handleQuerySuccess),e.$(this.element).hide()}return __extends(n,i),n.prototype.handleBuildingQuery=function(e,t){var i={field:this.options.field,maximumNumberOfValues:0,computedFields:[{field:this.options.field,operation:this.options.operation}]};this.index=t.queryBuilder.groupByRequests.length,t.queryBuilder.groupByRequests.push(i)},n.prototype.handleQuerySuccess=function(t,i){if(e._.isNumber(this.index)&&0!=i.results.groupByResults.length){var n=i.results.groupByResults[this.index],o=n.globalComputedFieldResults[0];e.$(this.element).text(Globalize.format(o,this.options.format)),e.$(this.element).show()}else e.$(this.element).hide()},n.ID="Aggregate",n.options={field:t.ComponentOptions.buildStringOption(),operation:t.ComponentOptions.buildStringOption({defaultValue:"sum"}),format:t.ComponentOptions.buildStringOption({defaultValue:"c0"})},n}(t.Component);t.Aggregate=i,t.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function t(t){this.options=t,this.logger=new e.Logger(this)}return t.prototype.sendSearchEvents=function(e){e.length>0&&(this.logger.info("Logging analytics search events",e),this.sendEventToApi(e,"searches","searchEvents"))},t.prototype.sendDocumentViewEvent=function(t){e.Assert.exists(t),this.logger.info("Logging analytics document view",t),this.sendEventToApi(t,"click","clickEvent")},t.prototype.sendCustomEvent=function(t){e.Assert.exists(t),this.logger.info("Logging analytics custom event",t),this.sendEventToApi(t,"custom","customEvent")},t.prototype.getTopQueries=function(i){var n=e.QueryUtils.mergePath(this.options.serviceUrl,"/rest/"+(t.CUSTOM_ANALYTICS_VERSION||t.DEFAULT_ANALYTICS_VERSION)+"/stats/topQueries");return this.getFromService(n,i)},t.prototype.sendEventToApi=function(i,n,o){var s=e.QueryUtils.mergePath(this.options.serviceUrl,"/rest/"+(t.CUSTOM_ANALYTICS_VERSION||t.DEFAULT_ANALYTICS_VERSION)+"/analytics/"+n);return s=this.appendUrlParamSign(s),s+=o+"="+encodeURIComponent(JSON.stringify(i)),this.options.token&&""!=this.options.token&&(s+="&access_token="+encodeURIComponent(this.options.token)),e.Utils.isNonEmptyString(this.options.userId)&&(s+="&user="+encodeURIComponent(this.options.userId)),e.$.ajax({url:s,dataType:"jsonp"})},t.prototype.appendUrlParamSign=function(e){return"?"==e.charAt(e.length-1)?e:e+"?"},t.prototype.getFromService=function(t,i){var n=this.options.token&&""!=this.options.token?e.$.extend({access_token:this.options.token},i):i;return e.$.ajax({url:this.appendUrlParamSign(t)+this.buildQueryStringFromParam(n),dataType:"jsonp"})},t.prototype.buildQueryStringFromParam=function(t){var i=e._.map(e._.pairs(t),function(e){return e[0]+"="+e[1]});return i.join("&")},t.DEFAULT_ANALYTICS_URI="https://usageanalytics.coveo.com",t.DEFAULT_ANALYTICS_VERSION="v10",t.CUSTOM_ANALYTICS_VERSION=void 0,t}();t.AnalyticsEndpoint=i}(t=e.Rest||(e.Rest={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function i(t,i,n,o){this._root=t,this._endpoint=i,this._templateSearchEvent=n,this._sendToCloud=o,this.searchDeferred=[],this.searchEvents=[],this.results=[],this._cancelled=!1,this._finished=!1,e.Assert.exists(t),e.Assert.exists(i),e.Assert.exists(n),this.handler=e.$.proxy(this._handleDuringQuery,this),e.$(t).on(e.Events.QueryEvents.duringQuery+" "+e.Events.QueryEvents.duringFetchMoreQuery,this.handler)}return i.prototype.getEventCause=function(){return this._templateSearchEvent.actionCause},i.prototype.getEventMeta=function(){return this._templateSearchEvent.customData},i.prototype.cancel=function(){this._stopRecording(),this._cancelled=!0},i.prototype._handleDuringQuery=function(i,n){var o=this;e.Assert.check(!this._finished),e.Assert.check(!this._cancelled),this.searchDeferred.push(n.deferred);var s=t.Component.get(i.target,t.SearchInterface);e.Assert.exists(s);var r=t.Component.get(i.target,e.Controllers.QueryController);e.Assert.exists(r),n.deferred.done(function(t){e.Assert.exists(t),e.Assert.check(!o._finished);var i=e._.extend({},o._templateSearchEvent);o.fillSearchEvent(i,s,n.query,t),o.searchEvents.push(i),o.results.push(t)}).always(function(){var t=e._.indexOf(o.searchDeferred,n.deferred);o.searchDeferred.splice(t,1),0==o.searchDeferred.length&&o.flush()})},i.prototype._stopRecording=function(){this.handler&&(e.$(this._root).off(e.Events.QueryEvents.duringQuery+" "+e.Events.QueryEvents.duringFetchMoreQuery,this.handler),this.handler=void 0)},i.prototype.flush=function(){var t=this;this._cancelled||(this._stopRecording(),this._finished=!0,e.Assert.check(this.searchEvents.length==this.results.length),e.Defer.defer(function(){t._sendToCloud&&t._endpoint.sendSearchEvents(t.searchEvents);var i=e._.map(t.searchEvents,function(t){return e.Rest.APIAnalyticsBuilder.convertSearchEventToAPI(t)});e.$(t._root).trigger(e.Events.AnalyticsEvents.searchEvent,{searchEvents:i})}))},i.prototype.fillSearchEvent=function(t,i,n,o){e.Assert.exists(t),e.Assert.exists(i),e.Assert.exists(n),e.Assert.exists(o);var s=i.queryStateModel.get(e.Models.QueryStateModel.attributesEnum.q);t.originLevel2=t.originLevel2||i.queryStateModel.get("t")||"default",t.queryText=s||n.q||"",t.advancedQuery=n.aq||"",t.didYouMean=n.enableDidYouMean,t.results=this.convertResults(o),t.responseTime=o.duration,t.pageNumber=n.firstResult/n.numberOfResults,t.resultsPerPage=n.numberOfResults,t.facets=this.convertFacets(),t.searchQueryUid=o.searchUid},i.prototype.convertResults=function(t){e.Assert.exists(t);var i=[];return e.$.each(t.results,function(e,t){i.push({clickUri:t.clickUri,documentUri:t.uri,documentUriHash:t.raw.sysurihash})}),i},i.prototype.convertFacets=function(){var i=this,n=[],o=t.Component.getComponentRef("Facet");return o&&e.$.each(e.$(this.getFacetSelector(o)),function(t,o){var o=e.$(o).coveo();o.disabled||n.push({fieldName:o.options.field,mode:o.options.useAnd?"and":"or",name:o.options.title,sort:o.options.sortCriteria,selections:i.convertFacetValues(o)})}),n},i.prototype.getFacetSelector=function(e){return["."+t.Component.computeCssClassNameForType(e.ID),"."+t.Component.computeCssClassNameForType(e.ID)].join(", ")},i.prototype.convertFacetValues=function(t){return e.Assert.exists(t),this.convertClassicFacetValues(t)},i.prototype.convertClassicFacetValues=function(t){var i=[];return t.disabled||(e.$.each(t.getSelectedValues(),function(e,t){i.push({entryName:t,status:"INCLUDE"})}),e.$.each(t.getExcludedValues(),function(e,t){i.push({entryName:t,status:"EXCLUDE"})})),i},i}();t.PendingSearchEvent=i}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(t){function i(i,n,o,s){t.call(this,i,n,o,s),this._root=i,this._endpoint=n,this._templateSearchEvent=o,this._sendToCloud=s,this.delayBeforeSending=5e3,this.armBatchDelay=50,this.beforeUnloadHandler=e.$.proxy(this.onWindowUnload,this),e.$(window).on("beforeunload",this.beforeUnloadHandler)}return __extends(i,t),i.prototype._handleDuringQuery=function(i,n){var o=this;this.toSendRightNow=function(){o.isCancelledOrFinished()||t.prototype._handleDuringQuery.call(o,i,n)},e._.delay(function(){o.toSendRightNow()},this.delayBeforeSending)},i.prototype.sendRightNow=function(){this.toSendRightNow&&this.toSendRightNow()},i.prototype._stopRecording=function(){t.prototype._stopRecording.call(this),this.beforeUnloadHandler&&(e.$(window).off("beforeunload",this.beforeUnloadHandler),this.beforeUnloadHandler=void 0)},i.prototype.onWindowUnload=function(){this.isCancelledOrFinished()||(this.armBatchDelay=0,this.sendRightNow())},i.prototype.isCancelledOrFinished=function(){return this._cancelled?!0:this._finished?(this.cancel(),!0):!1},i}(t.PendingSearchEvent);t.PendingSearchAsYouTypeSearchEvent=i}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){var t=function(){function e(){}return e.searchEvent="analyticsSearchEvent",e.documentViewEvent="analyticsDocumentViewEvent",e.customEvent="analyticsCustomEvent",e.changeAnalyticsCustomData="changeAnalyticsCustomData",e}();e.AnalyticsEvents=t}(t=e.Events||(e.Events={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function t(){}return t.convertSearchEventToAPI=function(e){var i={advancedQuery:e.advancedQuery,customMetadatas:e.customData,device:e.device,didYouMean:e.didYouMean,facets:t.convertFacetToAPI(e.facets),language:e.language,pageNumber:e.pageNumber,queryText:e.queryText,responseTime:e.responseTime,results:t.convertResultsToAPI(e.results),resultsPerPage:e.resultsPerPage,searchHub:e.originLevel1,searchInterface:e.originLevel2,searchQueryUid:e.searchQueryUid,type:e.actionType,actionCause:e.actionCause};return i},t.convertFacetToAPI=function(i){var n=e._.map(i,function(e){return{fieldName:e.fieldName,mode:e.mode,name:e.name,selections:t.convertFacetSelectionToAPI(e.selections),sort:e.sort}});return n},t.convertFacetSelectionToAPI=function(t){var i=e._.map(t,function(e){return{entryName:e.entryName,status:e.status}});return i},t.convertResultsToAPI=function(t){var i=e._.map(t,function(e){return{clickUri:e.clickUri,documentUri:e.documentUri,documentUriHash:e.documentUriHash}});return i},t.convertDocumentViewToAPI=function(e){var t={collectionName:e.collectionName,device:e.device,documentPosition:e.documentPosition,title:e.customMetadata1,documentClickUri:e.customMetadata2,documentUri:e.documentUri,documentUriHash:e.documentUriHash,language:e.language,responseTime:e.responseTime,searchHub:e.originLevel1,searchInterface:e.originLevel2,searchQueryUid:e.searchQueryUid,sourceName:e.sourceName,viewMethod:e.viewMethod,customMetadatas:e.customData,actionCause:e.actionCause};return t},t.convertCustomEventToAPI=function(e){var t={actionCause:e.actionCause,actionType:e.actionType,device:e.device,language:e.language,responseTime:e.responseTime,searchHub:e.originLevel1,searchInterface:e.originLevel2,customMetadatas:e.customData};return t},t}();t.APIAnalyticsBuilder=i}(t=e.Rest||(e.Rest={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function i(t,i,n,o){this.endpoint=t,this.rootElement=i,this.originLevel1=n,this.sendToCloud=o,this.isContextual=!1,this.language=String.locale,this.device=e.DeviceUtils.getDeviceName(),e.Assert.exists(t),e.Assert.exists(i),e.Assert.isNonEmptyString(this.language),e.Assert.isNonEmptyString(this.device),e.Assert.isNonEmptyString(this.originLevel1)
}return i.prototype.isActivated=function(){return!0},i.prototype.getCurrentEventCause=function(){return null!=this.pendingSearchEvent?this.pendingSearchEvent.getEventCause():null!=this.pendingSearchAsYouTypeSearchEvent?this.pendingSearchAsYouTypeSearchEvent.getEventCause():null},i.prototype.getCurrentEventMeta=function(){return null!=this.pendingSearchEvent?this.pendingSearchEvent.getEventMeta():null!=this.pendingSearchAsYouTypeSearchEvent?this.pendingSearchAsYouTypeSearchEvent.getEventMeta():null},i.prototype.logSearchEvent=function(e,t){var i=this.buildMetaObject(e,t);this.pushSearchEvent(e,i)},i.prototype.logSearchAsYouType=function(e,t){var i=this.buildMetaObject(e,t);this.pushSearchAsYouTypeEvent(e,i)},i.prototype.logClickEvent=function(e,t,i,n){var o=this.buildMetaObject(e,t);this.pushClickEvent(e,o,i,n)},i.prototype.logCustomEvent=function(e,t,i){var n=this.buildMetaObject(e,t);this.pushCustomEvent(e,n,i)},i.prototype.getTopQueries=function(e){return this.endpoint.getTopQueries(e)},i.prototype.sendAllPendingEvents=function(){this.pendingSearchAsYouTypeSearchEvent&&this.pendingSearchAsYouTypeSearchEvent.sendRightNow()},i.prototype.pushCustomEvent=function(t,i,n){var o=this,s=this.buildCustomEvent(t,i,n);this.triggerChangeAnalyticsCustomData("CustomEvent",i,s),this.checkToSendAnyPendingSearchAsYouType(t),e.Defer.defer(function(){o.sendToCloud&&o.endpoint.sendCustomEvent(s),e.$(o.rootElement).trigger(e.Events.AnalyticsEvents.customEvent,{customEvent:e.Rest.APIAnalyticsBuilder.convertCustomEventToAPI(s)})})},i.prototype.pushSearchEvent=function(i,n){var o=this;if(e.Assert.exists(i),this.pendingSearchEvent&&this.pendingSearchEvent.getEventCause()!==i.name&&(this.pendingSearchEvent._stopRecording(),this.pendingSearchEvent=null),this.checkToSendAnyPendingSearchAsYouType(i),!this.pendingSearchEvent){var s=this.buildSearchEvent(i,n);this.triggerChangeAnalyticsCustomData("SearchEvent",n,s);var r=this.pendingSearchEvent=new t.PendingSearchEvent(this.rootElement,this.endpoint,s,this.sendToCloud);e.Defer.defer(function(){o.pendingSearchEvent=void 0,r._stopRecording()})}},i.prototype.checkToSendAnyPendingSearchAsYouType=function(e){this.eventIsNotRelatedToSearchBox(e.name)?this.sendAllPendingEvents():this.cancelAnyPendingSearchAsYouTypeEvent()},i.prototype.pushSearchAsYouTypeEvent=function(e,i){this.cancelAnyPendingSearchAsYouTypeEvent();var n=this.buildSearchEvent(e,i);this.triggerChangeAnalyticsCustomData("SearchEvent",i,n),this.pendingSearchAsYouTypeSearchEvent=new t.PendingSearchAsYouTypeSearchEvent(this.rootElement,this.endpoint,n,this.sendToCloud)},i.prototype.pushClickEvent=function(t,i,n,o){var s=this,r=this.buildClickEvent(t,i,n,o);this.triggerChangeAnalyticsCustomData("ClickEvent",i,r),e.Assert.isNonEmptyString(r.searchQueryUid),e.Assert.isNonEmptyString(r.collectionName),e.Assert.isNonEmptyString(r.sourceName),e.Assert.isNumber(r.documentPosition),e.Defer.defer(function(){s.sendToCloud&&s.endpoint.sendDocumentViewEvent(r),e.$(s.rootElement).trigger(e.Events.AnalyticsEvents.documentViewEvent,{documentViewEvent:e.Rest.APIAnalyticsBuilder.convertDocumentViewToAPI(r)})})},i.prototype.buildAnalyticsEvent=function(t,i){return{actionCause:t.name,actionType:t.type,device:this.device,language:this.language,responseTime:void 0,originLevel1:this.originLevel1,originLevel2:this.resolveActiveTabFromElement(this.rootElement),customData:e._.keys(i.metaDataAsString).length>0?i.metaDataAsString:void 0,customMetadata1:i.metaDataAsNumber.customMetadata1,customMetadata2:i.metaDataAsNumber.customMetadata2,customMetadata3:i.metaDataAsNumber.customMetadata3,customMetadata4:i.metaDataAsNumber.customMetadata4,customMetadata5:i.metaDataAsNumber.customMetadata5,userAgent:navigator.userAgent}},i.prototype.buildSearchEvent=function(t,i){return this.merge(this.buildAnalyticsEvent(t,i),{mobile:e.DeviceUtils.isMobileDevice(),queryText:void 0,advancedQuery:void 0,results:void 0,resultsPerPage:void 0,searchQueryUid:void 0,pageNumber:void 0,didYouMean:void 0,facets:void 0,contextual:this.isContextual})},i.prototype.buildClickEvent=function(e,t,i,n){return this.merge(this.buildAnalyticsEvent(e,t),{searchQueryUid:i.queryUid,documentUri:i.uri,originLevel2:this.resolveActiveTabFromElement(n)||"default",documentUriHash:i.raw.sysurihash,collectionName:i.raw.syscollection,sourceName:i.raw.syssource,documentPosition:i.index,responseTime:0,viewMethod:e.name})},i.prototype.buildCustomEvent=function(e,t,i){return this.merge(this.buildAnalyticsEvent(e,t),{eventType:e.type,eventValue:e.name,originLevel2:this.resolveActiveTabFromElement(i)||"default",responseTime:0})},i.prototype.buildMetaObject=function(t,i){var n={metaDataAsNumber:{},metaDataAsString:{}};return e._.each(i,function(e,i){if(void 0!=t.metaMap&&void 0!=t.metaMap[i]){var o=t.metaMap[i];n.metaDataAsNumber["customMetadata"+o.toString()]=e}n.metaDataAsString[i]=e}),n.metaDataAsString.JSUIVersion=e.version.lib+";"+e.version.product,n},i.prototype.cancelAnyPendingSearchAsYouTypeEvent=function(){this.pendingSearchAsYouTypeSearchEvent&&(this.pendingSearchAsYouTypeSearchEvent.cancel(),this.pendingSearchAsYouTypeSearchEvent=void 0)},i.prototype.resolveActiveTabFromElement=function(t){e.Assert.exists(t);var i=this.resolveQueryStateModel(t);return i&&i.get(e.Models.QueryStateModel.attributesEnum.t)},i.prototype.resolveQueryStateModel=function(i){return t.Component.resolveBinding(i,e.Models.QueryStateModel)},i.prototype.eventIsNotRelatedToSearchBox=function(e){return e!==t.AnalyticsActionCauseList.searchboxSubmit.name&&e!==t.AnalyticsActionCauseList.searchboxClear.name},i.prototype.triggerChangeAnalyticsCustomData=function(t,i,n){var o={language:n.language,originLevel1:n.originLevel1,originLevel2:n.originLevel2,originLevel3:n.originLevel3},s=e.$.extend({},{type:t,metaObject:i},o);e.$(this.rootElement).trigger(e.Events.AnalyticsEvents.changeAnalyticsCustomData,s),n.language=s.language,n.originLevel1=s.originLevel1,n.originLevel2=s.originLevel2,n.originLevel3=s.originLevel3,n.customData=i.metaDataAsString,e._.each(e._.keys(i.metaDataAsNumber),function(e){n[e]=i.metaDataAsNumber[e]})},i.prototype.merge=function(t,i){return e.$.extend({},t,i)},i}();t.LiveAnalyticsClient=i}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function t(e){void 0===e&&(e=[]),this.analyticsClients=e,this.isContextual=!1}return t.prototype.isActivated=function(){return e._.some(this.analyticsClients,function(e){return e.isActivated()})},t.prototype.getCurrentEventCause=function(){return e._.find(e._.map(this.analyticsClients,function(e){return e.getCurrentEventCause()}),function(e){return null!=e})},t.prototype.getCurrentEventMeta=function(){return e._.find(e._.map(this.analyticsClients,function(e){return e.getCurrentEventMeta()}),function(e){return null!=e})},t.prototype.logSearchEvent=function(t,i){e._.each(this.analyticsClients,function(e){return e.logSearchEvent(t,i)})},t.prototype.logSearchAsYouType=function(t,i){e._.each(this.analyticsClients,function(e){return e.logSearchEvent(t,i)})},t.prototype.logClickEvent=function(t,i,n,o){e._.each(this.analyticsClients,function(e){return e.logClickEvent(t,i,n,o)})},t.prototype.logCustomEvent=function(t,i,n){e._.each(this.analyticsClients,function(e){return e.logCustomEvent(t,i,n)})},t.prototype.getTopQueries=function(t){var i=this,n=e.$.Deferred(),o=[];return e._.forEach(this.analyticsClients,function(e){e.getTopQueries(t).done(function(e){o[r]=e;for(var s=!0,r=0;r<i.analyticsClients.length&&s;r++)s=s&&void 0!=o[r];s&&n.resolve(i.mergeTopQueries(o,t.pageSize))})}),n},t.prototype.sendAllPendingEvents=function(){e._.each(this.analyticsClients,function(e){return e.sendAllPendingEvents()})},t.prototype.mergeTopQueries=function(t,i){var n=[];return e._.each(t,function(t){return e._.each(t,function(e){return n.push(e)})}),n.length=Math.min(n.length,i),n},t}();t.MultiAnalyticsClient=i}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r){if(void 0===s&&(s={}),i.call(this,o,n.ID,r),this.element=o,this.options=s,this.options=t.ComponentOptions.initComponentOptions(o,n,s),null==this.options.token){var a=e.Rest.SearchEndpoint.endpoints["default"];a&&(this.options.token=a.options.accessToken)}this.initializeAnalyticsClient(),e.Assert.exists(this.client)}return __extends(n,i),n.makeSingleton=function(i,o){if(!n.analyticsSingleton){var s=t.Component.computeSelectorForType(n.ID),r=e.$(i),a=r.find(s).add(r.closest(s));n.analyticsSingleton=1==a.length?new n(a.get(0),o).client:a.length>1?new t.MultiAnalyticsClient(e._.map(a,function(e){return new n(e,o).client})):new t.NoopAnalyticsClient}return n.analyticsSingleton},n.prototype.initializeAnalyticsClient=function(){if(e.Utils.isNonEmptyString(this.options.endpoint)){var i=new e.Rest.AnalyticsEndpoint({token:this.options.token,userId:this.options.user,serviceUrl:this.options.endpoint});this.client=new t.LiveAnalyticsClient(i,this.root||this.element,this.options.searchHub,this.options.sendToCloud)}else this.client=new t.NoopAnalyticsClient},n.ID="Analytics",n.options={user:t.ComponentOptions.buildStringOption(),token:t.ComponentOptions.buildStringOption(),endpoint:t.ComponentOptions.buildStringOption({defaultValue:e.Rest.AnalyticsEndpoint.DEFAULT_ANALYTICS_URI}),searchHub:t.ComponentOptions.buildStringOption({defaultValue:"default"}),sendToCloud:t.ComponentOptions.buildBooleanOption({defaultValue:!0})},n}(t.Component);t.Analytics=i}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r){void 0===s&&(s={}),i.call(this,o,n.ID,r),this.element=o,this.options=s,this.options=t.ComponentOptions.initComponentOptions(o,n,s),this.bind.onRoot(e.Events.QueryEvents.buildingCallOptions,this.handleBuildingCallOptions),this.bind.onRoot(e.Events.QueryEvents.queryError,this.handleQueryError)}return __extends(n,i),n.prototype.getCssClass=function(){return"coveo-authentication-provider"},n.prototype.getMenuItems=function(){var e=this;return[{text:t.l("Reauthenticate",this.options.caption),onOpen:function(){return e.authenticateWithProvider()},onClose:function(){return 0}}]},n.prototype.handleBuildingCallOptions=function(e,t){t.options.authentication.push(this.options.name)},n.prototype.handleQueryError=function(e,t){t.error.provider==this.options.name&&this.authenticateWithProvider()},n.prototype.authenticateWithProvider=function(){this.options.useIFrame?this.useIFrameToAuthenticate():this.redirectToAuthenticationProvider()},n.prototype.redirectToAuthenticationProvider=function(){this.logger.info("Redirecting to authentication provider "+this.options.name),window.location.href=this.getAuthenticationProviderUriForRedirect()},n.prototype.useIFrameToAuthenticate=function(){var t=this;this.logger.info("Using iframe to retrieve authentication for provider "+this.options.name);var i,n=e.$("<iframe/>").attr("src",this.getAuthenticationProviderUriForIFrame());i=this.options.showIFrame?this.createPopupForVisibleIFrame(n):this.createPopupForWaitMessage(n),e.$(window).one("message",function(){i.close(),n.detach(),t.logger.info("Got authentication for provider "+t.options.name+"; retrying query."),t.queryController.executeQuery()})},n.prototype.createPopupForWaitMessage=function(i){var n=e.$("<div/>").addClass("coveo-waiting-for-authentication-popup").append(e.JQueryUtils.getBasicLoadingDots());return i.hide().appendTo(document.body),e.ModalBox.open(n,{title:t.l("Authenticating",this.options.caption)})},n.prototype.createPopupForVisibleIFrame=function(t){var i=e.$("<div/>");return t.addClass("coveo-authentication-iframe").appendTo(i),e.ModalBox.open(i,{className:"coveo-authentication-popup"})},n.prototype.getAuthenticationProviderUriForRedirect=function(){return this.queryController.getEndpoint().getAuthenticationProviderUri(this.options.name,window.location.href,void 0)},n.prototype.getAuthenticationProviderUriForIFrame=function(){return this.queryController.getEndpoint().getAuthenticationProviderUri(this.options.name,void 0,"success")},n.ID="AuthenticationProvider",n.options={name:t.ComponentOptions.buildStringOption(),caption:t.ComponentOptions.buildStringOption({postProcessing:function(e,t){return e||t.name}}),useIFrame:t.ComponentOptions.buildBooleanOption({defaultValue:!1,attrName:"data-use-iframe"}),showIFrame:t.ComponentOptions.buildBooleanOption({defaultValue:!0,attrName:"data-show-iframe"})},n}(t.Component);t.AuthenticationProvider=i,t.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){var t=function(){function e(){}return e.populateBreadcrumb="populateBreadcrumb",e.clearBreadcrumb="clearBreadcrumb",e.redrawBreadcrumb="redrawBreadcrumb",e}();e.BreadcrumbEvents=t}(t=e.Events||(e.Events={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r){var a=this;i.call(this,o,n.ID,r),this.element=o,this.options=s,this.options=t.ComponentOptions.initComponentOptions(o,n,s),e.$(this.root).on(e.Events.QueryEvents.querySuccess,function(){return a.handleQuerySuccess()}),e.$(this.root).on(e.Events.BreadcrumbEvents.redrawBreadcrumb,function(){return a.redrawBreadcrumb()}),e.$(this.element).hide()}return __extends(n,i),n.prototype.drawBreadcrumb=function(i){var n=this;this.element.innerHTML="";var o=e.$("<div />").addClass("coveo-clear-all");e.$(this.element).fastToggle(0!=i.length),e.DeviceUtils.isMobileDevice()||e.$(this.element).append(o);for(var s=0;s<i.length;s++)e.$(i[s].element).addClass("item").appendTo(this.element);e.DeviceUtils.isMobileDevice()&&e.$(this.element).append(o),o.attr("title",t.l("ClearAllFilters")),o.append(e.$("<div />").addClass("coveo-icon")),this.bind.fastClick(o,function(){n.clearBreadcrumbs()})},n.prototype.redrawBreadcrumb=function(){this.lastBreadcrumbs?this.drawBreadcrumb(this.lastBreadcrumbs):this.drawBreadcrumb(this.getBreadcrumbs())},n.prototype.handleQuerySuccess=function(){this.drawBreadcrumb(this.getBreadcrumbs())},n.prototype.getBreadcrumbs=function(){var t={breadcrumbs:[]};return e.$(this.root).trigger(e.Events.BreadcrumbEvents.populateBreadcrumb,t),this.logger.debug("Retrieved breadcrumbs",t.breadcrumbs),this.lastBreadcrumbs=t.breadcrumbs,t.breadcrumbs},n.prototype.clearBreadcrumbs=function(){var i=this,n={};e.$(this.root).trigger(e.Events.BreadcrumbEvents.clearBreadcrumb,n),this.logger.debug("Clearing breadcrumbs"),this.queryController.deferExecuteQuery({beforeExecuteQuery:function(){return i.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.breadcrumbResetAll,{})}})},n.ID="Breadcrumb",n.options={},n}(t.Component);t.Breadcrumb=i,t.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function t(i,n){void 0===n&&(n=""),this.sort=i,this.direction=n,e.Assert.isNonEmptyString(i),e.Assert.check(e._.contains(t.validSorts,i)||t.sortIsField(i)),t.sortNeedsDirection(i)?e.Assert.check(e._.contains(t.validDirections,n)):e.Assert.check(""==n)}return t.prototype.putInQueryBuilder=function(i){e.Assert.exists(i),t.sortIsField(this.sort)?(i.sortCriteria="field"+this.direction,i.sortField=this.sort):i.sortCriteria=""!=this.direction?this.sort+this.direction:this.sort},t.prototype.getValueFromResult=function(i){return e.Assert.exists(i),t.sortIsField(this.sort)?(e.Assert.stringStartsWith(this.sort,"@"),i.raw[this.sort.substr(1)]):"date"==this.sort?i.raw.sysdate:(e.Assert.fail("Cannot retrieve value: "+this.sort),void 0)},t.prototype.toString=function(){return e.Utils.isNonEmptyString(this.direction)?this.sort+" "+this.direction:this.sort},t.prototype.equals=function(t){return e.Assert.exists(t),t.sort==this.sort&&t.direction==this.direction},t.parse=function(i){e.Assert.isNonEmptyString(i);var n=i.split(" ");return new t(n[0],n[1])},t.sortIsField=function(e){return"@"==e.substr(0,1)},t.sortNeedsDirection=function(i){return e._.contains(t.sortsNeedingDirection,i)||t.sortIsField(i)},t.validSorts=["relevancy","date","qre"],t.sortsNeedingDirection=["date"],t.validDirections=["ascending","descending"],t}();t.SortCriteria=i}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r){i.call(this,o,n.ID,r),this.element=o,this.options=s,this.iconTemplate=e._.template("<span class='coveo-icon <%= icon %>'></span>"),this.tabTemplate=e._.template("<span><%= caption %></span>"),this.isFirstQuery=!0,this.options=t.ComponentOptions.initComponentOptions(o,n,s),e.$(this.root).on(e.Events.QueryEvents.buildingQuery,e.$.proxy(this.handleBuildingQuery,this));var a=this.queryStateModel.getEventName(e.Models.Model.eventTypes.changeOne+e.Models.QueryStateModel.attributesEnum.t);e.$(this.root).on(a,e.$.proxy(this.handleQueryStateChanged,this)),this.render(),e.$(this.element).fastClick(e.$.proxy(this.handleClick,this))}return __extends(n,i),n.prototype.select=function(){this.queryStateModel.setMultiple({t:this.options.uniqueId,sort:e.Models.QueryStateModel.defaultAttributes.sort})},n.prototype.handleClick=function(i){var n=this;i.preventDefault(),this.select(),e.DeviceUtils.isMobileDevice()&&e.MobileUtils.removeToggleClassOnSearchInterface(),this.queryController.deferExecuteQuery({beforeExecuteQuery:function(){return n.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.interfaceChange,{interfaceChangeTo:n.options.uniqueId})}})},n.prototype.render=function(){var t=this.options.icon;""!=t&&e.$(this.element).prepend(this.iconTemplate({icon:t}));var i=this.options.caption;e.Utils.isNonEmptyString(i)&&e.$(this.element).append(this.tabTemplate({caption:i}))},n.prototype.handleBuildingQuery=function(t,i){e.Assert.exists(i),this.isFirstQuery=!1,this.isSelected()&&e.Utils.isNonEmptyString(this.options.expression)&&(this.options.constant?i.queryBuilder.constantExpression.add(this.options.expression):i.queryBuilder.advancedExpression.add(this.options.expression))},n.prototype.handleQueryStateChanged=function(t,i){e.Assert.exists(i),this.isSelected()?(e.$(this.element).addClass("coveo-selected"),this.queryController.setEndpoint(this.options.endpoint),this.showAndHideAppropriateElements()):e.$(this.element).removeClass("coveo-selected")},n.prototype.isSelected=function(){var t=this.queryStateModel.get(e.Models.QueryStateModel.attributesEnum.t);return t==this.options.uniqueId},n.prototype.showAndHideAppropriateElements=function(){var t=this,i=[],n=[];e._.each(e.$(this.root).find("[data-tab],[data-tab-not]"),function(e){t.isElementIncludedInTab(e)?(t.toggleAllComponentsUnder(e,!0),i.push(e)):(t.toggleAllComponentsUnder(e,!1),n.push(e))}),e.$(this.root).one(e.Events.QueryEvents.querySuccess,function(){e._.each(i,function(t){return e.$(t).removeClass("coveo-tab-disabled")}),e._.each(n,function(t){return e.$(t).addClass("coveo-tab-disabled")})})},n.prototype.isElementIncludedInTab=function(t){e.Assert.exists(t);var i=this.splitListOfTabs(e.$(t).attr("data-tab")),n=this.splitListOfTabs(e.$(t).attr("data-tab-not"));return e.Assert.check(!(0!=i.length&&0!=n.length),"You cannot both explicity include and exclude an element from tabs"),0!=i.length&&-1!=e._.indexOf(i,this.options.uniqueId)||0!=n.length&&-1==e._.indexOf(n,this.options.uniqueId)||0==i.length&&0==n.length},n.prototype.splitListOfTabs=function(t){return e.Utils.exists(t)?e._.map(t.split(","),function(t){return e.Utils.trim(t)}):[]},n.prototype.toggleAllComponentsUnder=function(i,n){e.Assert.exists(i),e.$(i).find("*").addBack().each(function(e,i){var o=t.Component.get(i,void 0,!0);o&&(n?o.enable():o.disable())})},n.prototype.enable=function(){i.prototype.enable.call(this),e.$(this.element).css("display","")},n.prototype.disable=function(){i.prototype.disable.call(this),e.$(this.element).css("display","none")},n.ID="Tab",n.options={uniqueId:t.ComponentOptions.buildStringOption({attrName:"data-id",required:!0}),icon:t.ComponentOptions.buildIconOption(),caption:t.ComponentOptions.buildLocalizedStringOption(),expression:t.ComponentOptions.buildStringOption(),endpoint:t.ComponentOptions.buildCustomOption(function(t){return null!=t?e.Rest.SearchEndpoint.endpoints[t]:null}),sort:t.ComponentOptions.buildCustomOption(function(e){return null!=e?t.SortCriteria.parse(e):null}),constant:t.ComponentOptions.buildBooleanOption({defaultValue:!0})},n}(t.Component);t.Tab=i,t.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r){var a=this;i.call(this,o,n.ID,r),this.element=o,this.options=s,this.options=t.ComponentOptions.initComponentOptions(o,n,s);var l=this.queryStateModel.getEventName(e.Models.Model.eventTypes.changeOne+e.Models.QueryStateModel.attributesEnum.t);e.$(this.root).on(l,e.$.proxy(this.handleTabChange,this)),this.options.tabSectionToOpen&&(e.$(this.options.tabSectionToOpen).addClass("coveo-targeted-by-current-tab"),e.$(this.element).addClass("coveo-targeting-tab-section"),this.bind.fastClick(e.$(this.element),function(){e.$(".coveo-glass").toggleClass("coveo-active-glass").toggleClass("coveo-active-glass-for-current-tab"),e.$(a.element).toggleClass("coveo-opening-tab-section"),e.$(a.options.tabSectionToOpen).toggleClass("coveo-opened-by-current-tab"),e.$(a.element).hasClass("coveo-opening-tab-section")?(e.$(a.options.tabSectionToOpen).css("z-index","1001"),e.$(a.element).css("z-index","1001")):(e.$(a.options.tabSectionToOpen).css("z-index",void 0),e.$(a.element).css("z-index",void 0))}))}return __extends(n,i),n.prototype.handleTabChange=function(){var i=this,n=this.queryStateModel.get(e.Models.QueryStateModel.attributesEnum.t);if(e.Utils.isNonEmptyString(n)){var o=!1;e.$(this.root).find(t.Component.computeSelectorForType(t.Tab.ID)).each(function(s,r){var a=t.Component.get(r,t.Tab);a.options.uniqueId==n&&(e.$(i.element).html(e.$(a.element).html()),o=!0)}),e.Assert.check(o,"Cannot find the currently active tab")}else e.$(this.element).hide()},n.ID="CurrentTab",n.options={tabSectionToOpen:t.ComponentOptions.buildStringOption()},n}(t.Component);t.CurrentTab=i,t.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r){var a=this;i.call(this,o,n.ID,r),this.element=o,this.options=s,this.options=t.ComponentOptions.initComponentOptions(o,n,s),e.$(this.root).on(e.Events.ResultListEvents.newResultsDisplayed,function(){return a.handleNewResultsDisplayed()})}return __extends(n,i),n.prototype.handleNewResultsDisplayed=function(){var t=this;e.$(this.root).find(".CoveoResult").dblclick(function(e){return t.handleResultDoubleClick(e)})},n.prototype.handleResultDoubleClick=function(i){var n=t.Component.computeCssClassNameForType(e.Ui.ResultLink.ID),o=e.$(i.target).hasClass(n);if(i.altKey&&!o){var s=e.$(i.currentTarget).data("CoveoResult"),r=this.buildResultInfo(s),a=e.ModalBox.open(r,{title:"Debug",className:"coveo-debug"});e.$(a.wrapper.find(".coveo-title")).fastClick(function(){return a.close()}),e.$(a.overlay).fastClick(function(){return a.close()}),i.cancelBubble=!0,i.result=!1}},n.prototype.buildResultInfo=function(t){e.Assert.exists(t);var i=e.$("<div/>");return i.append(e.$("<div/>").append(e.$("<a/>").attr("href",t.clickUri).text(t.title||t.uri))),e.$("<div>Properties</div>").addClass("coveo-debug-title").appendTo(i),this.buildPropertyTable(t).appendTo(i),e.$("<div>Fields</div>").addClass("coveo-debug-title").appendTo(i),this.buildFieldTable(t).appendTo(i),e.$("<div>Ranking Info</div>").addClass("coveo-debug-title").appendTo(i),this.buildRankingInfo(t).appendTo(i),i},n.prototype.buildPropertyTable=function(t){var i=this;e.Assert.exists(t);var n=e.$("<table/>").addClass("coveo-debug-property-table"),o=e._.keys(t).sort();return e._.each(o,function(o){if("raw"!=o&&o[0]==o.toLowerCase()[0]){var s=e.$("<tr/>").appendTo(n);e.$("<td/>").addClass("coveo-debug-property-name").text(o).appendTo(s),e.$("<td/>").addClass("coveo-debug-property-value").append(i.formatValue(t[o])).appendTo(s)}}),n},n.prototype.buildFieldTable=function(t){var i=this;e.Assert.exists(t);var n=e.$("<table/>").addClass("coveo-debug-fields-table"),o=e._.keys(t.raw).sort();return e._.each(o,function(o){var s=e.$("<tr/>").appendTo(n);e.$("<td/>").addClass("coveo-debug-field-name").text("@"+o).appendTo(s),e.$("<td/>").addClass("coveo-debug-field-value").append(i.formatValue(t.raw[o])).appendTo(s)}),n},n.prototype.buildRankingInfo=function(t){return e.Assert.exists(t),e.$("<div/>").addClass("coveo-debug-ranking-info").text(t.rankingInfo)},n.prototype.formatValue=function(t){return e.Utils.isNonEmptyString(t)&&0==t.indexOf("http")?e.$("<a/>").attr("href",t).text(t):e.$("<span/>").text(t)},n.ID="Debug",n.options={},n}(t.Component);t.Debug=i,t.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r){i.call(this,o,n.ID,r),this.element=o,this.options=s,this.bindings=r,this.options=t.ComponentOptions.initComponentOptions(o,n,s),e.Assert.exists(o),e.Assert.exists(this.options),this.hideNext=!0,this.bind.onRoot(e.Events.QueryEvents.buildingQuery,this.handlePrepareQueryBuilder),this.bind.onRoot(e.Events.QueryEvents.querySuccess,this.handleProcessNewQueryResults),this.bind.onRoot(e.Events.QueryEvents.noResults,this.handleNoResults),this.bind.onRoot(e.Events.QueryEvents.newQuery,this.handleNewQuery),e.$(this.element).hide()}return __extends(n,i),n.prototype.handleNewQuery=function(){this.hideNext?(e.$(this.element).empty(),e.$(this.element).hide()):this.hideNext=!0},n.prototype.handlePrepareQueryBuilder=function(t,i){e.Assert.exists(i),i.queryBuilder.enableDidYouMean=!0},n.prototype.handleNoResults=function(i,n){if(e.Utils.isNonEmptyArray(n.results.queryCorrections)&&!n.searchAsYouType){var o=this.queryStateModel.get(e.Models.QueryStateModel.attributesEnum.q),s=this.buildCorrectedSentence(n.results.queryCorrections[0]);this.queryStateModel.set(e.Models.QueryStateModel.attributesEnum.q,n.results.queryCorrections[0].correctedQuery),n.retryTheQuery=!0,this.hideNext=!1,e.$("<div/>").html(t.l("noResultFor","<span class='coveo-highlight'>"+e.StringUtils.htmlEncode(o)+"</span>")).appendTo(this.element),e.$("<div/>").html(t.l("autoCorrectedQueryTo","<span class='coveo-highlight'>"+s+"</span>")).appendTo(this.element),e.$(this.element).show(),this.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.didyoumeanAutomatic,{})}},n.prototype.handleProcessNewQueryResults=function(i,n){var o=this;e.Assert.exists(n),e.Assert.exists(n.results);var s=n.results;if(this.logger.trace("Received query results from new query",s),e.Utils.isNonEmptyArray(s.queryCorrections)){var r=this.buildCorrectedSentence(s.queryCorrections[0]),a=e.$("<div/>").text(t.l("didYouMean","")).appendTo(this.element),l=e.$("<a/>").html(r).appendTo(a);e.$(l).fastClick(function(){o.doQueryWithCorrectedTerm(s.queryCorrections[0].correctedQuery)}),e.$(this.element).show()}},n.prototype.buildCorrectedSentence=function(t){var i=[],n='<span class="coveo-word-correction">',o="</span>",s=0;return e._.each(t.wordCorrections,function(r){i.push(e.StringUtils.htmlEncode(t.correctedQuery.slice(s,r.offset))),s=r.offset,i.push(n),i.push(e.StringUtils.htmlEncode(t.correctedQuery.slice(s,r.length+s))),i.push(o),s=r.offset+r.length}),i.push(e.StringUtils.htmlEncode(t.correctedQuery.slice(s))),i.join("")},n.prototype.doQueryWithCorrectedTerm=function(i){var n=this;this.queryStateModel.set(e.Models.QueryStateModel.attributesEnum.q,i),this.queryController.deferExecuteQuery({beforeExecuteQuery:function(){return n.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.didyoumeanClick,{})}})},n.ID="DidYouMean",n.options={},n}(t.Component);t.DidYouMean=i,t.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r){i.call(this,o,n.ID,r),this.element=o,this.options=s,this.options=t.ComponentOptions.initComponentOptions(o,n,s),e.$(this.element).append(e.$("<div />").addClass("coveo-error-title").append("<h3></h3><h4></h4>"));var a=e.$("<div />").addClass("coveo-options").append(this.buildPrevious()).append(this.buildClear()).append(this.buildRetry());e.$(this.element).append(a).append(this.message=e.$("<div class='coveo-error-message'></div>")).hide(),e.$(this.root).on(e.Events.QueryEvents.newQuery,e.$.proxy(this.handleNewQuery,this)),e.$(this.root).on(e.Events.QueryEvents.queryError,e.$.proxy(this.handleQueryError,this))}return __extends(n,i),n.prototype.setErrorTitle=function(){var i={h3:t.l("OopsError"),h4:t.l("ProblemPersists")};e.DeviceUtils.isPhonegap()&&navigator.connection&&window.Connection&&(navigator.connection.type==window.Connection.NONE||0===navigator.connection.type)&&(i={h3:t.l("CannotConnect"),h4:t.l("NoNetworkConnection")}),e.$(this.element).find("h3").text(i.h3),e.$(this.element).find("h4").text(i.h4)},n.prototype.buildPrevious=function(){var i=this;return e.$("<span class='coveo-previous' > "+t.l("GoBack")+" </span>").fastClick(function(){i.usageAnalytics.logCustomEvent(t.AnalyticsActionCauseList.errorBack,{},i.root),i.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.errorBack,{}),history.back()})},n.prototype.buildClear=function(){var i=this;return e.$("<span class='coveo-clear'>"+t.l("Reset")+"</span>").fastClick(function(){i.queryStateModel.reset(),i.queryController.deferExecuteQuery({beforeExecuteQuery:function(){i.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.errorClearQuery,{}),i.usageAnalytics.logCustomEvent(t.AnalyticsActionCauseList.errorClearQuery,{},i.root)}})})},n.prototype.buildRetry=function(){var i=this;return e.$("<span class='coveo-retry'>"+t.l("Retry")+"</span>").fastClick(function(){i.queryController.deferExecuteQuery({beforeExecuteQuery:function(){i.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.errorRetry,{}),i.usageAnalytics.logCustomEvent(t.AnalyticsActionCauseList.errorRetry,{},i.root)}})})},n.prototype.handleNewQuery=function(){e.$(this.element).hide(),null!=this.closePopup&&this.closePopup()},n.prototype.handleQueryError=function(i,n){if(e.Assert.exists(n),e.Assert.exists(n.error),!n.error.isMissingAuthentication&&(this.message.empty(),this.setErrorTitle(),this.options.showDetailedError&&this.message.append(e.$("<span class='coveo-more-info'>"+t.l("MoreInfo")+"</span>").fastClick(function(t){e.$(t.target).parent().html(e._.template("<pre><%- type %>\n<%- message %></pre>",n.error))})),e.$(this.element).show(),this.options.popUp)){var o=e.ModalBox.open(e.$(this.element).clone(!0,!0),{title:e.JQueryUtils.getPopUpCloseButton(t.l("Close"),t.l("ErrorReport")),titleClose:!0,overlayClose:!0,className:"coveo-error-report"});this.closePopup=o.close}},n.ID="ErrorReport",n.options={popUp:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),showDetailedError:t.ComponentOptions.buildBooleanOption({defaultValue:!1})},n}(t.Component);t.ErrorReport=i,t.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function t(){this.selected=!1,this.excluded=!1,this.waitingForDelta=!1}return t.prototype.reset=function(){this.selected=!1,this.excluded=!1},t.prototype.updateCountsFromNewValue=function(t){e.Assert.exists(t),this.occurrences=t.occurrences,this.delta=t.delta,this.computedField=t.computedField},t.prototype.cloneWithZeroOccurrences=function(){return this.occurrences=0,this.computedField=0,this.delta=void 0,this},t.prototype.cloneWithDelta=function(t,i){e.Assert.isLargerOrEqualsThan(0,t);var n=this.cloneWithZeroOccurrences();return n.delta=i,n.occurrences=t,n},t.prototype.getFormattedCount=function(){var t=void 0;return e.Utils.exists(this.delta)&&this.delta>0?t="+"+Globalize.format(this.delta,"n0"):this.occurrences>0&&(t=Globalize.format(this.occurrences,"n0")),t},t.prototype.getFormattedComputedField=function(e){return 0!=this.computedField?Globalize.format(this.computedField,e):void 0
},t.create=function(i){if(e._.isString(i))return t.createFromValue(i);if(e._.isObject(i))return"computedFieldResults"in i?t.createFromGroupByValue(i):t.createFromFieldValue(i);throw new Error("Can't create value from "+i)},t.createFromValue=function(i){e.Assert.isNonEmptyString(i);var n=new t;return n.value=i.toLowerCase(),n.lookupValue=i,n},t.createFromGroupByValue=function(i){e.Assert.exists(i),e.Assert.exists(i);var n=new t;return n.value=i.value.toLowerCase(),n.lookupValue=e.Utils.exists(i.lookupValue)?i.lookupValue:i.value,n.occurrences=i.numberOfResults,n.computedField=e.Utils.isNonEmptyArray(i.computedFieldResults)?i.computedFieldResults[0]:void 0,n.score=i.score,n},t.createFromFieldValue=function(i){e.Assert.exists(i);var n=new t;return n.value=i.value.toLowerCase(),n.lookupValue=i.lookupValue,n.occurrences=i.numberOfResults,n},t}();t.FacetValue=i;var n=function(){function t(t){this.values=e.Utils.exists(t)?e._.map(t.values,function(e){return i.createFromGroupByValue(e)}):[]}return t.prototype.add=function(t){e.Assert.exists(t),e.Assert.check(!this.contains(t.value)),this.values.push(t)},t.prototype.remove=function(t){e.Assert.isNonEmptyString(t),t=t,this.values=e._.filter(this.values,function(e){return e.value!=t})},t.prototype.size=function(){return this.values.length},t.prototype.isEmpty=function(){return 0==this.values.length},t.prototype.at=function(t){return e.Assert.isLargerOrEqualsThan(0,t),e.Assert.isSmallerThan(this.values.length,t),this.values[t]},t.prototype.get=function(t){return e._.find(this.values,function(e){return e.value.toLowerCase()==t.toLowerCase()})},t.prototype.contains=function(t){return e.Utils.exists(this.get(t))},t.prototype.getAll=function(){return this.values},t.prototype.getSelected=function(){return e._.filter(this.values,function(e){return e.selected})},t.prototype.getExcluded=function(){return e._.filter(this.values,function(e){return e.excluded})},t.prototype.hasSelectedOrExcludedValues=function(){return 0!=this.getSelected().length||0!=this.getExcluded().length},t.prototype.reset=function(){e._.each(this.values,function(e){return e.reset()})},t.prototype.importActiveValuesFromOtherList=function(t){var i=this;e.Assert.exists(t),e._.each(t.getSelected(),function(t){var n=i.get(t.value);e.Utils.exists(n)?n.selected=!0:i.values.push(t.cloneWithZeroOccurrences())}),e._.each(t.getExcluded(),function(t){var n=i.get(t.value);e.Utils.exists(n)?n.excluded=!0:i.values.push(t.cloneWithZeroOccurrences())})},t.prototype.updateCountsFromNewValues=function(t){e.Assert.exists(t),this.values=e._.map(this.values,function(i){var n=t.get(i.value);return e.Utils.exists(n)?(i.updateCountsFromNewValue(n),i):i.cloneWithZeroOccurrences()})},t.prototype.updateDeltaWithFilteredFacetValues=function(t){e.Assert.exists(t),e._.each(this.values,function(i){var n=t.get(i.value);i.waitingForDelta=!1,e.Utils.exists(n)?i.delta=i.occurrences-n.occurrences>0?i.occurrences-n.occurrences:null:i.selected||i.excluded||(i.delta=i.occurrences)})},t.prototype.mergeWithUnfilteredFacetValues=function(t){var i=this;e.Assert.exists(t);var n=[];e._.each(t.values,function(t){var o=i.get(t.value);e.Utils.exists(o)?o.occurrences==t.occurrences?n.push(o):n.push(t.cloneWithDelta(t.occurrences,t.occurrences-o.occurrences)):n.push(t.cloneWithDelta(t.occurrences,t.occurrences))});var o=0;e._.each(this.values,function(i){var s=t.get(i.value);if(e.Utils.exists(s)){for(var r=0;r<n.length;r++)if(n[r].value==i.value){o=r+1;break}}else(i.selected||i.excluded)&&(n.splice(o,0,i),o++)}),this.values=n},t.prototype.sortValuesDependingOnStatus=function(t){if(this.values=e._.sortBy(this.values,function(e){return e.selected?1:e.excluded?3:2}),null!=t&&t<this.values.length){var i=this.getExcluded().length,n=this.values.splice(this.values.length-i,i);Array.prototype.splice.apply(this.values,[t-i,0].concat(n))}},t}();t.FacetValues=n}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i;!function(i){function n(i){var n=i.raw.objecttype,r=i.raw.sysfiletype;return e.Utils.isNonEmptyString(n)?o(n):e.Utils.isNonEmptyString(r)?s(r):{icon:"coveo-icon sysfiletype",caption:t.l("Unknown")}}function o(e){e=e.toLowerCase();var i=t.l["objecttype_"+e];return{icon:"coveo-icon objecttype "+e,caption:i?i():e}}function s(e){e=e.toLowerCase(),"."==e[0]&&(e=e.substring(1));var i=t.l["sysfiletype_"+e];return{icon:"coveo-icon sysfiletype "+e,caption:i?i():e}}function r(){if(void 0==a){a={};var t=String.locales[String.locale];e.Assert.isNotUndefined(t),e._.each(e._.keys(t),function(e){0==e.indexOf("sysfiletype_")?a[e.substr("sysfiletype_".length)]=e.toLocaleString():0==e.indexOf("objecttype_")&&(a[e.substr("objecttype_".length)]=e.toLocaleString())})}return a}var a;i.get=n,i.getObjectType=o,i.getSysFileType=s,i.getSysFileTypeCaptions=r}(i=t.FileTypes||(t.FileTypes={}))}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i;!function(i){function n(t){return new RegExp(e.Utils.escapeRegexCharacter(t),"i")}function o(i,n){var o=[i],s=this.getRegexToUseForFacetSearch(i);return n.options.valueCaption&&e._.each(e._.filter(e._.pairs(n.options.valueCaption),function(e){return s.test(e[1])}),function(e){o.push(e[0])}),("@objecttype"==n.options.field||"@sysfiletype"==n.options.field)&&e._.each(e._.filter(e._.pairs(t.FileTypes.getSysFileTypeCaptions()),function(e){return s.test(e[1])}),function(e){o.push(e[0])}),o}function s(t){return t=e._.map(t,function(t){return e.Utils.escapeRegexCharacter(t)}),t[0]=".*"+t[0]+".*",t.join("|")}function r(e,t,i,n){return t>e&&n>e&&t!=i}function a(t,i){if(0!=t.values.getSelected().length){var n=i.find("li").not(".coveo-selected");e._.each(n,function(t){e.$(t).addClass("coveo-no-state")})}}function l(i){var n=t.FileTypes.getSysFileTypeCaptions()[i.toLowerCase()];return void 0!=n&&e.Utils.isNonEmptyString(n)?n:i}function u(t,i){if(!t.isInstanceOf("HierarchicalFacet")||i){t.logger.trace("Clipping captions");for(var n=e.$(t.element).show(),o=n.find(".coveo-caption"),s=0;s<o.length;s++)""!=o[s].style.width&&(o[s].style.width="");for(var r=n.find(".coveo-label"),a=[],s=0;s<r.length;s++){var l=r.get(s),u=e.$(l),c=u.find(".coveo-caption"),p=c.get(0),d=l.scrollWidth,h=l.clientWidth,f=p.scrollWidth,v=Math.max(0,d-h);v&&a.push({element:c,width:f,crop:v,label:u})}n.css("display","");for(var s=0;s<a.length;s++){var m=a[s],g=m.element.get(0);g.style.width=m.width-m.crop+"px";{m.element[0]}m.crop>0?m.label.attr("title",m.element.text()):m.label.attr("title",null)}}}i.getRegexToUseForFacetSearch=n,i.getValuesToUseForSearchInFacet=o,i.buildFacetSearchPattern=s,i.needAnotherFacetSearch=r,i.addNoStateCssClassToFacetValues=a,i.tryToGetTranslatedCaption=l,i.clipCaptionsToAvoidOverflowingTheirContainer=u}(i=t.FacetUtils||(t.FacetUtils={}))}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function t(e){this.facet=e}return t.prototype.prepareForNewQuery=function(){this.lastGroupByRequestIndex=void 0,this.expressionToUseForFacetSearch=void 0},t.prototype.computeOurFilterExpression=function(){var t=this;e.Assert.check(this.facet.values.hasSelectedOrExcludedValues());var i=new e.Ui.ExpressionBuilder,n=this.facet.values.getSelected();n.length>0&&(this.facet.options.useAnd?e._.each(n,function(e){i.addFieldExpression(t.facet.options.field,"==",[e.value])}):i.addFieldExpression(this.facet.options.field,"==",e._.map(n,function(e){return e.value})));var o=this.facet.values.getExcluded();return o.length>0&&i.addFieldNotEqualExpression(this.facet.options.field,e._.map(o,function(e){return e.value})),i.build()},t.prototype.putGroupByIntoQueryBuilder=function(t){e.Assert.exists(t);var i=this._createGroupByAllowedValues(),n=this._createBasicGroupByRequest(i),o=this.createGroupByQueryOverride(t);e.Utils.isNullOrUndefined(o)?(this.expressionToUseForFacetSearch=t.computeCompleteExpression(),null==this.expressionToUseForFacetSearch&&(this.expressionToUseForFacetSearch="@sysuri")):(n.queryOverride=o.withoutConstant,n.constantQueryOverride=o.constant,this.expressionToUseForFacetSearch=o.withoutConstant+(o.constant?" "+o.constant:"")),this.lastGroupByRequestIndex=t.groupByRequests.length,t.groupByRequests.push(n)},t.prototype.searchInFacet=function(e,t,i){void 0===i&&(i=!0);var n=this.buildListFieldValuesRequest(e,t,!1);return this.createListFieldDeferer(n)},t.prototype.searchInFacetWithLookupField=function(t,i,n){void 0===n&&(n=!0);var o=this.buildGroupByQuery(),s=o.groupBy[0];s.maximumNumberOfValues=t,s.allowedValues=e._.map(i,function(e){return"*"+e+"*"});var r=this.buildSearchQueryForFacetWithLookupField(i);return null==o.aq?o.aq=r:o.aq+=" "+r,this.createSearchDeferer(o)},t.prototype.recursiveFacetSearch=function(t,i,n,o){var s=this;void 0===o&&(o=e.$.Deferred());var r,a=e.Ui.FacetUtils.getValuesToUseForSearchInFacet(t,this.facet),l=function(r){var a=r.length;r=s.checkForFacetSearchValuesToRemove(r,t),e.Ui.FacetUtils.needAnotherFacetSearch(r.length,a,n,5)?s.recursiveFacetSearch(t,i+i,a,o):o.resolve(r)};return null==this.facet.options.lookupField&&null==this.facet.options.computedField?(r=this.facet.facetQueryController.searchInFacet(i,a,this.facet.options.facetSearchIgnoreAccents),r.done(l)):(r=this.facet.facetQueryController.searchInFacetWithLookupField(i,a,!1),r.done(function(e){var t=e.groupByResults.length>0?e.groupByResults[0].values:[];l(t)})),r.fail(function(e,t){o.reject(e,t)}),o.fail(function(){r.reject()}),o},t.prototype.fetchMore=function(){var t=this.buildGroupByQuery();return this.facet.values.size()>0&&t.groupBy.push(this._createBasicGroupByRequest(e._.map(this.facet.values.getAll(),function(e){return e.value}))),this.createSearchDeferer(t)},t.prototype.searchInFacetToUpdateDelta=function(t){var i=this.buildGroupByQuery();return i.aq=this.computeOurFilterExpression(),e._.each(t,function(e){e.waitingForDelta=!0}),i.groupBy=[this._createBasicGroupByRequest(e._.map(t,function(e){return e.value}))],i.groupBy[0].completeFacetWithStandardValues=!1,this.createSearchDeferer(i)},t.prototype.createSearchDeferer=function(e){return this.facet.getEndpoint().search(e)},t.prototype.createListFieldDeferer=function(e){return this.facet.queryController.getEndpoint().listFieldValues(e)},t.prototype.buildSearchQueryForFacetWithLookupField=function(t){var i=this.facet.options.lookupField?this.facet.options.lookupField:this.facet.options.field;return"("+t.map(function(t){return e.QueryUtils.buildFieldExpression(i,"*=",["*"+t+"*"])}).join(" OR ")+")"},t.prototype.buildListFieldValuesRequest=function(e,i,n,o){void 0===n&&(n=!0);var s={field:this.facet.options.field,ignoreAccents:n,sortCriteria:"occurrences",maximumNumberOfValues:e,queryOverride:o||this.expressionToUseForFacetSearch};return null!=i&&(s.pattern=t.makeFacetSearchPattern(i),s.patternType="RegularExpression"),s},t.prototype.buildGroupByQuery=function(e){var t=[this._createBasicGroupByRequest(e)];return{q:this.expressionToUseForFacetSearch,enableDidYouMean:!1,firstResult:0,numberOfResults:0,groupBy:t}},t.prototype._createGroupByAllowedValues=function(){var t;if(void 0!=this.facet.options.allowedValues)return this.facet.options.allowedValues;if(void 0!=this.facet.options.customSort)return this.facet.options.customSort;if(this.facet.options.useAnd||!this.facet.keepDisplayedValuesNextTime){var i=this.facet.values.getSelected();if(0==i.length)return void 0;t=this.facet.values.getSelected()}else t=this.facet.values.getAll();return e._.map(t,function(e){return e.value})},t.prototype.createGroupByQueryOverride=function(t){var i=this.facet.options.additionalFilter?this.facet.options.additionalFilter:void 0;if(!this.facet.values.hasSelectedOrExcludedValues()||this.facet.options.useAnd)return i?{constant:i,withoutConstant:"@sysuri"}:void 0;var n=e._.defaults(t.computeCompleteExpressionPartsExcept(this.computeOurFilterExpression()),{withoutConstant:"@sysuri"});return void 0==n.constant?n.constant=i:n.constant+=i?" "+i:"",n},t.prototype._createBasicGroupByRequest=function(t,i){void 0===i&&(i=!0);var n=(this.facet.numberOfValues+(this.facet.options.enableMoreLess?1:0),{field:this.facet.options.field,maximumNumberOfValues:this.facet.numberOfValues+(this.facet.options.enableMoreLess?1:0),sortCriteria:this.facet.options.sortCriteria,injectionDepth:this.facet.options.injectionDepth,completeFacetWithStandardValues:void 0==this.facet.options.allowedValues?!0:!1});return this.facet.options.lookupField&&(n.lookupField=this.facet.options.lookupField),null!=t&&(n.allowedValues=t,n.maximumNumberOfValues=Math.max(n.maximumNumberOfValues,t.length)),i&&e.Utils.isNonEmptyString(this.facet.options.computedField)&&(n.computedFields=[{field:this.facet.options.computedField,operation:this.facet.options.computedFieldOperation}]),n},t.prototype.checkForFacetSearchValuesToRemove=function(t,i){var n=this,o=e.Ui.FacetUtils.getRegexToUseForFacetSearch(i);return e._.filter(t,function(e){return o.test(n.facet.getValueCaption(e))})},t.makeFacetSearchPattern=function(t){return t=e._.map(t,function(t){return e.Utils.escapeRegexCharacter(t)}),t[0]=".*"+t[0]+".*",t.join("|")},t}();t.FacetQueryController=i}(t=e.Controllers||(e.Controllers={}))}(Coveo||(Coveo={}));var Coveo;!function(e){!function(e){e[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.ENTER=13]="ENTER",e[e.SHIFT=16]="SHIFT",e[e.CTRL=17]="CTRL",e[e.ALT=18]="ALT",e[e.ESCAPE=27]="ESCAPE",e[e.SPACEBAR=32]="SPACEBAR",e[e.PAGE_UP=33]="PAGE_UP",e[e.PAGE_DOWN=34]="PAGE_DOWN",e[e.HOME=36]="HOME",e[e.LEFT_ARROW=37]="LEFT_ARROW",e[e.UP_ARROW=38]="UP_ARROW",e[e.RIGHT_ARROW=39]="RIGHT_ARROW",e[e.DOWN_ARROW=40]="DOWN_ARROW",e[e.INSERT=45]="INSERT",e[e.DELETE=46]="DELETE"}(e.KEYBOARD||(e.KEYBOARD={}));var t=(e.KEYBOARD,function(){function t(){}return t.keysEqual=function(t,i){return e.Utils.isNullOrUndefined(t.keyCode)?e.Utils.isNullOrUndefined(t.which)?!1:t.which==i:t.keyCode==i},t.isAllowedKeyForOmniBox=function(e){var i=e.keyCode,n=t.isNumberKeyPushed(i)||32==i||13==i||t.isLetterKeyPushed(i)||i>95&&112>i||i>185&&193>i||i>218&&223>i||8==i||46==i||t.isArrowKeyPushed(i);return n},t.isAllowedKeyForSearchAsYouType=function(e){return t.isAllowedKeyForOmniBox(e)&&!t.isArrowKeyPushed(e.keyCode)},t.isDeleteOrBackspace=function(e){return t.keysEqual(e,8)||t.keysEqual(e,46)},t.isArrowKeyPushed=function(e){return 37==e||38==e||39==e||40==e},t.isNumberKeyPushed=function(e){return e>47&&58>e},t.isLetterKeyPushed=function(e){return e>64&&91>e},t}());e.KeyboardUtils=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function i(i,n){var o=this;this.facet=i,this.facetSearchValuesListKlass=n,this.showingFacetSearchWaitAnimation=!1,this.searchTemplate=e._.template("<div class='coveo-search'></div>"),this.magnifierTemplate=e._.template("<div class='coveo-magnifier'></div>"),this.waitTemplate=e._.template("<div class='coveo-wait-animation'></div>"),this.clearIconTemplate=e._.template("<span class='coveo-icon'></span>"),this.clearTemplate=e._.template("<div title='"+t.l("Clear",t.l("Search"))+"' class='coveo-clear'></div>"),this.middleTemplate=e._.template("<div class='coveo-middle'></div>"),this.inputTemplate=e._.template("<input type='text' autocapitalize='off' autocorrect='off' placeholder='<%- placeholder %>'/>"),this.searchResultsTemplate=e._.template('<ul class="coveo-search-results"/>'),this.searchResults=e.$(this.searchResultsTemplate()),e.$(window).resize(function(){e.DeviceUtils.isMobileDevice()||o.positionSearchResults()})}return i.prototype.build=function(){return e.DeviceUtils.isMobileDevice()?this.buildSearchMobile():this.buildBaseSearch()},i.prototype.positionSearchResults=function(){if(null!=this.searchResults&&this.searchResults.is(":visible"))if(e.DeviceUtils.isMobileDevice())this.searchResults.insertAfter(this.search);else{var t=this.searchResults.outerWidth()-this.searchResults.innerWidth();this.searchResults.outerWidth(this.search.outerWidth()-t),this.searchResults.show(),e.JQueryUtils.positionPopup(this.searchResults,this.search,e.$(this.facet.element),e.$(this.facet.root),{vertical:2,horizontal:1})}},i.prototype.completelyDismissSearch=function(){this.cancelAnyPendingSearchOperation(),this.facet.unfadeInactiveValuesInMainList(),this.search.removeClass("coveo-no-results"),this.hideSearchResultsElement(),this.input.val(""),this.clear.hide()},i.prototype.buildBaseSearch=function(){var i=this;return this.search=e.$(this.searchTemplate()),this.magnifier=e.$(this.magnifierTemplate()).appendTo(this.search),this.wait=e.$(this.waitTemplate()).hide().appendTo(this.search),this.clearIcon=e.$(this.clearIconTemplate()),this.clear=e.$(this.clearTemplate()).appendTo(this.search).hide().append(this.clearIcon),this.middle=e.$(this.middleTemplate()).appendTo(this.search),this.input=e.$(this.inputTemplate({placeholder:t.l("SearchIn",this.facet.options.title)})).appendTo(this.middle),t.Component.pointElementsToDummyForm(this.input),this.input.keyup(function(e){return i.handleFacetSearchKeyUp(e)}),this.clear.fastClick(function(){return i.handleFacetSearchClear()}),this.input.focus(function(e){return i.handleFacetSearchFocus(e)}),this.input.blur(function(){return i.handleFacetSearchBlur()}),this.search},i.prototype.buildSearchMobile=function(){var i=this,n=e.$("<div class='coveo-search-button-mobile'>"+t.l("Search")+"</div>");return this.search=this.buildBaseSearch(),n.fastClick(function(){var n=e.ModalBox.open(e.$("<div />").append(i.search),{title:e.JQueryUtils.getPopUpCloseButton(t.l("Close"),t.l("SearchIn",i.facet.options.title)),validation:function(){return i.completelyDismissSearch(),!0},className:"coveo-mobile-facet-search"});e.$(n.wrapper.find(".coveo-title")).fastClick(function(){return n.close()}),i.input.val("").keyup().focus()}),n},i.prototype.handleFacetSearchKeyUp=function(t){e.Assert.exists(t);var i=""==this.input.val();this.showOrHideClearElement(i),e.DeviceUtils.isMobileDevice()?this.startNewSearchTimeout():this.handleKeyboardNavigation(t,i)},i.prototype.handleFacetSearchFocus=function(){""==this.getValueInInputForFacetSearch()||e.DeviceUtils.isMobileDevice()||this.startNewSearchTimeout(),e.DeviceUtils.isSmallScreenWidth()&&e.MobileUtils.addToggleClassOnSearchInterface("slide-left")},i.prototype.handleFacetSearchBlur=function(){var t=this;setTimeout(function(){e.DeviceUtils.isMobileDevice()||t.completelyDismissSearch()},250)},i.prototype.handleFacetSearchClear=function(){this.input.val(""),this.clear.hide(),this.completelyDismissSearch()},i.prototype.showOrHideClearElement=function(e){e?(this.clear.hide(),this.search.removeClass("coveo-no-results")):this.clear.show()},i.prototype.handleKeyboardNavigation=function(e,t){switch(e.which){case 13:this.keyboardNavigationEnterPressed(e,t);break;case 46:this.keyboardNavigationDeletePressed(e);break;case 27:this.completelyDismissSearch();break;case 40:this.moveCurrentResultDown();break;case 38:this.moveCurrentResultUp();break;default:this.highlightCurrentQueryWithinSearchResults(),this.startNewSearchTimeout()}},i.prototype.keyboardNavigationEnterPressed=function(e,t){e.shiftKey?this.triggerNewFacetSearch():this.searchResults.is(":visible")||"block"==this.searchResults.css("display")?(this.performSelectActionOnCurrentSearchResult(),this.completelyDismissSearch()):this.search.is(".coveo-no-results")||t||this.selectAllValuesMatchingSearch()},i.prototype.keyboardNavigationDeletePressed=function(e){e.shiftKey&&(this.performExcludeActionOnCurrentSearchResult(),this.completelyDismissSearch(),this.input.val(""))},i.prototype.triggerNewFacetSearch=function(i){var n=this;void 0===i&&(i=this.facet.options.numberOfValuesInFacetSearch),this.cancelAnyPendingSearchOperation(),this.showFacetSearchWaitingAnimation(),this.facet.logger.info("Triggering new facet search");{var o=this.getValueInInputForFacetSearch();t.FacetUtils.getValuesToUseForSearchInFacet(o,this.facet)}this.facetSearchDeferred=this.facet.facetQueryController.recursiveFacetSearch(o,this.facet.options.numberOfValuesInFacetSearch),this.facetSearchDeferred.done(function(e){n.facet.usageAnalytics.logCustomEvent(t.AnalyticsActionCauseList.facetSearch,{facetId:n.facet.options.uniqueId},n.facet.root),n.facet.logger.debug("Received field values",e),n._processNewFacetSearchResults(e.slice(0,n.facet.options.numberOfValuesInFacetSearch+1)),n.hideFacetSearchWaitingAnimation(),n.facetSearchDeferred=void 0}),this.facetSearchDeferred.fail(function(t,i){e.Utils.exists(i)&&(n.facet.logger.error("Error while retrieving facet values",i),n.hideFacetSearchWaitingAnimation()),n.facetSearchDeferred=void 0})},i.prototype.startNewSearchTimeout=function(){var e=this;this.cancelAnyPendingSearchOperation(),this.facetSearchTimeout=setTimeout(function(){""!=e.getValueInInputForFacetSearch()?e.triggerNewFacetSearch():e.completelyDismissSearch()},this.facet.options.facetSearchDelay)},i.prototype.cancelAnyPendingSearchOperation=function(){e.Utils.exists(this.facetSearchTimeout)&&(clearTimeout(this.facetSearchTimeout),this.facetSearchTimeout=void 0),e.Utils.exists(this.facetSearchDeferred)&&(this.facetSearchDeferred.reject(),this.facetSearchDeferred=void 0),this.hideFacetSearchWaitingAnimation()},i.prototype._processNewFacetSearchResults=function(i){e.Assert.exists(i),i.length>0?(this.search.removeClass("coveo-no-results"),this.facet.fadeInactiveValuesInMainList(this.facet.options.facetSearchDelay),this.rebuildSearchResults(i),this.showSearchResultsElement(),this.highlightCurrentQueryWithinSearchResults(),t.FacetUtils.clipCaptionsToAvoidOverflowingTheirContainer(this.facet,!0),this.makeFirstSearchResultTheCurrentOne()):(this.hideSearchResultsElement(),this.search.addClass("coveo-no-results"))},i.prototype.rebuildSearchResults=function(i){var n=this;e.Assert.exists(i),this.searchResults.empty();var o=e.$('<li class="coveo-selectable coveo-select-all"/>').text(t.l("SelectAll"));o.fastClick(function(){return n.selectAllValuesMatchingSearch()}),e.DeviceUtils.isMobileDevice()||o.appendTo(this.searchResults);var s=e._.map(i,function(e){return t.FacetValue.create(e)});new this.facetSearchValuesListKlass(this.facet,t.FacetValueElement).build(s).appendTo(this.searchResults),e.DeviceUtils.isMobileDevice()&&(o.append("<span class='coveo-mobile-facet-search-select-all'></span>"),o.appendTo(this.searchResults)),this.searchResults.find(".coveo-selectable").each(function(t,i){e.$(i).mousemove(function(){n.makeCurrentResult(e.$(i))})})},i.prototype.showSearchResultsElement=function(){this.searchResults.appendTo(this.facet.root),this.positionSearchResults()},i.prototype.hideSearchResultsElement=function(){this.searchResults.remove()},i.prototype.highlightCurrentQueryWithinSearchResults=function(){var t=this;e.$(this.searchResults).find(".coveo-caption").each(function(i,n){var o=t.getValueInInputForFacetSearch(),s=new RegExp("("+e.StringUtils.wildcardsToRegex(o)+")","ig"),r=e.$(n).text(),a=r.replace(s,'<span class="coveo-highlight">$1</span>');e.$(n).html(a)})},i.prototype.makeFirstSearchResultTheCurrentOne=function(){this.makeCurrentResult(this.getSelectables().first())},i.prototype.makeCurrentResult=function(){this.getSelectables().removeClass("coveo-current"),this.getSelectables().first().addClass("coveo-current")},i.prototype.moveCurrentResultDown=function(){var e=this.searchResults.find(".coveo-current");this.getSelectables().removeClass("coveo-current");var t=e.next(".coveo-selectable").first();t.length>0?t.addClass("coveo-current"):e.siblings(".coveo-selectable").first().addClass("coveo-current")},i.prototype.moveCurrentResultUp=function(){var e=this.searchResults.find(".coveo-current");this.searchResults.find(".coveo-selectable").removeClass("coveo-current");var t=e.prev(".coveo-selectable").first();t.length>0?t.addClass("coveo-current"):e.siblings(".coveo-selectable").last().addClass("coveo-current")},i.prototype.getSelectables=function(e){return void 0===e&&(e=this.searchResults),e.find(".coveo-selectable")},i.prototype.performSelectActionOnCurrentSearchResult=function(){var t=this.searchResults.find(".coveo-current");e.Assert.check(1==t.length);var i=t.find('input[type="checkbox"]');i.length>0?(i.prop("checked",!0),i.change()):t.fastClick()},i.prototype.performExcludeActionOnCurrentSearchResult=function(){var t=this.searchResults.find(".coveo-current");e.Assert.check(1==t.length),t.find(".coveo-exclude").fastClick()},i.prototype.getValueInInputForFacetSearch=function(){return this.input.val()},i.prototype.selectAllValuesMatchingSearch=function(){var i=this;this.facet.showWaitingAnimation();var n=this.getValueInInputForFacetSearch(),o=t.FacetUtils.getValuesToUseForSearchInFacet(n,this.facet),s=this.facet.facetQueryController.searchInFacet(1e3,o,this.facet.options.facetSearchIgnoreAccents);s.done(function(n){i.completelyDismissSearch();var o=e._.map(n,function(n){var o=i.facet.values.get(n.value);return e.Utils.exists(o)||(o=t.FacetValue.create(n)),o.selected=!0,o.excluded=!1,o});i.facet.processFacetSearchAllResultsSelected(o)}),this.completelyDismissSearch()},i.prototype.showFacetSearchWaitingAnimation=function(){var t=this;e.Defer.defer(function(){t.showingFacetSearchWaitAnimation||(t.wait.width(t.magnifier.width()),t.wait.height(t.magnifier.height()),t.magnifier.hide(),t.wait.show(),t.showingFacetSearchWaitAnimation=!0)})},i.prototype.hideFacetSearchWaitingAnimation=function(){this.showingFacetSearchWaitAnimation&&(this.magnifier.show(),this.wait.hide(),this.showingFacetSearchWaitAnimation=!1)},i}();t.FacetSearch=i}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(t){this.id=t,e.Assert.exists(window.localStorage)}return t.prototype.save=function(e){localStorage.setItem(this.getLocalStorageKey(),JSON.stringify(e))},t.prototype.load=function(){var e=localStorage.getItem(this.getLocalStorageKey());return e&&JSON.parse(e)},t.prototype.remove=function(e){if(void 0==e)localStorage.removeItem(this.getLocalStorageKey());else{var t=this.load();delete t[e],this.save(t)}},t.prototype.getLocalStorageKey=function(){return"coveo-"+this.id},t}();e.LocalStorageUtils=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function i(n,o){var s=this;this.facet=o,this.facetSettingsIconTemplate=e._.template("<span class='coveo-icon'></span>"),this.facetSettingsButtonTemplate=e._.template("<div title='"+t.l("Settings")+"' class='coveo-settings'></div>"),this.facetSettingsPopupTemplate=e._.template('<div class="coveo-settings-popup"></div>'),this.facetSettingsSectionTemplate=e._.template("<div class='coveo-section <%= _class %>'></div>"),this.facetSettingsSectionIconTemplate=e._.template("<div class='coveo-icon'></div>"),this.facetSettingsItemsTemplate=e._.template("<div class='coveo-items'></div>"),this.facetSettingsItemTemplate=e._.template("<div class='coveo-item' title='<%- title %>'><%- label %></div>"),this.enabledSorts=[],this.enabledSortsIgnoreRenderBecauseOfPairs=[],this.customSortDirection="ascending",this.customSortDirectionChange=!1,e._.each(n,function(e){var t=i.availableSorts[e.toLowerCase()];void 0!=t&&s.enabledSorts.push(t)}),this.removeEnabledSortsBasedOnFacetType(),this.filterDuplicateForRendering(),e.Utils.isNonEmptyArray(this.enabledSorts)&&(void 0!=this.facet.options.sortCriteria&&(this.activeSort=e._.find(this.enabledSorts,function(e){return e.name==s.facet.options.sortCriteria})),this.activeSort||(this.activeSort=this.enabledSorts[0]))}return i.prototype.build=function(){if(this.settingsButton=e.$(this.facetSettingsButtonTemplate()),this.settingsIcon=e.$(this.facetSettingsIconTemplate()),this.settingsPopup=e.$(this.facetSettingsPopupTemplate()),e.Utils.isNonEmptyArray(this.enabledSorts)){var t=this.buildSortSection();this.directionSection=this.buildDirectionSection()}return this.facet.options.enableSettingsFacetState&&(this.saveStateSection=this.buildSaveStateSection(),this.clearStateSection=this.buildClearStateSection()),this.hideSection=this.buildHideSection(),this.showSection=this.buildShowSection(),this.handleMouseEventOnButton(t),e.Utils.isNonEmptyArray(this.enabledSorts)?this.settingsPopup.append(t.element,this.directionSection,this.saveStateSection,this.clearStateSection,this.hideSection,this.showSection):this.settingsPopup.append(this.saveStateSection,this.clearStateSection,this.hideSection,this.showSection),this.settingsButton.append(this.settingsIcon),this.settingsButton},i.prototype.reorderValues=function(e){return"custom"==this.activeSort.name&&void 0!=this.facet.options.customSort?this.reorderValuesWithCustomOrder(e):e},i.prototype.loadSavedState=function(){var t=this.facetStateLocalStorage.load(),i=this.facet.queryStateModel.get(this.includedStateAttribute),n=this.facet.queryStateModel.get(this.excludedStateAttribute),o=this.facet.queryStateModel.get(this.operatorStateAttribute);if(!e.Utils.isNullOrUndefined(t)&&e.Utils.isEmptyArray(i)&&e.Utils.isEmptyArray(n)&&!e.Utils.isNonEmptyString(o)){var s={};s[this.includedStateAttribute]=t.included,s[this.excludedStateAttribute]=t.excluded,s[this.operatorStateAttribute]=t.operator,this.facet.queryStateModel.setMultiple(s),this.loadedFromSettings=s}},i.prototype.removeEnabledSortsBasedOnFacetType=function(){if(this.facet.isInstanceOf("FacetRange")){var e=this.facet;e.options.slider&&(this.enabledSorts=[])}},i.prototype.reorderValuesWithCustomOrder=function(t){var i=this,n=t.length,o=e._.map(t,function(t){var o=e._.indexOf(i.facet.options.customSort,t.lookupValue||t.value);return o=-1==o?++n:o,{facetValue:t,index:o}}),s=e._.sortBy(o,"index");return s="ascending"==this.customSortDirection?s:s.reverse(),e._.pluck(s,"facetValue")},i.prototype.buildSortSection=function(){var t=e.$(this.facetSettingsSectionTemplate({_class:"coveo-sort"})),i=e.$(this.facetSettingsSectionIconTemplate()),n=e.$(this.facetSettingsItemsTemplate()),o=this.buildSortSectionItems();return n.append(o),t.append(i,n),{element:t,sortItems:o}},i.prototype.buildSortSectionItems=function(){var t=this;return e._.map(this.enabledSorts,function(i){return e._.contains(t.enabledSortsIgnoreRenderBecauseOfPairs,i)?e.$("<div></div>").hide():e.$(t.facetSettingsItemTemplate({label:e.L10N.format(i.label),title:i.description})).click(function(e){return t.handleClickSortButton(e,i)})})},i.prototype.closePopupAndUpdateSort=function(){this.closePopup(),"custom"!=this.activeSort.name?this.facet.updateSort(this.activeSort.name):(this.facet.updateSort("nosort"),this.customSortDirectionChange&&(this.customSortDirectionChange=!1,this.facet.queryController.executeQuery()))},i.prototype.closePopup=function(){this.settingsPopup.detach()},i.prototype.buildDirectionSection=function(){var i=this,n=e.$(this.facetSettingsSectionTemplate({_class:"coveo-direction"})),o=e.$(this.facetSettingsSectionIconTemplate()),s=e.$(this.facetSettingsItemsTemplate()),r=e.$(this.facetSettingsItemTemplate({label:t.l("Ascending"),title:t.l("Ascending")})).click(function(e){return i.handleDirectionClick(e,"ascending")}),a=e.$(this.facetSettingsItemTemplate({label:t.l("Descending"),title:t.l("Descending")})).click(function(e){return i.handleDirectionClick(e,"descending")});return s.append(r,a),n.append(o,s),this.activeSort.directionToggle?this.selectItem(this.getItems(n).first()):n.addClass("coveo-disabled"),n},i.prototype.buildSaveStateSection=function(){var i=this,n=e.$(this.facetSettingsSectionTemplate({_class:"coveo-save-state"})),o=e.$(this.facetSettingsSectionIconTemplate()),s=e.$(this.facetSettingsItemsTemplate());this.facetStateLocalStorage=new e.LocalStorageUtils("facet-state-"+this.facet.options.uniqueId),this.includedStateAttribute=e.Models.QueryStateModel.getFacetId(this.facet.options.uniqueId),this.excludedStateAttribute=e.Models.QueryStateModel.getFacetId(this.facet.options.uniqueId,!1),this.operatorStateAttribute=e.Models.QueryStateModel.getFacetOperator(this.facet.options.uniqueId);e.$(this.facetSettingsItemTemplate({label:t.l("SaveFacetState"),title:t.l("SaveFacetState")})).fastClick(function(e){return i.handleSaveStateClick(e)}).appendTo(s);return n.append(o,s),n},i.prototype.buildClearStateSection=function(){{var i=this,n=e.$(this.facetSettingsSectionTemplate({_class:"coveo-clear-state"})),o=e.$(this.facetSettingsSectionIconTemplate()),s=e.$(this.facetSettingsItemsTemplate());
e.$(this.facetSettingsItemTemplate({label:t.l("ClearFacetState"),title:t.l("ClearFacetState")})).fastClick(function(e){return i.handleClearStateClick(e)}).appendTo(s)}return n.append(o,s),n},i.prototype.buildHideSection=function(){{var i=this,n=e.$(this.facetSettingsSectionTemplate({_class:"coveo-hide"})),o=e.$(this.facetSettingsSectionIconTemplate()),s=e.$(this.facetSettingsItemsTemplate());e.$(this.facetSettingsItemTemplate({label:t.l("Collapse"),title:t.l("HideFacet")})).fastClick(function(){i.facet.collapseFacet(),i.settingsPopup.detach()}).appendTo(s)}return n.append(o,s),n},i.prototype.buildShowSection=function(){{var i=this,n=e.$(this.facetSettingsSectionTemplate({_class:"coveo-show"})),o=e.$(this.facetSettingsSectionIconTemplate()),s=e.$(this.facetSettingsItemsTemplate());e.$(this.facetSettingsItemTemplate({label:t.l("Expand"),title:t.l("Expand")})).click(function(){i.facet.expandFacet(),i.settingsPopup.detach()}).appendTo(s)}return n.append(o,s),n},i.prototype.handleClickSettingsButtons=function(t,i){var n=this;this.settingsPopup.is(":visible")?this.settingsPopup.detach():(e.JQueryUtils.positionPopup(this.settingsPopup,e.$(t.delegateTarget),e.$(this.facet.root),e.$(this.facet.root),this.getPopupAlignment()),this.hideSection.toggle(!e.$(this.facet.element).hasClass("coveo-collapsed")),this.showSection.toggle(e.$(this.facet.element).hasClass("coveo-collapsed")),this.facet.options.enableSettingsFacetState&&this.clearStateSection.toggle(!e.Utils.isNullOrUndefined(this.facetStateLocalStorage.load())),e._.each(this.enabledSorts,function(e,t){n.activeSort.name.toLowerCase()==e.name.toLowerCase()?n.selectItem(i.sortItems[t]):n.unselectItem(i.sortItems[t])}))},i.prototype.handleClickSortButton=function(t,n){this.activeSort=n,n.directionToggle&&e._.contains(this.enabledSorts,i.availableSorts[this.activeSort.relatedSort])?this.activateDirectionSection():this.disableDirectionSection(),this.selectItem(e.$(t.target)),this.closePopupAndUpdateSort()},i.prototype.handleDirectionClick=function(t,n){e.$(t.target).parent().parent().hasClass("coveo-disabled")||-1!=this.activeSort.name.indexOf(n)||(this.activeSort=i.availableSorts[this.activeSort.relatedSort],this.unselectSection(this.directionSection),this.selectItem(e.$(t.target)),"custom"==this.activeSort.name&&this.customSortDirection!=n&&(this.customSortDirection=n,this.customSortDirectionChange=!0),this.closePopupAndUpdateSort())},i.prototype.handleSaveStateClick=function(){this.facetStateLocalStorage.save({included:this.facet.queryStateModel.get(this.includedStateAttribute),excluded:this.facet.queryStateModel.get(this.excludedStateAttribute),operator:this.facet.queryStateModel.get(this.operatorStateAttribute)}),this.closePopup()},i.prototype.handleClearStateClick=function(){var e=this;this.facetStateLocalStorage.remove(),this.facet.reset(),this.closePopup(),this.facet.triggerNewQuery(function(){return e.facet.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.facetClearAll,{facetId:e.facet.options.uniqueId})})},i.prototype.handleMouseEventOnButton=function(t){var i,n=this;this.settingsButton.click(function(e){return n.handleClickSettingsButtons(e,t)}),e.$([this.settingsIcon[0],this.settingsPopup[0]]).mouseleave(function(){return i=setTimeout(function(){n.settingsPopup.detach()},300)}).mouseenter(function(){return clearTimeout(i)})},i.prototype.activateDirectionSection=function(){this.directionSection.removeClass("coveo-disabled"),this.unselectSection(this.directionSection),this.selectItem(this.getItems(this.directionSection).first())},i.prototype.disableDirectionSection=function(){this.directionSection.addClass("coveo-disabled"),this.unselectSection(this.directionSection)},i.prototype.getItems=function(e){return e.find(".coveo-item")},i.prototype.unselectSection=function(e){this.getItems(e).removeClass("coveo-selected")},i.prototype.selectItem=function(e){e.addClass("coveo-selected")},i.prototype.unselectItem=function(e){e.removeClass("coveo-selected")},i.prototype.filterDuplicateForRendering=function(){this.hasDuplicate("alphaascending","alphadescending")&&this.enabledSortsIgnoreRenderBecauseOfPairs.push(i.availableSorts.alphadescending),this.hasDuplicate("computedfieldascending","computedfielddescending")&&this.enabledSortsIgnoreRenderBecauseOfPairs.push(i.availableSorts.computedfielddescending)},i.prototype.getPopupAlignment=function(){var t=e.DeviceUtils.isMobileDevice()?1:2,i=2;return{horizontal:t,vertical:i}},i.prototype.hasDuplicate=function(t,i){var n=e._.filter(this.enabledSorts,function(e){return e.name==t||e.name==i});return void 0!=n&&2==n.length},i.availableSorts={score:{label:t.l("Score"),directionToggle:!1,description:t.l("ScoreDescription"),name:"score"},occurrences:{label:t.l("Occurrences"),directionToggle:!1,description:t.l("OccurrencesDescription"),name:"occurrences"},alphaascending:{label:t.l("Label"),directionToggle:!0,description:t.l("LabelDescription"),name:"alphaascending",relatedSort:"alphadescending"},alphadescending:{label:t.l("Label"),directionToggle:!0,description:t.l("LabelDescription"),name:"alphadescending",relatedSort:"alphaascending"},computedfieldascending:{label:t.l("Value"),directionToggle:!0,description:t.l("ValueDescription"),name:"computedfieldascending",relatedSort:"computedfielddescending"},computedfielddescending:{label:t.l("Value"),directionToggle:!0,description:t.l("ValueDescription"),name:"computedfielddescending",relatedSort:"computedfieldascending"},chisquare:{label:t.l("RelativeFrequency"),directionToggle:!1,description:t.l("RelativeFrequencyDescription"),name:"chisquare"},custom:{label:t.l("Custom"),directionToggle:!0,description:t.l("CustomDescription"),name:"custom",relatedSort:"custom"}},i}();t.FacetSettings=i}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function i(e,t){this.facet=e,this.facetValueElementKlass=t,this.valueList={}}return i.prototype.build=function(){return this.valueContainer=e.$('<ul class="coveo-values"/>'),this.valueContainer},i.prototype.get=function(i){var n;return i instanceof t.FacetValue?n=i.value:(i=e.Utils.anyTypeToString(i),n=i.toLowerCase()),this.ensureFacetValueIsInList(i),this.valueList[n]},i.prototype.select=function(e){var t=this.get(e);return t.select(),t},i.prototype.unselect=function(e){var t=this.get(e);return t.unselect(),t},i.prototype.exclude=function(e){var t=this.get(e);return t.exclude(),t},i.prototype.unExclude=function(e){var t=this.get(e);return t.unexclude(),t},i.prototype.toggleSelect=function(e){var t=this.get(e);return t.facetValue.selected?t.unselect():t.select(),t},i.prototype.toggleExclude=function(e){var t=this.get(e);return t.facetValue.excluded?t.unexclude():t.exclude(),t},i.prototype.rebuild=function(i){var n=this;this.valueContainer.empty();var o=this._getValuesToBuildWith(),s=i;e._.each(o,function(e,t){if(n.facetValueShouldBeRemoved(e))n.facet.values.remove(e.value),s+=1;else if(s>t){var i=new n.facetValueElementKlass(n.facet,e,!0);n.valueList[e.value]=i;var o=i.build().listElement;n.valueContainer.append(o)}}),t.FacetUtils.addNoStateCssClassToFacetValues(this.facet,this.valueContainer),t.FacetUtils.clipCaptionsToAvoidOverflowingTheirContainer(this.facet)},i.prototype._getValuesToBuildWith=function(){return this.facet.facetSettings?this.facet.facetSettings.reorderValues(this.facet.values.getAll()):this.facet.values.getAll()},i.prototype.facetValueShouldBeRemoved=function(e){return!(0!=e.occurrences||0!=e.delta&&void 0!=e.delta||e.selected||e.excluded||this.facet.keepDisplayedValuesNextTime)},i.prototype.ensureFacetValueIsInList=function(e){var i;e instanceof t.FacetValue?(i=this.facet.values.get(e.value),null==i&&(this.facet.values.add(e),i=e)):(i=this.facet.values.get(e),null==i&&(i=t.FacetValue.createFromValue(e),this.facet.values.add(i))),void 0==this.valueList[i.value]?(this.valueList[i.value]=new t.FacetValueElement(this.facet,i,!0),this.valueList[i.value].build()):this.valueList[i.value].facetValue=i},i.prototype.addNoStateCssClassToFacetValues=function(){if(0!=this.facet.values.getSelected().length){var t=this.valueContainer.find("li").not(".coveo-selected");e._.each(t,function(t){e.$(t).addClass("coveo-no-state")})}},i}();t.FacetValuesList=i}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function i(e,t){this.facet=e,this.facetValue=t}return i.prototype.build=function(){this.listElement=e.$('<li class="coveo-value coveo-selectable"/>'),this.listElement.data("value",this.facetValue.value),this.facetValue.excluded||(this.excludeIcon=this._buildExcludeIcon().appendTo(this.listElement)),this.label=e.$("<label/>").appendTo(this.listElement),e.Utils.exists(this.facetValue.computedField)&&(this.computedField=this._buildValueComputedField().appendTo(this.label),this.label.addClass("coveo-with-computed-field"));var t=e.$('<div class="coveo-label"/>').appendTo(this.label);return this.checkbox=this._buildValueCheckbox().appendTo(t),this.stylishCheckbox=this._buildValueStylishCheckbox().appendTo(t),this.facet.options.showIcon&&(this.icon=this._buildValueIcon().appendTo(t)),this.valueCaption=this._buildValueCaption().appendTo(t),this.valueCount=this._buildValueCount().appendTo(t),this._setCssClassOnListValueElement(),this.bindEvent({displayNextTime:!0,pinFacet:this.facet.options.preservePosition}),this},i.prototype.bindEvent=function(t){this.isOmnibox=e.Utils.isNullOrUndefined(t.omniboxObject)?!1:!0,this._handleEventForCheckboxChange(t),this.facetValue.excluded?this._handleEventForExcludedValueElement(t):this._handleEventForValueElement(t)},i.prototype.select=function(){this.facetValue.selected=!0,this.facetValue.excluded=!1,this._setCssClassOnListValueElement()},i.prototype.unselect=function(){this.facetValue.selected=!1,this.facetValue.excluded=!1,this._setCssClassOnListValueElement()},i.prototype.exclude=function(){this.facetValue.selected=!1,this.facetValue.excluded=!0,this._setCssClassOnListValueElement()},i.prototype.unexclude=function(){this.facetValue.selected=!1,this.facetValue.excluded=!1,this._setCssClassOnListValueElement()},i.prototype._buildExcludeIcon=function(){return e.$("<div />").attr("title",t.l("Exclude",this.facet.getValueCaption(this.facetValue))).addClass("coveo-exclude")},i.prototype._buildValueComputedField=function(){var t=this.facetValue.getFormattedComputedField(this.facet.options.computedFieldFormat);return e.Utils.isNonEmptyString(t)?e.$("<span/>").addClass("coveo-computed-field").text(t):e.$([])},i.prototype._buildValueCheckbox=function(){var i=e.$('<input type="checkbox"/>');return i.prop("checked",this.facetValue.selected),i.prop("disabled",this.facetValue.excluded),t.Component.pointElementsToDummyForm(i),i},i.prototype._buildValueStylishCheckbox=function(){var t=e.$("<div/>").addClass("coveo-checkbox");return e.$("<span/>").appendTo(t),t},i.prototype._buildValueIcon=function(){var t=this._getValueIcon();return e.Utils.exists(t)?e.$('<img class="coveo-icon"/>').prop("src",this._getValueIcon()):this._buildValueIconFromSprite()},i.prototype._getValueIcon=function(){return e.Utils.exists(this.facet.options.valueIcon)?this.facet.options.valueIcon(this.facetValue):void 0},i.prototype._buildValueIconFromSprite=function(){return e.$("<div />").addClass("coveo-icon").addClass(this.facet.options.field.substr(1)).addClass(this.facetValue.value)},i.prototype._buildValueCaption=function(){return e.$('<span class="coveo-caption"/>').text(this.facet.getValueCaption(this.facetValue))},i.prototype._buildValueCount=function(){var t=this.facetValue.getFormattedCount();if(e.Utils.isNonEmptyString(t)){var i=e.$("<span/>").addClass("coveo-count").text(t);return i}return e.$([])},i.prototype._handleSelectValue=function(e){var i=this;this.facet.keepDisplayedValuesNextTime=e.displayNextTime&&!this.facet.options.useAnd;var n;this.facetValue.excluded?(n=t.AnalyticsActionCauseList.facetUnexclude,this.facet.unexcludeValue(this.facetValue)):(n=this.facetValue.selected?t.AnalyticsActionCauseList.facetDeselect:t.AnalyticsActionCauseList.facetSelect,this.facet.toggleSelectValue(this.facetValue)),this.isOmnibox&&(n=t.AnalyticsActionCauseList.omniboxFacet),this.facet.triggerNewQuery(function(){return i.facet.usageAnalytics.logSearchEvent(n,i.getAnalyticsFacetMeta())})},i.prototype._handleExcludeClick=function(e){var i=this;this.facet.keepDisplayedValuesNextTime=e.displayNextTime&&!this.facet.options.useAnd,this.facet.toggleExcludeValue(this.facetValue);var n=this.isOmnibox?t.AnalyticsActionCauseList.omniboxFacet:t.AnalyticsActionCauseList.facetExclude;this.facet.triggerNewQuery(function(){return i.facet.usageAnalytics.logSearchEvent(n,i.getAnalyticsFacetMeta())})},i.prototype._handleEventForExcludedValueElement=function(e){var t=this;this.label.fastClick(function(i){e.pinFacet&&t.facet.pinFacetPosition(),e.omniboxObject&&t._omniBoxCloseEvent(e.omniboxObject),t._handleSelectValue(e),i.stopPropagation()})},i.prototype._handleEventForValueElement=function(e){var t=this;this.excludeIcon.fastClick(function(i){e.omniboxObject&&t._omniBoxCloseEvent(e.omniboxObject),t._handleExcludeClick(e),i.stopPropagation()}),this.label.fastClick(function(i){e.pinFacet&&t.facet.pinFacetPosition(),i.preventDefault(),t.checkbox.change()})},i.prototype._handleEventForCheckboxChange=function(t){var i=this;this.checkbox.change(function(){t.omniboxObject&&i._omniBoxCloseEvent(t.omniboxObject),i._handleSelectValue(t),e.DeviceUtils.isMobileDevice()&&e.Defer.defer(function(){e.ModalBox.close(!0),i.facet.facetSearch.completelyDismissSearch()})})},i.prototype._omniBoxCloseEvent=function(e){e.closeOmniBox(),e.clear()},i.prototype._setCssClassOnListValueElement=function(){this.listElement.toggleClass("coveo-selected",this.facetValue.selected),this.listElement.toggleClass("coveo-excluded",this.facetValue.excluded)},i.prototype.getAnalyticsFacetMeta=function(){return{facetId:this.facet.options.uniqueId,facetValue:this.facetValue.value}},i}();t.ValueElement=i}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(t){function i(i,n,o){var s=this;t.call(this,i,n),this.facet=i,this.facetValue=n,this.keepDisplayedValueNextTime=o,this.firstQuery=!0,e.$(i.root).one(e.Events.QueryEvents.querySuccess,function(){s.firstQuery=!1})}return __extends(i,t),i.prototype.bindEvent=function(){t.prototype.bindEvent.call(this,{displayNextTime:this.keepDisplayedValueNextTime,pinFacet:this.facet.options.preservePosition})},i}(t.ValueElement);t.FacetValueElement=i}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){var t=function(e){function t(t,i,n){e.call(this,t,i),this.facet=t,this.facetValue=i,this.eventArg=n}return __extends(t,e),t.prototype.bindEvent=function(){e.prototype.bindEvent.call(this,{displayNextTime:!1,pinFacet:!1,omniboxObject:this.eventArg})},t}(e.ValueElement);e.OmniBoxValueElement=t}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function t(e,t){this.facet=e,this.facetValueElementKlass=t}return t.prototype.build=function(t){var i=this,n=e._.map(t,function(t){return e._.find(i.facet.values.getAll(),function(e){return e.value==t.value})||t});return e._.reduce(e._.map(n,function(e){return new i.facetValueElementKlass(i.facet,e,i.facet.keepDisplayedValuesNextTime).build().listElement}),function(e,t){return e.add(t)})},t}();t.FacetSearchValuesList=i}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function i(e,t){this.facet=e,this.facetValue=t}return i.prototype.build=function(i){var n=this;void 0===i&&(i=!0),e.Assert.exists(this.facetValue);var o=e.DeviceUtils.isMobileDevice()?e.$("<div/>"):e.$("<span/>");o.addClass("coveo-value"),o.toggleClass("coveo-selected",this.facetValue.selected),o.toggleClass("coveo-excluded",this.facetValue.excluded),o.attr("title",this.getBreadcrumbTooltip()),e.$("<span/>").addClass("coveo-caption").text(this.facet.getValueCaption(this.facetValue)).appendTo(o),e.$("<span/>").addClass("coveo-clear").appendTo(o);var s=!1;return o.fastClick(function(){s||(s=!0,n.facetValue.excluded?n.facet.unexcludeValue(n.facetValue.value):n.facet.deselectValue(n.facetValue.value),n.facet.triggerNewQuery(function(){return n.facet.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.breadcrumbFacet,{facetId:n.facet.options.uniqueId,facetValue:n.facetValue.value})}))}),o},i.prototype.getBreadcrumbTooltip=function(){var t=[this.facet.getValueCaption(this.facetValue),this.facetValue.getFormattedCount(),this.facetValue.getFormattedComputedField(this.facet.options.computedFieldFormat)];return e._.compact(t).join(" ")},i}();t.BreadcrumbValueElement=i}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function t(t,i,n){this.facet=t,this.facetValues=i,this.breadcrumbValueElementKlass=n,this.setExpandedAndCollapsed(),this.elem=e.$("<div/>").addClass("coveo-facet-breadcrumb");var o=e.DeviceUtils.isMobileDevice()?e.$("<div/>"):e.$("<span/>");o.addClass("coveo-title").text(this.facet.options.title+(e.DeviceUtils.isMobileDevice()?"":":")).appendTo(this.elem),this.valueContainer=e.$("<span/>").addClass("coveo-values").appendTo(this.elem)}return t.prototype.build=function(){return this.buildExpanded(),0!=this.collapsed.length&&this.buildCollapsed(),this.elem},t.prototype.buildExpanded=function(){var t=this;e._.each(this.expanded,function(i,n){0==n||e.DeviceUtils.isMobileDevice()||e.$("<span/>").addClass("coveo-separator").text(", ").appendTo(t.valueContainer),new t.breadcrumbValueElementKlass(t.facet,i).build().appendTo(t.valueContainer)})},t.prototype.buildCollapsed=function(){var t=this,i=e._.filter(this.collapsed,function(e){return e.selected}).length,n=e._.filter(this.collapsed,function(e){return e.excluded}).length;e.Assert.check(i+n==this.collapsed.length);var o=e.$("<div/>").addClass("coveo-value");e.DeviceUtils.isMobileDevice()||e.$("<span/>").addClass("coveo-separator").text(", ").appendTo(o),i>0&&(e.$("<span/>").addClass("coveo-multi-count").text(Globalize.format(i,"n0")).appendTo(o),e.$("<div/>").addClass("coveo-selected").addClass("coveo-multi-icon").appendTo(o)),n>0&&(e.$("<span/>").addClass("coveo-multi-count").text(Globalize.format(n,"n0")).appendTo(o),e.$("<div />").addClass("coveo-excluded").addClass("coveo-multi-icon").appendTo(o));var s=e._.map(this.collapsed,function(e){return new t.breadcrumbValueElementKlass(t.facet,e)}),r=e._.map(s,function(e){return e.getBreadcrumbTooltip()});o.attr("title",r.join("\n")),o.fastClick(function(){var t=[];e._.forEach(s,function(i){e.DeviceUtils.isMobileDevice()||t.push(e.$("<span/>").addClass("coveo-separator").text(", ")[0]),t.push(i.build(!1).get(0))}),e.$(t).insertBefore(o),o.detach()}),this.valueContainer.append(o)},t.prototype.setExpandedAndCollapsed=function(){this.facetValues.length>this.facet.options.numberOfValuesInBreadcrumb?(this.collapsed=e._.rest(this.facetValues,this.facet.options.numberOfValuesInBreadcrumb-1),this.expanded=e._.first(this.facetValues,this.facet.options.numberOfValuesInBreadcrumb-1)):(this.collapsed=[],this.expanded=this.facetValues)},t}();t.BreadcrumbValueList=i}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function i(e,t,i,n){this.facet=e,this.facetValues=t,this.omniboxObject=i,this.omniBoxValueElementKlass=n}return i.prototype.build=function(){var t=this,i=[];return e._.each(this.facetValues,function(e){i.push(t.buildOmniBoxForOneRow(e,t.omniboxObject))}),this.buildFinalOmniBoxElement(i)},i.prototype.buildOmniBoxForOneRow=function(t,i){var n=new this.omniBoxValueElementKlass(this.facet,t,i),o=n.build().listElement,s=i.completeQueryExpression.regex,r=i.completeQueryExpression.word;o.find(".coveo-caption").html(this.highlightOmniBoxMatch(this.facet.getValueCaption(t),s,r));var a=e.$("<div class='coveo-omnibox-selectable coveo-omnibox-facet-value'></div>").append(o);return a.on("keyboardSelect",function(){o.find("input[type=checkbox]").change()}),a},i.prototype.buildFinalOmniBoxElement=function(i){var n=this.buildOmniBoxHeader();if(e.Utils.isEmptyArray(i))return void 0;var o=e.$("<div></div>").append(n,i);return t.FacetUtils.addNoStateCssClassToFacetValues(this.facet,o),o},i.prototype.buildOmniBoxHeader=function(){var t=e.$("<span class='coveo-icon "+this.facet.options.field.substr(1)+"'></span>"),i=this.facet.options.title;return e.$("<div class='coveo-omnibox-facet-header'></div>").append(t,i)},i.prototype.highlightOmniBoxMatch=function(e,t,i){var n=e.search(t),o=n+i.length;return e.slice(0,n)+"<span class='coveo-highlights'>"+e.slice(n,o)+"</span>"+e.slice(o)},i.prototype.omniBoxCloseEvent=function(e){e.closeOmniBox(),e.clear()},i}();t.OmniboxValuesList=i}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){var t=function(){function e(){}return e.populateOmniBox="populateOmniBox",e.openOmniBox="openOmniBox",e.closeOmniBox="closeOmniBox",e}();e.OmniBoxEvents=t}(t=e.Events||(e.Events={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r,a){var l=this;void 0===a&&(a=n.ID),i.call(this,o,a,r),this.element=o,this.options=s,this.keepDisplayedValuesNextTime=!1,this.values=new t.FacetValues,this.firstQuery=!0,this.canFetchMore=!0,this.showingWaitAnimation=!1,this.listenToQueryStateChange=!0,this.options=t.ComponentOptions.initComponentOptions(o,n,s),null!=this.options.valueCaption&&(this.options.availableSorts=e._.filter(this.options.availableSorts,function(e){return!/^alpha.*$/.test(e)})),this._omniboxZIndex=n.omniboxIndex,n.omniboxIndex--,this._checkForComputedFieldAndSort(),this._checkForValueCaptionType(),this._checkForAllowedValuesOption(),this._checkForCustomSort(),this._initFacetQueryController(),this._initQueryEvents(),this._initQueryStateEvents(),this._initComponentStateEvents(),this._initOmniBoxEvents(),this._initBreadCrumbEvents(),this.numberOfValues=this.options.numberOfValues,e.$(window).resize(function(){l.disabled||t.FacetUtils.clipCaptionsToAvoidOverflowingTheirContainer(l)}),this._updateAppearanceDependingOnState(),e.$(this.root).one(e.Events.QueryEvents.querySuccess,function(){l.firstQuery=!1})}return __extends(n,i),n.prototype.createDom=function(){if(this._initBottomAndTopSpacer(),this._buildFacetContent(),this._updateAppearanceDependingOnState(),this.facetSettings&&this.options.enableSettingsFacetState){var t=e._.once(e.$.proxy(this.facetSettings.loadSavedState,this.facetSettings));this.bind.onRoot(e.Events.QueryEvents.newQuery,t)}},n.prototype.selectValue=function(t){e.Assert.exists(t),this.ensureDom(),this.logger.info("Selecting facet value",this.facetValuesList.select(t)),this._facetValueHasChanged()},n.prototype.selectMultipleValues=function(t){var i=this;e.Assert.exists(t),this.ensureDom(),e._.each(t,function(e){i.logger.info("Selecting facet value",i.facetValuesList.select(e))}),this._facetValueHasChanged()},n.prototype.deselectValue=function(t){e.Assert.exists(t),this.ensureDom(),this.logger.info("Deselecting facet value",this.facetValuesList.unselect(t)),this._facetValueHasChanged()},n.prototype.deselectMultipleValues=function(t){var i=this;e.Assert.exists(t),this.ensureDom(),e._.each(t,function(e){i.logger.info("Deselecting facet value",i.facetValuesList.unselect(e))}),this._facetValueHasChanged()},n.prototype.excludeValue=function(t){e.Assert.exists(t),this.ensureDom(),this.logger.info("Excluding facet value",this.facetValuesList.exclude(t)),this._facetValueHasChanged()},n.prototype.excludeMultipleValues=function(t){var i=this;e.Assert.exists(t),this.ensureDom(),e._.each(t,function(e){i.logger.info("Excluding facet value",i.facetValuesList.exclude(e))}),this._facetValueHasChanged()},n.prototype.unexcludeValue=function(t){e.Assert.exists(t),this.ensureDom(),this.logger.info("Unexcluding facet value",this.facetValuesList.unExclude(t)),this._facetValueHasChanged()},n.prototype.unexcludeMultipleValues=function(t){var i=this;e.Assert.exists(t),this.ensureDom(),e._.each(t,function(e){i.logger.info("Unexcluding facet value",i.facetValuesList.unExclude(e))}),this._facetValueHasChanged()},n.prototype.toggleSelectValue=function(t){e.Assert.exists(t),this.ensureDom(),this.logger.info("Toggle select facet value",this.facetValuesList.toggleSelect(t)),this._facetValueHasChanged()},n.prototype.toggleExcludeValue=function(t){e.Assert.exists(t),this.ensureDom(),this.logger.info("Toggle exclude facet value",this.facetValuesList.toggleExclude(t)),this._facetValueHasChanged()},n.prototype.getDisplayedValues=function(){return this.ensureDom(),e._.first(e._.pluck(this.values.getAll(),"value"),this.numberOfValues)},n.prototype.getSelectedValues=function(){return this.ensureDom(),e._.map(this.values.getSelected(),function(e){return e.value})},n.prototype.getExcludedValues=function(){return this.ensureDom(),e._.map(this.values.getExcluded(),function(e){return e.value})},n.prototype.reset=function(){this.ensureDom(),this.values.reset(),this._rebuildValueElements(),this._updateAppearanceDependingOnState(),this._updateQueryStateModel()},n.prototype.switchToAnd=function(){this.ensureDom(),this.logger.info("Switching to AND"),this.options.useAnd=!0,this._rebuildOperatorToggle(),this._updateOperatorQueryStateModel()},n.prototype.getEndpoint=function(){return this.queryController.getEndpoint()},n.prototype.switchToOr=function(){this.ensureDom(),this.logger.info("Switching to OR"),this.options.useAnd=!1,this._rebuildOperatorToggle(),this._updateOperatorQueryStateModel()},n.prototype.updateSort=function(e){var i=this;this.options.sortCriteria!=e&&(this.options.sortCriteria=e,this.triggerNewQuery(function(){return i.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.facetSortValues,{facetId:i.options.uniqueId,facetSortBy:e})}))},n.prototype.collapseFacet=function(){this.collapseElement.hide(),this.excludeElement.show(),e.$(this.element).addClass("coveo-collapsed")},n.prototype.expandFacet=function(){this.excludeElement.hide(),this.collapseElement.show(),e.$(this.element).removeClass("coveo-collapsed"),t.FacetUtils.clipCaptionsToAvoidOverflowingTheirContainer(this)},n.prototype.unfadeInactiveValuesInMainList=function(){e.$(this.element).removeClass("coveo-fade")},n.prototype.fadeInactiveValuesInMainList=function(){e.$(this.element).addClass("coveo-fade")},n.prototype.showWaitingAnimation=function(){var t=this;e.Defer.defer(function(){t.showingWaitAnimation||(t.headerElement.find(".coveo-icon").first().css("display","none"),t.headerElement.find(".coveo-wait-animation").css("display",""),t.showingWaitAnimation=!0)})},n.prototype.hideWaitingAnimation=function(){var t=this;e.Defer.defer(function(){t.showingWaitAnimation&&(t.headerElement.find(".coveo-icon").css("display",""),t.headerElement.find(".coveo-wait-animation").css("display","none"),t.showingWaitAnimation=!1)})},n.prototype.processFacetSearchAllResultsSelected=function(i){var n=this,o=[];e._.each(i,function(e){n._ensureFacetValueIsInList(e),o.push(e.value)}),this._updateQueryStateModel(),this.triggerNewQuery(function(){return n.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.facetSelectAll,{facetId:n.options.uniqueId})})},n.prototype.pinFacetPosition=function(){this.pinnedViewportPosition=this.element.getBoundingClientRect().top},n.prototype.getValueCaption=function(i){e.Assert.exists(i);var n=i.lookupValue||i.value,o=n;return o=t.FacetUtils.tryToGetTranslatedCaption(n),e.Utils.exists(this.options.valueCaption)&&("object"==typeof this.options.valueCaption&&(o=this.options.valueCaption[n]||o),"function"==typeof this.options.valueCaption&&(this.values.get(n),o=this.options.valueCaption.call(this,this.facetValuesList.get(n).facetValue))),o},n.prototype.enable=function(){i.prototype.enable.call(this)},n.prototype.disable=function(){i.prototype.disable.call(this)},n.prototype.triggerNewQuery=function(t){var i=this;this.queryController.deferExecuteQuery({beforeExecuteQuery:t}),e.Defer.defer(function(){return i.showWaitingAnimation()})},n.prototype._checkForComputedFieldAndSort=function(){-1!=this.options.sortCriteria.toLowerCase().indexOf("computedfield")&&e.Utils.isNullOrUndefined(this.options.computedField)&&this.logger.warn("Sort criteria is specified as ComputedField, but the facet uses no computed field. Facet will always be empty !",this)},n.prototype._checkForValueCaptionType=function(){this.options.valueCaption&&"function"==typeof this.options.valueCaption&&(this.options.enableFacetSearch=!1,this.options.includeInOmniBox=!1,this.logger.warn("Using a function as valueCaption is now deprecated. Use a json key value pair instead. Facet search and omnibox has been disabled for this facet",this))},n.prototype._checkForAllowedValuesOption=function(){void 0!=this.options.allowedValues&&(this.logger.info("Allowed values option set on facet : Disabling more/less",this),this.options.enableMoreLess=!1,this.logger.info("Allowed values options set on facet : Number of values set to lenght of allowed values : "+this.options.allowedValues.length,this),this.options.numberOfValues=this.options.allowedValues.length,this.logger.info("Allowed values options set in facet : Disabling facet search",this),this.options.enableFacetSearch=!1)},n.prototype._checkForCustomSort=function(){void 0==this.options.customSort||e._.contains(this.options.availableSorts,"custom")||this.options.availableSorts.unshift("custom"),"custom"==this.options.availableSorts[0]&&(this.options.sortCriteria="nosort")},n.prototype._initQueryEvents=function(){this.bind.onRoot(e.Events.QueryEvents.duringQuery,this._handleDuringQuery),this.bind.onRoot(e.Events.QueryEvents.buildingQuery,this._handleBuildingQuery),this.bind.onRoot(e.Events.QueryEvents.doneBuildingQuery,this._handleDoneBuildingQuery),this.bind.onRoot(e.Events.QueryEvents.deferredQuerySuccess,this._handleDeferredQuerySuccess)},n.prototype._initQueryStateEvents=function(){this.includedAttributeId=e.Models.QueryStateModel.getFacetId(this.options.uniqueId),this.excludedAttributeId=e.Models.QueryStateModel.getFacetId(this.options.uniqueId,!1),this.operatorAttributeId=e.Models.QueryStateModel.getFacetOperator(this.options.uniqueId),this.lookupValueAttributeId=e.Models.QueryStateModel.getFacetLookupValue(this.options.uniqueId),this.queryStateModel.registerNewAttribute(this.includedAttributeId,[]),this.queryStateModel.registerNewAttribute(this.excludedAttributeId,[]),this.queryStateModel.registerNewAttribute(this.operatorAttributeId,""),this.queryStateModel.registerNewAttribute(this.lookupValueAttributeId,{});var t=this.queryStateModel.getEventName(e.Models.Model.eventTypes.change);this.bind.onRoot(t,this._handleQueryStateChanged)},n.prototype._initComponentStateEvents=function(){this.componentStateId=e.Models.QueryStateModel.getFacetId(this.options.uniqueId),this.componentStateModel.registerComponent(this.componentStateId,this)},n.prototype._initOmniBoxEvents=function(){this.options.includeInOmniBox&&this.bind.onRoot(e.Events.OmniBoxEvents.populateOmniBox,this._handlePopulateOmnibox)},n.prototype._initBreadCrumbEvents=function(){this.options.includeInBreadcrumb&&(this.bind.onRoot(e.Events.BreadcrumbEvents.populateBreadcrumb,this._handlePopulateBreadcrumb),this.bind.onRoot(e.Events.BreadcrumbEvents.clearBreadcrumb,this._handleClearBreadcrumb))},n.prototype._initBottomAndTopSpacer=function(){var t=this,i=e.$(this.options.paddingContainer).children(".coveo-bottomSpace"),n=e.$(this.options.paddingContainer).children(".coveo-topSpace");this.options.preservePosition&&(e.$(this.options.paddingContainer).mouseleave(function(){return t._unpinFacetPosition()}),this.pinnedTopSpace=n,this.pinnedBottomSpace=i,0==this.pinnedTopSpace.length&&(this.pinnedTopSpace=e.$("<div />").addClass("coveo-topSpace").prependTo(this.options.paddingContainer)),0==this.pinnedBottomSpace.length&&(this.pinnedBottomSpace=e.$("<div />").addClass("coveo-bottomSpace").appendTo(this.options.paddingContainer)))},n.prototype._initFacetQueryController=function(){this.facetQueryController=new e.Controllers.FacetQueryController(this)
},n.prototype._initFacetValuesList=function(){this.facetValuesList=new t.FacetValuesList(this,t.FacetValueElement),e.$(this.element).append(this.facetValuesList.build())},n.prototype._initFacetSearch=function(){this.facetSearch=new t.FacetSearch(this,t.FacetSearchValuesList),e.$(this.element).append(this.facetSearch.build())},n.prototype._updateIncludedQueryStateModel=function(){var e={included:this.getSelectedValues(),title:this.includedAttributeId};this.queryStateModel.set(this.includedAttributeId,e.included)},n.prototype._facetValueHasChanged=function(){var t=this;this._updateQueryStateModel(),this._rebuildValueElements(),e.Defer.defer(function(){t._updateAppearanceDependingOnState()})},n.prototype._updateExcludedQueryStateModel=function(){var e={title:this.excludedAttributeId,excluded:this.getExcludedValues()};this.queryStateModel.set(this.excludedAttributeId,e.excluded)},n.prototype._updateOperatorQueryStateModel=function(){if(this.options.allowTogglingOperator){var e="";(0!=this.getSelectedValues().length||0!=this.getExcludedValues().length)&&(e=this.options.useAnd?"and":"or"),this.queryStateModel.set(this.operatorAttributeId,e)}},n.prototype._updateLookupValueQueryStateModel=function(){if(this.options.lookupField){var t={};e._.each(this.values.getSelected().concat(this.values.getExcluded()),function(e){t[e.value]=e.lookupValue}),this.queryStateModel.set(this.lookupValueAttributeId,t)}},n.prototype._handleQueryStateChangedOperator=function(e){"and"==e?this.switchToAnd():"or"==e&&this.switchToOr()},n.prototype._handleQueryStateChangedIncluded=function(t){var i=e._.difference(this.getSelectedValues(),t);e.Utils.isNonEmptyArray(i)&&this.deselectMultipleValues(i),e.Utils.arrayEqual(this.getSelectedValues(),t,!1)||this.selectMultipleValues(t)},n.prototype._handleQueryStateChangedExcluded=function(t){var i=e._.difference(this.getExcludedValues(),t);e.Utils.isNonEmptyArray(i)&&this.unexcludeMultipleValues(i),e.Utils.arrayEqual(this.getExcludedValues(),t,!1)||this.excludeMultipleValues(t)},n.prototype._handleLookupvalueChanged=function(t){var i=this;e._.each(t,function(e,t){i.facetValuesList.get(decodeURIComponent(t)).facetValue.lookupValue=decodeURIComponent(e)})},n.prototype._handleQueryStateChanged=function(t,i){e.Assert.exists(i),this.ensureDom();var n=i.attributes,o=n[this.includedAttributeId],s=n[this.excludedAttributeId],r=n[this.operatorAttributeId],a=n[this.lookupValueAttributeId];this.listenToQueryStateChange&&(e.Utils.isNullOrEmptyString(r)||this._handleQueryStateChangedOperator(r),e.Utils.isNullOrUndefined(o)||this._handleQueryStateChangedIncluded(o),e.Utils.isNullOrUndefined(s)||this._handleQueryStateChangedExcluded(s),e.Utils.isNullOrUndefined(a)||this._handleLookupvalueChanged(a))},n.prototype._handlePopulateOmnibox=function(t,i){e.Assert.exists(i),e.Assert.exists(i.completeQueryExpression),this.canFetchMore?this._handleOmniBoxWithSearchInFacet(i):this._handleOmniBoxWithStaticValue(i)},n.prototype._handleOmniBoxWithStaticValue=function(i){var n=this,o=i.completeQueryExpression.regex,s=(i.completeQueryExpression.word,e._.first(e._.filter(this.getDisplayedValues(),function(e){return o.test(n.getValueCaption(n.facetValuesList.get(e).facetValue))}),this.options.numberOfValuesInOmniBox)),r=e._.map(s,function(e){return n.facetValuesList.get(e).facetValue}),a=new t.OmniboxValuesList(this,r,i,t.OmniBoxValueElement).build();i.rows.push({element:a?a.get(0):void 0,zIndex:this._omniboxZIndex})},n.prototype._handleOmniBoxWithSearchInFacet=function(i){var n=this,o=(i.completeQueryExpression.regex,e.$.Deferred());i.rows.push({deferred:o});var s=this.facetQueryController.recursiveFacetSearch(i.completeQueryExpression.word,this.options.numberOfValuesInOmniBox);s.done(function(s){var r=e._.map(s,function(e){return n.values.get(e.lookupValue)||t.FacetValue.create(e)}),a=new t.OmniboxValuesList(n,r,i,t.OmniBoxValueElement).build();o.resolve({element:a?a.get(0):void 0,zIndex:n._omniboxZIndex})}),s.fail(function(){o.resolve({element:void 0})})},n.prototype._handleDuringQuery=function(){this.ensureDom(),this.keepDisplayedValuesNextTime||this.fadeInactiveValuesInMainList(this.options.facetSearchDelay)},n.prototype._handleBuildingQuery=function(t,i){if(e.Assert.exists(i),e.Assert.exists(i.queryBuilder),this.facetQueryController.prepareForNewQuery(),this.values.hasSelectedOrExcludedValues()){var n=this.facetQueryController.computeOurFilterExpression();this.logger.trace("Putting filter in query",n),i.queryBuilder.advancedExpression.add(n)}},n.prototype._handleDoneBuildingQuery=function(t,i){e.Assert.exists(i),e.Assert.exists(i.queryBuilder);var n=i.queryBuilder;this.facetQueryController.putGroupByIntoQueryBuilder(n)},n.prototype._handleDeferredQuerySuccess=function(t,i){e.Assert.exists(i),this.unfadeInactiveValuesInMainList(),this.hideWaitingAnimation();var n=i.results.groupByResults[this.facetQueryController.lastGroupByRequestIndex];n||(this.keepDisplayedValuesNextTime=!1),this._processNewGroupByResults(n)},n.prototype._handlePopulateBreadcrumb=function(i,n){if(e.Assert.exists(n),this.values.hasSelectedOrExcludedValues()){var o=new t.BreadcrumbValueList(this,this.values.getSelected().concat(this.values.getExcluded()),t.BreadcrumbValueElement).build();n.breadcrumbs.push({element:o.get(0)})}},n.prototype._handleClearBreadcrumb=function(t,i){e.Assert.exists(i),this.reset()},n.prototype._processNewGroupByResults=function(i){this.logger.trace("Displaying group by results",i),void 0!=i&&void 0!=i.values&&(this.nbAvailableValues=i.values.length,this.canFetchMore=this.numberOfValues<this.nbAvailableValues);var n=new t.FacetValues(i);this._updateValues(n),this.numberOfValues>this.nbAvailableValues&&(this.numberOfValues=this.nbAvailableValues),this.values.hasSelectedOrExcludedValues()&&!this.options.useAnd&&this.options.isMultiValueField?this._triggerUpdateDeltaQuery(e._.filter(this.values.getAll(),function(e){return!e.selected&&!e.excluded})):this.values.getSelected().length>0&&!this.options.useAnd&&this.values.updateDeltaWithFilteredFacetValues(new t.FacetValues),this.values.hasSelectedOrExcludedValues()&&!this.options.useAnd&&this.options.isMultiValueField||(this._rebuildValueElements(),this._updateAppearanceDependingOnState(),this._ensurePinnedFacetHasntMoved()),this.keepDisplayedValuesNextTime=!1},n.prototype._updateValues=function(t){e.Assert.exists(t),this.keepDisplayedValuesNextTime?this.values.updateCountsFromNewValues(t):(t.importActiveValuesFromOtherList(this.values),t.sortValuesDependingOnStatus(this.numberOfValues),this.values=t)},n.prototype._ensureFacetValueIsInList=function(t){e.Assert.exists(t),this.values.contains(t.value)||this.values.add(t)},n.prototype._isAnyValueCurrentlyDisplayed=function(){return!this.values.isEmpty()},n.prototype._handleOperatorClick=function(){var e=this;if(this.options.useAnd?this.switchToOr():this.switchToAnd(),0!=this.getSelectedValues().length){var i=this.options.useAnd?"AND":"OR",n=this.options.useAnd?"OR":"AND";this.triggerNewQuery(function(){return e.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.facetToggle,{facetId:e.options.uniqueId,facetOperatorBefore:n,facetOperatorAfter:i})})}},n.prototype._handleEraserClick=function(){var e=this;this.reset(),this.triggerNewQuery(function(){return e.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.facetClearAll,{facetId:e.options.uniqueId})})},n.prototype._updateQueryStateModel=function(){this.listenToQueryStateChange=!1,this._updateExcludedQueryStateModel(),this._updateIncludedQueryStateModel(),this._updateOperatorQueryStateModel(),this._updateLookupValueQueryStateModel(),this.listenToQueryStateChange=!0},n.prototype._buildFacetContent=function(){this.headerElement=this._buildHeader().appendTo(this.element),this._initFacetValuesList(),this.options.enableFacetSearch&&this._initFacetSearch(),this.options.enableMoreLess&&(this.footerElement=this._buildFooter().appendTo(this.element),this._moreElement=this._buildMore().appendTo(this.footerElement),this._lessElement=this._buildLess().appendTo(this.footerElement))},n.prototype._buildHeader=function(){var t=e.$('<div class="coveo-header"/>');return this._buildIcon().appendTo(t),this._buildWaitAnimation().appendTo(t),this.options.enableSettings&&this._buildSettingsButtons().appendTo(t),this.options.enableCollapse&&(this.collapseElement=this._buildCollapse().appendTo(t),this.excludeElement=this._buildExpand().appendTo(t)),this.operatorElement=this._buildOperatorToggle().appendTo(t),this.operatorElement.fastToggle(this.options.allowTogglingOperator),this._eraserElement=this._buildEraser().appendTo(t),this._buildTitle().appendTo(t),t},n.prototype._buildIcon=function(){var t;return t=this.options.headerIcon?"coveo-icon-custom "+this.options.headerIcon:"coveo-icon "+this.options.field.substr(1),e.$("<div></div>").addClass(t)},n.prototype._buildWaitAnimation=function(){return e.$("<div />").addClass("coveo-wait-animation").css("display","none")},n.prototype._buildCollapse=function(){var i=this,n=e.$("<span></span>").addClass("coveo-icon");return e.$("<div />").attr("title",t.l("Collapse")).addClass("coveo-collapse").append(n).fastClick(function(){i.collapseFacet()})},n.prototype._buildExpand=function(){var i=this,n=e.$("<span></span>").addClass("coveo-icon");return e.$("<div />").attr("title",t.l("Expand")).hide().addClass("coveo-expand").append(n).fastClick(function(){i.expandFacet()})},n.prototype._buildTitle=function(){return e.$('<div class="coveo-title"/>').text(this.options.title)},n.prototype._buildOperatorToggle=function(){var i=this,n=e.$("<span></span>").addClass("coveo-icon");return n.addClass("coveo-"+(this.options.useAnd?"and":"or")),e.$("<div />").attr("title",t.l("SwitchTo",this.options.useAnd?t.l("Or"):t.l("And"))).addClass("coveo-operator").append(n).fastClick(function(){i._handleOperatorClick()})},n.prototype._buildSettingsButtons=function(){return this.facetSettings=new t.FacetSettings(this.options.availableSorts,this),this.facetSettings.build()},n.prototype._rebuildOperatorToggle=function(){var e=this._buildOperatorToggle();this.operatorElement&&this.operatorElement.replaceWith(e),this.operatorElement=e},n.prototype._buildEraser=function(){var i=this,n=e.$("<span></span>").addClass("coveo-icon");return e.$("<div />").attr("title",t.l("Clear",this.options.title)).append(n).addClass("coveo-eraser").fastClick(function(){i._handleEraserClick()})},n.prototype._updateNumberOfValues=function(){this.numberOfValues=Math.max(this.numberOfValues,this.values.getExcluded().length+this.values.getSelected().length),this.numberOfValues=Math.min(this.numberOfValues,this.values.size()),this.numberOfValues=Math.max(this.numberOfValues,this.options.numberOfValues)},n.prototype._rebuildValueElements=function(){this._updateNumberOfValues(),this.facetValuesList.rebuild(this.numberOfValues),this.options.enableMoreLess&&this._updateMoreLess()},n.prototype._updateMoreLess=function(){var e=!1;this.values.getExcluded().length+this.values.getSelected().length<this.numberOfValues&&this.options.numberOfValues<this.numberOfValues?(this._lessElement.show(),e=!0):this._lessElement.hide();var t=this.nbAvailableValues>this.numberOfValues;this._moreElement.toggleClass("coveo-active",t),e||t?this.footerElement.removeClass("coveo-empty"):this.footerElement.addClass("coveo-empty")},n.prototype._buildFooter=function(){return e.$('<div class="coveo-footer"/>')},n.prototype._buildMore=function(){return e.$('<a class="coveo-more">'+t.l("More")+"</a>").fastClick(e.$.proxy(this._handleClickMore,this))},n.prototype._handleClickMore=function(){var e=this.numberOfValues-this.options.numberOfValues,t=Math.floor(e/this.options.pageSize)+1;this.numberOfValues=this.options.numberOfValues+t*this.options.pageSize,this.values.size()>=this.numberOfValues||!this.canFetchMore?this._rebuildValueElements():this._triggerMoreQuery()},n.prototype._triggerMoreQuery=function(){var i=this;this.logger.info("Triggering new facet more query"),this.showWaitingAnimation(),this.facetQueryController.fetchMore().done(function(n){var o=new t.FacetValues(n.groupByResults[0]);n.groupByResults.length>1&&e._.each(n.groupByResults,function(i,n){n>0&&e._.each(i.values,function(e){o.contains(e.value)||o.add(t.FacetValue.createFromGroupByValue(e))})}),o.importActiveValuesFromOtherList(i.values),o.sortValuesDependingOnStatus(i.numberOfValues),i.values=o,i.nbAvailableValues=i.values.size(),i.canFetchMore=i.numberOfValues<i.nbAvailableValues,i.values.hasSelectedOrExcludedValues()&&!i.options.useAnd&&i.options.isMultiValueField?i._triggerUpdateDeltaQuery(e._.filter(i.values.getAll(),function(e){return!e.selected&&!e.excluded})):(i.values.hasSelectedOrExcludedValues()&&!i.options.useAnd?(i.values.updateDeltaWithFilteredFacetValues(new t.FacetValues),i.hideWaitingAnimation()):i.hideWaitingAnimation(),i._rebuildValueElements())}).fail(function(){return i.hideWaitingAnimation()})},n.prototype._triggerUpdateDeltaQuery=function(i){var n=this;this.showWaitingAnimation(),this.facetQueryController.searchInFacetToUpdateDelta(i).done(function(i){var o=new t.FacetValues;e._.each(i.groupByResults,function(i){e._.each(i.values,function(e){o.contains(e.value)||o.add(t.FacetValue.createFromGroupByValue(e))})}),n.values.updateDeltaWithFilteredFacetValues(o),n._rebuildValueElements(),n.hideWaitingAnimation()})},n.prototype._buildLess=function(){return e.$('<a class="coveo-less">'+t.l("Less")+"</a>").hide().fastClick(e.$.proxy(this._handleClickLess,this))},n.prototype._handleClickLess=function(){this._lessElement.hide(),this.numberOfValues=Math.max(this.options.numberOfValues,this.values.getExcluded().length+this.values.getSelected().length),this._moreElement.addClass("coveo-active"),this.values.sortValuesDependingOnStatus(this.numberOfValues),this._rebuildValueElements()},n.prototype._unpinFacetPosition=function(){var e=this;this._isFacetPinned()&&(this.pinnedTopSpace.animate({height:0},"fast",function(){void 0!=e.facetSearch&&e.facetSearch.positionSearchResults()}),this.pinnedBottomSpace.animate({height:0},"fast",function(){void 0!=e.facetSearch&&e.facetSearch.positionSearchResults()}),this.pinnedViewportPosition=void 0)},n.prototype._isFacetPinned=function(){return e.Utils.exists(this.pinnedViewportPosition)},n.prototype._ensurePinnedFacetHasntMoved=function(){var t=this;if(this._isFacetPinned()){e.Assert.exists(this.pinnedViewportPosition),this.pinnedTopSpace.height(0),this.pinnedBottomSpace.height(0);var i=this.options.scrollContainer==document.body?window:this.options.scrollContainer,n=this.element.getBoundingClientRect().top,o=n-this.pinnedViewportPosition;e.$(i).scrollTop(e.$(i).scrollTop()+o),n=this.element.getBoundingClientRect().top,o=n-this.pinnedViewportPosition,0>o?this.pinnedTopSpace.height(-1*o):setTimeout(function(){var n=t.element.getBoundingClientRect().top,o=n-t.pinnedViewportPosition;e.$(i).scrollTop(e.$(i).scrollTop()+o);for(var s=0,r=0;o>0&&r++<100;)s+=100,t.pinnedBottomSpace.height(s),n=t.element.getBoundingClientRect().top,o=n-t.pinnedViewportPosition,e.$(i).scrollTop(e.$(i).scrollTop()+o)},0)}},n.prototype._updateAppearanceDependingOnState=function(){e.$(this.element).toggleClass("coveo-active",this.values.hasSelectedOrExcludedValues()),e.$(this.element).toggleClass("coveo-empty",!this._isAnyValueCurrentlyDisplayed()),e.$(this._eraserElement).fastToggle(this.values.hasSelectedOrExcludedValues())},n.ID="Facet",n.omniboxIndex=50,n.options={title:t.ComponentOptions.buildLocalizedStringOption({defaultValue:"No Title"}),field:t.ComponentOptions.buildFieldOption({required:!0,groupByField:!0}),headerIcon:t.ComponentOptions.buildIconOption(),uniqueId:t.ComponentOptions.buildStringOption({attrName:"data-id",postProcessing:function(e,t){return e||t.field}}),isMultiValueField:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),lookupField:t.ComponentOptions.buildFieldOption(),enableSettings:t.ComponentOptions.buildBooleanOption({defaultValue:!0}),enableSettingsFacetState:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),availableSorts:t.ComponentOptions.buildListOption({defaultValue:["occurrences","score","alphaAscending","alphaDescending"],values:["Occurrences","Score","AlphaAscending","AlphaDescending","ComputedFieldAscending","ComputedFieldDescending","ChiSquare","NoSort"]}),sortCriteria:t.ComponentOptions.buildStringOption({postProcessing:function(e,t){return e||(t.availableSorts.length>0?t.availableSorts[0]:"occurrences")}}),customSort:t.ComponentOptions.buildListOption(),numberOfValues:t.ComponentOptions.buildNumberOption({defaultValue:5}),injectionDepth:t.ComponentOptions.buildNumberOption({defaultValue:1e3}),showIcon:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),useAnd:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),allowTogglingOperator:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableFacetSearch:t.ComponentOptions.buildBooleanOption({defaultValue:!0}),facetSearchDelay:t.ComponentOptions.buildNumberOption({defaultValue:100}),facetSearchIgnoreAccents:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),numberOfValuesInFacetSearch:t.ComponentOptions.buildNumberOption({defaultValue:15}),includeInBreadcrumb:t.ComponentOptions.buildBooleanOption({defaultValue:!0}),numberOfValuesInBreadcrumb:t.ComponentOptions.buildNumberOption({defaultFunction:function(){return e.DeviceUtils.isMobileDevice()?3:5}}),includeInOmniBox:t.ComponentOptions.buildBooleanOption({defaultValue:!1,attrName:"data-include-in-omnibox"}),numberOfValuesInOmniBox:t.ComponentOptions.buildNumberOption({defaultFunction:function(){return e.DeviceUtils.isMobileDevice()?3:5},attrName:"data-number-of-values-in-omnibox"}),computedField:t.ComponentOptions.buildFieldOption(),computedFieldOperation:t.ComponentOptions.buildStringOption({defaultValue:"sum"}),computedFieldFormat:t.ComponentOptions.buildStringOption({defaultValue:"c0"}),computedFieldCaption:t.ComponentOptions.buildLocalizedStringOption({defaultValue:t.l("ComputedField")}),preservePosition:t.ComponentOptions.buildBooleanOption({defaultValue:!0}),paddingContainer:t.ComponentOptions.buildSelectorOption({defaultFunction:function(e){return e.parentElement}}),scrollContainer:t.ComponentOptions.buildSelectorOption({defaultFunction:function(){return document.body}}),enableMoreLess:t.ComponentOptions.buildBooleanOption({defaultValue:!0}),pageSize:t.ComponentOptions.buildNumberOption({defaultValue:10}),enableCollapse:t.ComponentOptions.buildBooleanOption({defaultValue:!0}),allowedValues:t.ComponentOptions.buildListOption(),additionalFilter:t.ComponentOptions.buildStringOption()},n}(e.Ui.Component);t.Facet=i,t.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function e(e,t){this.element=e,this.options=t,this.steps=[],this.options.dateField&&(this.options.start=new Date(this.options.start).getTime(),this.options.end=new Date(this.options.end).getTime()),void 0==this.options.rounded&&(this.options.rounded=0),(this.options.steps||this.options.getSteps)&&this.buildSteps(),this.options.graph&&(this.sliderGraph=new a(this)),this.sliderLine=new n(this),this.sliderLine.build().appendTo(this.element),this.options.rangeSlider?(this.sliderRange=new s(this),this.sliderRange.build().appendTo(this.element)):(this.sliderButton=new o(this,1),this.sliderButton.build().addClass("coveo-no-range-button").appendTo(this.element),this.sliderLine.setActiveWidth(this.sliderButton)),this.sliderCaption=new r(this),this.sliderCaption.build().appendTo(this.element)}return e.prototype.onMoving=function(){this.options.rangeSlider?(this.sliderRange.setBoundary(),this.sliderLine.setActiveWidth(this.sliderRange.firstButton,this.sliderRange.secondButton)):this.sliderLine.setActiveWidth(this.sliderButton),this.options.graph&&this.sliderGraph.draw(),this.displayCaption()},e.prototype.initializeState=function(e){void 0===e&&(e=[this.options.start,this.options.end]),this.currentValues=e,this.options.rangeSlider?(this.sliderRange.initializeSliderRangeState(e),this.sliderLine.setActiveWidth(this.sliderRange.firstButton,this.sliderRange.secondButton)):(void 0==e?this.sliderButton.toEnd():this.sliderButton.setValue(e[1]),this.sliderButton.leftBoundary=0,this.sliderButton.rightBoundary=this.element.width(),this.sliderLine.setActiveWidth(this.sliderButton)),this.displayCaption()},e.prototype.getPosition=function(){return this.options.rangeSlider?this.sliderRange.getPosition():[0,this.sliderButton.getPosition()]},e.prototype.getPercentPosition=function(){return this.options.rangeSlider?this.sliderRange.getPercentPosition():[0,this.sliderButton.getPercent()]},e.prototype.getValues=function(){return void 0!=this.currentValues?this.currentValues:this.options.rangeSlider?this.sliderRange.getValue():[this.options.start,this.sliderButton.getValue()]},e.prototype.getCaptionFromValue=function(e){return this.sliderCaption.getCaptionFromValues(e)},e.prototype.getCaption=function(){return this.sliderCaption.getCaption()},e.prototype.setValues=function(e){void 0!=e&&(e[0]=Math.max(e[0],this.options.start),e[1]=Math.min(e[1],this.options.end)),this.currentValues=e,this.options.rangeSlider?(this.sliderRange.setValue(e),this.sliderLine.setActiveWidth(this.sliderRange.firstButton,this.sliderRange.secondButton)):(this.sliderButton.setValue(e[1]),this.sliderLine.setActiveWidth(this.sliderButton)),this.displayCaption()},e.prototype.drawGraph=function(e){this.sliderGraph.draw(e)},e.prototype.displayCaption=function(){void 0!=this.options.valueCaption?this.sliderCaption.setFromString(this.options.valueCaption(this.getValues())):void 0!=this.options.percentCaption?this.sliderCaption.setFromString(this.options.percentCaption(this.getPercentPosition())):void 0!=this.options.displayAsPercent&&void 0!=this.options.displayAsPercent.separator?this.sliderCaption.setAsPercent():this.sliderCaption.setAsValue()},e.prototype.buildSteps=function(){if(this.options.getSteps)this.steps=this.options.getSteps(this.options.start,this.options.end);else for(var e=(this.options.end-this.options.start)/this.options.steps,t=this.options.start;t<=this.options.end;)this.steps.push(t),t+=e},e}();t.Slider=i;var n=function(){function t(e){this.slider=e}return t.prototype.build=function(){return this.backGround=e.$("<div class='coveo-slider-line coveo-background'></div>"),this.activePart=e.$("<div class='coveo-slider-line coveo-active'></div>"),this.backGround.add(this.activePart)},t.prototype.setActiveWidth=function(e,t){if(this.slider.options.rangeSlider){var i=100*(t.getPercent()-e.getPercent());this.activePart.css({width:i+"%",left:100*e.getPercent()+"%",right:100*t.getPercent()+"%"})}else{var i=100*e.getPercent();this.activePart.css({width:i+"%"})}},t}(),o=function(){function t(t,i){this.slider=t,this.which=i,this.eventMouseDown=e.DeviceUtils.isMobileDevice()?"touchstart":"mousedown",this.eventMouseMove=e.DeviceUtils.isMobileDevice()?"touchmove":"mousemove",this.eventMouseUp=e.DeviceUtils.isMobileDevice()?"touchend":"mouseup"}return t.prototype.build=function(){return this.element=e.$("<div class='coveo-slider-button'></div>"),this.bindEvents(),this.element.get(0).CoveoSliderButton=this,this.element},t.prototype.toBeginning=function(){this.element.css({left:"0%"})},t.prototype.toEnd=function(){this.slider.element.width();this.element.css({left:"100%"})},t.prototype.setValue=function(e){var t=this.fromValueToPercent(e);this.element.css("left",Math.round(100*t)+"%")},t.prototype.getPosition=function(){var e=this.element.css("left");return-1!=e.indexOf("%")?parseFloat(e)/100*this.slider.element.width():parseFloat(e)},t.prototype.getPercent=function(e){return void 0===e&&(e=this.getPosition()),0==this.slider.element.width()?0:+(e/this.slider.element.width()).toFixed(2)},t.prototype.getValue=function(){var e=this.getPercent()*(this.slider.options.end-this.slider.options.start)+this.slider.options.start;return e},t.prototype.fromValueToPercent=function(e){return 1-(this.slider.options.end-e)/(this.slider.options.end-this.slider.options.start)},t.prototype.fromPositionToValue=function(e){var t=this.getPercent(e);return this.slider.options.start+t*(this.slider.options.end-this.slider.options.start)},t.prototype.fromValueToPosition=function(e){var t=this.fromValueToPercent(e);return this.slider.element.width()*t},t.prototype.bindEvents=function(){var t=this;e.$(this.element).on(this.eventMouseDown,function(e){t.handleStartSlide(e)});var i=this.slider.options.document||document;e.$(i).on(this.eventMouseMove,function(e){"touchmove"==t.eventMouseMove&&t.isMouseDown&&e.preventDefault(),t.handleMoving(e)}),e.$(i).on(this.eventMouseUp,function(e){t.handleEndSlide(e)})},t.prototype.handleStartSlide=function(t){var i=this.getMousePosition(t);this.isMouseDown=!0,this.startPositionX=i.x,this.lastElementLeft=this.element.css("left"),this.origUserSelect=e.$("body").css("user-select"),this.origCursor=e.$("body").css("cursor"),e.$("body").css("user-select","none"),e.$("body").css("cursor","pointer"),e.$(this.element).addClass("coveo-active"),e.$(this.element).trigger(e.Events.SliderEvents.startSlide,{button:this,slider:this.slider})},t.prototype.handleMoving=function(t){this.isMouseDown&&(this.updatePosition(t),this.slider.onMoving(),this.handleButtonNearEnd(),this.element.trigger(e.Events.SliderEvents.duringSlide,{button:this,slider:this.slider}))},t.prototype.handleEndSlide=function(){this.isMouseDown&&(e.$("body").css("user-select",this.origUserSelect),e.$("body").css("cursor",this.origCursor),e.$(this.element).removeClass("coveo-active"),this.element.trigger(e.Events.SliderEvents.endSlide,{button:this,slider:this.slider})),this.isMouseDown=!1},t.prototype.handleButtonNearEnd=function(){0==this.which&&(void 0==this.origZIndex&&(this.origZIndex=this.element.css("z-index")),this.currentPos>90?this.element.css("z-index",this.origZIndex+1):this.element.css("z-index",this.origZIndex))},t.prototype.getMousePosition=function(e){var t=0,i=0;return"touchmove"==this.eventMouseMove?(t=e.originalEvent.touches[0].pageX,i=e.originalEvent.touches[0].pageY):e.pageX||e.pageY?(t=e.pageX,i=e.pageY):(e.clientX||e.clientY)&&(t=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,i=e.clientY+document.body.scrollTop+document.documentElement.scrollTop),{x:t,y:i}},t.prototype.updatePosition=function(e){var t=this.getMousePosition(e),i=t.x-this.startPositionX;if(this.currentPos=parseInt(this.lastElementLeft,10)+i,this.slider.options.steps||this.slider.options.getSteps){var n=this.snapToStep(i);this.currentPos=n.position;var o=n.value}this.currentPos=Math.max(this.leftBoundary,this.currentPos),this.currentPos=Math.min(this.rightBoundary,this.currentPos),this.currentPos=100*this.getPercent(this.currentPos),this.currentPos=Math.min(this.currentPos,100),this.currentPos=Math.max(this.currentPos,0),this.element.css("left",Math.round(this.currentPos)+"%"),this.slider.currentValues[this.which]=this.slider.options.steps||this.slider.options.getSteps?o:this.getValue()},t.prototype.snapToStep=function(){var t=this,i=e._.map(this.slider.steps,function(e,i){return Math.abs(t.currentPos-t.fromValueToPosition(t.slider.steps[i]))}),n=e._.map(this.slider.steps,function(e,i){return Math.abs(t.rightBoundary-t.fromValueToPosition(t.slider.steps[i]))}),o=e._.map(this.slider.steps,function(e,i){return Math.abs(t.leftBoundary-t.fromValueToPosition(t.slider.steps[i]))}),s=e._.min(i),r=e._.min(n),a=e._.min(o),l=this.slider.steps[e._.indexOf(i,s)],u=this.slider.steps[e._.indexOf(n,r)],c=this.slider.steps[e._.indexOf(o,a)];return l=Math.min(l,u),l=Math.max(l,c),{position:this.fromValueToPosition(l),value:l}},t}();t.SliderButton=o;var s=function(){function e(e){this.slider=e,this.firstButton=new o(e,0),this.secondButton=new o(e,1)}return e.prototype.build=function(){var e=this.firstButton.build(),t=this.secondButton.build().addClass("coveo-range-button");return e.add(t)},e.prototype.initializeSliderRangeState=function(e){void 0==e?(this.firstButton.toBeginning(),this.secondButton.toEnd()):(this.firstButton.setValue(e[0]),this.secondButton.setValue(e[1])),this.setBoundary()},e.prototype.setValue=function(e){this.firstButton.setValue(e[0]),this.secondButton.setValue(e[1])},e.prototype.setBoundary=function(){this.firstButton.leftBoundary=0,this.firstButton.rightBoundary=this.secondButton.getPosition(),this.secondButton.leftBoundary=this.firstButton.getPosition(),this.secondButton.rightBoundary=this.slider.element.width()},e.prototype.getPosition=function(){return[this.firstButton.getPosition(),this.secondButton.getPosition()]},e.prototype.getPercentPosition=function(){return[this.firstButton.getPercent(),this.secondButton.getPercent()]},e.prototype.getValue=function(){return[this.firstButton.getValue(),this.secondButton.getValue()]},e}(),r=function(){function t(e){this.slider=e,this.separator="-",this.unitSign="",this.slider.options.displayAsPercent?this.separator=void 0!=this.slider.options.displayAsPercent.separator?this.slider.options.displayAsPercent.separator:this.separator:this.slider.options.displayAsValue&&(this.separator=void 0!=this.slider.options.displayAsValue.separator?this.slider.options.displayAsValue.separator:this.separator,this.unitSign=void 0!=this.slider.options.displayAsValue.unitSign?this.slider.options.displayAsValue.unitSign:this.unitSign)}return t.prototype.build=function(){return this.caption=e.$("<div class='coveo-slider-caption'></div>"),this.caption},t.prototype.getCaption=function(){return this.caption.text()},t.prototype.getCaptionFromValues=function(e){return this.getValueCaption(e)},t.prototype.getCaptionFromValuesAsPercent=function(e){return this.getValueCaption(e)},t.prototype.setAsValue=function(){this.caption.text(this.getValueCaption())},t.prototype.setAsPercent=function(){var e=this.slider.getPercentPosition();this.caption.text([(100*e[0]).toFixed(this.slider.options.rounded),"%",this.separator,(100*e[1]).toFixed(this.slider.options.rounded),"%"].join(" "))},t.prototype.setFromString=function(e){this.caption.text(e)},t.prototype.getValueCaption=function(e){void 0===e&&(e=this.slider.getValues());var t=e[0],i=e[1];if(this.slider.options.dateField){var n=new Date(t),o=new Date(i);n.setHours(0,0,0,0),o.setHours(0,0,0,0),t=Globalize.format(n,this.slider.options.dateFormat||"MMM dd, yyyy"),i=Globalize.format(o,this.slider.options.dateFormat||"MMM dd, yyyy"),this.unitSign=""}else t=t.toFixed(this.slider.options.rounded),i=i.toFixed(this.slider.options.rounded);return[t,this.unitSign,this.separator,i,this.unitSign].join(" ")},t}(),a=function(){function t(t){var i=this;this.slider=t,this.svg=d3.select(t.element.get(0)).append("svg").append("g"),this.x=d3.scale.ordinal(),this.y=d3.scale.linear(),this.slider.options.graph.margin=e.Utils.extendDeep({top:20,right:0,left:0,bottom:20},this.slider.options.graph.margin||{}),this.slider.options.graph.animationDuration=this.slider.options.graph.animationDuration||500,e.$(window).resize(function(){i.draw()}),this.tooltip=e.$("<div></div>").css({display:"none"}).addClass("coveo-slider-tooltip"),this.slider.element.append(this.tooltip),this.slider.options.graph.steps=this.slider.options.graph.steps||10}return t.prototype.draw=function(e){if(void 0===e&&(e=this.oldData),e){var t=this.slider.element.outerWidth(),i=this.slider.element.outerHeight(),n=t-this.slider.options.graph.margin.left-this.slider.options.graph.margin.right,o=i-this.slider.options.graph.margin.top-this.slider.options.graph.margin.bottom;this.applyTransformOnSvg(n,o),this.setXAndYRange(n,o),this.setXAndYDomain(e);var s=this.svg.selectAll(".coveo-bar").data(e),r=this.slider.getValues();this.renderGraphBars(s,n,o,r),this.setGraphBarsTransition(s,o,r),this.oldData=e}},t.prototype.setXAndYRange=function(e,t){this.x.rangeBands([0,e],.2,0),this.y.range([t-this.slider.options.graph.margin.top,0])},t.prototype.setXAndYDomain=function(t){this.padGraphWithEmptyData(t),this.x.domain(e._.map(t,function(e){return e.start})),this.y.domain([0,d3.max(t,function(e){return e.y})])},t.prototype.padGraphWithEmptyData=function(e){var t=e[0].end-e[0].start;
0!=t&&(this.padBeginningOfGraphWithEmptyData(e,t),this.padEndOfGraphWithEmptyData(e,t))},t.prototype.padBeginningOfGraphWithEmptyData=function(e,t){if(e[0].start>this.slider.options.start)for(var i=e[0].start-this.slider.options.start,n=Math.round(i/t),o=e[0].start,s=n;s>0;s--)e.unshift({start:o-t,end:o,y:0}),o-=t},t.prototype.padEndOfGraphWithEmptyData=function(e,t){var i=e.length-1;if(e[i].end<this.slider.options.end)for(var n=this.slider.options.end-e[i].end,o=Math.round(n/t),s=e[i].end,r=0;o>r;r++)e.push({start:s,end:s+t,y:0}),s+=t},t.prototype.applyTransformOnSvg=function(t,i){e.$(this.slider.element).find("svg").attr("width",t).attr("height",i),this.svg.attr("transform","translate("+this.slider.options.graph.margin.left+","+this.slider.options.graph.margin.top+")")},t.prototype.renderGraphBars=function(e,t,i,n){e.enter().append("rect").attr("class",this.getFunctionForClass(n)).attr("width",this.x.rangeBand()).attr("height",this.getFunctionForHeight(i)).attr("x",this.getFunctionForX()).attr("y",this.getFunctionForY()).on("click",this.getFunctionForClick()).on("mouseover",this.getFunctionForMouseOver(i)).on("mouseout",this.getFunctionForMouseOut())},t.prototype.setGraphBarsTransition=function(e,t,i){e.transition().attr("x",this.getFunctionForX()).attr("width",this.x.rangeBand()).attr("class",this.getFunctionForClass(i)).transition().duration(this.slider.options.graph.animationDuration).attr("y",this.getFunctionForY()).attr("height",this.getFunctionForHeight(t))},t.prototype.getBarClass=function(e,t,i){return t.start>=e[0]&&t.end<=e[1]?"coveo-active":e[0]==this.slider.options.start&&0==i?"coveo-active":e[1]==this.slider.options.end&&i==this.slider.options.graph.steps-1?"coveo-active":""},t.prototype.setTooltip=function(e,t){this.tooltip.html("<span class='coveo-caption'>"+this.slider.getCaptionFromValue([e.start,e.end])+"</span><span class='coveo-count'>"+e.y+"</span>"),this.tooltip.css({display:"block",left:this.x(e.start)-.2*this.slider.options.graph.steps,top:this.y(e.y)-t})},t.prototype.getFunctionForX=function(){var e=this;return function(t){return e.x(t.start)}},t.prototype.getFunctionForY=function(){var e=this;return function(t){return e.y(t.y)}},t.prototype.getFunctionForHeight=function(e){var t=this;return function(i){return e-t.y(i.y)}},t.prototype.getFunctionForClass=function(e){var t=this;return function(i,n){return"coveo-bar "+t.getBarClass(e,i,n)}},t.prototype.getFunctionForClick=function(){var t=this;return function(i){t.slider.element.trigger(e.Events.SliderEvents.graphValueSelected,{start:i.start,end:i.end,value:i.y})}},t.prototype.getFunctionForMouseOver=function(e){var t=this;return function(i){d3.event.clientX,d3.event.clientY;t.setTooltip(i,e)}},t.prototype.getFunctionForMouseOut=function(){var e=this;return function(){e.tooltip.css("display","none")}},t}()}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.prototype.merge=function(t){return e.$.extend({},this,t)},t.prototype.mergeDeep=function(t){return e.$.extend(!0,{},e.Utils.extendDeep(this,t))},t}();e.Options=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(e){function t(){e.apply(this,arguments),this.now=new Date,this.useTodayYesterdayAndTomorrow=!0,this.useWeekdayIfThisWeek=!0,this.omitYearIfCurrentOne=!0,this.useLongDateFormat=!1,this.includeTimeIfToday=!0,this.includeTimeIfThisWeek=!0,this.alwaysIncludeTime=!1,this.predefinedFormat=void 0}return __extends(t,e),t}(e.Options),i=function(){function i(){}return i.convertFromJsonDateIfNeeded=function(t){return e._.isDate(t)?t:e._.isNumber(t)?new Date(t):e._.isString(t)?new Date(t.replace("@"," ")):void 0},i.keepOnlyDatePart=function(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())},i.offsetDateByDays=function(e,t){var i=new Date(e.valueOf());return i.setDate(i.getDate()+t),i},i.dateToString=function(n,o){if(e.Utils.isNullOrUndefined(n))return"";if(o=(new t).merge(o),e.Utils.isNullOrUndefined(n))return"";var n=i.keepOnlyDatePart(n),s=i.keepOnlyDatePart(o.now),r=i.offsetDateByDays(s,1),a=i.offsetDateByDays(s,-1),l=Math.abs(e.TimeSpan.fromDates(n,s).getDays())<7;return o.predefinedFormat?Globalize.format(n,o.predefinedFormat):o.useTodayYesterdayAndTomorrow&&n.valueOf()==s.valueOf()?e.Ui.l("Today"):o.useTodayYesterdayAndTomorrow&&n.valueOf()==a.valueOf()?e.Ui.l("Yesterday"):o.useTodayYesterdayAndTomorrow&&n.valueOf()==r.valueOf()?e.Ui.l("Tomorrow"):o.useWeekdayIfThisWeek&&l?n.valueOf()>s.valueOf()?e.Ui.l("Next")+" "+Globalize.format(n,"dddd"):e.Ui.l("Last")+" "+Globalize.format(n,"dddd"):o.omitYearIfCurrentOne&&n.getFullYear()===s.getFullYear()?Globalize.format(n,"M"):o.useLongDateFormat?Globalize.format(n,"D"):Globalize.format(n,"d")},i.timeToString=function(t){return e.Utils.isNullOrUndefined(t)?"":Globalize.format(t,"t")},i.dateTimeToString=function(i,n){if(e.Utils.isNullOrUndefined(i))return"";n=(new t).merge(n);var o=e.DateUtils.keepOnlyDatePart(n.now),s=Math.abs(e.TimeSpan.fromDates(i,o).getDays())<7,r=e.DateUtils.dateToString(i,n),a=e.DateUtils.keepOnlyDatePart(i);return n.alwaysIncludeTime||n.includeTimeIfThisWeek&&s||n.includeTimeIfToday&&a.valueOf()==o.valueOf()?r+", "+e.DateUtils.timeToString(i):r},i.isValid=function(e){return e instanceof Date?!isNaN(e.getTime()):!1},i}();e.DateUtils=i}(Coveo||(Coveo={})),Date.prototype.toISOString||!function(){function e(e){return 10>e?"0"+e:e}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"."+(this.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}}();var Coveo;!function(e){var t;!function(t){var i=function(t){function i(i){var n=this;t.call(this,i),this.facet=i,this.facet.bind.onRoot(e.Events.QueryEvents.querySuccess,function(e,t){return n.handleQuerySuccess(e,t)})}return __extends(i,t),i.prototype.putGroupByIntoQueryBuilder=function(e){this.facet.options.slider&&this.facet.options.slider.graph&&this.putGroupByForGraphIntoQueryBuilder(e),this.facet.options.slider?this.putGroupByForSliderIntoQueryBuilder(e):t.prototype.putGroupByIntoQueryBuilder.call(this,e)},i.prototype._createBasicGroupByRequest=function(i,n){void 0===n&&(n=!0);var o=t.prototype._createBasicGroupByRequest.call(this,null,n);return o.allowedValues=void 0,o=this.facet.options.slider&&this.facet.options.slider.graph?this.buildGroupByQueryForSlider(o):this.facet.options.slider?this.buildGroupByQueryForAutomaticRanges(o):e.Utils.isNonEmptyArray(this.facet.options.ranges)?this.buildGroupByQueryForPredefinedRanges(o):this.facet.values.hasSelectedOrExcludedValues()?this.buildGroupByQueryForSelectedAndExcludedValues(o):this.buildGroupByQueryForAutomaticRanges(o)},i.prototype._createGroupByAllowedValues=function(){return void 0},i.prototype.computeOurFilterExpression=function(i){if(void 0===i&&(i=[this.facet.startOfSlider,this.facet.endOfSlider]),this.facet.options.slider){var n=new e.Ui.ExpressionBuilder;return void 0!=i[0]&&void 0!=i[1]&&(this.facet.options.slider.excludeOuterBounds?this.addFilterExpressionWithOuterBoundsExcluded(i[0],i[1],n):this.addFilterExpressionWithOuterBoundsIncluded(i[0],i[1],n)),n.build()}return t.prototype.computeOurFilterExpression.call(this)},i.prototype.handleQuerySuccess=function(t,i){var n=this;if(this.facet.options.slider&&this.facet.options.slider.graph&&void 0==this.rangeValuesForGraphToUse){this.rangeValuesForGraphToUse=[];var o=i.results.groupByResults[this.graphGroupByQueriesIndex].values;e._.each(o,function(e){var t=e.value.split("..");n.rangeValuesForGraphToUse.push({start:n.facet.options.dateField?n.getISOFormat(t[0].replace("@"," ")):parseInt(t[0],10),end:n.facet.options.dateField?n.getISOFormat(t[1].replace("@"," ")):parseInt(t[1],10)})})}},i.prototype.addFilterExpressionWithOuterBoundsIncluded=function(e,t,i){(e!=this.facet.options.slider.start||t!=this.facet.options.slider.end)&&(this.facet.options.dateField&&(e=this.getFilterDateFormat(e),t=this.getFilterDateFormat(t)),i.addFieldExpression(this.facet.options.field,"==",[e+".."+t]))},i.prototype.addFilterExpressionWithOuterBoundsExcluded=function(e,t,i){var n=this.facet.options.slider.start,o=this.facet.options.slider.end,s=e,r=t;this.facet.options.dateField?(s=this.getFilterDateFormat(e),r=this.getFilterDateFormat(t),n=this.getFilterDateFormat(n),o=this.getFilterDateFormat(o)):(s+="",r+="",n+="",o+=""),s!=n&&r==o?i.addFieldExpression(this.facet.options.field,">=",[s]):s==n&&r!=o?i.addFieldExpression(this.facet.options.field,"<=",[r]):this.addFilterExpressionWithOuterBoundsIncluded(e,t,i)},i.prototype.buildGroupByQueryForSlider=function(e){if(void 0!=this.facet.options.slider.start&&void 0!=this.facet.options.slider.end){var t=this.facet.options.slider.start,i=this.facet.options.slider.end;return(this.facet.options.dateField||this.facet.options.dateField)&&(t=this.getISOFormat(t),i=this.getISOFormat(i)),e.rangeValues=[{start:t,end:i,endInclusive:!0,label:"Slider"}],e}return this.buildGroupByQueryForAutomaticRanges(e)},i.prototype.buildGroupByQueryForAutomaticRanges=function(e){return e.generateAutomaticRanges=!0,e},i.prototype.buildGroupByQueryForPredefinedRanges=function(e){return e.rangeValues=this.facet.options.ranges,e.maximumNumberOfValues=this.facet.options.ranges.length,e},i.prototype.putGroupByForGraphIntoQueryBuilder=function(e){this.graphGroupByQueriesIndex=e.groupByRequests.length;var t=this._createBasicGroupByRequest();if(t.rangeValues){var i=t.rangeValues[0];t.rangeValues=this.createRangeValuesForGraph(i)}var n=this.computeOurFilterExpression(this.facet.getSliderBoundaryForQuery());if(void 0!=n){var o=e.computeCompleteExpressionPartsExcept(n);t.queryOverride=o.withoutConstant,t.constantQueryOverride=o.constant,void 0==t.queryOverride?t.queryOverride=this.facet.options.slider.queryOverride||"@sysuri":t.queryOverride+=" "+this.facet.options.slider.queryOverride}else if(null!=this.facet.options.slider.queryOverride){var s=e.computeCompleteExpression();t.queryOverride=(null!=s?s+" ":"")+this.facet.options.slider.queryOverride}t.sortCriteria="nosort",t.maximumNumberOfValues=this.facet.options.slider.graph.steps,e.groupByRequests.push(t)},i.prototype.putGroupByForSliderIntoQueryBuilder=function(e){this.lastGroupByRequestIndex=e.groupByRequests.length;var t=this._createBasicGroupByRequest();t.maximumNumberOfValues=null!=this.facet.options.slider.graph?this.facet.options.slider.graph.steps||1:1,t.queryOverride=this.facet.options.slider.queryOverride||"@sysuri",t.sortCriteria="nosort",t.generateAutomaticRanges=!0,t.rangeValues=void 0,e.groupByRequests.push(t)},i.prototype.createRangeValuesForGraph=function(e){return void 0==this.facet.options.slider.graph.steps&&(this.facet.options.slider.graph.steps=10),this.facet.options.dateField&&isNaN(this.facet.options.slider.start)&&(this.facet.options.slider.start=new Date(this.facet.options.slider.start).getTime()),this.facet.options.dateField&&isNaN(this.facet.options.slider.end)&&(this.facet.options.slider.end=new Date(this.facet.options.slider.end).getTime()),void 0!=this.rangeValuesForGraphToUse?this.usePrebuiltRange(e):this.buildRange(e)},i.prototype.usePrebuiltRange=function(t){return e._.map(this.rangeValuesForGraphToUse,function(e){return{start:e.start,end:e.end,endInclusive:t.endInclusive,label:t.label}})},i.prototype.buildRange=function(t){var i=this,n=this.facet.options.slider.start,o=(this.facet.options.slider.end,(this.facet.options.slider.end-this.facet.options.slider.start)/this.facet.options.slider.graph.steps);return e._.map(e._.range(0,this.facet.options.slider.graph.steps,1),function(e){var s=n+e*o,r=n+(e+1)*o;return i.facet.options.dateField&&(s=i.getISOFormat(s),r=i.getISOFormat(r)),{endInclusive:t.endInclusive,label:t.label,start:s,end:r}})},i.prototype.buildGroupByQueryForSelectedAndExcludedValues=function(t){var i=this;return t.rangeValues=e._.map(this.facet.values.getAll(),function(e){var t=e.value.split(".."),n=t[0],o=t[1];return i.facet.options.dateField&&(n=i.getISOFormat(n),o=i.getISOFormat(o)),{start:n,end:o,endInclusive:!0,label:e.lookupValue}}),t},i.prototype.getISOFormat=function(t){if(t){var i=new Date(t);return e.DateUtils.isValid(i)||(i=new Date(this.getBrowserCompatibleFormat(t)),e.DateUtils.isValid(i))?i.toISOString():(this.facet.logger.error("Cannot parse this date format.",t,new Date(t)),void 0)}return void 0},i.prototype.getFilterDateFormat=function(e){return e?this.getISOFormat(e).replace("T","@").replace(".000Z","").replace(/-/g,"/"):void 0},i.prototype.getBrowserCompatibleFormat=function(e){return e.replace("@","T").replace(/\//g,"-")},i}(t.FacetQueryController);t.FacetRangeQueryController=i}(t=e.Controllers||(e.Controllers={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){var t=function(){function e(){}return e.startSlide="startSlide",e.duringSlide="duringSlide",e.endSlide="endSlide",e.graphValueSelected="graphValueSelected",e}();e.SliderEvents=t}(t=e.Events||(e.Events={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){function t(){return document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")}e.supportSVG=t}(t=e.FeatureDetectionUtils||(e.FeatureDetectionUtils={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r){i.call(this,o,t.ComponentOptions.initComponentOptions(o,n,s),r,n.ID),this.element=o,this.isEmpty=!1,this.options.enableFacetSearch=!1,this.options.enableSettings=!1,this.options.includeInOmniBox=!1,this.hasASlider()&&(null==this.options.slider.excludeOuterBounds&&(this.options.slider.excludeOuterBounds=!1),this.options.dateField=this.options.slider.dateField=this.options.slider.dateField||this.options.dateField||!1,this.options.slider.start&&(this.options.slider.start=this.options.slider.dateField?new Date(this.options.slider.start).getTime():parseFloat(this.options.slider.start)),this.options.slider.end&&(this.options.slider.end=this.options.slider.dateField?new Date(this.options.slider.end).getTime():parseFloat(this.options.slider.end)),this.hasAGraph()&&(e.FeatureDetectionUtils.supportSVG()||(this.options.slider.graph=void 0,this.logger.info("Your browser does not support SVG. Cannot add graphic to your facet range",this)),"undefined"==typeof d3&&(this.options.slider.graph=void 0,this.logger.info("Cannot find the required dependencies d3.js. Cannot add graphic to your facet range",this))),this.handleNoresults())}return __extends(n,i),n.prototype.reset=function(){this.hasASlider()?(this.slider.initializeState(),this.updateQueryState(),this.updateFacetStyle()):i.prototype.reset.call(this)},n.prototype.getSelectedValues=function(){return this.hasASlider()?void 0!=this.startOfSlider&&void 0!=this.endOfSlider?[this.startOfSlider.toString(),this.endOfSlider.toString()]:["undefined","undefined"]:i.prototype.getSelectedValues.call(this)},n.prototype.getValueCaption=function(n){var o=i.prototype.getValueCaption.call(this,n);if(e.Utils.exists(this.options.valueCaption)&&"string"==typeof this.options.valueCaption){var s=/^(.*)\.\.(.*)$/.exec(n.value);if(null!=s){var r=t.TemplateHelpers.getHelper(this.options.valueCaption);if(null!=r)o=r.call(this,s[1])+" - "+r.call(this,s[2]);else var a=s[1].match(/^[\+\-]?[0-9]+(\.[0-9]+)?$/)?Number(s[1]):e.DateUtils.convertFromJsonDateIfNeeded(s[1]),l=s[2].match(/^[\+\-]?[0-9]+(\.[0-9]+)?$/)?Number(s[2]):e.DateUtils.convertFromJsonDateIfNeeded(s[2]),o=Globalize.format(a,this.options.valueCaption)+" - "+Globalize.format(l,this.options.valueCaption)}}return o},n.prototype._initFacetValuesList=function(){this.hasASlider()||i.prototype._initFacetValuesList.call(this)},n.prototype._handlePopulateBreadcrumb=function(t,n){var o=this;if(this.hasASlider()){var s=function(){o.sliderIsActive()&&n.breadcrumbs.push({element:o.buildBreadcrumbFacetSlider().get(0),clearAll:function(){return o.reset()}})};this.slider?s():e.$(this.root).one(e.Events.QueryEvents.deferredQuerySuccess,function(){s(),e.$(o.root).trigger(e.Events.BreadcrumbEvents.redrawBreadcrumb)})}else i.prototype._handlePopulateBreadcrumb.call(this,t,n)},n.prototype.getSliderBoundaryForQuery=function(){var e=!1;return this.hasASlider()&&!this.slider?e=!0:this.hasASlider()&&this.slider&&this.sliderIsActive()&&(e=!0),e?this.generateBoundary():void 0},n.prototype.handleNoresults=function(){var t=this;e.$(this.root).on(e.Events.QueryEvents.noResults,function(){t.isEmpty=!0,t._updateAppearanceDependingOnState()}),e.$(this.root).on(e.Events.QueryEvents.newQuery,function(){t.isEmpty=!1})},n.prototype.sliderIsActive=function(){return!(isNaN(this.startOfSlider)||isNaN(this.endOfSlider)||isNaN(this.initialStartOfSlider)||isNaN(this.initialEndOfSlider)||this.startOfSlider==this.initialStartOfSlider&&this.endOfSlider==this.initialEndOfSlider)},n.prototype.buildBreadcrumbFacetSlider=function(){var i=this,n=e.$("<div/>").addClass("coveo-facet-breadcrumb");e.$("<span/>").addClass("coveo-title").text(this.options.title+":").appendTo(n);{var o=e.$("<span/>").addClass("coveo-values").appendTo(n),s=e.$("<span class='coveo-value'>"+this.slider.getCaption()+"</span>").appendTo(o);e.$("<span class='coveo-clear'></span>").appendTo(s)}return s.fastClick(function(){i.reset(),i.triggerNewQuery(function(){return i.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.facetClearAll,{facetId:i.options.uniqueId})})}),n},n.prototype.initSlider=function(){this.buildSlider(),this.slider.initializeState([this.startOfSlider,this.endOfSlider]),this.updateFacetStyle()},n.prototype._initQueryStateEvents=function(){var t=this;if(this.options.slider){this.rangeQueryStateAttribute=e.Models.QueryStateModel.getFacetId(this.options.uniqueId)+":range",this.queryStateModel.registerNewAttribute(this.rangeQueryStateAttribute,[void 0,void 0]);var n=this.queryStateModel.getEventName(e.Models.Model.eventTypes.changeOne+this.rangeQueryStateAttribute);this.bind.onRoot(n,function(e,i){t.slider?t.handleRangeQueryStateChanged(e,i):t.setRangeStateSliderStillNotCreated(e,i)})}else i.prototype._initQueryStateEvents.call(this)},n.prototype.handleRangeQueryStateChanged=function(e,t){this.setupSliderIfNeeded(t),this.startOfSlider=void 0==t.value[0]?this.startOfSlider:t.value[0],this.endOfSlider=void 0==t.value[1]?this.endOfSlider:t.value[1],this.slider.setValues([this.startOfSlider,this.endOfSlider]),this.updateFacetStyle()},n.prototype.setRangeStateSliderStillNotCreated=function(e,t){this.rangeFromUrlState=this.copyValues(t.value)},n.prototype.buildSlider=function(){var i=this,n=e.$("<div class='coveo-values coveo-slider-container'></div>");this.hasAGraph()&&n.addClass("coveo-with-graph");var o=e.$("<div></div>");this.slider=new t.Slider(o,e.$.extend({},this.options.slider,{dateField:this.options.dateField})),o.on(e.Events.SliderEvents.endSlide,function(e,t){i.handleEndSlide(e,t)}),o.on(e.Events.SliderEvents.duringSlide,function(e,t){i.handleDuringSlide(e,t)}),this.hasAGraph()&&o.on(e.Events.SliderEvents.graphValueSelected,function(e,t){i.handleGraphValueSelected(e,t)}),n.append(o),e.$(this.element).append(n),this.updateFacetStyle()},n.prototype._initFacetQueryController=function(){this.facetQueryController=new e.Controllers.FacetRangeQueryController(this)},n.prototype._handleBuildingQuery=function(t,n){e.Assert.exists(n),e.Assert.exists(n.queryBuilder);var o=this.getSliderBoundaryForQuery();if(void 0!=o){this.facetQueryController.prepareForNewQuery();var s=this.facetQueryController.computeOurFilterExpression(o);e.Utils.isNonEmptyString(s)&&(this.logger.trace("Putting filter in query",s),n.queryBuilder.advancedExpression.add(s))}else i.prototype._handleBuildingQuery.call(this,t,n)},n.prototype._processNewGroupByResults=function(e){var t=this;this.hasASlider()||(null!=e&&(null!=this.options.ranges||this.keepDisplayedValuesNextTime&&!this.values.hasSelectedOrExcludedValues()||(this.keepDisplayedValuesNextTime=!1,e.values.sort(function(e,i){var n=e.value.split(".."),o=i.value.split("..");return t.options.dateField?Date.parse(n[0])-Date.parse(o[0]):Number(n[0])-Number(o[0])}))),i.prototype._processNewGroupByResults.call(this,e))},n.prototype._handleDeferredQuerySuccess=function(e,t){this.ensureDom(),i.prototype._handleDeferredQuerySuccess.call(this,e,t),this.setupSliderIfNeeded(t);var n=t.results.groupByResults[this.facetQueryController.lastGroupByRequestIndex];(void 0==n||void 0==n.values[0])&&(this.isEmpty=!0,this._updateAppearanceDependingOnState()),this.hasAGraph()&&(this._updateAppearanceDependingOnState(),this.renderToSliderGraph(t)),this._updateAppearanceDependingOnState()},n.prototype._facetValueShouldBeRemoved=function(){return!1},n.prototype._rebuildValueElements=function(){this.hasASlider()||i.prototype._rebuildValueElements.call(this)},n.prototype.handleEndSlide=function(e,n){var o=this,s=n.slider.getValues();this.startOfSlider=s[0],this.endOfSlider=s[1],this.updateQueryState(s)&&(this.updateFacetStyle(),i.prototype.triggerNewQuery.call(this,function(){return o.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.facetRangeSlider,{facetId:o.options.uniqueId,facetRangeStart:o.startOfSlider.toString(),facetRangeEnd:o.endOfSlider.toString()})}))},n.prototype.handleDuringSlide=function(e,t){var i=t.slider.getValues();this.startOfSlider=i[0],this.endOfSlider=i[1],this.slider.setValues([this.startOfSlider,this.endOfSlider]),this.updateFacetStyle()},n.prototype.handleGraphValueSelected=function(e,n){var o=this;(this.options.slider.rangeSlider&&this.startOfSlider!=n.start||this.endOfSlider!=n.end)&&(this.options.slider.rangeSlider&&(this.startOfSlider=n.start),this.endOfSlider=n.end,this.slider.setValues([this.startOfSlider,this.endOfSlider]),this.updateQueryState(),i.prototype.triggerNewQuery.call(this,function(){return o.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.facetRangeGraph,{facetId:o.options.uniqueId,facetRangeStart:o.startOfSlider.toString(),facetRangeEnd:o.endOfSlider.toString()})}))},n.prototype.updateQueryState=function(e,t){void 0===e&&(e=this.slider.getValues()),void 0===t&&(t=!1);var i=this.copyValues(e),n=e[0]+0,o=e[1]+0,s=this.queryStateModel.get(this.rangeQueryStateAttribute);return null==s||i[0]!=s[0]||i[1]!=s[1]?(i[0]=n,i[1]=o,this.queryStateModel.set(this.rangeQueryStateAttribute,i,{silent:t}),!0):!1},n.prototype.copyValues=function(e){var t=[];return t[0]=e[0]+0,t[1]=e[1]+0,t},n.prototype.updateFacetStyle=function(){this.sliderIsActive()?e.$(this.element).removeClass("coveo-disabled"):e.$(this.element).addClass("coveo-disabled")},n.prototype.renderToSliderGraph=function(t){var i,n=this,o=t.results.groupByResults[this.facetQueryController.graphGroupByQueriesIndex],s=0;o&&(i=e._.map(o.values,function(e){s+=e.numberOfResults;var t=e.value.split("..")[0],i=e.value.split("..")[1];n.options.dateField?(t=new Date(t.split("@")[0]).getTime(),i=new Date(i.split("@")[0]).getTime()):(t=parseFloat(t),i=parseFloat(i));var o=e.numberOfResults;return{start:t,y:o,end:i,isDate:n.options.dateField}})),0==s?(this.isEmpty=!0,this._updateAppearanceDependingOnState()):void 0!=i&&this.slider.drawGraph(i)},n.prototype._updateAppearanceDependingOnState=function(){this.options.slider?(this.isEmpty&&!this.sliderIsActive()?e.$(this.element).addClass("coveo-disabled-empty"):(e.$(this.element).removeClass("coveo-disabled-empty"),e.$(this._eraserElement).fastToggle(this.sliderIsActive())),this.updateFacetStyle()):i.prototype._updateAppearanceDependingOnState.call(this)},n.prototype.generateBoundary=function(){if(this.slider){var e=this.generateBoundaryFromSlider();return void 0==e[0]&&void 0==e[1]?this.generateBoundaryFromState():e}return this.generateBoundaryFromState()},n.prototype.generateBoundaryFromSlider=function(){var e,t;return void 0!=this.startOfSlider&&(e=this.startOfSlider),void 0!=this.endOfSlider&&(t=this.endOfSlider),[e,t]},n.prototype.generateBoundaryFromState=function(){var e,t,i=this.queryStateModel.get(this.rangeQueryStateAttribute)[0];void 0!=i&&(e=i);var n=this.queryStateModel.get(this.rangeQueryStateAttribute)[1];return void 0!=n&&(t=n),e!=this.queryStateModel.getDefault(this.rangeQueryStateAttribute)[0]||t!=this.queryStateModel.getDefault(this.rangeQueryStateAttribute)[1]?[e,t]:[void 0,void 0]},n.prototype.setupSliderIfNeeded=function(t){if(this.ensureDom(),!e.Utils.isNullOrUndefined(this.options.slider)&&e.Utils.isNullOrUndefined(this.slider)){this.alreadySetBoundary()||this.trySetSliderBoundaryFromOptions(),this.alreadySetBoundary()||void 0==t||this.trySetSliderBoundaryFromQueryResult(t),this.trySetSliderBoundaryFromState(),this.setupSliderStateVariables();var i=this.verifySetup();i?this.logger.warn("Unable to initialize slider with current values",this):(this.initSlider(),this.updateQueryState())}},n.prototype.verifySetup=function(){var e=0;return e+=void 0==this.initialStartOfSlider?1:0,e+=isNaN(this.initialStartOfSlider)?1:0,e+=void 0==this.initialEndOfSlider?1:0,e+=isNaN(this.initialEndOfSlider)?1:0},n.prototype.setupSliderStateVariables=function(){isNaN(this.initialStartOfSlider)||isNaN(this.initialEndOfSlider)?this.logger.warn("Cannnot initialize slider with those values : start: "+this.initialStartOfSlider+" end: "+this.initialEndOfSlider):(this.initialStartOfSlider=parseFloat(this.initialStartOfSlider.toString()),this.initialEndOfSlider=parseFloat(this.initialEndOfSlider.toString()),this.startOfSlider=void 0!=this.startOfSlider?parseFloat(this.startOfSlider.toString()):this.initialStartOfSlider,this.endOfSlider=void 0!=this.endOfSlider?parseFloat(this.endOfSlider.toString()):this.initialEndOfSlider,this.options.slider.start=this.initialStartOfSlider,this.options.slider.end=this.initialEndOfSlider,this.queryStateModel.setNewDefault(this.rangeQueryStateAttribute,[this.initialStartOfSlider,this.initialEndOfSlider]))},n.prototype.alreadySetBoundary=function(){return void 0!=this.startOfSlider&&void 0!=this.endOfSlider},n.prototype.trySetSliderBoundaryFromOptions=function(){e.Utils.isNullOrUndefined(this.options.slider.start)||this.setupInitialSliderStateStart(this.options.slider.start),e.Utils.isNullOrUndefined(this.options.slider.end)||this.setupInitialSliderStateEnd(this.options.slider.end)},n.prototype.trySetSliderBoundaryFromState=function(){var e=this.rangeFromUrlState||this.queryStateModel.get(this.rangeQueryStateAttribute);e&&void 0!=e[0]&&void 0!=e[1]&&(this.setupInitialSliderStateStart(e[0]),this.setupInitialSliderStateEnd(e[1]),this.startOfSlider=e[0],this.endOfSlider=e[1])},n.prototype.trySetSliderBoundaryFromQueryResult=function(e){var t=e.results.groupByResults[this.facetQueryController.lastGroupByRequestIndex];t&&t.values.length>0&&(this.setupInitialSliderStateStart(t.values[0].value.split("..")[0]),this.setupInitialSliderStateEnd(t.values[t.values.length-1].value.split("..")[1]))},n.prototype.setupInitialSliderStateStart=function(e){void 0==this.initialStartOfSlider&&(this.initialStartOfSlider=e,this.options.dateField&&isNaN(e)&&(this.initialStartOfSlider=new Date(e.replace("@"," ")).getTime()))},n.prototype.setupInitialSliderStateEnd=function(e){void 0==this.initialEndOfSlider&&(this.initialEndOfSlider=e,this.options.dateField&&isNaN(e)&&(this.initialEndOfSlider=new Date(e.replace("@"," ")).getTime()))},n.prototype.hasASlider=function(){return void 0!=this.options.slider},n.prototype.hasAGraph=function(){return this.hasASlider()&&void 0!=this.options.slider.graph},n.ID="FacetRange",n.parent=t.Facet,n.options={dateField:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),slider:t.ComponentOptions.buildObjectOption({subOptions:{start:t.ComponentOptions.buildStringOption(),end:t.ComponentOptions.buildStringOption(),queryOverride:t.ComponentOptions.buildStringOption(),excludeOuterBounds:t.ComponentOptions.buildBooleanOption(),rounded:t.ComponentOptions.buildNumberOption(),steps:t.ComponentOptions.buildNumberOption(),rangeSlider:t.ComponentOptions.buildBooleanOption({attrName:"data-range-slider"}),displayAsValue:t.ComponentOptions.buildObjectOption({subOptions:{unitSign:t.ComponentOptions.buildStringOption(),separator:t.ComponentOptions.buildStringOption()}}),displayAsPercent:t.ComponentOptions.buildObjectOption({subOptions:{separator:t.ComponentOptions.buildStringOption()}}),dateField:t.ComponentOptions.buildBooleanOption(),graph:t.ComponentOptions.buildObjectOption({subOptions:{steps:t.ComponentOptions.buildNumberOption(),animationDuration:t.ComponentOptions.buildNumberOption(),margin:t.ComponentOptions.buildObjectOption({subOptions:{top:t.ComponentOptions.buildNumberOption(),bottom:t.ComponentOptions.buildNumberOption(),left:t.ComponentOptions.buildNumberOption(),right:t.ComponentOptions.buildNumberOption()}})}})}})},n}(t.Facet);t.FacetRange=i,t.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(Coveo){var Ui;!function(Ui){var FieldValue=function(_super){function FieldValue(e,t,i,n){var o=this;_super.call(this,e,FieldValue.ID,i),this.element=e,this.options=t,this.result=n,this.options=Ui.ComponentOptions.initComponentOptions(e,FieldValue,t),this.result=this.result||this.resolveResult(),Coveo.Assert.exists(this.result),this.options.field=this.options.field.toLowerCase();var s=Coveo.Utils.getCoveoFieldKey(this.options.field),r=this.result.raw[s];null==r&&(r=this.result[s]),Coveo._.isObject(r)&&(r=null);var a;this.options.splitValues&&r?(a=r.split(";"),a=Coveo._.map(a,function(e){return Coveo.$.trim(e)})):a=[r],Coveo._.each(a,function(e){void 0!=e&&o.renderOneValue(e)})}return __extends(FieldValue,_super),FieldValue.prototype.getHelperOptions=function(){return!this.evaluatedHelperOptions&&Coveo.Utils.isNonEmptyString(this.options.helperOptions)&&(this.evaluatedHelperOptions=eval("("+this.options.helperOptions+")")),this.evaluatedHelperOptions},FieldValue.prototype.renderOneValue=function(e){var t=Coveo.$("<span></span>"),i=e;this.options.helper&&(i=Ui.TemplateHelpers.getHelper(this.options.helper).call(this,e,this.getHelperOptions())),this.options.htmlValue?t.html(i):t.text(i),Coveo.$(this.element).append(t),this.bindEventOnValue(t,e)},FieldValue.prototype.bindEventOnValue=function(e,t){var i=this,n=Coveo.Models.QueryStateModel.getFacetId(this.options.facet),o=this.queryStateModel.get(n),s=this.componentStateModel.get(n),r=Coveo._.filter(s,function(e){return!e.disabled}).length>0;null!=o&&r&&(Coveo.$(e).on("click",function(){Coveo._.contains(o,t.toLowerCase())?i.queryStateModel.set(n,Coveo._.without(o,t.toLowerCase())):i.queryStateModel.set(n,Coveo._.union(o,[t.toLowerCase()])),i.queryController.deferExecuteQuery({beforeExecuteQuery:function(){return i.usageAnalytics.logSearchEvent(Ui.AnalyticsActionCauseList.documentField,{facetId:i.options.facet,facetValue:t.toLowerCase()})}})}),Coveo._.contains(o,t.toLowerCase())&&Coveo.$(e).addClass("coveo-selected"),Coveo.$(e).addClass("coveo-clickable"))},FieldValue.ID="FieldValue",FieldValue.options={field:Ui.ComponentOptions.buildFieldOption(),facet:Ui.ComponentOptions.buildStringOption({postProcessing:function(e,t){return e||t.field}}),htmlValue:Ui.ComponentOptions.buildBooleanOption({defaultValue:!1}),helper:Ui.ComponentOptions.buildStringOption(),helperOptions:Ui.ComponentOptions.buildStringOption(),splitValues:Ui.ComponentOptions.buildBooleanOption({defaultValue:!1})},FieldValue}(Ui.Component);Ui.FieldValue=FieldValue,Ui.CoveoJQuery.registerAutoCreateComponent(FieldValue)}(Ui=Coveo.Ui||(Coveo.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function o(s,r,a,l){i.call(this,s,n.ID,a),this.element=s,this.options=r,this.options=t.ComponentOptions.initComponentOptions(s,o,r);var u=e.$(this.element).find("tr[data-field]");u.each(function(e,t){new n(t,{},a,l)}),0==e.$(s).find("tr").length&&e.$(s).detach()}return __extends(o,i),o.ID="FieldTable",o.options={},o}(t.Component);t.CoveoJQuery.registerAutoCreateComponent(i);var n=function(i){function n(o,s,r,a){i.call(this,o,n.ID,r),this.element=o,this.options=s,this.result=a,this.options=t.ComponentOptions.initComponentOptions(o,n,s),this.result=a||this.resolveResult();
var l=e.Utils.getCoveoFieldKey(this.options.field);if(null!=this.result.raw[l]||null!=this.result[l]){e.$(o).append('<th class ="CoveoCaption">'+this.options.caption.toLocaleString()+"</th>");var u=e.$("<td />").appendTo(o);new t.FieldValue(u[0],this.options,r,a)}else e.$(o).detach()}return __extends(n,i),n.ID="ValueRow",n.options=e._.extend({caption:t.ComponentOptions.buildStringOption({postProcessing:function(e,t){return e||t.field.substr(1)}})},t.FieldValue.options),n}(t.Component)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r){i.call(this,o,n.ID,r),this.element=o,this.options=s,this.options=t.ComponentOptions.initComponentOptions(o,n,s),e.Assert.check(e.Utils.isCoveoField(this.options.field),this.options.field+" is not a valid field"),e.Assert.exists(this.options.maximumExpandedResults),this.bind.onRoot(e.Events.QueryEvents.buildingQuery,this.handleBuildingQuery),this.bind.onRoot(e.Events.QueryEvents.preprocessResults,this.handlepreprocessResults)}return __extends(n,i),n.resultNodeToQueryResult=function(t){var i=t.result;return i.attachments=e._.map(e._.sortBy(t.children,"score"),n.resultNodeToQueryResult),i.parentResult=null!=t.parent?t.parent.result:null,i},n.findUniqueId=function(e,t){for(var i=0;i<e.length;i++){if(e[i].result.uniqueId==t)return e[i];var o=n.findUniqueId(e[i].children,t);if(null!=o)return o}return null},n.foldWithParent=function(t){var i={score:Number.NEGATIVE_INFINITY,children:[],result:{}};e._.each(t,function(t,o){var s=n.findUniqueId(i.children,t.uniqueId);if(null==t.parentResult||t.parentResult.uniqueId==t.uniqueId)null==s&&(s={result:t,score:o,children:[]},i.children.push(s),s.parent=i);else{null!=s?(s.score=Math.min(o,s.score),s.parent.children=e._.without(s.parent.children,s)):s={result:t,score:o,children:[]};var r=n.findUniqueId(i.children,t.parentResult.uniqueId);null==r&&(r={result:t.parentResult,score:Number.POSITIVE_INFINITY,children:[]},i.children.push(r),r.parent=i),r.children.push(s),s.parent=r;for(var a=r;null!=a&&s.score<a.score;)a.score=s.score,a=a.parent}});var o=n.resultNodeToQueryResult(i);return o.attachments},n.defaultGetResult=function(e){var t=e.childResults||[];t.unshift(e),e.childResults=[],t=n.foldWithParent(t);var i=t.shift();return i.childResults=t,i},n.defaultGetMoreResults=function(e){return n.foldWithParent(e)},n.prototype.handleBuildingQuery=function(t,i){e.Assert.exists(i),this.disabled||(i.queryBuilder.childField=this.options.childField,i.queryBuilder.parentField=this.options.parentField,i.queryBuilder.filterField=this.options.field,i.queryBuilder.filterFieldRange=this.options.range)},n.prototype.handlepreprocessResults=function(t,i){e.Assert.exists(i),e.Assert.check(!i.results._folded,"Two folding component are active at the same time for the same tab. Can't process result !"),i.results._folded=!0;var o=i.results,s=this.options.getResult||n.defaultGetResult;o.results=e._.map(o.results,s),this.addLoadMoreHandler(o.results,i.query)},n.prototype.addLoadMoreHandler=function(t,i){var n=this;return e._.map(t,function(t){return n.options.enableExpand&&!e.Utils.isNullOrUndefined(t.raw[n.options.field.substr(1)])&&(t.moreResults=function(){return n.moreResults(t,i)}),t})},n.prototype.moreResults=function(i,n){var o=this,s=e.$.Deferred(),r=new t.QueryBuilder;r.numberOfResults=this.options.maximumExpandedResults;var a=i.raw[this.options.field.substr(1)];e.Utils.isNonEmptyString(a)&&r.advancedExpression.addFieldExpression(this.options.field,"=",[a]),e.Utils.isNonEmptyString(n.q)&&r.expression.add("("+n.q+") OR @sysuri"),e.Utils.isNonEmptyString(this.options.expandExpression)&&r.constantExpression.add(this.options.expandExpression),null!=this.options.parentField&&(r.parentField=this.options.parentField),null!=this.options.childField&&(r.childField=this.options.childField),this.options.rearrange?this.options.rearrange.putInQueryBuilder(r):(r.sortCriteria=n.sortCriteria,r.sortField=n.sortField);var l=r.build();return this.queryController.getEndpoint().search(l).done(function(t){e.QueryUtils.setIndexAndUidOnQueryResults(l,t,i.queryUid),e.QueryUtils.setStateObjectOnQueryResults(o.queryStateModel.get(),t),o.handlePreprocessMoreResults(t),s.resolve(t.results)}),s},n.prototype.handlePreprocessMoreResults=function(e){var t=this.options.getMoreResults||n.defaultGetMoreResults;e.results=t(e.results)},n.ID="Folding",n.options={field:t.ComponentOptions.buildFieldOption({required:!0}),childField:t.ComponentOptions.buildFieldOption({defaultValue:"@systopparentid"}),parentField:t.ComponentOptions.buildFieldOption({defaultValue:"@syscontainsattachment"}),range:t.ComponentOptions.buildNumberOption({defaultValue:2}),rearrange:t.ComponentOptions.buildCustomOption(function(i){return e.Utils.isNonEmptyString(i)?t.SortCriteria.parse(i):null}),directChildField:t.ComponentOptions.buildFieldOption({defaultValue:"@sysisattachment"}),directParentField:t.ComponentOptions.buildFieldOption({defaultValue:"@syscontainsattachment"}),enableExpand:t.ComponentOptions.buildBooleanOption({defaultValue:!0}),expandExpression:t.ComponentOptions.buildStringOption(),maximumExpandedResults:t.ComponentOptions.buildNumberOption({defaultValue:100})},n}(t.Component);t.Folding=i,e.Ui.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r){i.call(this,o,n.ID,r),this.element=o,this.options=s,this.options=t.ComponentOptions.initComponentOptions(o,n,s),e.$(this.root).on(e.Events.QueryEvents.buildingQuery,e.$.proxy(this.handleBuildingQuery,this)),e.$(this.root).on(this.queryStateModel.getEventName(e.Models.Model.eventTypes.changeOne+e.Models.QueryStateModel.attributesEnum.hq),e.$.proxy(this.handleUpdateUi,this))}return __extends(n,i),n.prototype.handleBuildingQuery=function(t,i){e.Assert.exists(i);var n=this.queryStateModel.get(e.Models.QueryStateModel.attributesEnum.hq);e.Utils.isNonEmptyString(n)?i.queryBuilder.advancedExpression.add(n):e.$(this.element).hide()},n.prototype.handleUpdateUi=function(t,i){e.Assert.exists(i);var n=i.value,o=this.queryStateModel.get(e.Models.QueryStateModel.attributesEnum.hd);e.Utils.isNonEmptyString(n)?(this.updatePanel(o),e.$(this.element).show()):e.$(this.element).hide()},n.prototype.updatePanel=function(i){var n=this;e.$(this.element).empty();var o=e.$("<span></span>").text(i),s=e.$("<a/>").attr("href","#").text(t.l("Remove")).addClass("coveo-remove").fastClick(function(){n.usageAnalytics.isContextual=!1,n.clearHiddenQuery()});this.usageAnalytics.isContextual=!0,e.$(this.element).append(o,s)},n.prototype.clearHiddenQuery=function(){var i=this,n=this.queryStateModel.get(e.Models.QueryStateModel.attributesEnum.hd);this.queryStateModel.set(e.Models.QueryStateModel.attributesEnum.hd,""),this.queryStateModel.set(e.Models.QueryStateModel.attributesEnum.hq,""),this.queryController.deferExecuteQuery({beforeExecuteQuery:function(){return i.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.contextRemove,{contextName:n})}})},n.ID="HiddenQuery",n.options={},n}(t.Component);t.HiddenQuery=i,t.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(t){function i(i){var n=this;t.call(this,i),this.facet=i,e.$(this.facet.root).on(e.Events.QueryEvents.querySuccess,function(e,t){void 0!=n.lastGroupByIndexForCountOf&&n.facet.options.useAnd&&(n.lastGroupByForCountOf=t.results.groupByResults[n.lastGroupByIndexForCountOf])}),e.$(this.facet.root).on(e.Events.QueryEvents.buildingQuery,function(){n.lastGroupByIndexForCountOf=void 0})}return __extends(i,t),i.prototype.putGroupByIntoQueryBuilder=function(e){t.prototype.putGroupByIntoQueryBuilder.call(this,e);var i=t.prototype._createBasicGroupByRequest.call(this);i.queryOverride="@sysuri",this.lastGroupByIndexForCountOf=e.groupByRequests.length,e.groupByRequests.push(i)},i}(t.FacetQueryController);t.HierarchicalFacetQueryController=i}(t=e.Controllers||(e.Controllers={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(e,t,n){i.call(this,e,t,n),this.facet=e,this.facetValue=t,this.keepDisplayedValueNextTime=n}return __extends(n,i),n.prototype.build=function(){var e=i.prototype.build.call(this);return e.label.append(e.excludeIcon),e},n.prototype.buildXOfYCountText=function(i){var n=this,o=this.facet.facetQueryController,s=e._.find(o.lastGroupByForCountOf.values,function(e){return e.value==n.facetValue.value});if(s){var r=Globalize.format(s.numberOfResults,"n0");return r!=i?i+" "+t.l("Of")+" "+r:i}return i},n}(t.FacetValueElement);t.HierarchicalFacetValueElement=i}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){var t=function(e){function t(t,i){e.call(this,t,i),this.facet=t,this.facetValueElementKlass=i}return __extends(t,e),t.prototype._getValuesToBuildWith=function(){return this.hierarchyFacetValues},t}(e.FacetValuesList);e.HierarchicalFacetValuesList=t}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){var t=function(e){function t(t,i,n){e.call(this,t,i,n),this.facet=t,this.facetValue=i,this.eventArg=n}return __extends(t,e),t.prototype._handleSelectValue=function(t){this.facet.open(this.facetValue),e.prototype._handleSelectValue.call(this,t)},t.prototype._handleExcludeClick=function(t){this.facet.open(this.facetValue),e.prototype._handleExcludeClick.call(this,t)},t}(e.OmniBoxValueElement);e.OmniboxHierarchicalValueElement=t}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){var t=function(t){function i(i,n,o){t.call(this,i,n,o,e.OmniboxHierarchicalValueElement),this.facet=i,this.facetValues=n,this.omniboxObject=o}return __extends(i,t),i}(e.OmniboxValuesList);e.OmniboxHierarchicalValuesList=t}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){var t=function(e){function t(t,i){e.call(this,t,i),this.facet=t,this.facetValue=i}return __extends(t,e),t.prototype.build=function(){var t=e.prototype.build.call(this);return t.addClass("coveo-hierarchical-facet-value"),t.find(".coveo-caption").html(this.facetValue.value.split(this.facet.options.delimitingCharacter).join("<span class='coveo-hierarchical-breadcrumb-separator'></span>")),t},t}(e.BreadcrumbValueElement);e.HierarchicalBreadcrumbValueElement=t}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){var t=function(t){function i(i,n,o){t.call(this,i,n,e.HierarchicalBreadcrumbValueElement),this.facet=i,this.facetValues=n,this.valueHierarchy=o}return __extends(i,t),i}(e.BreadcrumbValueList);e.HierarchicalBreadcrumbValuesList=t}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){var t=function(e){function t(t,i,n){e.call(this,t,i,n),this.facet=t,this.facetValue=i,this.keepDisplayedValueNextTime=n}return __extends(t,e),t.prototype._handleSelectValue=function(t){this.facet.open(this.facetValue),e.prototype._handleSelectValue.call(this,t)},t.prototype._handleExcludeClick=function(t){this.facet.open(this.facetValue),e.prototype._handleExcludeClick.call(this,t)},t}(e.FacetValueElement);e.HierarchicalFacetSearchValueElement=t}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){var t=function(t){function i(i){t.call(this,i,e.HierarchicalFacetSearchValueElement),this.facet=i}return __extends(i,t),i}(e.FacetSearchValuesList);e.HierarchicalFacetSearchValuesList=t}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r){i.call(this,o,e.$.extend({},s,{numberOfValues:1e4,injectionDepth:1e4}),r,n.ID),this.element=o,this.bindings=r,this.firstPlacement=!0,this.correctLevels=[],this.options=t.ComponentOptions.initComponentOptions(o,n,this.options),this.numberOfValuesToShow=this.originalNumberOfValuesToShow=s.numberOfValues||5,this.logger.info("Hierarchy facet : Set number of values very high in order to build hierarchy",this.options.numberOfValues,this)}return __extends(n,i),n.prototype.selectValue=function(e){this.ensureDom(),this.ensureValueHierarchyExists([e]);var t=this.getValueFromHierarchy(e);this.options.useAnd||this.selectChilds(t,t.childs),this.flagParentForSelection(t),i.prototype.selectValue.call(this,e)},n.prototype.selectMultipleValues=function(t){var n=this;this.ensureDom(),this.ensureValueHierarchyExists(t),e._.each(t,function(t){var i=n.getValueFromHierarchy(t);n.flagParentForSelection(i),n.options.useAnd||e._.each(i.childs,function(e){n.logger.info("Selecting facet value",n.facetValuesList.select(e.facetValue))})}),i.prototype.selectMultipleValues.call(this,t)},n.prototype.deselectValue=function(t){var n=this;this.ensureDom(),this.ensureValueHierarchyExists([t]);var o=this.getValueFromHierarchy(t);if(!this.options.useAnd){var s=void 0!=o.childs;if(s){var r=e._.filter(o.childs,function(e){var t=n.getFacetValueFromHierarchy(e.facetValue);return t.selected||t.excluded});r.length==o.childs.length&&this.deselectChilds(o,o.childs)}}this.unflagParentForSelection(o),i.prototype.deselectValue.call(this,t)},n.prototype.excludeValue=function(e){this.ensureDom(),this.ensureValueHierarchyExists([e]);var t=this.getValueFromHierarchy(e);this.options.useAnd?(this.deselectChilds(t,t.childs),this.close(t)):this.excludeChilds(t.childs),this.flagParentForSelection(t),i.prototype.excludeValue.call(this,e)},n.prototype.unexcludeValue=function(e){this.ensureDom(),this.ensureValueHierarchyExists([e]);var t=this.getValueFromHierarchy(e);this.options.useAnd||this.unexcludeChilds(t.childs),this.unflagParentForSelection(t),i.prototype.unexcludeValue.call(this,e)},n.prototype.deselectMultipleValues=function(t){var n=this;this.ensureDom(),this.ensureValueHierarchyExists(t),e._.each(t,function(t){var i=n.getValueFromHierarchy(t);n.unflagParentForSelection(i),n.options.useAnd||e._.each(i.childs,function(e){n.logger.info("Deselecting facet value",n.facetValuesList.unselect(e.facetValue))})}),i.prototype.deselectMultipleValues.call(this,t)},n.prototype.toggleSelectValue=function(e){this.ensureDom(),this.ensureValueHierarchyExists([e]),0==this.getFacetValueFromHierarchy(e).selected?this.selectValue(e):this.deselectValue(e)},n.prototype.toggleExcludeValue=function(e){this.ensureDom(),this.ensureValueHierarchyExists([e]),0==this.getFacetValueFromHierarchy(e).excluded?this.excludeValue(e):this.unexcludeValue(e)},n.prototype.getValueCaption=function(t){var i=this.getSelf(t),n=i;return e.Utils.exists(this.options.valueCaption)&&("object"==typeof this.options.valueCaption&&(n=this.options.valueCaption[i]||n),"function"==typeof this.options.valueCaption&&(n=this.options.valueCaption.call(this,t))),n},n.prototype._facetValueHasChanged=function(){var t=this;this._updateQueryStateModel(),e.Defer.defer(function(){t._updateAppearanceDependingOnState()})},n.prototype.getDisplayedValues=function(){return e._.first(e._.pluck(this.values.getAll(),"value"),this.numberOfValuesToShow)},n.prototype.updateSort=function(e){this.firstPlacement=!0,i.prototype.updateSort.call(this,e)},n.prototype.open=function(e){var i=e instanceof t.FacetValue?this.valueHierarchy[e.value]:e;void 0!=i&&(this.getElementFromFacetValueList(i.facetValue.value).addClass("coveo-open"),this.showChilds(i.childs),void 0!=i.parent&&this.open(this.valueHierarchy[i.facetValue.value].parent),this.valueHierarchy[i.facetValue.value].keepOpened=!0)},n.prototype.close=function(i){var n=this,o=i instanceof t.FacetValue?this.valueHierarchy[i.value]:i;void 0!=o&&(this.getElementFromFacetValueList(o.facetValue).removeClass("coveo-open"),this.hideChilds(o.childs),e._.each(o.childs,function(e){n.close(n.valueHierarchy[e.facetValue.value])}),this.valueHierarchy[o.facetValue.value].keepOpened=!1)},n.prototype.getLevel=function(e){return e.value.split(this.options.delimitingCharacter).length-1},n.prototype.reset=function(){e._.each(this.valueHierarchy,function(e){e.hasChildSelected=!1}),i.prototype.reset.call(this)},n.prototype._initFacetSearch=function(){this.facetSearch=new t.FacetSearch(this,t.HierarchicalFacetSearchValuesList),e.$(this.element).append(this.facetSearch.build())},n.prototype._handleDeferredQuerySuccess=function(e,t){this._updateAppearanceDependingOnState(),i.prototype._handleDeferredQuerySuccess.call(this,e,t)},n.prototype._handlePopulateBreadcrumb=function(i,n){if(e.Assert.exists(n),this.values.hasSelectedOrExcludedValues()){var o=new t.HierarchicalBreadcrumbValuesList(this,this.values.getSelected().concat(this.values.getExcluded()),this.valueHierarchy).build();n.breadcrumbs.push({element:o.get(0)})}},n.prototype._handleOmniBoxWithStaticValue=function(i){var n=this,o=i.completeQueryExpression.regex,s=(i.completeQueryExpression.word,e._.first(e._.filter(this.valueHierarchy,function(e){return o.test(n.getValueCaption(e.facetValue))}),this.options.numberOfValuesInOmniBox)),r=e._.compact(e._.map(s,function(e){var t=n.getFromFacetValueList(e.facetValue);return t?t.facetValue:void 0})),a=new t.OmniboxHierarchicalValuesList(this,r,i).build();i.rows.push({element:a?a.get(0):void 0,zIndex:this._omniboxZIndex})},n.prototype._rebuildValueElements=function(){this.processHierarchy(),this.setValueListContent(),i.prototype._rebuildValueElements.call(this),this.buildParentChildRelationship(),this.crop()},n.prototype._initFacetValuesList=function(){this.facetValuesList=new t.HierarchicalFacetValuesList(this,t.HierarchicalFacetValueElement),e.$(this.element).append(this.facetValuesList.build())},n.prototype._updateMoreLess=function(){this._moreElement.toggleClass("coveo-active",this.topLevelHierarchy.length>this.numberOfValuesToShow),this.numberOfValuesToShow>this.originalNumberOfValuesToShow?this._lessElement.show():this._lessElement.hide()},n.prototype._handleClickMore=function(){this.numberOfValuesToShow+=this.originalNumberOfValuesToShow,this.numberOfValuesToShow=Math.min(this.numberOfValuesToShow,this.values.size()),this._rebuildValueElements()},n.prototype._handleClickLess=function(){this.numberOfValuesToShow=this.originalNumberOfValuesToShow,this._rebuildValueElements()},n.prototype.ensureValueHierarchyExists=function(i){var n=this;i[0]&&"string"==typeof i[0]&&(i=e._.map(i,function(e){return t.FacetValue.createFromValue(e)}));var o=!1;e._.each(i,function(e){(void 0==n.valueHierarchy||void 0==n.valueHierarchy[e.value])&&(o=!0)}),o&&this.processHierarchy(i)},n.prototype.crop=function(){var t=this,i=e._.partition(this.topLevelHierarchy,function(e){return e.facetValue.selected||e.facetValue.excluded});e._.each(e._.last(i[1],i[1].length-(this.numberOfValuesToShow-i[0].length)),function(e){t.getElementFromFacetValueList(e.facetValue).hide()})},n.prototype.placeChildsUnderTheirParent=function(t,i){var n=this;e._.each(t.childs.reverse(),function(e){if(n.valueHierarchy[e.facetValue.value]){var t=n.getElementFromFacetValueList(e.facetValue);t.insertAfter(i)}}),t.keepOpened?(this.open(t),this.showChilds(t.childs)):this.hideChilds(t.childs)},n.prototype.addCssClassToParentAndChilds=function(t,i){var n=this;i.addClass("coveo-has-childs"),t.hasChildSelected&&i.addClass("coveo-has-childs-selected");var o=e.$("<div class='coveo-has-childs-toggle'></div>").fastClick(function(){i.hasClass("coveo-open")?n.close(t):n.open(t)});i.prepend(o)},n.prototype.buildParentChildRelationship=function(){var t=this,i=e._.chain(this.valueHierarchy).toArray().sortBy("level").value();e._.each(i,function(i){var n=t.getElementFromFacetValueList(i.facetValue);e.Utils.isNonEmptyArray(i.childs)?(t.placeChildsUnderTheirParent(i,n),t.addCssClassToParentAndChilds(i,n)):n.addClass("coveo-no-childs"),n.css("margin-left",t.options.marginByLevel*(i.level-t.options.levelStart))})},n.prototype.setValueListContent=function(){var t=this;this.facetValuesList.hierarchyFacetValues=e._.map(this.correctLevels,function(e){return t.values.contains(e.facetValue.value)||(e.facetValue.occurrences=0,t.values.add(e.facetValue)),e.facetValue})},n.prototype.createHierarchy=function(t){var i=this,n=e._.map(t,function(e){var t=i.getParent(e),n=e.lookupValue||e.value;return{facetValue:e,level:i.getLevel(e),parent:t,self:n}});return this.setInHierarchy(n),e._.each(this.valueHierarchy,function(e){e.facetValue.selected&&i.flagParentForSelection(e)}),n},n.prototype.processHierarchy=function(t){var i=this;void 0===t&&(t=this.values.getAll()),this.valueHierarchy=this.valueHierarchy?this.valueHierarchy:{},e._.each(this.valueHierarchy,function(e){void 0==i.values.get(e.facetValue.value)&&delete i.valueHierarchy[i.getLookupOrValue(e.facetValue).toLowerCase()]}),this.createHierarchy(t)},n.prototype.setInHierarchy=function(t){var i=this;this.correctLevels=e._.filter(t,function(e){var t=void 0==i.options.levelStart||e.level>=i.options.levelStart,n=void 0==i.options.levelEnd||e.level<i.options.levelEnd;return t&&n}),e._.each(this.correctLevels,function(t){var n,o=e._.map(e._.filter(i.correctLevels,function(e){return e.parent==t.self}),function(e){return{facetValue:e.facetValue,level:e.level,keepOpened:!1,hasChildSelected:!1}}),s=e._.find(i.correctLevels,function(e){return e.self==t.parent}),r=i.valueHierarchy[t.facetValue.value];s&&(n=i.valueHierarchy[s.facetValue.value]),i.valueHierarchy[t.facetValue.value]={childs:o,parent:void 0==s?void 0:{facetValue:s.facetValue,level:s.level,keepOpened:n?n.keepOpened:!1,hasChildSelected:n?n.hasChildSelected:!1,originalPosition:n?n.originalPosition:void 0},facetValue:t.facetValue,level:t.level,keepOpened:r?r.keepOpened:!1,hasChildSelected:r?r.hasChildSelected:!1,originalPosition:r?r.originalPosition:void 0}}),this.topLevelHierarchy=e._.chain(this.values.getAll()).filter(function(e){var t=i.getValueFromHierarchy(e);return t?t.level==(i.options.levelStart||0):!1}).map(function(e){return i.getValueFromHierarchy(e)}).value()},n.prototype.getParent=function(e){var t=this.getLookupOrValue(e).lastIndexOf(this.options.delimitingCharacter);return-1!=t?this.getLookupOrValue(e).substring(0,t):void 0},n.prototype.getSelf=function(e){var t=this.getParent(e);if(void 0==t)return this.getLookupOrValue(e);var i=this.getLookupOrValue(e).indexOf(t);return this.getLookupOrValue(e).substring(i+t.length+1)},n.prototype.showFacetValue=function(e){this.getElementFromFacetValueList(e.facetValue.value).removeClass("coveo-inactive")},n.prototype.hideFacetValue=function(e){this.getElementFromFacetValueList(e.facetValue.value).addClass("coveo-inactive")},n.prototype.hideChilds=function(t){var i=this;e._.each(t,function(e){i.hideFacetValue(e)})},n.prototype.showChilds=function(t){var i=this;e._.each(t,function(e){i.showFacetValue(e)})},n.prototype.hideParent=function(e){e&&this.hideFacetValue(e)},n.prototype.showParent=function(e){e&&this.showFacetValue(e)},n.prototype.selectChilds=function(t,i){this.flagParentForSelection(t),this.selectMultipleValues(e._.map(i,function(e){return e.facetValue}))},n.prototype.deselectChilds=function(t,i){t.hasChildSelected=!1,this.deselectMultipleValues(e._.map(i,function(e){return e.facetValue}))},n.prototype.excludeChilds=function(t){this.excludeMultipleValues(e._.map(t,function(e){return e.facetValue}))},n.prototype.unexcludeChilds=function(t){this.unexcludeMultipleValues(e._.map(t,function(e){return e.facetValue}))},n.prototype.selectParent=function(e){void 0!=e&&(this.selectValue(e.facetValue),e.parent&&this.selectParent(this.valueHierarchy[e.parent.facetValue.value]))},n.prototype.deselectParent=function(e){void 0!=e&&this.deselectValue(e.facetValue)},n.prototype.flagParentForSelection=function(e){for(var t=e.parent;t;){var i=this.valueHierarchy[t.facetValue.value];i.hasChildSelected=!0,t=i.parent}},n.prototype.unflagParentForSelection=function(t){for(var i=this,n=t.parent;n;){var o=this.valueHierarchy[n.facetValue.value],s=e._.filter(o.childs,function(e){var n=i.valueHierarchy[e.facetValue.value];return void 0!=n?n.facetValue.value!=t.facetValue.value&&(n.facetValue.selected||n.facetValue.excluded||n.hasChildSelected):void 0});0==s.length&&(o.hasChildSelected=!1),n=o.parent}},n.prototype.getValueFromHierarchy=function(e){var i=e instanceof t.FacetValue?e.value:e;return this.valueHierarchy[i]},n.prototype.getFacetValueFromHierarchy=function(e){return this.getValueFromHierarchy(e).facetValue},n.prototype.getLookupOrValue=function(e){return e.lookupValue||e.value},n.prototype.getElementFromFacetValueList=function(t){var i=this.getFromFacetValueList(t);return i?i.listElement:e.$("</div>")},n.prototype.getFromFacetValueList=function(e){var t=this.getValueFromHierarchy(e);return void 0!=t?this.facetValuesList.get(e):void 0},n.ID="HierarchicalFacet",n.options={delimitingCharacter:t.ComponentOptions.buildStringOption({defaultValue:"|"}),levelStart:t.ComponentOptions.buildNumberOption({defaultValue:0}),levelEnd:t.ComponentOptions.buildNumberOption(),marginByLevel:t.ComponentOptions.buildNumberOption({defaultValue:10})},n}(t.Facet);t.HierarchicalFacet=i,t.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function t(){this.logger=new e.Logger(this)}return t.prototype.instantiateToString=function(t){e.Assert.exists(t);var i=this.instantiateToElement(t);return e.$(i).html()},t.prototype.instantiateToElement=function(t){e.Assert.exists(t);var i=e.$("<div></div>"),n=e.$('<div class="coveo-header"></div>').appendTo(i);e.$('<a class="coveo-title"></a>').text(t.title).attr("href",t.clickUri).appendTo(n);var o=i.get(0);return this.logger.trace("Instantiated default result template",o),o},t}();t.DefaultResultTemplate=i}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.buildAttributeString=function(t){var i=[];return e._.each(t,function(e,t){void 0!=e&&i.push(t+"="+JSON.stringify(e.toString()))}),i.join(" ")},t}();e.HTMLUtils=t;var i=function(){function e(){}return e.buildAnchor=function(e,i){var n;return i&&i.text?(n=i.text,i.text=void 0):n=e,"<a href='"+e+"'"+t.buildAttributeString(i)+">"+n+"</a>"},e}();e.AnchorUtils=i;var n=function(){function i(){}return i.buildImage=function(e,i){var n="<img ";return n+=e?"src='"+e+"' ":"",n+=t.buildAttributeString(i)+"/>"},i.selectImageFromResult=function(t){return e.$("img[data-coveo-sys-uri-hash='"+t.raw.sysurihash+"']")},i.buildImageWithDirectSrcAttribute=function(e,t){var n=new Image,o=e.getViewAsDatastreamUri(t.uniqueId,"$Thumbnail$",{contentType:"image/png"});n.onload=function(){i.selectImageFromResult(t).attr("src",o)},n.src=o},i.buildImageWithBase64SrcAttribute=function(e,t){e.getRawDataStream(t.uniqueId,"$Thumbnail$").done(function(e){var n=String.fromCharCode.apply(null,new Uint8Array(e));i.selectImageFromResult(t).attr("src","data:image/png;base64, "+btoa(n))}).fail(function(){i.selectImageFromResult(t).remove()})},i.buildImageFromResult=function(t,n,o){var o=o?o:{},s=i.buildImage(void 0,e.$.extend(o,{"data-coveo-sys-uri-hash":t.raw.sysurihash}));return n.isJsonp()||e.DeviceUtils.isIE8or9()?i.buildImageWithDirectSrcAttribute(n,t):i.buildImageWithBase64SrcAttribute(n,t),s},i}();e.ImageUtils=n}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.splitSemicolonSeparatedListOfEmailAddresses=function(t){var i=t.split(/\s*;\s*/);return e._.filter(i,function(t){return e.Utils.exists(t)&&e.Utils.isNonEmptyString(e.Utils.trim(t))})},t.emailAddressesToHyperlinks=function(i,n,o,s,r){void 0===s&&(s=2),void 0===r&&(r=!1),i=e._.filter(i,function(t){return e.Utils.exists(t)&&e.Utils.isNonEmptyString(e.Utils.trim(t))});var a=e._.map(i,function(i){var s=t.parseEmail(i),a=s[1],l=s[0];if(e.Utils.exists(o)&&a==o&&(l=e.Ui.l("Me")),r){var u=l.split(" ");e.Utils.isNullOrUndefined(u[1])||(l=u[0]+" "+u[1].substring(0,1)+".")}var c=a.indexOf("@")>=0?a.indexOf("@")+1:0,p=a.substr(c);return e.Utils.exists(n)&&p!=n&&(l+=" ("+p+")"),'<a title="'+i+'" href="mailto:'+a+'">'+l+"</a>"}),l=a.length-s,u=l>0?t.buildEmailAddressesAndOthers(e._.last(a,l)):"";return e._.first(a,s).join(", ")+u},t.buildEmailAddressesAndOthers=function(t){return"<span class='coveo-emails-excess-collapsed coveo-active' onclick='Coveo.Ui.TemplateHelpers.getHelper(\"excessEmailToggle\")(this);'> "+e.Ui.l("AndOthers",t.length.toString(),t.length)+"</span><span class='coveo-emails-excess-expanded'> , "+t.join(" , ")+"</span>"},t.parseEmail=function(e){var e,t,i=e.match(/^\s*(.*)\s+<(.*)>$/);return null!=i?(t=i[1],/^".*"|'.*'$/.test(t)&&(t=t.substr(1,t.length-2)),e=i[2]):(t=e,e=e),[t,e]},t}();e.EmailUtils=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(e){function t(){e.apply(this,arguments),this.decimals=0}return __extends(t,e),t}(e.Options),i=function(){function i(){}return i.currencyToString=function(i,n){if(e.Utils.isNullOrUndefined(i))return"";e.Assert.isNumber(i),n=(new t).merge(n);var o=Globalize.culture().numberFormat.currency,s=o.symbol;e.Utils.isNonEmptyString(n.symbol)&&(o.symbol=n.symbol);var r=Globalize.format(i,"c"+n.decimals.toString());return o.symbol=s,r},i}();e.CurrencyUtils=i}(Coveo||(Coveo={}));var Coveo;!function(e){function t(t,i){return e._.isEmpty(i)?t:s({value:t,search:i.toLowerCase()})}var i=function(){function e(e,t,i){this.begin=e,this.size=t,this.replacementSize=i}return e}();e.Hole=i;var n=function(){function t(){}return t.replace=function(n,o,s){var r=new t;if(e.Utils.isNullOrEmptyString(n))return r;var a=n.lastIndexOf(o);if(-1==a)return r.value=n,r;for(var l=[];a>=0;){var u=new i(a,o.length,s.length);l.push(u),n=n.slice(0,a)+s+n.slice(a+o.length),a=n.lastIndexOf(o)}return r.holes=l,r.value=n,r},t.shortenPath=function(n,o){var s=n,r=new t;if(e.Utils.isNullOrEmptyString(s)||s.length<=o)return r.value=s,r;var a=[],l=-1;if(l=e.Utils.stringStartsWith(s,"\\\\")?s.indexOf("\\",l+2):s.indexOf("\\"),-1!=l){for(var u=0,c=s.indexOf("\\",l+1);-1!=c&&s.length-u+t.SHORTEN_END.length>o;)u=c-l-1,c=s.indexOf("\\",c+1);if(u>0){s=s.slice(0,l+1)+t.SHORTEN_END+s.slice(u);var p=new i(l+1,u-t.SHORTEN_END.length,t.SHORTEN_END.length);a.push(p)}}if(s.length>o){var d=s.length-o+t.SHORTEN_END.length,h=s.length-d;s=s.slice(0,h)+t.SHORTEN_END;var p=new i(h,d,t.SHORTEN_END.length);a.push(p)}return r.holes=a,r.value=s,r},t.shortenString=function(n,o,s){var r=n;s=e.Utils.toNotNullString(s);var a=new t;if(e.Utils.isNullOrEmptyString(r)||o<=s.length)return a.value=r,a;if(r.length<=o)return a.value=r,a;var l=r;if(o-=s.length,l=l.slice(0,o)," "!=r.charAt(l.length)){var u=l.lastIndexOf(" ");-1!=u&&l.length-u<t.WORD_SHORTER&&(l=l.slice(0,u))}var c=[];return c[0]=new i(l.length,r.length-l.length,s.length),l+=s,a.value=l,a.holes=c,a},t.shortenUri=function(n,o){var s=new t;if(e.Utils.isNullOrEmptyString(n)||n.length<=o)return s.value=n,s;var r=[],a=n.indexOf("//");if(-1!=a&&(a=n.indexOf("/",a+2)),-1!=a){for(var l=0,u=n.indexOf("/",a+1);-1!=u&&n.length-l+t.SHORTEN_END.length>o;)l=u-a-1,u=n.indexOf("/",u+1);if(l>0){n=n.slice(0,a+1)+t.SHORTEN_END+n.slice(a+1+l);var c=new i(a+1,l,t.SHORTEN_END.length);r.push(c)}}if(n.length>o){var p=n.length-o+t.SHORTEN_END.length,d=n.length-p;n=n.slice(0,d)+t.SHORTEN_END;var c=new i(d,p,t.SHORTEN_END.length);r.push(c)}return s.holes=r,s.value=n,s},t.SHORTEN_END="...",t.WORD_SHORTER=10,t}();e.StringAndHoles=n;var o=function(){function t(){}return t.highlightString=function(e,i,n,o){return t.buildHighlightedString(e,i,n,o)},t.buildHighlightedString=function(t,i,n,o){if(e.Assert.isNotUndefined(i),e.Assert.isNotNull(i),e.Assert.isNonEmptyString(o),e.Utils.isNullOrEmptyString(t))return t;for(var s=0,r=t.length,a="",l=0;l<i.length;l++){var u=i[l],c=u.offset,p=c+u.length;if(null!=n){for(var d=!1,h=0;h<n.length;h++){var f=n[h],v=f.begin,m=v+f.size;if(v>c&&p>=v&&m>p)p=v;else{if(c>=v&&m>p){d=!0;break}if(c>=v&&m>c&&p>=m)c=v+f.replacementSize,p-=f.size-f.replacementSize;else if(v>c&&p>=m)p-=f.size-f.replacementSize;else if(c>=m){var g=f.size-f.replacementSize;c-=g,p-=g}}}if(d||c==p)continue}if(p>r)break;a+=e._.escape(t.slice(s,c)),a+="<span class='"+o+"'",u.dataHighlightGroup&&(a+=" data-highlight-group='"+u.dataHighlightGroup.toString()+"'"),u.dataHighlightGroupTerm&&(a+=" data-highlight-group-term='"+u.dataHighlightGroupTerm+"'"),a+=" >",a+=e._.escape(t.slice(c,p)),a+="</span>",s=p
}return s!=r&&(a+=e._.escape(t.slice(s))),a},t}();e.HighlightUtils=o;var s=e._.template('<% var i = 0; var lowercaseValue = value.toLowerCase(); while(i < value.length) { %><% var index = lowercaseValue.indexOf(search, i); if(index != -1) { %><% if(i != index){ %> <span><%- value.substr(i, index) %></span><% } %><span class="coveo-hightlight"><%- value.substr(index, search.length) %></span><% i = index + search.length %></span><% } else { %><span><%- value.substr(i) %></span><% i = value.length; %><% } %><% } %>');e.highlightString=t}(Coveo||(Coveo={}));var Coveo;!function(e){function t(t,i,o,r){var l=(new u).merge(r),c=a(t);return c.find("*").each(function(t,r){var a=e.$(r).text(),u=s(o),c=e._.extend(i||{},u||{});e.$(r).html(e.HighlightUtils.highlightString(a,n(a,c,l),[],l.cssClass))}),c.html()}function i(t,i,o,r){var a=(new u).merge(r),l=s(o),c=e._.extend(i||{},l||{});return e.HighlightUtils.highlightString(t,n(t,c,a),[],a.cssClass)}function n(t,i,n){var o=[],s=e._.keys(i).sort(r);return e._.each(s,function(s){var a=!1,u=e._.compact([s].concat(i[s]).sort(r));e._.each(u,function(i){var r=e.StringUtils.getHighlights(t,l(i,n),s);void 0!=r&&e.Utils.isNonEmptyArray(r)&&(a=!0,o.push(r))})}),e._.chain(o).flatten().compact().uniq(function(e){return e.offset}).sortBy(function(e){return e.offset}).map(function(t){var n=e._.keys(i),o=e._.indexOf(n,t.dataHighlightGroupTerm)+1;return e._.extend(t,{dataHighlightGroup:o})}).value()}function o(t,i){var n=[];if(i==t.length-1)e._.each(t[i],function(e){n.push(e)});else{var s=o(t,i+1);e._.each(t[i],function(t){e._.each(s,function(e){n.push(t+" "+e)})})}return n}function s(t){return e._.chain(t).map(function(t){var i=e._.map(t,function(e,t){return[t].concat(e)});return e.Utils.isNonEmptyArray(i)?o(i,0):[]}).flatten().object([]).value()}function r(e,t){return e.length-t.length}function a(t){var i=e.$("<div />");return i.get(0).innerHTML=t,i}function l(e,t){var i=e.split(" ").join("\\W+");return new RegExp("([^a-zA-Z]|^)("+i+"(?![a-zA-Z]))",t.regexFlags)}var u=function(e){function t(t,i,n){void 0===t&&(t="coveo-highlight"),void 0===i&&(i=0),void 0===n&&(n="gi"),e.call(this),this.cssClass=t,this.shorten=i,this.regexFlags=n}return __extends(t,e),t}(e.Options);e.highlightStreamHTML=t,e.highlightStreamText=i}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){function i(){for(var e=arguments.callee.caller,t=e.arguments[0],i=0;void 0!=e&&(void 0==t||void 0==t.uri)&&100>i;)t=e.arguments[0],e=e.caller,i++;return t}t.TemplateHelpers.registerTemplateHelper("javascriptEncode",function(t){return e.Utils.exists(t)?e.StringUtils.javascriptEncode(t):void 0}),t.TemplateHelpers.registerTemplateHelper("shorten",function(t,i,n,o){var s=e.StringAndHoles.shortenString(t,i,"...");return e.Utils.exists(n)?e.HighlightUtils.highlightString(s.value,n,s.holes,o||"highlight"):s.value}),t.TemplateHelpers.registerTemplateHelper("shortenPath",function(t,i,n,o){var s=e.StringAndHoles.shortenPath(t,i);return e.Utils.exists(n)?e.HighlightUtils.highlightString(s.value,n,s.holes,o||"highlight"):s.value}),t.TemplateHelpers.registerTemplateHelper("shortenUri",function(t,i,n,o){var s=e.StringAndHoles.shortenUri(t,i);return e.Utils.exists(n)?e.HighlightUtils.highlightString(s.value,n,s.holes,o||"highlight"):s.value}),t.TemplateHelpers.registerTemplateHelper("highlight",function(t,i,n){return e.Utils.exists(t)?e.Utils.exists(i)?e.HighlightUtils.highlightString(t,i,null,n||"highlight"):t:void 0}),t.TemplateHelpers.registerTemplateHelper("highlightStreamText",function(t,n,o,s){return void 0===n&&(n=i().termsToHighlight),void 0===o&&(o=i().phrasesToHighlight),e.Utils.exists(t)?e.Utils.isNonEmptyArray(e._.keys(n))||e.Utils.isNonEmptyArray(e._.keys(o))?e.highlightStreamText(t,n,o,s):t:void 0}),t.TemplateHelpers.registerTemplateHelper("highlightStreamHTML",function(t,n,o,s){return void 0===n&&(n=i().termsToHighlight),void 0===o&&(o=i().phrasesToHighlight),e.Utils.exists(t)?e.Utils.isNonEmptyArray(n)?e.highlightStreamHTML(t,n,o,s):t:void 0}),t.TemplateHelpers.registerTemplateHelper("number",function(t,i){return e.Utils.exists(t)?e._.isString(i)?e.StringUtils.htmlEncode(Globalize.format(t,i)):e.StringUtils.htmlEncode(t.toString()):void 0}),t.TemplateHelpers.registerTemplateHelper("date",function(t,i){return e.DateUtils.dateToString(e.DateUtils.convertFromJsonDateIfNeeded(t),i)}),t.TemplateHelpers.registerTemplateHelper("time",function(t,i){return e.DateUtils.timeToString(e.DateUtils.convertFromJsonDateIfNeeded(t),i)}),t.TemplateHelpers.registerTemplateHelper("dateTime",function(t,i){return e.DateUtils.dateTimeToString(e.DateUtils.convertFromJsonDateIfNeeded(t),i)}),t.TemplateHelpers.registerTemplateHelper("emailDateTime",function(t,i){var n={};n.includeTimeIfThisWeek=!0;var o=e.$.extend({},n,i);return t?e.DateUtils.dateTimeToString(e.DateUtils.convertFromJsonDateIfNeeded(t),o):void 0}),t.TemplateHelpers.registerTemplateHelper("currency",function(t,i){return e.CurrencyUtils.currencyToString(t,i)}),t.TemplateHelpers.registerTemplateHelper("email",function(t,i,n,o,s){if(void 0===o&&(o=2),void 0===s&&(s=!1),e._.isString(t)){var r=e.EmailUtils.splitSemicolonSeparatedListOfEmailAddresses(t);return e.EmailUtils.emailAddressesToHyperlinks(r,i,n,o,s)}return e._.isArray(t)?e.EmailUtils.emailAddressesToHyperlinks(t,i,n,o,s):void 0}),t.TemplateHelpers.registerTemplateHelper("excessEmailToggle",function(t){return e.$(t).removeClass("coveo-active"),e.$(t).hasClass("coveo-emails-excess-collapsed")?e.$(t).siblings(".coveo-emails-excess-expanded").addClass("coveo-active"):e.$(t).hasClass("coveo-hide-expanded")&&(e.$(t).parent().addClass("coveo-inactive"),e.$(t).parent().siblings(".coveo-emails-excess-collapsed").addClass("coveo-active")),void 0}),t.TemplateHelpers.registerTemplateHelper("anchor",function(t,i){return e.AnchorUtils.buildAnchor(t,i)}),t.TemplateHelpers.registerTemplateHelper("image",function(t,i){return e.ImageUtils.buildImage(t,i)}),t.TemplateHelpers.registerTemplateHelper("thumbnail",function(t,n,o){return void 0===t&&(t=i()),void 0===n&&(n="default"),e.QueryUtils.hasThumbnail(t)?e.ImageUtils.buildImageFromResult(t,e.Rest.SearchEndpoint.endpoints[n],o):void 0}),t.TemplateHelpers.registerTemplateHelper("fromFileTypeToIcon",function(e,n){void 0===e&&(e=i()),void 0===n&&(n={});var o="",s="coveo-icon";if(n.classToUse)s+=" "+n.classToUse;else if(n.fileTypeToUse)s+=" sysfiletype "+n.fileTypeToUse;else{var r=t.FileTypes.get(e);s=r.icon,o=r.caption}return"<span class='"+s+"' title='"+o+"'></span>"}),t.TemplateHelpers.registerTemplateHelper("attrEncode",function(e){return(""+e).replace(/&/g,"&amp;").replace(/'/g,"&apos;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}),t.TemplateHelpers.registerTemplateHelper("loadTemplates",function(n,o){void 0===o&&(o=!0);var s,r="",a=i(),l=!1,u=n;return e._.each(n,function(e,t){"default"==e&&(s=t)}),void 0!=s&&(u=e._.omit(n,s)),e._.each(u,function(e,i){l&&o||(l=l||e,r+=t.TemplateHelpers.getHelper("loadTemplate")(i,e,a))}),l||void 0==s||(r+=t.TemplateHelpers.getHelper("loadTemplate")(s,!0,a)),r}),t.TemplateHelpers.registerTemplateHelper("loadTemplate",function(n,o,s){return void 0===o&&(o=!0),e.Utils.isNullOrUndefined(s)&&(s=i()),o?t.TemplateCache.getTemplate(n)(s):""})}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r,a){var l=this;void 0===a&&(a=n.ID),i.call(this,o,a,r),this.element=o,this.options=s,this.bindings=r,this.currentlyDisplayedResults=[],this.reachedTheEndOfResults=!1,this.resetList=!0,this.pageChanged=!1,this.options=t.ComponentOptions.initComponentOptions(o,n,s),e.Assert.exists(o),e.Assert.exists(this.options),e.Assert.exists(this.options.resultContainer),e.Assert.exists(this.options.resultTemplate),e.Assert.exists(this.options.waitAnimationContainer),e.Assert.exists(this.options.infiniteScrollContainer),this.showOrHideElementsDependingOnState(!1,!1),e.$(this.root).on(e.Events.QueryEvents.newQuery,e.$.proxy(this.handleNewQuery,this)),e.$(this.root).on(e.Events.QueryEvents.querySuccess,e.$.proxy(this.handleProcessNewQueryResults,this)),e.$(this.root).on(e.Events.QueryEvents.duringQuery,e.$.proxy(this.handleDuringQuery,this)),e.$(this.root).on(e.Events.QueryEvents.queryError,function(){l.hideWaitingAnimation(),e.$(l.options.resultContainer).empty(),l.currentlyDisplayedResults=[]}),this.options.enableInfiniteScroll&&e.$(this.options.infiniteScrollContainer).scroll(function(e){return l.handleScrollOfResultList(e)});var u=this.queryStateModel.getEventName(e.Models.Model.eventTypes.changeOne+e.Models.QueryStateModel.attributesEnum.first);e.$(this.queryStateModel.element).on(u,e.$.proxy(this.handlePageChanged,this))}return __extends(n,i),n.prototype.handlePageChanged=function(){var t=this;e.$(this.root).one(e.Events.QueryEvents.querySuccess,function(){e.$(t.options.infiniteScrollContainer).scrollTop(0)})},n.prototype.handleNewQuery=function(){this.disabled||e.$(this.element).show()},n.prototype.displayMoreResults=function(i){var n=this;return e.Assert.isLargerOrEqualsThan(1,i),e.Assert.check(this.hasPotentiallyMoreResultsToDisplay()),this.isCurrentlyFetchingMoreResults()?(this.logger.warn("Ignoring request to display more results since we're already doing so"),void 0):this.hasPotentiallyMoreResultsToDisplay()?(this.options.showInfiniteScrollWaitingAnimation&&this.showWaitingAnimationForInfiniteScrolling(),this.fetchingMoreResults=this.queryController.fetchMore(i),this.fetchingMoreResults.done(function(o){e.Assert.exists(o),n.usageAnalytics.logCustomEvent(t.AnalyticsActionCauseList.pagerScrolling,{},n.element);var s=o.results;n.reachedTheEndOfResults=i>o.results.length,n._buildResults(o),e._.each(s,function(e){n.currentlyDisplayedResults.push(e)}),e.$(n.element).trigger(e.Events.ResultListEvents.newResultsDisplayed,{})}),this.fetchingMoreResults.always(function(){n.hideWaitingAnimationForInfiniteScrolling(),n.fetchingMoreResults=void 0,e.Defer.defer(function(){return n.handleScrollOfResultList()})}),void 0):(this.logger.warn("Ignoring request to display more results since we know there aren't more to display"),void 0)},n.prototype._triggerNewResultDisplayed=function(t,i){var n={result:t,item:i};e.$(this.element).trigger(e.Events.ResultListEvents.newResultDisplayed,n)},n.prototype._buildResults=function(t){var i=this;e.$.each(t.results,function(t,n){var o=i._instantiateTemplateForResult(n);e.$(o).data("CoveoResult",n),e.$(i.options.resultContainer).append(o),i._autoCreateComponentsInsideResult(o,n),i._triggerNewResultDisplayed(n,o)})},n.prototype._instantiateTemplateForResult=function(i){e.Assert.exists(i);var n=this.options.resultTemplate.instantiateToElement(i);return t.Component.bindResultToElement(n,i),n},n.prototype._autoCreateComponentsInsideResult=function(i,n){e.Assert.exists(i);var o=this.searchInterface.options,s=e.$.extend({},{options:o},this.getBindings(),{result:n});t.CoveoJQuery.automaticallyCreateComponentsInside(i,s)},n.prototype.handleDuringQuery=function(){this.logger.trace("Emptying the result container"),this.currentlyDisplayedResults=[],this.cancelFetchingMoreResultsIfNeeded(),this.showWaitingAnimation(),this.showOrHideElementsDependingOnState(!1,!1)},n.prototype.handleProcessNewQueryResults=function(t,i){if(e.Assert.exists(i),e.Assert.exists(i.results),e.$(this.element).fastToggle(!this.disabled),!this.disabled){var n=i.results;this.logger.trace("Received query results from new query",n),this.hideWaitingAnimation(),this.options.resultContainer.innerHTML="",this.currentlyDisplayedResults=[],this._buildResults(n),this.currentlyDisplayedResults=n.results,this.reachedTheEndOfResults=!1,this.showOrHideElementsDependingOnState(!0,0!=this.currentlyDisplayedResults.length),this.options.enableInfiniteScroll&&n.results.length==i.queryBuilder.numberOfResults&&this.handleScrollOfResultList(),e.DeviceUtils.isMobileDevice()&&void 0!=this.options.mobileScrollContainer&&(this.options.mobileScrollContainer.scrollTop=0),e.$(this.element).trigger(e.Events.ResultListEvents.newResultsDisplayed,{})}},n.prototype.reset=function(){this.hideWaitingAnimation(),e.$(this.options.resultContainer).empty(),this.currentlyDisplayedResults=[]},n.prototype.handleScrollOfResultList=function(e){this.isCurrentlyFetchingMoreResults()||this.isScrollingOfResultListAlmostAtTheBottom()&&this.hasPotentiallyMoreResultsToDisplay()&&this.displayMoreResults(this.options.infiniteScrollPageSize,null!=e)},n.prototype.isCurrentlyFetchingMoreResults=function(){return e.Utils.exists(this.fetchingMoreResults)},n.prototype.isScrollingOfResultListAlmostAtTheBottom=function(){var t;try{t=e.$(this.options.infiniteScrollContainer).get(0)instanceof Window}catch(i){t=!1}return t?this.isScrollAtBottomForWindowElement():this.isScrollAtBottomForHtmlElement()},n.prototype.isScrollAtBottomForWindowElement=function(){var t=e.$(window).height(),i=e.$(window).scrollTop(),n=e.$(document).height();return t/2>n-(t+i)},n.prototype.isScrollAtBottomForHtmlElement=function(){var t=e.$(this.options.infiniteScrollContainer).innerHeight(),i=e.$(this.options.infiniteScrollContainer).get(0).scrollHeight,n=e.$(this.options.infiniteScrollContainer).scrollTop()+t;return t/2>i-n},n.prototype.hasPotentiallyMoreResultsToDisplay=function(){return this.currentlyDisplayedResults.length>0&&!this.reachedTheEndOfResults},n.prototype.cancelFetchingMoreResultsIfNeeded=function(){this.isCurrentlyFetchingMoreResults()&&(this.logger.trace("Cancelling fetching more results"),this.fetchingMoreResults.reject(),this.fetchingMoreResults=void 0)},n.prototype.showOrHideElementsDependingOnState=function(t,i){e.$(this.element).find(".coveo-show-if-query").fastToggle(t),e.$(this.element).find(".coveo-show-if-no-query").fastToggle(!t),e.$(this.element).find(".coveo-show-if-results").fastToggle(t&&i),e.$(this.element).find(".coveo-show-if-no-results").fastToggle(t&&!i)},n.prototype.showWaitingAnimation=function(){switch(this.options.waitAnimation.toLowerCase()){case"fade":e.$(this.options.waitAnimationContainer).addClass("coveo-fade-out");break;case"spinner":e.$(this.options.resultContainer).children().hide(),0==e.$(this.options.waitAnimationContainer).find(".coveo-wait-animation").length&&e.$(this.options.waitAnimationContainer).append('<img src="../image/wait.gif" class="coveo-wait-animation"/>')}},n.prototype.hideWaitingAnimation=function(){switch(this.options.waitAnimation.toLowerCase()){case"fade":e.$(this.options.waitAnimationContainer).removeClass("coveo-fade-out");break;case"spinner":e.$(this.options.waitAnimationContainer).children("img.coveo-wait-animation").detach()}},n.prototype.showWaitingAnimationForInfiniteScrolling=function(){e.$(this.options.waitAnimationContainer).append('<img src="../image/wait.gif" class="coveo-wait-animation"/>')},n.prototype.hideWaitingAnimationForInfiniteScrolling=function(){e.$(this.options.waitAnimationContainer).children("img.coveo-wait-animation").detach()},n.ID="ResultList",n.options={resultContainer:t.ComponentOptions.buildChildHtmlElementOption({defaultFunction:function(t){return e.$("<div/>").appendTo(t).get(0)}}),resultTemplate:t.ComponentOptions.buildTemplateOption({defaultFunction:function(){return new t.DefaultResultTemplate}}),waitAnimation:t.ComponentOptions.buildStringOption({defaultValue:"none"}),waitAnimationContainer:t.ComponentOptions.buildChildHtmlElementOption({postProcessing:function(e,t){return e||t.resultContainer}}),enableInfiniteScroll:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),infiniteScrollPageSize:t.ComponentOptions.buildNumberOption({defaultValue:10}),infiniteScrollContainer:t.ComponentOptions.buildChildHtmlElementOption({defaultFunction:function(t){return e.JQueryUtils.findScrollingParent(t)}}),showInfiniteScrollWaitingAnimation:t.ComponentOptions.buildBooleanOption({defaultValue:!0}),mobileScrollContainer:t.ComponentOptions.buildSelectorOption({defaultFunction:function(){return e.$(".coveo-results-column").get(0)}})},n}(t.Component);t.ResultList=i,t.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r,a){void 0===a&&(a=e.Ui.ResultList.ID),i.call(this,o,s,r,n.ID),this.element=o,this.options=s,this.columnResultsArray=[],this.imagesInCurrentRow=[],this.imagesLoaded=0,this.resultIndex=0,this.lastRowHeight=0,this.options=t.ComponentOptions.initComponentOptions(o,n,s),this.lastRowHeight=this.options.heightThreshold,e.$(this.root).on(e.Events.ResultListEvents.newResultsDisplayed,e.$.proxy(this.handleProcessNewResultsDisplayed,this)),this.bindWindowResizeEvent()}return __extends(n,i),n.prototype.getResultsElement=function(){return e.$(this.element).find(".CoveoResult")},n.prototype.getResultsElementImages=function(){return e.$(this.element).find(".CoveoResult img")},n.prototype.getResultsContainerDiv=function(){return e.$(this.element).find("> div")},n.prototype.bindWindowResizeEvent=function(){var t,i=this;e.$(window).on("resize",function(){clearTimeout(t),t=setTimeout(i.retrieveLayoutMethod(),250)})},n.prototype.handleProcessNewResultsDisplayed=function(){this.disabled?e.$(this.element).fadeOut():e.$(this.element).fadeIn(),this.onImageProxy(this.retrieveLayoutMethod())},n.prototype.addTransitionAllToElement=function(t){e._.defer(function(){t.addClass("coveo-transition-all")})},n.prototype.retrieveLayoutMethod=function(){var e=this;if(!this.disabled){if(this.options.layoutType.toLowerCase()==n.columnLayoutTypeStr)return function(){return e.setupColumns()};if(this.options.layoutType.toLowerCase()==n.rowLayoutTypeStr)return function(){return e.setupRows()}}return function(){}},n.prototype.onImageProxy=function(t){var i=(this.getResultsElement().each(function(t,i){0==e.$(i).find("img").length&&e.$(i).detach()}),this.getResultsElementImages()),n=0,o=function(o){e.$(o).height()>0?(null==e.$(o).attr("width")&&null==e.$(o).attr("height")&&(e.$(o).attr("height",e.$(o).height()),e.$(o).attr("width",e.$(o).width())),n++,n==i.length&&t()):(e.$(o).parent().detach(),i=i.not(o),n==i.length&&t())};i.each(function(t,i){this.src&&this.complete||e.$(i).height()>0?o(i):e.$(i).off("load").one("load",function(){o(i)})})},n.prototype.getHorizontalMargin=function(e){return parseInt(e.css("margin-left"))+parseInt(e.css("margin-right"))},n.prototype.getVerticalMargin=function(e){return parseInt(e.css("margin-top"))+parseInt(e.css("margin-bottom"))},n.prototype.setupColumns=function(){var t=this.getResultsContainerDiv().width(),i=this.getResultsElement(),n=this.options.columnWidth,o=this.getHorizontalMargin(i),s=Math.floor(t/(n+o));this.columnResultsArray=[];for(var r=0;s>r;r++)this.columnResultsArray.push(o);this.positionColumns(n,o),e.$(this.element).trigger(e.Events.ImageResultListEvents.imageResultsLayoutComplete,{}),this.options.enableInfiniteScroll&&this.adjustNumberOfResults()},n.prototype.positionColumns=function(t,i){var n=this,o=this.getResultsElement();e._.each(o,function(o){var s=e._.min(n.columnResultsArray),r=e.$.inArray(s,n.columnResultsArray),a=i+r*(t+i);e.$(o).css({left:a+"px",top:s+"px",width:t+"px"}),n.columnResultsArray[r]=s+e.$(o).outerHeight()+i}),this.setResultsContainerHeight(e._.max(this.columnResultsArray)),this.addTransitionAllToElement(o)},n.prototype.setResultsContainerHeight=function(t){e.$(this.element).height(Math.ceil(t)),e.$(this.element).attr("data-height",Math.ceil(t))},n.prototype.setupRows=function(){var t=this.getResultsElement(),i=e.$(this.element).width();this.resultIndex=0;for(var n=0;this.resultIndex<t.length;){this.imagesInCurrentRow=[];var o=this.getCurrentRowHeight(t,i);this.setCurrentRowImagesDimensions(t,o,n),n+=o}this.setResultsContainerHeight(n),e.$(this.element).trigger(e.Events.ImageResultListEvents.imageResultsLayoutComplete,{}),this.addTransitionAllToElement(t),this.options.enableInfiniteScroll&&this.adjustNumberOfResults()},n.prototype.getCurrentRowHeight=function(e,t){for(var i=0,n=null;this.resultIndex<e.length&&(null==n||n>=this.options.heightThreshold);){var o=this.getImageDimensionsFromResult(e.eq(this.resultIndex));null!=o&&(i+=o.width/o.height,n=t/i),this.imagesInCurrentRow.push(this.resultIndex),this.resultIndex++}return n>this.options.heightThreshold&&(n=this.lastRowHeight),this.lastRowHeight=n,n},n.prototype.getImageDimensionsFromResult=function(e){var t=e.find("img"),i=parseInt(t.attr("height")),n=parseInt(t.attr("width"));return{height:i,width:n}},n.prototype.setCurrentRowImagesDimensions=function(t,i,n){var o=this,s=0;e._.each(this.imagesInCurrentRow,function(e){var r=parseInt(t.eq(e).find("img").attr("width")),a=parseInt(t.eq(e).find("img").attr("height")),l=r*i/a,u=o.getHorizontalMargin(t.eq(e)),c=o.getVerticalMargin(t.eq(e));t.eq(e).css({height:Math.round(i-c),width:Math.round(l-u),left:Math.round(s),top:Math.round(n)}),s+=l})},n.prototype.adjustNumberOfResults=function(){var t=Number(e.$(this.element).attr("data-height"));0==e.$.isNumeric(t)&&(t=e.$(this.element).height()),t<e.$(this.options.infiniteScrollContainer).height()&&i.prototype.hasPotentiallyMoreResultsToDisplay.call(this)&&i.prototype.displayMoreResults.call(this,this.options.infiniteScrollPageSize,!1)},n.ID="ImageResultList",n.rowLayoutTypeStr="row",n.columnLayoutTypeStr="column",n.options={layoutType:t.ComponentOptions.buildStringOption({defaultValue:"row",postProcessing:function(e){return e.toLowerCase()}}),heightThreshold:t.ComponentOptions.buildNumberOption({defaultValue:250}),columnWidth:t.ComponentOptions.buildNumberOption({defaultValue:225})},n}(t.ResultList);t.ImageResultList=i,e.Ui.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.ajaxBasicAuth=function(i,n,o,s,r,a){e.$.ajax({type:i,timeout:5e3,url:n,beforeSend:function(i){null!=o&&null!=s&&(i.setRequestHeader("Authorization",t.getBasicAuthBase64(o,s)),e.DeviceUtils.isPhonegap()&&i.setRequestHeader("Basic-Auth-Challenge-Client","Phonegap"))}}).fail(function(e){a&&a(e)}).done(function(e){r(e)})},t.getBasicAuthBase64=function(e,t){return"Basic "+btoa(e+":"+t)},t}();e.AjaxUtils=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function i(i){this.loginPanel=i,this.userInputTemplate=e._.template("<div class='coveo-input-container'>          <span class='coveo-username-icon'></span>          <input class='coveo-username' type='text' placeholder='"+t.l("Username")+"' autocorrect='off' autocapitalize='off' />      </div>"),this.passwordInputTemplate=e._.template("<div class='coveo-input-container'>          <span class='coveo-password-icon'></span>          <input class='coveo-password'  type='password' placeholder='"+t.l("Password")+"' autocorrect='off' autocapitalize='off' />      </div>"),this.containerTemplate=e._.template("<div class='coveo-login-credentials-container'></div>")}return i.prototype.buildDom=function(){var t=this;this.credentialContainer=e.$(this.containerTemplate()),this.loginUser=e.$(this.userInputTemplate()),this.loginUser.keypress(function(e){return t.handleInputKeypress(e)}),this.loginPassword=e.$(this.passwordInputTemplate()),this.loginPassword.keypress(function(e){return t.handleInputKeypress(e)}),this.credentialContainer.append(this.loginUser,this.loginPassword),this.loginPanel.getOrCreateContainer().append(this.credentialContainer),this.loginUser.find("input").val(this.getUser()),this.loginPassword.find("input").val(this.getPassword())},i.prototype.show=function(){this.credentialContainer.show()},i.prototype.getUser=function(){return window.localStorage.getItem(this.getLocalStorageKeyUser())},i.prototype.setUser=function(e){this.loginUser.find("input").val(e),window.localStorage.setItem(this.getLocalStorageKeyUser(),e)},i.prototype.getPassword=function(){return window.localStorage.getItem(this.getLocalStorageKeyPassword())},i.prototype.setPassword=function(e){this.loginPassword.find("input").val(e),window.localStorage.setItem(this.getLocalStorageKeyPassword(),e)},i.prototype.validate=function(){var t=e.$.Deferred();return this.setPassword(this.getPasswordFromInput()),this.setUser(this.getUserFromInput()),t.resolve(!0),t},i.prototype.submit=function(){var t=e.$.Deferred();return this.setPassword(this.getPasswordFromInput()),this.setUser(this.getUserFromInput()),t.resolve(!0),t},i.prototype.getLocalStorageKeyUser=function(){return"coveo-user-"+this.loginPanel.options.id},i.prototype.getLocalStorageKeyPassword=function(){return"coveo-password-"+this.loginPanel.options.id},i.prototype.getPasswordFromInput=function(){return this.loginPassword.find("input").val()},i.prototype.getUserFromInput=function(){return this.loginUser.find("input").val()},i.prototype.handleInputKeypress=function(e){this.loginPanel.isHidden||13!=e.keyCode||this.loginPanel.submit()},i}();t.LoginCredentials=i}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(e,t){this.filename=e,this.flags=t}return t.prototype.done=function(e){return this._success=e,this},t.prototype.fail=function(e){return this._error=e,this},t.prototype.tryAccess=function(){this.tryGetFilesystem()},t.prototype._onGotFileEntry=function(){},t.prototype.tryGetFilesystem=function(){window.requestFileSystem(LocalFileSystem.PERSISTENT,0,e.$.proxy(this._gotFileSystem,this),e.$.proxy(this.onError,this))},t.prototype._gotFileSystem=function(t){t.root.getFile(this.filename,this.flags,e.$.proxy(this._onGotFileEntry,this),e.$.proxy(this.onError,this))},t.prototype.onError=function(e){this._error(e)},t}();e.PhonegapFileAccess=t;var i=function(t){function i(e){t.call(this,e,null)}return __extends(i,t),i.prototype.read=function(){return this.tryAccess(),this},i.prototype._onGotFileEntry=function(e){this.gotFileEntry(e)},i.prototype.gotFileEntry=function(t){t.file(e.$.proxy(this.gotFile,this),e.$.proxy(this._error,this))},i.prototype.gotFile=function(e){var t=this,i=new FileReader;i.onloadend=function(e){t._success&&t._success(e.target.result)},i.readAsText(e)},i}(t);e.PhonegapFileReader=i;var n=function(t){function i(e,i){void 0===i&&(i=!1),t.call(this,e,{create:!0,exclusive:!1}),this.append=i}return __extends(i,t),i.prototype.write=function(e){return this.content=e,this.tryAccess(),this},i.prototype._onGotFileEntry=function(t){t.createWriter(e.$.proxy(this.gotFileWriter,this),e.$.proxy(this._error,this))},i.prototype.gotFileWriter=function(e){var t=this;e.onwriteend=function(e){t._success&&t._success(e)},this.append&&e.seek(e.length),e.write(this.content)},i}(t);e.PhonegapFileWriter=n}(Coveo||(Coveo={}));var Coveo;!function(Coveo){var Ui;!function(Ui){var LoginPageSettings=function(){function LoginPageSettings(e){this.loginPanel=e,this.pageSettingsInputTemplate=Coveo._.template("<div class='coveo-input-container'>          <span class='coveo-page-settings-icon'></span>          <input class='coveo-page-settings' type='text' placeholder='"+Ui.l("PageUrl")+"' autocorrect='off' autocapitalize='off' />    </div>")}return LoginPageSettings.prototype.buildDom=function(){var e=this,t=Coveo.$("<div></div>").addClass("coveo-login-page-settings-container");this.pageSettings=Coveo.$(this.pageSettingsInputTemplate()),this.pageSettings.keypress(function(t){return e.handleInputKeypress(t)}),t.append(this.pageSettings),this.pageSettings.find("input").val(this.getPageSettingsUrl()),this.loginPanel.getOrCreateContainer().append(t)},LoginPageSettings.prototype.getPageSettingsUrl=function(){return window.localStorage.getItem(this.getLocalStorageKeyPageUrl())},LoginPageSettings.prototype.setPageSettingsUrl=function(e){this.pageSettings.find("input").val(e),window.localStorage.setItem(this.getLocalStorageKeyPageUrl(),e)},LoginPageSettings.prototype.submit=function(e){var t=this.pageSettings.find("input").val();this.setPageSettingsUrl(t);var i=Coveo.$.Deferred();return this.tryToWriteFileToDisc(e,i,!0),i},LoginPageSettings.prototype.validate=function(e){var t=Coveo.$.Deferred();return this.getPageSettingsUrl()?this.tryToReadFileFomDisc(e,t,!1):t.reject(),t},LoginPageSettings.prototype.getLocalStorageKeyPageUrl=function(){return"coveo-page-settings-url-"+this.loginPanel.options.id},LoginPageSettings.prototype.handleInputKeypress=function(e){this.loginPanel.isHidden||13!=e.keyCode||this.loginPanel.submit()},LoginPageSettings.prototype.loadFromInterfaceEditorUrl=function(e){var t=document.createElement("a");return t.href=e,"/load"==t.pathname?""!=Coveo.Utils.getQueryStringValue("id",t.search)||-1!=e.indexOf("?id")?e:e+"?id":e+"/load?id"},LoginPageSettings.prototype.tryToWriteFileToDisc=function(e,t,i){var n=this;void 0===i&&(i=!1);var o=this.getPageSettingsUrl();Coveo.AjaxUtils.ajaxBasicAuth("GET",this.loadFromInterfaceEditorUrl(o),this.loginPanel.getUser(),this.loginPanel.getPassword(),function(o){Coveo.DeviceUtils.isPhonegap()?new Coveo.PhonegapFileWriter("SearchPage.html").write(JSON.stringify(o)).done(function(){n.loginPanel.logger.info("Found the page and successfully wrote to disc",n.getPageSettingsUrl()),i&&e.done(function(){n.loginPanel.logger.info("Replacing body content with new search page",n.getPageSettingsUrl()),n.writeDocumentContent(o.body)}),t.resolve()}).fail(function(){n.loginPanel.logger.error("Found the file but unable to write",n.getPageSettingsUrl()),t.reject(Ui.l("ErrorSavingToDevice"))}):(n.loginPanel.logger.info("Found the page",n.getPageSettingsUrl()),i&&n.writeDocumentContent(o.body),t.resolve())},function(){void 0==n.getPageSettingsUrl()||""==n.getPageSettingsUrl()?(n.loginPanel.logger.error("Search page url is empty"),t.reject(Ui.l("PleaseEnterYourSearchPage"))):(n.loginPanel.logger.error("Unable to find the file",n.getPageSettingsUrl()),t.reject(Ui.l("CannotConnectSearchPage")))})},LoginPageSettings.prototype.tryToReadFileFomDisc=function(e,t,i){var n=this;void 0===i&&(i=!1),Coveo.DeviceUtils.isPhonegap()?new Coveo.PhonegapFileReader("SearchPage.html").read().done(function(o){n.loginPanel.logger.info("Found the page on disc",n.getPageSettingsUrl()),i&&e.done(function(){var e=JSON.parse(o).body;n.writeDocumentContent(e)}),n.tryToWriteFileToDisc(Coveo.$.Deferred(),Coveo.$.Deferred(),!1),t.resolve()}).fail(function(){n.getPageSettingsUrl()?(n.loginPanel.logger.info("Unable to find the page on disc",n.getPageSettingsUrl()),n.loginPanel.logger.info("Trying to fetch it with GET request and write to disc"),n.tryToWriteFileToDisc(e,t,!1)):t.reject(Ui.l("ErrorReadingFromDevice"))}):this.tryToWriteFileToDisc(e,t,i)},LoginPageSettings.prototype.writeDocumentContent=function(e){document.body.outerHTML=e,this.appendMissingLoginComponentIfNeeded(),this.configureNewEndpoints(),Ui.TemplateCache.scanAndRegisterTemplates(),this.initNewSearchInterface()},LoginPageSettings.prototype.appendMissingLoginComponentIfNeeded=function(){var e=Coveo.$("."+Ui.Component.computeCssClassNameForType(Ui.Login.ID));if(0==e.length){var t=Coveo.$('<div class="CoveoLogin" data-require-page-settings="true"></div>');this.loginPanel.options.requireLogin?t.attr("data-require-login","true"):t.attr("data-require-login","false"),Coveo.$(".coveo-tab-section").append(t)}else{var i=e.attr("data-require-page-settings");("false"==i||void 0==i)&&e.attr("data-require-page-settings","true")}},LoginPageSettings.prototype.configureNewEndpoints=function(){var scripts=Coveo.$("body").find("script.CoveoEndpoint");Coveo._.each(scripts,function(script){eval(Coveo.$(script).text())})},LoginPageSettings.prototype.initNewSearchInterface=function(){var scripts=Coveo.$("body").find("script.CoveoInit");if(0!=scripts.length)Coveo.InitializeFromPhonegap=!0,Coveo._.each(scripts,function(script){eval(Coveo.$(script).text())});else{var searchInterface=Coveo.$("."+Ui.Component.computeCssClassNameForType(Ui.SearchInterface.ID));0!=searchInterface.length?searchInterface.coveo("init"):Coveo.$("#search").coveo("init")}},LoginPageSettings}();Ui.LoginPageSettings=LoginPageSettings}(Ui=Coveo.Ui||(Coveo.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r,a){void 0===a&&(a=n.ID),i.call(this,o,a,r),this.element=o,this.options=s,this.errorMessageTemplate=e._.template("<div class='coveo-login-error-message'></div>"),this.captionTemplate=e._.template("<div class='coveo-login-caption'></div>"),this.tabButtonTemplate=e._.template("<div class='coveo-login-tab'>Login</div>"),this.containerTemplate=e._.template("<div class='coveo-login-form-container'></div>"),this.submitButtonTemplate=e._.template("<button class='coveo-submit'type='submit'><div class='coveo-icon coveo-waiting'></div>"+t.l("GetStarted")+"</button>"),this.combinedTemplate=e._.template("<div class='coveo-login-combined coveo-active'></div>"),this.logoTemplate=e._.template("<div class='coveo-login-logo'></div>"),this.options=t.ComponentOptions.initComponentOptions(o,n,s),e.Assert.exists(this.options.id),e.Assert.exists(e.Rest.SearchEndpoint.endpoints[this.options.id]),this.isHidden=!0,this.options.requireLogin&&(this.credentials=new t.LoginCredentials(this)),this.options.requirePageSettings&&(this.pageSettings=new t.LoginPageSettings(this)),this.loadingAnimation=e.$(this.searchInterface.options.firstLoadingAnimation),this.bind.onRoot(e.Events.QueryEvents.queryError,this.handleQueryError),this.buildTabButton(),this.ensureDom(),this.updateEndpointWithCredentials(),this.resetErrorMessage(),this.hide(),this.validate()
}return __extends(n,i),n.prototype.getPageSettingsUrl=function(){return this.pageSettings?this.pageSettings.getPageSettingsUrl():void 0},n.prototype.setPageSettingsUrl=function(e){this.pageSettings&&this.pageSettings.setPageSettingsUrl(e)},n.prototype.getUser=function(){return this.credentials?this.credentials.getUser():void 0},n.prototype.setUser=function(e){this.credentials&&this.credentials.setUser(e)},n.prototype.getPassword=function(){return this.credentials?this.credentials.getPassword():void 0},n.prototype.setPassword=function(e){this.credentials&&this.credentials.setPassword(e)},n.prototype.setErrorMessage=function(e){this.errorMessage.text(e),this.errorMessage.show(),this.logo.hide()},n.prototype.resetErrorMessage=function(){this.errorMessage.text(""),this.errorMessage.hide(),this.logo.show()},n.prototype.createDom=function(){var t=this;this.logo=e.$(this.logoTemplate()),this.getOrCreateCombined().append(this.logo),this.caption=e.$(this.captionTemplate()),this.options.caption&&this.caption.text(this.options.caption),this.errorMessage=e.$(this.errorMessageTemplate()),this.getOrCreateCombined().append(this.errorMessage),this.getOrCreateContainer().append(this.caption),this.credentials&&this.credentials.buildDom(),this.pageSettings&&this.pageSettings.buildDom(),this.submitButton=e.$(this.submitButtonTemplate()),this.submitButton.fastClick(function(){return t.submit()}),this.getOrCreateContainer().append(this.submitButton)},n.prototype.getOrCreateContainer=function(){return this.container||(this.container=e.$(this.containerTemplate()),this.getOrCreateCombined().append(this.container)),this.container},n.prototype.getOrCreateCombined=function(){return this.combined||(this.combined=e.$(this.combinedTemplate()),e.$(this.root).append(this.combined)),this.combined},n.prototype.hide=function(){this.isHidden=!0,this.getOrCreateCombined().hide()},n.prototype.hideAndExecuteQuery=function(){this.hide(),this.queryController.executeQuery()},n.prototype.validate=function(){this.baseValidationEvent("validate",this.hide)},n.prototype.submit=function(){var e=this,t=function(){e.credentials&&e.updateEndpointWithCredentials(),e.pageSettings||e.hideAndExecuteQuery()};this.baseValidationEvent("submit",t)},n.prototype.isAccessDeniedError=function(e){return 401===e.status||403===e.status},n.prototype.baseValidationEvent=function(t,i){var n=this;e.MobileUtils.hideIOSKeyboard(document.activeElement),this.resetErrorMessage();var o=[],s=e.$.Deferred();this.credentials&&o.push(this.credentials[t](s)),this.pageSettings&&o.push(this.pageSettings[t](s)),e.$.when.apply(this,o).fail(function(t){n.show(),s.reject(!1),n.pageSettings&&e.Utils.isNonEmptyString(n.getPageSettingsUrl())&&n.setErrorMessage(t),n.credentials&&(e.Utils.isNonEmptyString(n.getPassword())||e.Utils.isNonEmptyString(n.getUser()))&&n.setErrorMessage(t)}).always(function(){n.submitButton.removeClass("coveo-waiting")}).done(function(){s.resolve(!0),e.$.proxy(i,n)})},n.prototype.show=function(){this.isHidden=!1,this.ensureDom(),e.MobileUtils.removeToggleClassOnSearchInterface(),this.getOrCreateCombined().show(),e.DeviceUtils.isPhonegap()&&e.$(document).on("backbutton",e.$.proxy(this.handleBackButton,this))},n.prototype.handleBackButton=function(){this.hide(),e.$(document).off("backbutton")},n.prototype.handleQueryError=function(e,i){this.isAccessDeniedError(i.error)&&(this.setErrorMessage(t.l("BadUserPass")),this.show())},n.prototype.updateEndpointWithCredentials=function(){this.credentials&&void 0!=e.Rest.SearchEndpoint.endpoints[this.options.id]&&(e.Rest.SearchEndpoint.endpoints[this.options.id].options.password=this.getPassword(),e.Rest.SearchEndpoint.endpoints[this.options.id].options.username=this.getUser())},n.prototype.buildTabButton=function(){var t=this;e.$(this.element).append(e.$(this.tabButtonTemplate())),e.$(this.element).fastClick(function(){t.show()})},n.ID="Login",n.options={id:t.ComponentOptions.buildStringOption({defaultValue:"default"}),caption:t.ComponentOptions.buildLocalizedStringOption(),autoTriggerQuery:t.ComponentOptions.buildBooleanOption({defaultValue:!0}),requireLogin:t.ComponentOptions.buildBooleanOption({defaultValue:!0}),requirePageSettings:t.ComponentOptions.buildBooleanOption({defaultValue:!1})},n}(t.Component);t.Login=i,t.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r){var a=this;i.call(this,o,n.ID,r),this.element=o,this.options=s,this.options=t.ComponentOptions.initComponentOptions(o,n,s),t.Component.pointElementsToDummyForm(e.$(o)),e.$(o).change(function(e){a._handleChange(e)}),e.$(o).keyup(function(e){a._handleKeyUp(e)});var l=e.Models;e.$(this.root).on(e.Events.QueryEvents.buildingQuery,e.$.proxy(this.handleBuildingQuery,this)),e.$(this.root).on(e.Events.QueryEvents.newQuery,e.$.proxy(this._handleNewQuery,this));var u=this.queryStateModel.getEventName(l.Model.eventTypes.changeOne+l.QueryStateModel.attributesEnum.q);e.$(this.queryStateModel.element).on(u,e.$.proxy(this._handleQueryStateChanged,this)),this._clearElement=e.$("<span></span>").addClass("coveo-query-box-clear").hide();e.$("<span></span>").addClass("coveo-icon").appendTo(this._clearElement);if(this._clearElement.fastClick(function(){a.clear(),a._hideClearElement(),a.updateQueryState(),e.DeviceUtils.isMobileDevice()||e.$(a.element).focus(),a.queryController.isStandaloneSearchBox()||a.queryController.deferExecuteQuery({beforeExecuteQuery:function(){return a.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.searchboxClear,{})}})}),e.DeviceUtils.isSmallScreenWidth()&&e.$(this.element).focus(function(){e.MobileUtils.removeToggleClassOnSearchInterface()}),e.$(this.element).after(this._clearElement),this.options.autoFocus)try{e.$(this.element).focus()}catch(c){}}return __extends(n,i),n.prototype.clear=function(){e.$(this.element).val(""),this.updateQueryState()},n.prototype.replace=function(t,i){e.$(this.element).val(e.$(this.element).val().replace(t,i)),this.updateQueryState()},n.prototype.replaceCurrentExpression=function(e){this.replace(this.getCurrentQueryExpression(),e),this.updateQueryState()},n.prototype.clearCurrentExpression=function(){this.replace(this.getCurrentQueryExpression(),""),this.updateQueryState()},n.prototype.getCurrentQueryExpression=function(){var t=e.$(this.element).getCursorPosition(),i=e.$(this.element).val(),n=i.length,o=t,s=t;for(" "==i[o]&&o--;o>0&&" "!=i[o];)o--;for(;n>s&&" "!=i[s];)s++;return i.substring(o,s)},n.prototype.insertAt=function(t,i){var n=e.$(this.element).val(),o=[n.slice(0,t),i,n.slice(t)].join("");e.$(this.element).val(o),this.updateQueryState()},n.prototype._handleChange=function(){return this._addClearElement(),this.updateQueryState(),void 0},n.prototype._handleQueryStateChanged=function(t,i){e.Assert.exists(i);var n=i.value;e.$(this.element).val(n),this._addClearElement()},n.prototype._handleKeyUp=function(t){e.Assert.exists(t),this._addClearElement(),13==t.which?(this.logger.debug("Performing query because user pressed Enter"),this.updateQueryState(),this.enterOnSearchBox(),t.stopPropagation(),e.DeviceUtils.isMobileDevice()&&e.$(this.element).blur()):this.options.enableSearchAsYouType&&e.KeyboardUtils.isAllowedKeyForSearchAsYouType(t)&&this.startNewSearchAsYouTypeTimeout()},n.prototype._addClearElement=function(){""==e.$(this.element).val()?this._hideClearElement():this._showClearElement()},n.prototype._hideClearElement=function(){this._clearElement.hide()},n.prototype._showClearElement=function(){this._clearElement.show()},n.prototype.startNewSearchAsYouTypeTimeout=function(){var e=this;this.cancelAnyPendingSearchAsYouTypeTimeout(),this.searchAsYouTypeTimeout=setTimeout(function(){e.triggerNewQuery(function(){return e.usageAnalytics.logSearchAsYouType(t.AnalyticsActionCauseList.searchboxAsYouType,{})},!0)},this.options.searchAsYouTypeDelay)},n.prototype._handleNewQuery=function(){n.queryBoxIsAlreadyAddedToQuery=!1},n.prototype.handleBuildingQuery=function(t,i){e.Assert.exists(i),e.Assert.exists(i.queryBuilder);var o=e.$(this.element).val();this.options.enableWildcards&&(i.queryBuilder.enableWildcards=!0),this.options.enableQuestionMarks&&(i.queryBuilder.enableQuestionMarks=!0),this.options.enableLowercaseOperators&&(i.queryBuilder.enableLowercaseOperators=!0),this.options.enablePartialMatch&&(i.queryBuilder.enablePartialMatch=!0,i.queryBuilder.partialMatchKeywords=this.options.partialMatchKeywords,i.queryBuilder.partialMatchThreshold=this.options.partialMatchThreshold),e.Utils.isNonEmptyString(o)&&!n.queryBoxIsAlreadyAddedToQuery&&(this.options.disableQuerySyntax?i.queryBuilder.expression.add("<@- "+o+" -@>"):i.queryBuilder.expression.add(o),this.logger.trace("Adding query to QueryBuilder",o),n.queryBoxIsAlreadyAddedToQuery=!0)},n.prototype.enterOnSearchBox=function(){var i=this;e.$(this.element).trigger(e.Events.UserActionEvents.enterOnSearchBox),this.triggerNewQuery(function(){return i.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.searchboxSubmit,{})},!1)},n.prototype.triggerNewQuery=function(e,t){this.cancelAnyPendingSearchAsYouTypeTimeout(),this.queryController.deferExecuteQuery({beforeExecuteQuery:e,searchAsYouType:t})},n.prototype.updateQueryState=function(){var t=e.$(this.element).val();this.queryStateModel.set(e.Models.QueryStateModel.attributesEnum.q,t)},n.prototype.cancelAnyPendingSearchAsYouTypeTimeout=function(){e.Utils.exists(this.searchAsYouTypeTimeout)&&(clearTimeout(this.searchAsYouTypeTimeout),this.searchAsYouTypeTimeout=void 0)},n.ID="QueryBox",n.options={enableSearchAsYouType:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),searchAsYouTypeDelay:t.ComponentOptions.buildNumberOption({defaultValue:500}),disableQuerySyntax:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableWildcards:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableQuestionMarks:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableLowercaseOperators:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),enablePartialMatch:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),partialMatchKeywords:t.ComponentOptions.buildNumberOption({defaultValue:5}),partialMatchThreshold:t.ComponentOptions.buildStringOption({defaultValue:"50%"}),autoFocus:t.ComponentOptions.buildBooleanOption({defaultValue:!0})},n.queryBoxIsAlreadyAddedToQuery=!1,n}(e.Ui.Component);t.QueryBox=i,e.Ui.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r){i.call(this,o,n.ID,r),this.element=o,this.options=s,this.bind.fastClick(e.$(o),this.handleClick),""==e.$.trim(e.$(o).text())&&e.$("<span/>").text(t.l("Search")).addClass("coveo-icon").appendTo(o)}return __extends(n,i),n.prototype.handleClick=function(){var e=this;this.logger.debug("Performing query following button click"),this.queryController.deferExecuteQuery({beforeExecuteQuery:function(){return e.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.searchboxSubmit,{})}})},n.ID="SearchButton",n}(t.Component);t.SearchButton=i,t.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r){i.call(this,o,n.ID,r),this.element=o,this.options=s,this.options=t.ComponentOptions.initComponentOptions(o,n,s),this.searchButton=new t.SearchButton(e.$("<a/>").appendTo(this.element).get(0),void 0,r);var a=e.$("<div/>").appendTo(this.element),l=this.buildInputTag();l.appendTo(a),this.searchBox=this.options.activateOmniBox?new t.OmniBox(l.get(0),this.options,r):new t.QueryBox(l.get(0),this.options,r)}return __extends(n,i),n.prototype.buildInputTag=function(){var t=this;return e.$('<input type="text" autocapitalize="off" autocorrect="off" />').blur(function(i){t.queryStateModel.set(e.Models.QueryStateModel.attributesEnum.q,e.$(i.target).val())})},n.ID="SearchBox",n.parent=t.OmniBox,n.options={activateOmniBox:t.ComponentOptions.buildBooleanOption({attrName:"data-activate-omnibox",defaultValue:!1,postProcessing:function(t,i){return i.enableSearchAsYouType?(t&&new e.Logger(document).warn("Cannot initialize omnibox and search as you type at the same time : Disabling omnibox functionnality"),!1):t}}),enableSearchAsYouType:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),searchAsYouTypeDelay:t.ComponentOptions.buildNumberOption({defaultValue:500}),disableQuerySyntax:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableWildcards:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableQuestionMarks:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableLowercaseOperators:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),enablePartialMatch:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),partialMatchKeywords:t.ComponentOptions.buildNumberOption({defaultValue:5}),partialMatchThreshold:t.ComponentOptions.buildStringOption({defaultValue:"50%"}),autoFocus:t.ComponentOptions.buildBooleanOption({defaultValue:!0})},n}(e.Ui.Component);t.SearchBox=i,e.Ui.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r){var a=this;i.call(this,o,s,r),this.element=o,this.options=s,this.omniBoxHeaderSearchForTemplate=e._.template("<div class='coveo-omnibox-selectable coveo-omnibox-section coveo-omnibox-header'><div class='coveo-text'>"+t.l("SearchFor","<strong><%- data %></strong>")+"</div></div>"),this.omniBoxIsOpen=!1,this.isLoadingData=!1,this.headerIsCurrentlyRendered=!1,this.options=t.ComponentOptions.initComponentOptions(o,n,s),e.$(o).keyup(function(e){return a._handleKeyUp(e)}),this.renderOmniBoxDiv(),this.omniBoxDiv.hide(),this.prepareThrottledCall(),e.$(this.root).fastClick(function(t){a.omniBoxIsOpen&&!e.$.contains(a.omniBoxDiv.get(0),e.$(t.target).get(0))&&a.escapeEvent()});var l=this.queryStateModel.getEventName(e.Models.Model.eventTypes.changeOne+e.Models.QueryStateModel.attributesEnum.q);e.$(this.queryStateModel.element).on(l,e.$.proxy(this._handleQueryStateChanged,this)),e.$(window).on("resize",function(){a.omniBoxIsOpen&&a.setWidthOnOmniBoxDiv()})}return __extends(n,i),n.prototype.close=function(){e.$(this.root).trigger(e.Events.OmniBoxEvents.closeOmniBox),this.omniBoxDiv&&(this.omniBoxDiv.children().remove(),this.omniBoxDiv.hide()),this.clearLastOmniBoxRows(),e.Utils.isNullOrUndefined(this.lastOmniBoxData)||this.rejectAllPendingDeferred(this.lastOmniBoxData),this.resetOmniBoxInternalData(),this.omniBoxIsOpen=!1},n.prototype.open=function(){""!=e.$(this.element).val()?(this.throttledCallForOmniBoxBody(),e.$(this.root).trigger(e.Events.OmniBoxEvents.openOmniBox)):this.escapeEvent()},n.prototype.getDataForOmniboxBody=function(){if(this.addSearchAnimation(),this.isCurrentlyBeingRendered)this.throttledCallForOmniBoxBody();else{var e=this.buildOmniBoxRequestObject(),t=this.requestOmniBoxData(e);this.processNewOmniBoxData(t)}},n.prototype.buildOmniBoxRequestObject=function(){var t=this,i=this.getCurrentQueryExpression(),n={completeQueryExpression:{word:e.$(this.element).val(),regex:this.getRegexToSearch()},currentQueryExpression:{word:i,regex:this.getRegexToSearch(i)},allQueryExpressions:this.getQueryExpressionBreakDown(),cursorPosition:e.$(this.element).getCursorPosition(),clear:function(){t.clear()},clearCurrentExpression:function(){t.clearCurrentExpression()},replace:function(e,i){t.replace(e,i)},replaceCurrentExpression:function(e){t.replaceCurrentExpression(e)},insertAt:function(e,i){t.insertAt(e,i)},closeOmniBox:function(){t.close()}};return n},n.prototype.prepareThrottledCall=function(){this.throttledCallForOmniBoxBody=e.Utils.throttle(this.getDataForOmniboxBody,this.options.omniBoxDelay,void 0,this)},n.prototype.requestOmniBoxData=function(t){e.Assert.exists(t),this.logger.info("Requesting omnibox data to all components");var i=e.$.extend({rows:[]},t);return e.$(this.root).trigger(e.Events.OmniBoxEvents.populateOmniBox,i),i},n.prototype.getQueryExpressionBreakDown=function(){var t=this,i=[],n=e.$(this.element).val().split(" ");return e._.each(n,function(e){i.push({word:e,regex:t.getRegexToSearch(e)})}),i},n.prototype._handleNewQuery=function(e,t){i.prototype._handleNewQuery.call(this,e,t),this.omniBoxIsOpen&&e.stopPropagation()},n.prototype._handleKeyUp=function(i){var n=this;i.stopImmediatePropagation();var o=e.$(this.element).val().length;!e.Utils.isNullOrUndefined(this.lastOmniBoxData)&&!e.Utils.isNullOrUndefined(this.lastNumberOfLettersInOmniBox)&&Math.abs(o-this.lastNumberOfLettersInOmniBox)>this.options.omniBoxChangeLimit&&(this.rejectAllPendingDeferred(this.lastOmniBoxData),this.prepareThrottledCall()),e.KeyboardUtils.keysEqual(i,27)&&this.omniBoxIsOpen?this.escapeEvent():e.KeyboardUtils.keysEqual(i,13)?this.omniBoxIsOpen?this.selectionEvent():(this.escapeEvent(),this.triggerNewQuery(function(){return n.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.searchboxSubmit,{})})):e.KeyboardUtils.isArrowKeyPushed(i.keyCode)&&this.omniBoxIsOpen?this.navigationEvent(i):e.KeyboardUtils.isAllowedKeyForOmniBox(i)&&(""==e.$(this.element).val()?this.escapeEvent():this.open())},n.prototype._handleChange=function(e){return e.stopImmediatePropagation(),!1},n.prototype.handleHover=function(e){var t=this.getCorrectTarget(e);t&&this.toggleSelected(t)},n.prototype.bindOmniBoxEvent=function(){this.bindHoverEvent()},n.prototype.bindHoverEvent=function(){var t=this;e.$(this.omniBoxDiv).find(".coveo-omnibox-selectable").hover(function(e){t.handleHover(e)})},n.prototype.escapeEvent=function(){this.clearLastOmniBoxRows(),this.close(),this.removeSearchAnimation()},n.prototype.selectionEvent=function(){var e=this;this.isFirstValueSelected(this.findSelected())?this.triggerNewQuery(function(){return e.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.searchboxSubmit,{})}):this.keyBoardSelection()},n.prototype.navigationEvent=function(e){var t=this.findSelected();0==t.length?this.navigationEventWhenNoSelection(e):this.navigationEventWhenSelection(e,t)},n.prototype.navigationEventWhenNoSelection=function(t){e.KeyboardUtils.keysEqual(t,40)&&this.findSelectable().first().addClass("coveo-omnibox-selected")},n.prototype.navigationEventWhenSelection=function(e,t){if(!this.isLoadingData)switch(e.keyCode){case 38:this.isFirstValueSelected(t)||(this.unselectValueInOmnibox(t),this.selectValueBeforeAlreadySelected(t));break;case 40:this.isLastValueSelected(t)||(this.unselectValueInOmnibox(t),this.selectValueAfterAlreadySelected(t))}},n.prototype.keyBoardSelection=function(){this.logger.trace("Selecting facet value because of omnibox selection");var e=this.findSelected();e.trigger("keyboardSelect"),this.escapeEvent()},n.prototype.triggerNewQuery=function(t){this.logger.info("Triggering new query because of omnibox selection"),this.escapeEvent(),this.queryStateModel.set(e.Models.QueryStateModel.attributesEnum.q,e.$(this.element).val()),this.queryController.deferExecuteQuery({beforeExecuteQuery:t})},n.prototype.processNewOmniBoxData=function(e){this.logger.trace("Processing omnibox data"),this.isCurrentlyBeingRendered=!0,this.numberOfPendingQueries=0,this.renderOmniBoxBody(e),this.omniBoxIsOpen=!0},n.prototype.renderHeader=function(){this.buildHeader(),this.setWidthOnOmniBoxDiv(),this.omniBoxDiv.show(),this.findSelectable().first().addClass("coveo-omnibox-selected"),this.headerIsCurrentlyRendered=!0},n.prototype.renderOmniBoxDiv=function(){this.omniBoxDiv=e.$("<div class='coveo-omnibox'></div>"),e.$(this.element).after(this.omniBoxDiv)},n.prototype.setWidthOnOmniBoxDiv=function(){this.omniBoxDiv.width(this.getWidth())},n.prototype.buildHeader=function(){var i=this;void 0!=this.omniBoxHeader&&this.omniBoxHeader.remove(),this.omniBoxHeader=e.$(this.omniBoxHeaderSearchForTemplate({data:e.$(this.element).val()})),this.omniBoxHeader.fastClick(function(){i.triggerNewQuery(function(){return i.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.searchboxSubmit,{})})}),this.omniBoxDiv.prepend(this.omniBoxHeader)},n.prototype.renderOmniBoxBody=function(t){var i=this;this.omniBoxRows=[],this.lastOmniBoxData=t,this.lastNumberOfLettersInOmniBox=e.$(this.element).val().length;e._.find(t.rows,function(t){return!e.Utils.isNullOrUndefined(t.element)});e._.each(t.rows,function(t){e.Utils.isNullOrUndefined(t.element)?e.Utils.isNullOrUndefined(t.deferred)||(i.numberOfPendingQueries++,i.renderOmniBoxForOneElementDeferred(t)):i.renderOmniBoxForOneElement(t)}),0==this.numberOfPendingQueries&&this.allDeferredHaveArrived(),setTimeout(function(){i.rejectAllPendingDeferred(t)},this.options.omniBoxTimeout)},n.prototype.rejectAllPendingDeferred=function(t){e._.each(t.rows,function(t){e.Utils.isNullOrUndefined(t.deferred)||"pending"!=t.deferred.state()||t.deferred.reject()})},n.prototype.allDeferredHaveArrived=function(){this.appendOmniBoxSections(),this.resetOmniBoxInternalData(),this.removeSearchAnimation()},n.prototype.clearLastOmniBoxRows=function(){void 0!=this.lastOmniBoxRows&&e._.each(this.lastOmniBoxRows,function(t){e.$(t.element).remove()})},n.prototype.appendOmniBoxSections=function(){if(this.omniBoxRows.length>0&&""!=e.$(this.element).val()){this.renderHeader(),this.clearLastOmniBoxRows(),this.omniBoxRows=e._.sortBy(this.omniBoxRows,function(e){return e.zIndex}).reverse();for(var t=0;t<this.omniBoxRows.length;t++)this.omniBoxDiv.append(this.omniBoxRows[t].element);this.bindOmniBoxEvent(),this.resetOmniBoxInternalData()}else this.close()},n.prototype.resetOmniBoxInternalData=function(){this.lastOmniBoxRows=this.omniBoxRows,this.isCurrentlyBeingRendered=!1,this.headerIsCurrentlyRendered=!1},n.prototype.renderOmniBoxForOneElement=function(t){var i=t.zIndex||-1;e.$(t.element).addClass("coveo-omnibox-section"),this.omniBoxRows.push({zIndex:i,element:t.element})},n.prototype.renderOmniBoxForOneElementDeferred=function(t){var i=this;t.deferred.done(function(t){i.headerIsCurrentlyRendered||void 0==t.element||i.renderHeader(),i.numberOfPendingQueries--,e.Utils.isNullOrUndefined(t.element)||i.renderOmniBoxForOneElement(t),0==i.numberOfPendingQueries&&i.allDeferredHaveArrived()}),t.deferred.fail(function(){i.numberOfPendingQueries--,0==i.numberOfPendingQueries&&i.allDeferredHaveArrived()})},n.prototype.isFirstValueSelected=function(e){return e.get(0)==this.findSelectable().first().get(0)},n.prototype.isLastValueSelected=function(e){return e.get(0)==this.findSelectable().last().get(0)},n.prototype.unselectValueInOmnibox=function(e){e.removeClass("coveo-omnibox-selected")},n.prototype.selectValueBeforeAlreadySelected=function(t){e.$(this.findSelectable().get(this.findPosOfAlreadySelected(t)-1)).addClass("coveo-omnibox-selected")},n.prototype.selectValueAfterAlreadySelected=function(t){e.$(this.findSelectable().get(this.findPosOfAlreadySelected(t)+1)).addClass("coveo-omnibox-selected")},n.prototype.findPosOfAlreadySelected=function(t){var i=-1,n=this.findSelectable();return e._.find(n,function(e){return i++,e==t.get(0)}),i},n.prototype.findSelectable=function(){return this.omniBoxDiv.find(".coveo-omnibox-selectable")},n.prototype.findSelected=function(){return this.findSelectable().closest(".coveo-omnibox-selected")},n.prototype.toggleSelected=function(e){this.omniBoxDiv.find(".coveo-omnibox-selected").removeClass("coveo-omnibox-selected"),e.addClass("coveo-omnibox-selected")},n.prototype.getWidth=function(){var t=e.$(this.element);return t.outerWidth()+this.getSearchButtonWidth()},n.prototype.getSearchButtonWidth=function(){var i=e.$(this.element).closest("."+t.Component.computeCssClassNameForType(t.SearchBox.ID));if(0!=i.length){var n=i.coveo(t.SearchBox);return void 0!=n.searchButton?e.$(n.searchButton.element).outerWidth():0}return 0},n.prototype.getRegexToSearch=function(t){return void 0===t&&(t=e.$(this.element).val()),new RegExp(e.Utils.escapeRegexCharacter(t),"i")},n.prototype.getCorrectTarget=function(t){var i=e.$(t.target);return i.closest(".coveo-omnibox-selectable")},n.prototype.addSearchAnimation=function(){this._hideClearElement(),e.$(this.element).addClass("coveo-loading"),this.isLoadingData=!0},n.prototype.removeSearchAnimation=function(){e.$(this.element).removeClass("coveo-loading"),this._addClearElement(),this.isLoadingData=!1},n.ID="OmniBox",n.options={omniBoxDelay:t.ComponentOptions.buildNumberOption({defaultValue:500}),omniBoxTimeout:t.ComponentOptions.buildNumberOption({defaultValue:2e3}),omniBoxChangeLimit:t.ComponentOptions.buildNumberOption({defaultValue:3}),omniBoxMinimumLetters:t.ComponentOptions.buildNumberOption({defaultValue:1})},n.parent=t.QueryBox,n}(t.QueryBox);t.OmniBox=i,e.Ui.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function t(e,t){this.structure=e,this.onSelect=t}return t.prototype.buildOmniBoxElement=function(t,i){var n;if(0!=t.length){n=e.$("<div></div>");var o=this.buildElementHeader();n.append(o);var s=this.buildRowElements(t,i);e._.each(s,function(e){n.append(e)})}return n},t.prototype.buildElementHeader=function(){return e.$(this.structure.header.template({headerTitle:this.structure.header.title}))},t.prototype.buildRowElements=function(t,i){var n=this,o=[];return e._.each(t,function(t){var s=e.$(n.structure.row({rawValue:t.value,data:e.JQueryUtils.highlightElement(t.value,i.completeQueryExpression.word)}));s.fastClick(function(){n.onSelect.call(n,t.value,i)}),s.on("keyboardSelect",function(){n.onSelect.call(n,t.value,i)}),o.push(s)}),o},t}();t.SuggestionForOmniBox=i}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r){i.call(this,o,s,r,n.ID),this.element=o,this.options=s,this.bindings=r,this.options=t.ComponentOptions.initComponentOptions(o,n,s),this.setupOptions(),this.bind.onRoot(e.Events.OmniBoxEvents.populateOmniBox,this.handlePopulateOmniBox)}return __extends(n,i),n.prototype._buildResults=function(i){var n=this;if(this.lastOmniboxRequest){var o=e.$("<div></div>");o.append("<div class='coveo-omnibox-result-list-header'>          <span class='coveo-icon-omnibox-result-list'></span>           <span class='coveo-caption'>"+(this.options.headerTitle||t.l("SuggestedResults"))+"</span>         </div>"),e._.each(i.results,function(t){var i=n._instantiateTemplateForResult(t);e.$(i).data("CoveoResult",t).addClass("coveo-omnibox-selectable").appendTo(o),e.$(i).on("keyboardSelect",function(){n.options.onSelect.call(n,t,e.$(i),n.lastOmniboxRequest.omniboxObject)}),n._autoCreateComponentsInsideResult(i,t),n._triggerNewResultDisplayed(t,i)}),this.lastOmniboxRequest.deferred.resolve({element:o.get(0),zIndex:this.options.omniboxZIndex})}},n.prototype.setupOptions=function(){this.logger.info("Disabling infinite scroll for OmniBoxResultList",this),this.options.enableInfiniteScroll=!1,this.options.onSelect=this.options.onSelect||this.onRowSelection},n.prototype.handlePopulateOmniBox=function(i,n){var o=this,s=e.$.Deferred();n.rows.push({deferred:s}),this.lastOmniboxRequest={omniboxObject:n,deferred:s},this.queryController.executeQuery({beforeExecuteQuery:function(){return o.usageAnalytics.logSearchAsYouType(t.AnalyticsActionCauseList.searchboxSubmit,{})},searchAsYouType:!0})},n.prototype.onRowSelection=function(e){this.usageAnalytics.logClickEvent(t.AnalyticsActionCauseList.documentOpen,{documentTitle:e.title,documentURL:e.clickUri},e,this.root),window.location.href=e.clickUri},n.ID="OmniBoxResultList",n.options={omniboxZIndex:t.ComponentOptions.buildNumberOption(51),headerTitle:t.ComponentOptions.buildStringOption()},n}(t.ResultList);t.OmniBoxResultList=i,t.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r){var a=this;i.call(this,o,n.ID,r),this.element=o,this.options=s,this.listenToQueryStateChange=!0,this.needToReset=!0,this.ignoreNextQuerySuccess=!1,this.listItemTemplate=e._.template('<li class="<%= _class %>"></li>'),this.listItemValueTemplate=e._.template("<a><%= listItemValue %></a>"),this.navigationButtonTemplate=e._.template('<li class="<%= _class %>"><a><span title="<%= buttonValue %>"/></a></li>'),this.options=t.ComponentOptions.initComponentOptions(o,n,s),this.currentPage=1,this.bind.onRoot(e.Events.QueryEvents.newQuery,function(){return a.handleNewQuery()}),this.bind.onRoot(e.Events.QueryEvents.buildingQuery,function(e,t){return a.handleBuildingQuery(e,t)}),this.bind.onRoot(e.Events.QueryEvents.querySuccess,function(e,t){return a.handleQuerySuccess(e,t)}),this.bind.onRoot(e.Events.QueryEvents.queryError,function(e,t){return a.handleQueryError(e,t)}),this.bind.onRoot(e.Events.QueryEvents.noResults,function(e,t){return a.handleNoResults(e,t)});var l=this.queryStateModel.getEventName(e.Models.Model.eventTypes.changeOne+e.Models.QueryStateModel.attributesEnum.first);e.$(this.queryStateModel.element).on(l,e.$.proxy(this.handleQueryStateModelChanged,this)),this.list=e.$("<ul></ul>").appendTo(o)}return __extends(n,i),n.prototype.setPage=function(i){e.Assert.exists(i),this.needToReset=!1,this.currentPage=i,this.updateQueryStateModel(this.getFirstResultNumber(this.currentPage)),this.usageAnalytics.logCustomEvent(t.AnalyticsActionCauseList.pagerNumber,{pagerNumber:i},this.element),this.queryController.deferExecuteQuery()},n.prototype.previousPage=function(){this.needToReset=!1,this.currentPage=this.currentPage-1,this.currentPage=Math.max(this.currentPage,1),this.updateQueryStateModel(this.getFirstResultNumber(this.currentPage)),this.usageAnalytics.logCustomEvent(t.AnalyticsActionCauseList.pagerPrevious,{pagerNumber:this.currentPage},this.element),this.queryController.deferExecuteQuery()},n.prototype.nextPage=function(){this.needToReset=!1,this.currentPage=this.currentPage+1,this.currentPage=Math.min(this.currentPage,1e3),this.updateQueryStateModel(this.getFirstResultNumber(this.currentPage)),this.usageAnalytics.logCustomEvent(t.AnalyticsActionCauseList.pagerNext,{pagerNumber:this.currentPage},this.element),this.queryController.deferExecuteQuery()},n.prototype.handleNewQuery=function(){this.needToReset&&(this.currentPage=1,this.updateQueryStateModel(this.getFirstResultNumber(this.currentPage))),this.needToReset=!0},n.prototype.updateQueryStateModel=function(t){this.listenToQueryStateChange=!1,this.queryStateModel.set(e.Models.QueryStateModel.attributesEnum.first,t),this.listenToQueryStateChange=!0},n.prototype.handleQueryError=function(){this.reset()},n.prototype.handleQuerySuccess=function(t,i){var n=this;if(this.reset(),this.ignoreNextQuerySuccess)this.ignoreNextQuerySuccess=!1;else{e.Assert.isNotUndefined(i);var o=i.query.firstResult,s=i.results.totalCount,r=this.computePagerBoundary(o,s);if(this.currentPage=r.currentPage,r.end-r.start>0){for(var a=r.start;a<=r.end;a++){var l=e.$(this.listItemValueTemplate({listItemValue:a}));!function(t){var i=e.$(n.listItemTemplate({_class:t==n.currentPage?"coveo-active":""})).fastClick(function(){return n.handleClickPage(t)});i.append(l).appendTo(n.list)}(a)}this.options.navigationButton&&r.lastResultPage>1&&this.renderNavigationButton(r,this.list)}}},n.prototype.handleNoResults=function(e,t){var i=this.computePagerBoundary(t.results.totalCount,t.results.totalCount).lastResultPage;this.currentPage>i&&(this.ignoreNextQuerySuccess=!0,this.setPage(i))},n.prototype.reset=function(){e.$(this.list).empty()},n.prototype.handleBuildingQuery=function(t,i){e.Assert.exists(i);var n=this.getQueryEventArgs();i.queryBuilder.firstResult=n.first,i.queryBuilder.numberOfResults=n.count},n.prototype.computePagerBoundary=function(e,t){var i=this.queryController.options.resultsPerPage,n=Math.floor(e/i)+1,o=Math.ceil(t/i);o=Math.max(o,1);var s=Math.floor(this.options.numberOfPages/2),r=n-s;r=Math.max(r,1);var a=r+this.options.numberOfPages-1;return a=Math.min(a,o),{start:r,end:a,lastResultPage:o,currentPage:n}},n.prototype.renderNavigationButton=function(i,n){var o=this;if(this.currentPage>1){var s=e.$(this.navigationButtonTemplate({_class:"coveo-previous",buttonValue:t.l("Previous")})).prependTo(n);
s.fastClick(function(){return o.handleClickPrevious()})}if(this.currentPage<i.lastResultPage){var r=e.$(this.navigationButtonTemplate({_class:"coveo-next",buttonValue:t.l("Next")})).appendTo(n);r.fastClick(function(){return o.handleClickNext()})}},n.prototype.handleQueryStateModelChanged=function(t,i){if(this.listenToQueryStateChange){e.Assert.exists(i),this.needToReset=!1;var n=i.value;this.currentPage=this.fromFirstResultsToPageNumber(n)}},n.prototype.handleClickPage=function(t){e.Assert.exists(t),this.setPage(t)},n.prototype.handleClickPrevious=function(){this.previousPage()},n.prototype.handleClickNext=function(){this.nextPage()},n.prototype.fromFirstResultsToPageNumber=function(e){return e/this.queryController.options.resultsPerPage+1},n.prototype.getFirstResultNumber=function(e){return void 0===e&&(e=this.currentPage),(e-1)*this.queryController.options.resultsPerPage},n.prototype.getQueryEventArgs=function(){return{count:this.queryController.options.resultsPerPage,first:this.getFirstResultNumber()}},n.ID="Pager",n.options={numberOfPages:t.ComponentOptions.buildNumberOption({defaultFunction:function(){return e.DeviceUtils.isMobileDevice()?3:10}}),navigationButton:t.ComponentOptions.buildBooleanOption({defaultValue:!0,attrName:"data-show-previous-next"})},n}(t.Component);t.Pager=i,t.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function t(t,i,n){this.boxInputToBuild=t,this.nameOfInput=i,this.type=n,this.inputs={},this.inputTemplate=e._.template("<div class='coveo-choice-container'>        <div class='coveo-section coveo-section-input'>          <input <%= otherAttribute %> class='coveo-<%= label %>' id='coveo-<%= label %>' type='<%= type %>' name='<%= name%>' value='<%= label %>' ></input><span class='coveo-input-icon'></span><label for='coveo-<%= label %>'><%= label %></label>        </div>        <div class='coveo-section coveo-section-tab'><%- tab %></div>      <div class='coveo-section coveo-section-expression'><%- expression %></div>      </div>")}return t.prototype.build=function(){var t=this;return e._.reduce(e._.map(this.boxInputToBuild,function(i){return t.inputs[i.label]=e.$(t.inputTemplate({label:i.label,name:t.nameOfInput,type:t.type,otherAttribute:i.otherAttribute,tab:i.tab,expression:i.expression})),t.inputs[i.label]}),function(e,t){return e.add(t)})},t.prototype.select=function(t){e.Assert.exists(this.inputs[t]),this.inputs[t].find("input").prop("checked",!0),this.inputs[t].find(".coveo-input-icon").addClass("coveo-selected")},t.prototype.unselect=function(t){e.Assert.exists(this.inputs[t]),this.inputs[t].find("input").prop("checked",!1),this.inputs[t].find(".coveo-input-icon").removeClass("coveo-selected")},t.prototype.getSelected=function(){var t=e._.find(this.inputs,function(e){return e.find("input").prop("checked")});return t.find("input").val()},t.prototype.getSelecteds=function(){var t=e._.filter(this.inputs,function(e){return e.find("input").prop("checked")});return e._.map(t,function(e){return e.find("input").val()})},t}();t.PreferencesPanelBoxInput=i;var n=function(e){function t(t,i){e.call(this,t,i,"radio"),this.radioElementToBuild=t,this.name=i}return __extends(t,e),t}(i);t.PreferencesPanelRadioInput=n;var o=function(t){function i(e,i){t.call(this,e,i,"checkbox"),this.checkboxElementToBuild=e,this.name=i}return __extends(i,t),i.prototype.build=function(){var i=t.prototype.build.call(this),n=(i.find("input"),i.find(".coveo-input-icon"));return e._.each(n,function(t){var i=e.$(t).siblings("input"),n=e.$(t);i.change(function(){n.toggleClass("coveo-selected",i.is(":checked"))}),n.fastClick(function(){i.prop("checked",!i.is(":checked")),i.change()})}),i},i}(i);t.PreferencesPanelCheckboxInput=o;var s=function(){function t(t,i){this.textElementToBuild=t,this.name=i,this.inputs={},this.inputTemplate=e._.template("<div class='coveo-choice-container'><input <%= otherAttribute %> class='coveo-<%= label %>' id='coveo-<%= label %>' type='<%= type %>' name='<%= name%>' placeholder='<%= placeholder %>' ></input></div>")}return t.prototype.build=function(){var t=this;return e._.reduce(e._.map(this.textElementToBuild,function(i){return t.inputs[i.label]=e.$(t.inputTemplate({label:i.label,name:t.name,type:"text",otherAttribute:i.otherAttribute,placeholder:i.placeholder||i.label})),t.inputs[i.label]}),function(e,t){return e.add(t)})},t.prototype.getValues=function(){var t=this;return e._.map(this.inputs,function(e,i){return t.getInput(i).val()})},t.prototype.setValue=function(t,i){e.Assert.exists(this.inputs[t]),this.getInput(t).val(i)},t.prototype.reset=function(){e._.each(this.inputs,function(e){e.find("input").val("")})},t.prototype.getInput=function(t){e.Assert.exists(this.inputs[t]);var i=this.inputs[t].find("input");return 0==i.length&&(i=this.inputs[t].find("textarea")),i},t}();t.PreferencesPanelTextInput=s;var r=function(t){function i(){t.apply(this,arguments),this.inputTemplate=e._.template("<div class='coveo-choice-container'><textarea <%= otherAttribute %> class='coveo-<%= label %>' id='coveo-<%= label %>' name='<%= name%>' placeholder='<%= placeholder %>' ></textarea></div>")}return __extends(i,t),i.prototype.build=function(){var t=this;return e._.reduce(e._.map(this.textElementToBuild,function(i){return t.inputs[i.label]=e.$(t.inputTemplate({label:i.label,name:t.name,otherAttribute:i.otherAttribute,placeholder:i.placeholder||i.label})),t.inputs[i.label]}),function(e,t){return e.add(t)})},i}(s);t.PreferencesPanelTextAreaInput=r;var a=function(){function t(e,t,i){this.toBuild=e,this.options=t,this.name=i,this.textInput=new r([{label:e.label,otherAttribute:"readonly"}],i)}return t.prototype.build=function(){var t=this;return this.select=e.$("<select multiple></select>"),e._.each(this.options,function(i){t.select.append(e.$("<option>"+i+"</option>"))}),this.select.change(function(){var i=t.select.val();e.Utils.isNullOrUndefined(i)?t.reset():t.textInput.setValue(t.toBuild.label,i.join(","))}),this.textInput.build().append(this.select)},t.prototype.getValues=function(){return this.textInput.getValues()[0].split(",")},t.prototype.setValues=function(e){this.textInput.setValue(this.toBuild.label,e.join(","))},t.prototype.reset=function(){this.textInput.setValue(this.toBuild.label,"")},t}();t.PreferencePanelMultiSelectInput=a}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(e,o,s){i.call(this,e,n.ID,s),this.element=e,this.options=o,this.options=t.ComponentOptions.initComponentOptions(e,n,o),this.buildCloseButton(),this.buildTitle()}return __extends(n,i),n.prototype.getCssClass=function(){return"coveo-preference-panel"},n.prototype.getMenuItems=function(){var e=this;return[{text:t.l("Preferences"),onOpen:function(){return e.open()},onClose:function(){return e.close()}}]},n.prototype.open=function(){e.$(this.element).addClass("coveo-active")},n.prototype.close=function(){e.$(this.element).removeClass("coveo-active")},n.prototype.save=function(){e.$(this.element).trigger(e.Events.PreferencesPanelEvents.savePreferences),this.queryController.executeQuery()},n.prototype.closeWithoutSave=function(){e.$(this.element).trigger(e.Events.PreferencesPanelEvents.exitPreferencesWithoutSave)},n.prototype.buildCloseButton=function(){var t=this,i=e.$("<div class='coveo-close'><span class='coveo-icon'></span></div>");i.fastClick(function(){t.closeWithoutSave(),t.close()}),e.$(this.element).prepend(i)},n.prototype.buildTitle=function(){var i=e.$("<div class='coveo-title'>"+t.l("Preferences")+"</div>");e.$(this.element).prepend(i)},n.ID="PreferencesPanel",n.options={},n}(t.Component);t.PreferencesPanel=i,t.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i;!function(t){function i(i,n){e.$(i).fastClick(function(e){e.preventDefault(),n&&n.indexOf("javascript:")<0&&t.openInPhonegap(n)})}function n(e){window.open(e,"_system","location=yes")}t.bindOpenLinkInPhonegap=i,t.openInPhonegap=n}(i=t.PhonegapUtils||(t.PhonegapUtils={}))}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r,a){i.call(this,o,n.ID,r),this.element=o,this.options=s,this.result=a,this.options=t.ComponentOptions.initComponentOptions(o,n,s);var l=a.raw.sysparents;l?this.renderParentsXml(o,l):this.renderUri(o,a),e.DeviceUtils.isPhonegap()&&t.PhonegapUtils.bindOpenLinkInPhonegap(o,this.uri)}return __extends(n,i),n.prototype.renderParentsXml=function(t,i){for(var n=e.$.parseXML(i),o=n.getElementsByTagName("parent"),s=[],r=[],a=0;a<o.length;a++){if(a>0){var l=this.buildSeperator();r.push(l),t.appendChild(l)}var u=o.item(a),c=this.buildHtmlToken(u.getAttribute("name"),u.getAttribute("uri"));s.push(c),t.appendChild(c)}if(s.length>1){var p=this.buildEllipsis();t.insertBefore(p,r[0]);var d=this.buildSeperator();t.insertBefore(d,p);for(var h=0,f=[],a=0;a<s.length;a++)f[a]=s[a].offsetWidth,h+=f[a];var v=r[0].offsetWidth,m=p.offsetWidth,g=t.offsetWidth;if(h>=g){h+=m+v;for(var y=[],a=1;a<s.length&&h>=g;)t.removeChild(s[a]),t.removeChild(r[a-1]),a>1&&y.push(r[a-1]),y.push(s[a]),h-=f[a]+v,a++;p.onclick=function(){for(var e=0;e<y.length;e++)t.insertBefore(y[e],p);t.removeChild(p)}}else t.removeChild(p),t.removeChild(d)}},n.prototype.renderUri=function(t,i){this.uri=i.clickUri;var n;n=-1==i.printableUri.indexOf("\\")?e.StringAndHoles.shortenUri(i.printableUri,e.$(t).width()/7):e.StringAndHoles.shortenPath(i.printableUri,e.$(t).width()/7);var o=e.HighlightUtils.highlightString(n.value,i.printableUriHighlights,n.holes,"coveo-highlight"),s=e.$("<a>").attr("title",i.printableUri).addClass("coveo-printable-uri").html(o);e.DeviceUtils.isPhonegap()||s.attr("href",i.clickUri),s.appendTo(t)},n.prototype.buildSeperator=function(){var e=document.createElement("span");return e.innerText=">",e.className="coveo-printable-uri-separator",e},n.prototype.buildEllipsis=function(){var e=document.createElement("span");return e.innerText="...",e.className="coveo-printable-uri",e},n.prototype.buildHtmlToken=function(t,i){var n=t.charAt(0).toUpperCase()+t.slice(1),o=document.createElement("a");return e.DeviceUtils.isPhonegap()||(o.href=i),this.uri=i,o.className="coveo-printable-uri",o.innerText=n,o},n.ID="PrintableUri",n.options={},n}(t.Component);t.PrintableUri=i,t.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r){var a=this;i.call(this,o,n.ID,r),this.element=o,this.options=s,this.options=t.ComponentOptions.initComponentOptions(o,n,s),e.$(this.root).on(e.Events.QueryEvents.querySuccess,e.$.proxy(this.handleQuerySuccess,this)),e.$(this.root).on(e.Events.QueryEvents.queryError,function(){e.$(a.element).hide()}),e.$(this.element).hide(),this.textContainer=e.$("<span />").appendTo(this.element)}return __extends(n,i),n.prototype.handleQuerySuccess=function(i,n){if(!this.disabled){e.Assert.exists(n);var o=t.l("Duration",this.formatQueryDuration(n.results.duration))+"\n"+t.l("IndexDuration",this.formatQueryDuration(n.results.indexDuration))+"\n"+t.l("ProxyDuration",this.formatQueryDuration(n.results.proxyDuration))+"\n"+t.l("ClientDuration",this.formatQueryDuration(n.results.clientDuration));this.textContainer.text(this.formatQueryDuration(n.results.duration)),e.$(this.element).attr("title",o),e.$(this.element).show()}},n.prototype.formatQueryDuration=function(e){if(void 0==e)return t.l("Unavailable");var i=Math.max(e/1e3,.01);return t.l("Seconds",Globalize.format(i,"n2"),i)},n.ID="QueryDuration",n.options={},n}(t.Component);t.QueryDuration=i,t.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r){var a=this;i.call(this,o,n.ID,r),this.element=o,this.options=s,this.options=t.ComponentOptions.initComponentOptions(o,n,s),e.$(this.root).on(e.Events.QueryEvents.querySuccess,e.$.proxy(this.handleQuerySuccess,this)),e.$(this.root).on(e.Events.QueryEvents.queryError,function(){e.$(a.element).hide()}),e.$(this.element).hide(),this.textContainer=e.$("<span />").appendTo(this.element)}return __extends(n,i),n.prototype.handleQuerySuccess=function(i,n){if(!this.disabled)if(e.Assert.exists(n),e.$(this.element).show(),n.results.results.length>0){var o=Globalize.format(n.query.firstResult+1,"n0"),s=Globalize.format(n.query.firstResult+n.results.results.length,"n0"),r=Globalize.format(n.results.totalCount,"n0");this.textContainer.html(t.l("ShowingResultsOf",'<span class="coveo-highlight">'+o+"</span>",'<span class ="coveo-highlight">'+s+"</span>",'<span class ="coveo-highlight">'+r+"</span>",n.results.results.length))}else if(null!=n.results.exception&&null!=n.results.exception.code){var a=("QueryException"+n.results.exception.code).toLocaleString();this.textContainer.html(t.l("QueryException",a))}else this.textContainer.html(t.l("QueryDidntMatchAnyDocuments"))},n.ID="QuerySummary",n.options={},n}(t.Component);t.QuerySummary=i,t.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.buildMailToString=function(e){var i=e.to?"mailto:"+encodeURIComponent(e.to):"mailto:",n=t.buildMailToParametersString(e.subject,e.cc,e.bcc,e.body,i);return n&&(i+="?"+n),i},t.buildMailToParametersString=function(e,i,n,o,s){var r=[];if(e&&r.push(t.buildMailToParameter("subject",e)),i&&r.push(t.buildMailToParameter("cc",i)),n&&r.push(t.buildMailToParameter("bcc",n)),o){var a=t.getShortenBody(o,s+"?"+r.join("&"));a&&r.push(t.buildMailToParameter("body",a))}return r.join("&")},t.getShortenBody=function(i,n){var o=i;if(n.length<e.Ui.MailTo.maxLength){var s=e.Ui.MailTo.maxLength-n.length-"&body=".length;o=t.shortenString(i,s)}return o},t.buildMailToParameter=function(e,t){return t?encodeURIComponent(e)+"="+encodeURIComponent(t):""},t.shortenString=function(t,i,n){void 0===n&&(n=!1);var o=n?encodeURIComponent(e.Ui.MailTo.shortenBodyIndicator):e.Ui.MailTo.shortenBodyIndicator;i-=e.Ui.MailTo.shortenBodyIndicator.length;var s=t.length>i?!0:!1,r=t.substring(0,i);return r+=s?o:""},t.appendShortenBodyToMailToString=function(e,i){var n=t.getShortenBody(i,e);return e.indexOf("?")>=0?e+"&body="+n:e+"?body="+n},t.removeCurrentUserEmailFromString=function(t,i){return i&&t?e._.filter(i.split(";"),function(e){return-1==e.indexOf(t)}).join(";"):i},t.buildReplyMailToFromResult=function(t,i){return new e.Ui.MailTo({currentUserEmail:i,originalFrom:t.raw.sysfrom,to:t.raw.sysfrom,subject:t.raw.sysconversationsubject})},t.buildReplyAllMailToFromResult=function(t,i){return new e.Ui.MailTo({currentUserEmail:i,originalFrom:t.raw.sysfrom,to:t.raw.sysfrom+";"+t.raw.systo,subject:t.raw.sysconversationsubject,cc:t.raw.syscc})},t.buildForwardMailToFromResult=function(t,i){return new e.Ui.MailTo({currentUserEmail:i,originalFrom:t.raw.sysfrom,subject:t.raw.sysconversationsubject})},t.encodeMailToBody=function(t){var i=t.split("\n");return e._.each(i,function(e,t){i[t]=encodeURIComponent(i[t])}),i.join(e.Ui.MailTo.enter)},t}();e.EmailActionsUtils=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(t){function i(){t.apply(this,arguments),this.currentUserEmail="",this.originalFrom="",this.to="",this.subject="",this.cc="",this.bcc="",this.body="",this.bodyIsHTML=e.DeviceUtils.isPhonegap()}return __extends(i,t),i}(e.Options);t.DefaultMailToOptions=i;var n=function(){function n(n){this.options=n,this.bodyHeader="",this.options=(new i).merge(n),this.removeCurrentUserFromParameters(),e.DeviceUtils.isPhonegap()&&this.setRecipientsArrays(),this.options.originalFrom&&(this.bodyHeader=this.options.bodyIsHTML?"<p><br/><br/><br/>"+t.l("From")+": "+this.options.originalFrom+"<hr></p>":"\n\n\n"+t.l("From")+": "+this.options.originalFrom+"\n_________________________________\n")}return n.prototype.removeCurrentUserFromParameters=function(){this.options.to=e.EmailActionsUtils.removeCurrentUserEmailFromString(this.options.currentUserEmail,this.options.to),this.options.cc=e.EmailActionsUtils.removeCurrentUserEmailFromString(this.options.currentUserEmail,this.options.cc),this.options.bcc=e.EmailActionsUtils.removeCurrentUserEmailFromString(this.options.currentUserEmail,this.options.bcc)},n.prototype.setRecipientsArrays=function(){this.toArray=this.options.to?this.options.to.split(";"):[],this.ccArray=this.options.cc?this.options.cc.split(";"):[],this.bccArray=this.options.bcc?this.options.bcc.split(";"):[]},n.prototype.open=function(){if(e.DeviceUtils.isPhonegap()){var t=this.options.bodyIsHTML?this.body:e.EmailActionsUtils.shortenString(this.body,n.phonegapMaxLength);window.plugin.email.open(this.getEmailOpenerObject(t))}else this.ensureValueIsSet(),window.location.href=this.value},n.prototype.getEmailOpenerObject=function(e){var t={to:this.toArray,cc:this.ccArray,bcc:this.bccArray,subject:this.options.subject,body:e,isHtml:this.options.bodyIsHTML};return console.log(t),t},n.prototype.ensureValueIsSet=function(){this.value?this.valueBodyIsSet()||this.setValueBody():this.setValue()},n.prototype.setValue=function(){this.value=e.EmailActionsUtils.buildMailToString(this.options),this.value&&!this.valueBodyIsSet()&&this.setValueBody()},n.prototype.setValueBody=function(){this.value=e.EmailActionsUtils.appendShortenBodyToMailToString(this.value,this.body)},n.prototype.setMailToBodyFromText=function(t){void 0===t&&(t=""),this.body=t,e.DeviceUtils.isPhonegap()||(this.body=e.EmailActionsUtils.encodeMailToBody(this.body))},n.prototype.valueBodyIsSet=function(){return this.value.indexOf("body=")>=0},n.prototype.bodyIsSet=function(){return this.body?!0:!1},n.enter="%0D%0A",n.shortenBodyIndicator="\r\n\r\n...",n.maxLength=1e3,n.phonegapMaxLength=15e3,n}();t.MailTo=n}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(e,o,s,r){i.call(this,e,n.ID,s),this.element=e,this.options=o,this.result=r,this.options=t.ComponentOptions.initComponentOptions(e,n,o),this.result=r||this.resolveResult(),this.createAndAppendEmailActions(),this.appendWaitingAnimation()}return __extends(n,i),n.prototype.createAndAppendEmailActions=function(){this.options.reply&&(this.reply=new t.EmailAction(e.$(document.createElement("div"))[0],this,{type:t.EmailAction.reply,currentUserEmail:this.options.currentUserEmail},this.getBindings(),this.result),e.$(this.element).append(this.reply.element)),this.options.replyAll&&(this.replyAll=new t.EmailAction(e.$(document.createElement("div"))[0],this,{type:t.EmailAction.replyAll,currentUserEmail:this.options.currentUserEmail},this.getBindings(),this.result),e.$(this.element).append(this.replyAll.element)),this.options.forward&&(this.forward=new t.EmailAction(e.$(document.createElement("div"))[0],this,{type:t.EmailAction.forward,currentUserEmail:this.options.currentUserEmail},this.getBindings(),this.result),e.$(this.element).append(this.forward.element))},n.prototype.appendWaitingAnimation=function(){this.loadingAnimation=e.JQueryUtils.getBasicLoadingDots().hide(),e.$(this.element).append(this.loadingAnimation)},n.ID="EmailActions",n.options={currentUserEmail:t.ComponentOptions.buildStringOption({defaultValue:""}),reply:t.ComponentOptions.buildBooleanOption({defaultValue:!0}),replyAll:t.ComponentOptions.buildBooleanOption({defaultValue:!0}),forward:t.ComponentOptions.buildBooleanOption({defaultValue:!0})},n}(e.Ui.Component);t.EmailActions=i,e.Ui.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r,a,l){var u=this;i.call(this,o,n.ID,a),this.element=o,this.actions=s,this.options=r,this.result=l,this.options=t.ComponentOptions.initComponentOptions(o,t.EmailActions,r),this.result=l||this.resolveResult(),this.setMailToFromResult(),e.$(this.element).fastClick(function(){u.showWaitingAnimation(),u.mailTo.bodyIsSet()?u.openMailTo():u.appendBodyToMailTo(function(){return u.openMailTo()})})}return __extends(n,i),n.prototype.showWaitingAnimation=function(){this.actions.loadingAnimation.show()},n.prototype.hideWaitingAnimation=function(){this.actions.loadingAnimation.hide()},n.prototype.setMailToFromResult=function(){switch(this.options.type){case n.reply:this.mailTo=e.EmailActionsUtils.buildReplyMailToFromResult(this.result,this.options.currentUserEmail),e.$(this.element).append(t.l("Reply"));break;case n.replyAll:this.mailTo=e.EmailActionsUtils.buildReplyAllMailToFromResult(this.result,this.options.currentUserEmail),e.$(this.element).append(t.l("ReplyAll"));break;case n.forward:e.$(this.element).append(t.l("Forward")),this.mailTo=e.EmailActionsUtils.buildForwardMailToFromResult(this.result,this.options.currentUserEmail);break;default:this.mailTo=new t.MailTo({})}},n.prototype.appendBodyToMailTo=function(t){var i=this;if(e.DeviceUtils.isPhonegap()){var n,o=this.queryController.getEndpoint();n=e.DeviceUtils.isAndroid()?o.getDocumentText(this.result.uniqueId).done(function(e){i.doneRetrieveBody(e,t)}):o.getDocumentHtml(this.result.uniqueId).done(function(e){i.doneRetrieveBody(e.getElementsByTagName("body")[0].innerHTML,t)}),n.fail(function(){i.doneRetrieveBody("",t)})}else this.queryController.getEndpoint().getDocumentText(this.result.uniqueId).done(function(e){return i.doneRetrieveBody(e,t)}).fail(function(){return i.doneRetrieveBody("",t)})},n.prototype.doneRetrieveBody=function(e,t){var i=e.content?e.content:e;this.mailTo.setMailToBodyFromText(i),t(e)},n.prototype.openMailTo=function(){this.mailTo.open(),this.hideWaitingAnimation()},n.ID="EmailAction",n.options={type:t.ComponentOptions.buildStringOption({defaultValue:"forward"}),currentUserEmail:t.ComponentOptions.buildStringOption({defaultValue:""})},n.forward="forward",n.reply="reply",n.replyAll="replyAll",n}(e.Ui.Component);t.EmailAction=i}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i="CoveoHighlight",n=function(n){function o(i,s,r,a){n.call(this,i,o.ID,r),this.element=i,this.options=s,this.result=a,this.options=t.ComponentOptions.initComponentOptions(i,o,s),this.result=a||this.resolveResult(),e.Assert.exists(this.result)}return __extends(o,n),o.prototype.createDom=function(){this.header=this.buildHeader().appendTo(e.$(this.element)),this.iframe=this.buildIFrame().appendTo(e.$(this.element))},o.prototype.open=function(){var i=this;this.ensureDom(),this.usageAnalytics.logClickEvent(t.AnalyticsActionCauseList.documentQuickView,{documentTitle:this.result.title,documentURL:this.result.clickUri},this.result,this.queryController.element);var n=(new Date).getTime(),o=this.iframe.find("iframe")[0];o.src="about:blank";var s=this.queryController.getEndpoint(),r={query:this.queryStateModel.get(e.Models.QueryStateModel.attributesEnum.q),requestedOutputSize:this.options.maximumDocumentSize};s.getDocumentHtml(this.result.uniqueId,r).done(function(e){null!=o.contentDocument&&(i.renderHTMLDocument(o,e),i.triggerQuickviewLoaded(n))}).fail(function(t,r){null!=o.contentDocument&&(0!=r.status?(i.renderErrorReport(o),i.triggerQuickviewLoaded(n)):(o.onload=function(){i.triggerQuickviewLoaded(n)},o.src=s.getViewAsHtmlUri(i.result.uniqueId,i.queryStateModel.get(e.Models.QueryStateModel.attributesEnum.q))))})},o.prototype.renderHTMLDocument=function(t,i){var n=this;t.onload=function(){n.onReceivingMessage(t.contentWindow)},this.writeToIFrame(t,i),this.wrapPreElementsInIframe(t),e.DeviceUtils.isMobileDevice()&&this.bindOpenIframeLinksInPhonegap(t)},o.prototype.renderErrorReport=function(e){var i="<html><body style='font-family: Arimo, \"Helvetica Neue\", Helvetica, Arial, sans-serif; -webkit-text-size-adjust: none;'>"+t.l("OopsError")+"</body></html>";this.writeToIFrame(e,i)},o.prototype.writeToIFrame=function(e,t){var i=t;"object"==typeof t&&(i=t.getElementsByTagName("html")[0].outerHTML),e.contentWindow.document.open(),e.contentWindow.document.write(i),e.contentWindow.document.close()},o.prototype.bindOpenIframeLinksInPhonegap=function(i){try{var n=e.$(i.contentWindow.document).find("a");e._.each(n,function(e){var i=e.href;e.href="javascript:",t.PhonegapUtils.bindOpenLinkInPhonegap(e,i)})}catch(o){}},o.prototype.wrapPreElementsInIframe=function(t){var i=this;try{var n=document.createElement("style");n.type="text/css";var o='html pre { white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word;} body, html {Arimo, "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-text-size-adjust: none; margin:0; padding:0; transform-origin:0 0; -ms-transform-origin:0 0; -webkit-transform-origin:0 0;} * { max-width: 100%; -webkit-text-size-adjust: none; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box;} html body {height: auto; width: auto;}';n.styleSheet?n.styleSheet.cssText=o:n.appendChild(document.createTextNode(o));var s=t.contentWindow.document.head;if(s.appendChild(n),e.DeviceUtils.isMobileDevice()&&this.options.allowedZoom){e.DeviceUtils.isIos()&&e.$(t.contentWindow.document.body).css({"-ms-transform":"translate3d(0,0,0)","-webkit-transform":"translate3d(0,0,0)",transform:"translate3d(0,0,0)"});var r=e.DeviceUtils.isIos()?this.iframe.get(0):t,a=t.contentWindow.document.body,l=e.DeviceUtils.isIos()?this.iframe.get(0):t.contentWindow.document.body,u=e.DeviceUtils.isIos()?t:t.contentWindow.document.body,c={frameElement:r,bodyElement:a,scaleElement:u,scrollElement:l,maxWidth:0,maxHeight:0,scale:1,scroll:{left:0,top:0},initialState:void 0};e.$(l).on("touchstart",function(e){i.handleTouchStart(e,c)}).on("touchmove",function(e){i.handleTouchMove(e,c)}).on("touchend",function(e){i.handleTouchEnd(e,c)}),this.iframeSizeCalculation(t),this.calculateBoundaries(c),e.$(window).on("orientationchange",function(){i.iframeSizeCalculation(t),i.calculateBoundaries(c),e.$(c.scrollElement).animate({scrollLeft:0,scrollTop:0},0)})}}catch(p){}},o.prototype.handleTouchStart=function(t,i){var n=this,o=e._.map(t.originalEvent.touches,function(e){return n.mouseEventToPoint(e,i.scrollElement)});i.initialState={scale:i.scale,touches:o,centerClient:{x:this.getMeanValue(o,"x"),y:this.getMeanValue(o,"y")},scroll:{left:i.scroll.left,top:i.scroll.top},distance:2==o.length?this.distance(o[0],o[1]):0}},o.prototype.handleTouchMove=function(t,i){var n=this,o=e._.map(t.originalEvent.touches,function(e){return n.mouseEventToPoint(e,i.scrollElement)});if(null!=i.initialState){if(2===o.length){var s=this.distance(o[0],o[1]);i.scale=Math.max(this.options.minimumZoom,Math.min(this.options.maximumZoom,s/i.initialState.distance*i.initialState.scale))}return this.calculateScroll(i,o),this.updateScaleScroll(i),t.preventDefault(),!1}},o.prototype.handleTouchEnd=function(t,i){t.originalEvent.touches;this.updateScaleScroll(i),e.DeviceUtils.isIos()&&this.overlaps.css({"-ms-transform":"scale("+i.scale+","+i.scale+") translate(0, 0)","-webkit-transform":"scale("+i.scale+","+i.scale+") translate(0, 0)",transform:"scale("+i.scale+","+i.scale+") translate(0, 0)","transform-origin":"0 0","-ms-transform-origin":"0 0","-webkit-transform-origin":"0 0"}),i.initialState=null},o.prototype.iframeSizeCalculation=function(t){var i=e.$(t.contentWindow.document.body).width(),n=e.$(t.contentWindow.document.body).height();e.$(t.contentWindow.document.body).width(i),e.$(t.contentWindow.document.body).height(n),e.DeviceUtils.isMobileDevice()&&this.resizeIframe(),e.DeviceUtils.isIos()&&(this.overlaps&&this.overlaps.remove(),this.overlaps=e.$("<div />").css({top:0,left:0,width:Math.max(window.innerWidth,i),height:Math.max(window.innerHeight,n),position:"absolute"}).appendTo(this.iframe),this.overlaps.fastClick(function(i){var n=e.$(t).offset();e.$(t.contentWindow.document.elementFromPoint(i.clientX-n.left,i.clientY-n.top)).fastClick()}),e.$(this.iframe).css({position:"relative"}))},o.prototype.getMeanValue=function(t,i){return 1==t.length?t[0][i]:e._.reduce(t,function(e,t){return e[i]+t[i]})/t.length},o.prototype.mouseEventToPoint=function(t,i){var n=e.$(i).offset();return{x:t.clientX-n.left,y:t.clientY-n.top}},o.prototype.distance=function(e,t){return Math.ceil(Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)))},o.prototype.calculateBoundaries=function(e){e.maxWidth=e.bodyElement.scrollWidth,e.maxHeight=e.bodyElement.scrollHeight},o.prototype.calculateScroll=function(t,i){var n=(t.initialState.scroll.left+t.initialState.centerClient.x)/t.initialState.scale*t.scale-this.getMeanValue(i,"x"),o=(t.initialState.scroll.top+t.initialState.centerClient.y)/t.initialState.scale*t.scale-this.getMeanValue(i,"y"),s=t.maxWidth*t.scale-e.$(t.frameElement).width(),r=t.maxHeight*t.scale-e.$(t.frameElement).width();t.scroll={left:Math.max(0,Math.min(s,n)),top:Math.max(0,Math.min(r,o))}},o.prototype.updateScaleScroll=function(t){var i="scale("+t.scale+","+t.scale+") translate("+-1*t.scroll.left/t.scale+"px, "+-1*t.scroll.top/t.scale+"px)";e.$(t.scaleElement).css({"-ms-transform":i,"-webkit-transform":i,transform:i,"transform-origin":"0 0","-ms-transform-origin":"0 0","-webkit-transform-origin":"0 0"})},o.prototype.triggerQuickviewLoaded=function(t){var i=(new Date).getTime(),n={duration:i-t};e.$(this.element).trigger(e.Events.UserActionEvents.quickViewLoaded,n)},o.prototype.onReceivingMessage=function(t){var n=this;this.header.empty();var o={};this.keywordsState=[];var s=e.$(t.document.body).find("[id^="+i+"]");0==s.length&&this.header.css("min-height",0);for(var r=0;r<s.length;r++){var a=s[r],l=a.id.substr(i.length+1).match(/^([0-9]+)\.([0-9]+)\.([0-9]+)$/);if(null!=l){var u=l[1],c=l[2];o[u]?o[u].count=Math.max(o[u].count,Number(c)):o[u]={text:a.innerHTML,count:1,index:u}}}for(var p=e._.keys(o),r=0;r<p.length;r++){var u=p[r],d=o[u],h=e.$(t.document.body).find('[id^="'+i+":"+u+'.1"]')[0],f=h.style.backgroundColor;this.keywordsState.push({word:d,color:f,currentIndex:0,index:Number(d.index)})}e.$.each(this.keywordsState,function(e,i){n.header.append(n.buildWordButton(i,t))})},o.prototype.buildWordButton=function(t,i){var n=this,o=e.$("<span/>").addClass("coveo-term");return o.append(e.$("<span/>").addClass("coveo-term-left-arrow").append(e.$("<span/>").addClass("coveo-term-left-arrow-icon")).click(function(){n.navigate(t,!0,i)})),o.append(e.$("<span/>").addClass("coveo-term-name").text(t.word.text).click(function(){n.navigate(t,!1,i)})),o.append(e.$("<span/>").addClass("coveo-term-right-arrow").append(e.$("<span/>").addClass("coveo-term-right-arrow-icon")).click(function(){n.navigate(t,!1,i)})),o.css("background-color",t.color),o},o.prototype.navigate=function(t,n,o){var s,r=t.currentIndex;s=n?1>=r?t.word.count:r-1:r==t.word.count?1:r+1;var a=e.$(o.document.body),l=a.find('[id^="'+i+":"+t.word.index+"."+s+'"]')[0],u=e.$(l).offset(),c=a.get(0);a.stop(!0).animate({scrollLeft:u.left-c.clientWidth/2+e.$(l).width()/2,scrollTop:u.top-c.clientHeight/2+e.$(l).height()/2}),this.iframe.stop(!0).animate({scrollLeft:u.left-this.iframe.width()/2+e.$(l).width()/2,scrollTop:u.top-this.iframe.height()/2+e.$(l).height()/2});var p=a.find('[id^="'+i+":"+t.word.index+"."+r+'"]')[0];null!=p&&(p.style.border=""),l.style.border="1px dotted #333",t.currentIndex=s},o.prototype.buildHeader=function(){return e.$("<div/>").addClass("coveo-quickview-header")},o.prototype.buildIFrame=function(){return e.$('<div class="coveo-iframeWrapper"><iframe/></div>')},o.prototype.resizeIframe=function(){var i=e._.reduce(e.$(".coveo-modalBox .coveo-title, .coveo-modalBox .coveo-quick-view-header, .coveo-modalBox ."+t.Component.computeCssClassNameForType(t.EmailAction.ID)),function(t,i){return t+e.$(i).height()},0)+20;e.$(this.iframe).height(e.$(".coveo-modalBox .coveo-body").height()-i)},o.ID="QuickViewDocument",o.options={maximumDocumentSize:t.ComponentOptions.buildNumberOption({defaultValue:0}),allowedZoom:t.ComponentOptions.buildBooleanOption({defaultValue:!0}),minimumZoom:t.ComponentOptions.buildNumberOption({defaultValue:.5}),maximumZoom:t.ComponentOptions.buildNumberOption({defaultValue:4})},o
}(t.Component);t.QuickViewDocument=n,t.CoveoJQuery.registerAutoCreateComponent(n)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r,a){var l=this;i.call(this,o,n.ID,r),this.element=o,this.options=s,this.result=a,this.options=t.ComponentOptions.initComponentOptions(o,n,s),null==this.options.contentTemplate?e.$(this.root).one(e.Events.ResultListEvents.newResultsDisplayed,function(){l.dialogBoxContent=e.$(l.element).children().detach(),l.createLinkAndAppendItToDom(a)}):this.element.innerHTML.match(/^\s*$/)&&this.createLinkAndAppendItToDom(a),this.bindClick(a)}return __extends(n,i),n.prototype.open=function(){var e=this.prepareOpenQuickViewObject();this.createModalBox(e),this.bindQuickViewEvents(e),this.animateAndOpen()},n.prototype.close=function(){this.modalbox.close(),e.DeviceUtils.isAndroid()&&e.DeviceUtils.isPhonegap()&&e.$(document).off("backbutton")},n.prototype.createLinkAndAppendItToDom=function(t){("undefined"==typeof t.hasHtmlVersion||t.hasHtmlVersion)&&(this.link=e.$(n.quickViewLinkTemplate()),e.$(this.element).append(this.link))},n.prototype.bindClick=function(t){"undefined"==typeof t.hasHtmlVersion||t.hasHtmlVersion?e.$(this.element).fastClick(e.$.proxy(this.open,this)):e.$(this.element).css("display","none")},n.prototype.bindQuickViewEvents=function(t){var i=this;e.DeviceUtils.isAndroid()&&e.DeviceUtils.isPhonegap()&&e.$(document).on("backbutton",function(){i.close()}),e.$(this.modalbox.wrapper.children(".coveo-title")).fastClick(function(){return i.close()}),e.$(window).on("resize orientationchange",t.resizeHandler),this.modalbox.content.on(e.Events.UserActionEvents.quickViewLoaded,function(){e.$(t.loadingAnimation).remove()})},n.prototype.animateAndOpen=function(){var i=this,n=this.modalbox.wrapper.css("animation-duration");if(n){var o=/^(.+)(ms|s)$/.exec(n),s=Number(o[1])*("s"==o[2]?1e3:1);setTimeout(function(){e.$(i.modalbox.modalBox.find("."+t.Component.computeCssClassNameForType(t.QuickViewDocument.ID))).coveo("open"),i.resizeIFrame()},s)}else e.$(this.modalbox.modalBox.find("."+t.Component.computeCssClassNameForType(t.QuickViewDocument.ID))).coveo("open"),this.resizeIFrame()},n.prototype.createModalBox=function(i){var n=this;i.content&&(this.dialogBoxContent=i.content);var o=e.$("<div/>").append(this.dialogBoxContent);this.options.title&&o.prepend(e.$('<div class="coveo-title" />').html(this.options.title)),this.modalbox=e.ModalBox.open(o,{overlayClose:!0,title:e.JQueryUtils.getPopUpCloseButton(t.l("Close"),t.l("QuickView")),className:"coveo-quick-view",validation:function(){return e.$(window).off("resize orientationchange",i.resizeHandler),n.modalbox=null,!0}})},n.prototype.prepareOpenQuickViewObject=function(){var e=this,t=function(){e.resizeIFrame()},i=this.options.loadingAnimation;return{resizeHandler:t,loadingAnimation:i,content:void 0!=this.options.contentTemplate?this.prepareQuickViewContent(i):void 0}},n.prototype.prepareQuickViewContent=function(i){var n=e.$(this.options.contentTemplate.instantiateToElement(this.result)),o=this.searchInterface.options,s=e.$.extend({},{options:o},this.getBindings(),{result:this.result});return t.CoveoJQuery.automaticallyCreateComponentsInside(n.get(0),s),0!=n.find("."+t.Component.computeCssClassNameForType(t.QuickViewDocument.ID)).length&&this.options.showLoadingAnimation&&n.prepend(i),n},n.prototype.resizeIFrame=function(){var e=this.modalbox.content.find("."+t.Component.computeCssClassNameForType(t.QuickViewDocument.ID)).find("iframe");if(0!=e.length){var i=this.modalbox.content.get(0).scrollHeight-this.modalbox.content.outerHeight(),n=this.modalbox.content.get(0).scrollWidth-this.modalbox.content.outerWidth();i>0?e.height(e.height()-i):e.css("height",""),n>0?e.width(e.width()-n-5):e.css("width","")}},n.ID="QuickView",n.quickViewLinkTemplate=e._.template("<div class='coveo-icon-for-quickview'>"+t.l("QuickView")+"</div>"),n.options={title:t.ComponentOptions.buildStringOption(),showLoadingAnimation:t.ComponentOptions.buildBooleanOption({defaultValue:!0}),contentTemplate:t.ComponentOptions.buildTemplateOption({selectorAttr:"data-template-selector",idAttr:"data-template-id"}),loadingAnimation:t.ComponentOptions.buildOption(11,function(i){var n=e.$(i).attr("data-loading-animation-selector");if(null!=n){var o=e.$(n);if(0!=o.length)return o.remove().get(0)}var s=e.$(i).attr("data-loading-animation-template-id");if(null!=s){var r=t.ComponentOptions.loadResultTemplateFromId(s);if(r)return r.instantiateToElement({})}return e.JQueryUtils.getBasicLoadingAnimation().get(0)})},n}(t.Component);t.QuickView=i,t.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r,a,l){void 0===l&&(l=0),i.call(this,o,n.ID,r),this.element=o,this.options=s,this.bindings=r,this.attachmentLevel=l,this.options=t.ComponentOptions.initComponentOptions(o,n,s),this.attachments=a.attachments,e.Utils.isNonEmptyArray(this.attachments)&&this.renderAttachments()}return __extends(n,i),n.prototype.renderAttachments=function(){var t=this;e._.each(this.attachments,function(i){var o=t.attachmentLevel>0?t.options.subResultTemplate.instantiateToElement(i):t.options.resultTemplate.instantiateToElement(i);if(t.autoCreateComponentsInsideResult(o,e.$.extend({},i,{attachments:[]})),e.$(t.element).append(o),t.attachmentHasSubAttachment(i)&&t.attachmentLevel<t.options.maximumAttachmentLevel){var s=e.$("<div></div>");e.$(o).append(s),new n(s.get(0),t.options,t.bindings,i,t.attachmentLevel+1)}})},n.prototype.attachmentHasSubAttachment=function(t){return e.Utils.isNonEmptyArray(t.attachments)?!0:e.Utils.isNonEmptyArray(t.childResults)?(t.attachments=t.childResults,!0):!1},n.prototype.autoCreateComponentsInsideResult=function(i,o){e.Assert.exists(i);var s=this.searchInterface.options,r=e.$.extend({},{options:s},this.getBindings(),{result:o});t.CoveoJQuery.automaticallyCreateComponentsInside(i,r,[n.ID])},n.ID="ResultAttachments",n.options={resultTemplate:t.ComponentOptions.buildTemplateOption({defaultFunction:function(){return new t.DefaultResultTemplate}}),subResultTemplate:t.ComponentOptions.buildTemplateOption({postProcessing:function(e,t){return null!=e?e:t.resultTemplate}}),maximumAttachmentLevel:t.ComponentOptions.buildNumberOption({defaultValue:5})},n}(t.Component);t.ResultAttachments=i,t.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r,a){i.call(this,o,n.ID,r),this.element=o,this.options=s,this.result=a,this.showingMoreResults=!1,this.options=t.ComponentOptions.initComponentOptions(this.element,n,s),e.Assert.exists(a),this.buildElements(),this.displayThoseResults(this.result.childResults),this.updateElementVisibility(),0!=this.result.childResults.length||this.result.moreResults||e.$(this.element).hide()}return __extends(n,i),n.prototype.showMoreResults=function(){var t=this;e.Assert.exists(this.result.moreResults),this.cancelAnyPendingShowMore(),this.moreResultsDeferred=this.result.moreResults(),this.waitAnimation=e.JQueryUtils.getBasicLoadingDots().appendTo(this.results),this.updateElementVisibility(),this.moreResultsDeferred.done(function(e){t.showingMoreResults=!0,t.displayThoseResults(e),t.updateElementVisibility(e.length)}),this.moreResultsDeferred.always(function(){t.moreResultsDeferred=void 0,t.waitAnimation.detach(),t.waitAnimation=void 0})},n.prototype.showLessResults=function(){this.cancelAnyPendingShowMore(),this.showingMoreResults=!1,this.displayThoseResults(this.result.childResults),this.updateElementVisibility(),this.scrollToResultElement()},n.prototype.buildElements=function(){this.buildHeader(),this.buildResults(),this.buildFooter()},n.prototype.buildHeader=function(){var t=e.$("<div/>").addClass("coveo-folding-header").appendTo(this.element);void 0!=this.options.normalCaption&&void 0!=this.options.expandedCaption&&(this.normalCaption=e.$("<div/>").addClass("coveo-folding-header-caption").text(this.options.normalCaption).appendTo(t),this.expandedCaption=e.$("<div/>").addClass("coveo-folding-header-caption").text(this.options.expandedCaption).appendTo(t)),this.onlyOneMessageCaption=e.$("<div/>").addClass("coveo-folding-header-caption").text(this.options.oneResultCaption).appendTo(t)},n.prototype.buildResults=function(){this.results=e.$("<div/>").addClass("coveo-folding-results").appendTo(this.element)},n.prototype.buildFooter=function(){var t=this,i=e.$("<div/>").addClass("coveo-folding-footer").appendTo(this.element.parentElement);if(this.result.moreResults){this.showMore=e.$("<div/>").addClass("coveo-folding-footer-section-for-less").appendTo(i).fastClick(function(){return t.showMoreResults()}),this.showLess=e.$("<div/>").addClass("coveo-folding-footer-section-for-more").appendTo(i).fastClick(function(){return t.showLessResults()});var n=e.$("<div><span class='coveo-folding-footer-icon'></span></div>").addClass("coveo-more"),o=e.$("<div><span class='coveo-folding-footer-icon'></span></div>").addClass("coveo-less"),s=e.$("<a/>").addClass("coveo-folding-show-more").text(this.options.moreCaption),r=e.$("<a/>").addClass("coveo-folding-show-less").text(this.options.lessCaption);this.showMore.append(s),this.showLess.append(r),this.showMore.append(n),this.showLess.append(o)}},n.prototype.updateElementVisibility=function(t){this.normalCaption&&this.normalCaption.fastToggle(!this.showingMoreResults&&this.result.childResults.length>0),this.expandedCaption&&this.expandedCaption.fastToggle(this.showingMoreResults),this.onlyOneMessageCaption.fastToggle(t&&1==t),this.showMore&&(this.showMore.fastToggle(!this.showingMoreResults&&!e.Utils.exists(this.moreResultsDeferred)),this.showLess.fastToggle(this.showingMoreResults)),e.$(this.element).find(".coveo-show-if-normal").fastToggle(!this.showingMoreResults),e.$(this.element).find(".coveo-show-if-expanded").fastToggle(this.showingMoreResults)},n.prototype.scrollToResultElement=function(){var i=e.$(this.element).closest(".CoveoResult").offset(),n=e.$(this.root).find("."+t.Component.computeCssClassNameForType(t.ResultList.ID)),o=!1;if(0!=n.length){var s=n.coveo(),r=s.options.mobileScrollContainer||s.options.infiniteScrollContainer,a=r.scrollHeight>e.$(r).height();a&&(o=!0,e.$(r).animate({scrollTop:r.scrollTop+i.top-(e.DeviceUtils.isMobileDevice()?50:0)}))}i.top<e.$(window).scrollTop()&&!o&&e.$("html, body").animate({scrollTop:i.top})},n.prototype.displayThoseResults=function(t){var i=this;this.results.empty(),e._.each(t,function(e){i.renderChildResult(e)})},n.prototype.renderChildResult=function(t){var i=e.$(this.options.resultTemplate.instantiateToElement(t)).addClass("coveo-child-result").appendTo(this.results);i.toggleClass("coveo-normal-child-result",!this.showingMoreResults),i.toggleClass("coveo-expanded-child-result",this.showingMoreResults),this.autoCreateComponentsInsideResult(i.get(0),t)},n.prototype.autoCreateComponentsInsideResult=function(i,n){e.Assert.exists(i);var o=this.searchInterface.options,s=e.$.extend({},{options:o},this.getBindings(),{result:n});t.CoveoJQuery.automaticallyCreateComponentsInside(i,s)},n.prototype.cancelAnyPendingShowMore=function(){this.moreResultsDeferred&&this.moreResultsDeferred.reject(),e.Assert.doesNotExists(this.moreResultsDeferred),e.Assert.doesNotExists(this.waitAnimation)},n.ID="ResultFolding",n.options={resultTemplate:t.ComponentOptions.buildTemplateOption({defaultFunction:function(){return new t.DefaultResultTemplate}}),normalCaption:t.ComponentOptions.buildLocalizedStringOption(),expandedCaption:t.ComponentOptions.buildLocalizedStringOption(),moreCaption:t.ComponentOptions.buildLocalizedStringOption({postProcessing:function(e){return e||t.l("ShowMore")}}),lessCaption:t.ComponentOptions.buildLocalizedStringOption({postProcessing:function(e){return e||t.l("ShowLess")}}),oneResultCaption:t.ComponentOptions.buildLocalizedStringOption({postProcessing:function(e){return e||t.l("DisplayingTheOnlyMessage")}})},n}(t.Component);t.ResultFolding=i,e.Ui.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){function t(e){void 0===e&&(e=navigator);var t;return t=-1!=e.appVersion.indexOf("Win")?0:-1!=e.appVersion.indexOf("Mac")?1:-1!=e.appVersion.indexOf("X11")?2:-1!=e.appVersion.indexOf("Linux")?3:4}!function(e){e[e.WINDOWS=0]="WINDOWS",e[e.MACOSX=1]="MACOSX",e[e.UNIX=2]="UNIX",e[e.LINUX=3]="LINUX",e[e.UNKNOWN=4]="UNKNOWN"}(e.NAME||(e.NAME={}));e.NAME;e.get=t}(t=e.OSUtils||(e.OSUtils={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r,a,l){i.call(this,o,n.ID,r),this.element=o,this.options=s,this.result=a,this.os=l,this.options=t.ComponentOptions.initComponentOptions(o,n,s),this.options=e.$.extend({},this.options,this.componentOptionsModel.get(e.Models.ComponentOptionsModel.attributesEnum.resultLink)),this.result=a||this.resolveResult(),e.Assert.exists(this.componentOptionsModel),e.Assert.exists(this.result),e.$(o).on("mousedown touchend",e.$.proxy(this.logOpenDocument,this)),this.bindOnClickIfNotUndefined()||this.bindOpenQuickViewIfNotUndefined()||this.setHrefIfNotAlready()||this.openLinkThatIsNotAnAnchor()}return __extends(n,i),n.prototype.bindOnClickIfNotUndefined=function(){var t=this;return void 0!=this.options.onClick?(e.$(this.element).fastClick(function(e){t.options.onClick.call(t,e,t.result)}),!0):!1},n.prototype.bindOpenQuickViewIfNotUndefined=function(){var t=this;return this.options.openQuickview?(e.$(this.element).fastClick(function(i){i.preventDefault();var n=e.$(t.element).parent().find(".CoveoQuickView .coveo-icon-for-quickview");0==n.length&&(n=e.$(t.element).closest(".CoveoQuickView .coveo-icon-for-quickview")),n.fastClick()}),!0):!1},n.prototype.openLinkThatIsNotAnAnchor=function(){var i=this;e.DeviceUtils.isPhonegap()?t.PhonegapUtils.bindOpenLinkInPhonegap(this.element,this.getResultUri()):this.elementIsAnAnchor()||e.$(this.element).fastClick(function(){i.options.alwaysOpenInNewWindow?i.options.openInOutlook&&i.hasOutlookField()?window.location.href=i.getResultUri():window.open(i.getResultUri(),"_blank"):window.location.href=i.getResultUri()})},n.prototype.setHrefIfNotAlready=function(){if(e.DeviceUtils.isPhonegap()&&this.elementIsAnAnchor()){var i=e.$(this.element).attr("href");return(void 0==i||""==i)&&(i=this.getResultUri()),e.$(this.element).removeAttr("href"),e.$(this.element).removeAttr("target"),t.PhonegapUtils.bindOpenLinkInPhonegap(this.element,i),!0}return this.elementIsAnAnchor()&&!e.Utils.isNonEmptyString(e.$(this.element).attr("href"))?(e.$(this.element).attr("href",this.getResultUri()),!this.options.alwaysOpenInNewWindow||this.options.openInOutlook&&this.hasOutlookField()||e.$(this.element).attr("target","_blank"),!0):!1},n.prototype.bindPhonegapClick=function(){e.DeviceUtils.isPhonegap()&&t.PhonegapUtils.bindOpenLinkInPhonegap(this.element,this.getResultUri())},n.prototype.logOpenDocument=function(){this.usageAnalytics.logClickEvent(t.AnalyticsActionCauseList.documentOpen,{documentURL:this.result.clickUri,documentTitle:this.result.title},this.result,this.root)},n.prototype.getResultUri=function(){return void 0==this.options.field&&this.options.openInOutlook&&this.setField(),void 0!=this.options.field?this.result.raw[e.Utils.getCoveoFieldKey(this.options.field)]:this.result.clickUri},n.prototype.elementIsAnAnchor=function(){return"A"==this.element.tagName},n.prototype.setField=function(){var t=e.Utils.exists(this.os)?this.os:e.OSUtils.get();1==t&&this.hasOutlookField()?this.options.field="@sysoutlookformacuri":0==t&&this.hasOutlookField()&&(this.options.field="@sysoutlookuri")},n.prototype.hasOutlookField=function(){var t=e.Utils.exists(this.os)?this.os:e.OSUtils.get();return 1==t&&void 0!=this.result.raw.sysoutlookformacuri?!0:0==t&&void 0!=this.result.raw.sysoutlookuri?!0:!1},n.ID="ResultLink",n.options={field:t.ComponentOptions.buildFieldOption(),openInOutlook:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),openQuickview:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),alwaysOpenInNewWindow:t.ComponentOptions.buildBooleanOption({defaultValue:!1})},n}(t.Component);t.ResultLink=i,t.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r){var a=this;i.call(this,o,n.ID,r),this.element=o,this.options=s,this.bindings=r,this.options=t.ComponentOptions.initComponentOptions(o,n,s),this.preferencePanel=e.$(this.element).parents("."+t.Component.computeCssClassNameForType(t.PreferencesPanel.ID)),this.preferencePanelLocalStorage=new e.LocalStorageUtils(n.ID),this.mergeLocalPreferencesWithStaticPreferences(),this.bindPreferencePanelEvent(),this.bindBreadcrumbEvent(),this.bindQueryEvent(),e.$(this.root).one(e.Events.InitializationEvents.afterComponentsInitialization,function(){a.createDom()});var l=this.queryStateModel.getEventName(e.Models.Model.eventTypes.changeOne+e.Models.QueryStateModel.attributesEnum.t);e.$(this.root).one(l,function(){a.fromPreferencesToCheckboxInput()})}return __extends(n,i),n.prototype.createDom=function(){this.buildTitle(),this.buildCheckboxesInput(),this.options.showAdvancedFilters&&this.buildAdvancedFilters()},n.prototype.save=function(){this.fromCheckboxInputToPreferences();var t=e._.omit(this.preferences,"tab");this.logger.info("Saving preferences",t),this.preferencePanelLocalStorage.save(t)},n.prototype.exitWithoutSave=function(){this.fromPreferencesToCheckboxInput()},n.prototype.bindPreferencePanelEvent=function(){var t=this;this.bind.on(this.preferencePanel,e.Events.PreferencesPanelEvents.savePreferences,function(){return t.save()}),this.bind.on(this.preferencePanel,e.Events.PreferencesPanelEvents.exitPreferencesWithoutSave,function(){return t.exitWithoutSave()})},n.prototype.bindBreadcrumbEvent=function(){this.options.includeInBreadcrumb&&(this.bind.onRoot(e.Events.BreadcrumbEvents.populateBreadcrumb,e.$.proxy(this.handlePopulateBreadcrumb,this)),this.bind.onRoot(e.Events.BreadcrumbEvents.clearBreadcrumb,e.$.proxy(this.handleClearBreadcrumb,this)))},n.prototype.bindQueryEvent=function(){this.bind.onRoot(e.Events.QueryEvents.buildingQuery,e.$.proxy(this.handleBuildingQuery,this))},n.prototype.handleBuildingQuery=function(t,i){e._.each(this.getActiveFilters(),function(e){i.queryBuilder.advancedExpression.add(e.expression)})},n.prototype.handlePopulateBreadcrumb=function(i,n){var o=this.getActiveFilters();if(e.Utils.isNonEmptyArray(o)){var s=e.$("<div/>").addClass("coveo-results-filter-preferences-breadcrumb");e.$("<span/>").addClass("coveo-title").text(t.l("FiltersInYourPreferences")+":").appendTo(s);for(var r=e.$("<span/>").addClass("coveo-values").appendTo(s),a=0;a<o.length;a++)0!=a&&e.$("<span/>").addClass("coveo-separator").text(", ").appendTo(r),this.buildBreadcrumb(o[a]).appendTo(r);n.breadcrumbs.push({element:s.get(0)})}},n.prototype.handleClearBreadcrumb=function(){e._.each(this.getActiveFilters(),function(e){e.selected=!1}),this.fromPreferencesToCheckboxInput()},n.prototype.buildTitle=function(){e.$(this.element).append(e.$("<div class='coveo-title'>"+t.l("ResultsFilteringExpression")+"</div>"))},n.prototype.buildAdvancedFilters=function(){var i=this;this.advancedFilters=e.$("<div>"+t.l("Create")+"</div>").addClass("coveo-advanced-filters"),this.buildAdvancedFilterInput(),this.buildAdvancedFilterFormValidate(),this.advancedFiltersBuilder=e.$("<div class='coveo-advanced-filters-builder'></div>"),this.advancedFiltersBuilder.append(this.advancedFilterFormValidate),this.advancedFilters.fastClick(function(){return i.openAdvancedFilterSectionOrSaveFilters()});var n=e.$("<a href='http://onlinehelp.coveo.com/en/ces/7.0/user/user_help.htm' target='_blank' class='coveo-online-help'>?</a>");e.$(this.element).find(".coveo-title").first().after(n,this.advancedFilters),e.$(this.element).append(this.advancedFiltersBuilder)},n.prototype.buildAdvancedFilterInput=function(){this.advancedFiltersTextInputCaption=new t.PreferencesPanelTextAreaInput([{label:t.l("Caption"),placeholder:t.l("EnterExpressionName"),otherAttribute:"required"}],n.ID+"-advanced-caption"),this.advancedFiltersTextInputExpression=new t.PreferencesPanelTextAreaInput([{label:t.l("Expression"),placeholder:t.l("EnterExpressionToFilterWith"),otherAttribute:"required"}],n.ID+"-advanced-expression"),this.advancedFiltersTabSelect=new t.PreferencePanelMultiSelectInput({label:t.l("Tab"),placeholder:t.l("SelectTab")},this.getAllTabs(),n.ID+"-multiselect")},n.prototype.buildAdvancedFilterFormValidate=function(){var t=this;this.advancedFilterFormValidate=e.$("<form></form>");var i=e.$("<input type='submit' />"),n=e.$("<span class='coveo-save'></span>"),o=e.$("<span class='coveo-close'></span>"),s=e.$("<div class='coveo-choice-container coveo-close-and-save'></div>").append(n,o);this.advancedFilterFormValidate.append(this.advancedFiltersTextInputCaption.build().addClass("coveo-caption"),this.advancedFiltersTabSelect.build().addClass("coveo-tab"),this.advancedFiltersTextInputExpression.build().addClass("coveo-expression"),s,i),n.fastClick(function(){i.click()}),o.fastClick(function(){t.advancedFiltersBuilder.toggleClass("coveo-active")}),this.advancedFilterFormValidate.find("textarea").keyup(function(e){13==e.keyCode&&i.click()}),this.advancedFilterFormValidate.submit(function(e){t.validateAndSaveAdvancedFilter(e)})},n.prototype.getAdvancedFiltersTextInputToBuild=function(){return[{label:t.l("Caption"),otherAttribute:"required"},{label:t.l("Expression"),otherAttribute:"required"}]},n.prototype.getAllTabs=function(){var i=t.Component.getComponentRef("Tab");if(i){var n=e.$(this.root).find("."+t.Component.computeCssClassNameForType(i.ID));return e._.map(n,function(t){var i=e.$(t).coveo();return i.options.uniqueId})}},n.prototype.getPreferencesBoxInputToBuild=function(){return e._.map(this.preferences,function(e){return{label:e.caption,tab:e.tab,expression:e.expression}})},n.prototype.buildCheckboxesInput=function(){var i=this;void 0!=this.preferenceContainer&&this.preferenceContainer.remove();var o=this.getPreferencesBoxInputToBuild();e.Utils.isNonEmptyArray(o)&&(this.preferencePanelCheckboxInput=new t.PreferencesPanelCheckboxInput(o,n.ID),this.preferenceContainer=e.$("<div class='coveo-choices-container'></div>"),this.preferenceContainer.append(this.preferencePanelCheckboxInput.build()),this.preferenceContainer.find(".coveo-choice-container").append("<div class='coveo-section coveo-section-edit-delete'></div>"),e.$(this.element).append(this.preferenceContainer),this.buildEditAdvancedFilter(),this.buildDeleteAdvancedFilter(),this.fromPreferencesToCheckboxInput(),this.preferenceContainer.find("input").change(function(t){i.save();var n=i.preferences[e.$(t.target).val()];i.fromFilterToAnalyticsEvent(n,n.selected?"selected":"unselected"),i.queryController.executeQuery()}))},n.prototype.buildDeleteAdvancedFilter=function(){var t=this;e._.each(this.preferences,function(i){if(i.custom){var n=e.$("<span class='coveo-delete'><span class='coveo-icon'></span></span>"),o=t.getFilterElementByCaption(i.caption),s=o.closest(".coveo-section").siblings(".coveo-section-edit-delete");n.appendTo(s),n.fastClick(function(){t.confirmDelete(i,o)})}})},n.prototype.buildEditAdvancedFilter=function(){var t=this;e._.each(this.preferences,function(i){if(i.custom){var n=e.$("<span class='coveo-edit'><span class='coveo-icon'></span></span>"),o=t.getFilterElementByCaption(i.caption),s=o.closest(".coveo-section").siblings(".coveo-section-edit-delete");n.appendTo(s),n.fastClick(function(){t.editElement(i,o)})}})},n.prototype.buildBreadcrumb=function(t){var i=this,n=e.$("<span/>").addClass("coveo-value");return e.$("<span/>").addClass("coveo-caption").text(t.caption).appendTo(n),e.$("<span/>").addClass("coveo-clear").appendTo(n),n.fastClick(function(){t.selected=!1,i.fromFilterToAnalyticsEvent(t,"cleared from breadcrumb"),i.fromPreferencesToCheckboxInput(),i.queryController.executeQuery()}),n},n.prototype.confirmDelete=function(e,i){confirm(t.l("AreYouSureDeleteFilter",e.caption,e.expression))&&(this.deleteFilterPreference(e,i),this.fromFilterToAnalyticsEvent(e,"deleted"),this.queryController.executeQuery())},n.prototype.editElement=function(e,t){var i=this.preferences[e.caption].caption,n=this.preferences[e.caption].tab,o=this.preferences[e.caption].expression;this.deleteFilterPreference(e,t),this.openAdvancedFilterSectionOrSaveFilters(),this.populateEditSection({tab:n,caption:i,expression:o}),this.advancedFiltersBuilder.find("input[type=text]").first().focus()},n.prototype.populateEditSection=function(e){void 0===e&&(e={tab:[""],caption:"",expression:""}),this.advancedFiltersTextInputCaption.setValue(t.l("Caption"),e.caption),this.advancedFiltersTextInputExpression.setValue(t.l("Expression"),e.expression),this.advancedFiltersTabSelect.setValues(e.tab)},n.prototype.deleteFilterPreference=function(e,t){this.preferencePanelLocalStorage.remove(e.caption),delete this.preferences[e.caption],t.closest(".coveo-choice-container").remove()},n.prototype.openAdvancedFilterSectionOrSaveFilters=function(){this.advancedFiltersBuilder.hasClass("coveo-active")?this.advancedFilterFormValidate.find("input[type=submit]").click():(this.populateEditSection(),this.advancedFiltersBuilder.toggleClass("coveo-active"))},n.prototype.validateAndSaveAdvancedFilter=function(t){t.preventDefault(),this.advancedFiltersBuilder.removeClass("coveo-active");var i=this.advancedFiltersTextInputCaption.getValues()[0],n=this.advancedFiltersTextInputExpression.getValues()[0],o=this.advancedFiltersTabSelect.getValues();this.preferences[i]={caption:i,custom:!0,expression:n,tab:o,selected:!0},this.buildCheckboxesInput(),this.save(),this.queryStateModel.set(e.Models.QueryStateModel.attributesEnum.t,this.getActiveTab()),this.advancedFiltersTextInputCaption.reset(),this.advancedFiltersTextInputExpression.reset(),this.advancedFiltersTabSelect.reset(),this.advancedFiltersBuilder.appendTo(this.element),this.fromFilterToAnalyticsEvent(this.preferences[i],"saved"),this.queryController.executeQuery()},n.prototype.fromPreferencesToCheckboxInput=function(){var t=this;e._.each(this.getActiveFilters(),function(e){t.preferencePanelCheckboxInput.select(e.caption)}),e._.each(this.getInactiveFilters(),function(e){t.preferencePanelCheckboxInput.unselect(e.caption)})},n.prototype.fromCheckboxInputToPreferences=function(){var t=this.preferencePanelCheckboxInput.getSelecteds();e._.each(this.preferences,function(i){i.selected=e._.contains(t,i.caption)?!0:!1})},n.prototype.getActiveFilters=function(){var t=this,i=this.getActiveTab();return e._.filter(this.preferences,function(e){return e.selected&&t.filterIsInActiveTab(e,i)})},n.prototype.getInactiveFilters=function(){var t=this,i=this.getActiveTab();return e._.filter(this.preferences,function(e){return!e.selected||!t.filterIsInActiveTab(e,i)})},n.prototype.getActiveTab=function(){return this.queryStateModel.get(e.Models.QueryStateModel.attributesEnum.t)},n.prototype.filterIsInActiveTab=function(t,i){return t.tab=e._.compact(t.tab),e._.contains(t.tab,i)||e.Utils.isEmptyArray(t.tab)},n.prototype.getFilterElementByCaption=function(e){return this.preferenceContainer.find("input[value='"+e+"']").parent()},n.prototype.fromResultsFilterOptionToResultsPreferenceInterface=function(t){void 0===t&&(t=this.options.filters);var i={};return e._.each(this.options.filters,function(e,t){i[t]={expression:e.expression,tab:e.tab,selected:!1,custom:!1,caption:t}}),i},n.prototype.mergeLocalPreferencesWithStaticPreferences=function(){var t=this.fromResultsFilterOptionToResultsPreferenceInterface(),i=this.preferencePanelLocalStorage.load(),n=e._.filter(i,function(i){var n=i.custom,o=e._.find(t,function(e){return e.caption==i.caption});return n||void 0!=o}),o={};e._.each(n,function(e){o[e.caption]={expression:e.expression,tab:e.tab,selected:e.selected,custom:e.custom,caption:e.caption}}),this.preferences=e.$.extend(!0,{},t,o)},n.prototype.fromFilterToAnalyticsEvent=function(e,i){this.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.customfiltersChange,{customFilterName:e.caption,customFilterExpression:e.expression,customFilterType:i})},n.ID="ResultsFiltersPreferences",n.options={includeInBreadcrumb:t.ComponentOptions.buildBooleanOption({defaultValue:!0}),showAdvancedFilters:t.ComponentOptions.buildBooleanOption({defaultValue:!0})},n}(t.Component);t.ResultsFiltersPreferences=i,t.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r){var a=this;i.call(this,o,n.ID,r),this.element=o,this.options=s,this.bindings=r,this.options=t.ComponentOptions.initComponentOptions(o,n,s),this.preferencePanel=e.$(this.element).parents("."+t.Component.computeCssClassNameForType(t.PreferencesPanel.ID)),this.preferencePanelLocalStorage=new e.LocalStorageUtils(n.ID),e.Assert.exists(this.componentOptionsModel),e.Assert.exists(window.localStorage),e.Assert.isLargerOrEqualsThan(1,this.preferencePanel.length),this.preferences=this.preferencePanelLocalStorage.load()||{},t.ComponentOptions.initComponentOptions(this.element,n,this.preferences),this.updateComponentOptionsModel(),this.bind.on(this.preferencePanel,e.Events.PreferencesPanelEvents.savePreferences,function(){return a.save()}),this.bind.on(this.preferencePanel,e.Events.PreferencesPanelEvents.exitPreferencesWithoutSave,function(){return a.exitWithoutSave()}),this.buildTitle(),this.buildCheckboxesInput()}return __extends(n,i),n.prototype.save=function(){this.fromCheckboxInputToPreferences(),this.logger.info("Saving preferences",this.preferences),this.preferencePanelLocalStorage.save(this.preferences),this.updateComponentOptionsModel()},n.prototype.exitWithoutSave=function(){this.fromPreferencesToCheckboxInput()},n.prototype.updateComponentOptionsModel=function(){this.componentOptionsModel.set(e.Models.ComponentOptionsModel.attributesEnum.resultLink,this.preferences)},n.prototype.buildTitle=function(){e.$(this.element).append(e.$("<div class='coveo-title'>"+t.l("LinkOpeningSettings")+"</div>"))},n.prototype.buildCheckboxesInput=function(){var i=this;this.preferencePanelCheckboxInput=new t.PreferencesPanelCheckboxInput([{label:t.l("OpenInOutlookWhenPossible")},{label:t.l("AlwaysOpenInNewWindow")}],n.ID);var o=e.$("<div class='coveo-choices-container'></div>");o.append(this.preferencePanelCheckboxInput.build()),o.find("input").change(function(e){i.fromPreferenceChangeEventToUsageAnalyticsLog(e),i.save(),i.queryController.executeQuery()}),e.$(this.element).append(o),this.fromPreferencesToCheckboxInput()},n.prototype.fromCheckboxInputToPreferences=function(){var i=this.preferencePanelCheckboxInput.getSelecteds();this.preferences={openInOutlook:!1,alwaysOpenInNewWindow:!1},e._.contains(i,t.l("OpenInOutlookWhenPossible"))&&(this.preferences.openInOutlook=!0),e._.contains(i,t.l("AlwaysOpenInNewWindow"))&&(this.preferences.alwaysOpenInNewWindow=!0)},n.prototype.fromPreferencesToCheckboxInput=function(){this.preferences.openInOutlook&&this.preferencePanelCheckboxInput.select(t.l("OpenInOutlookWhenPossible")),this.preferences.alwaysOpenInNewWindow&&this.preferencePanelCheckboxInput.select(t.l("AlwaysOpenInNewWindow"))},n.prototype.fromPreferenceChangeEventToUsageAnalyticsLog=function(i){var n=e.$(i.target).is(":checked")?"selected":"unselected",o=e.$(i.target).val();this.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.preferencesChange,{preferenceName:o,preferenceType:n})},n.ID="ResultsPreferences",n.options={showOpenInOutlook:t.ComponentOptions.buildBooleanOption({defaultValue:!0}),loadBooleanFromAttribute:t.ComponentOptions.buildBooleanOption({defaultValue:!0})},n}(t.Component);t.ResultsPreferences=i,t.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r,a,l){i.call(this,o,n.ID,r),this.element=o,this.options=s,this.result=a,this.os=l,this.options=t.ComponentOptions.initComponentOptions(o,n,s),this.options=e.$.extend({},this.options),this.result=a||this.resolveResult(),e.Assert.exists(this.componentOptionsModel),e.Assert.exists(this.result),this.options.field||this.logger.error("You must specify a field to the ResultTagging component"),this.tags=this.result.raw[e.Utils.getCoveoFieldKey(this.options.field)]||[],this.tagZone=e.$("<div></div>").addClass("coveo-tag-zone").appendTo(e.$(o)),e.$(o).append(this.buildTagIcon()),this.autoCompleteZone=e.$("<div></div>").addClass("coveo-auto-complete-zone").appendTo(e.$(o)),e.$(this.autoCompleteZone).append(this.buildTextBox()),e.$(this.autoCompleteZone).append(this.buildAddIcon()),e.$(this.autoCompleteZone).append(this.buildClearIcon()),this.buildExistingTags()
}return __extends(n,i),n.prototype.buildExistingTags=function(){var t=this;this.tags&&e._.each(this.tags,function(i){e.$(t.tagZone).append(t.buildTagValue(i))})},n.prototype.buildTagIcon=function(){var i=this,n=e.$("<div></div>").addClass("coveo-add-tag"),o=e.$("<span></span>").text(t.l("EnterTag")).addClass("coveo-add-tag-text");return n.append(e.$("<span></span>").addClass("coveo-add-tag-icon").fastClick(function(){return setTimeout(e.$.proxy(i.focusOnTextBox,i),20)})),n.append(o),n.attr("title",t.l("EnterTag")),n},n.prototype.focusOnTextBox=function(){this.textBox.focus()},n.prototype.buildTagValue=function(t){var i=this,n=e.$("<div></div>").addClass("coveo-tag");this.buildShortenedTagWithTitle(t).appendTo(n);var o=e.$("<span></span>").addClass("coveo-delete-icon").appendTo(n);return o.fastClick(function(){return i.doRemoveTag(n,t.toLowerCase())}),n},n.prototype.buildShortenedTagWithTitle=function(t){var i=e.StringUtils.removeMiddle(t,16,"..."),n=e.$("<a></a>").text(i).attr("title",t).attr("href","javascript:void;");return this.bindFacetEventOnValue(n,t),n},n.prototype.buildTextBox=function(){var i=this;return this.textBox=e.$("<input/>").attr("type","text").addClass("coveo-add-tag-textbox").attr("placeholder",t.l("EnterTag")),this.autoCompletePopup=e.$("<div></div>").addClass(n.AUTO_COMPLETE_CLASS).appendTo(e.$(this.autoCompleteZone)),this.manageAutocompleteAutoHide(),this.textBox.keyup(function(t){38==t.keyCode||40==t.keyCode||13==t.keyCode?i.manageUpDownEnter(t.keyCode):e.KeyboardUtils.isArrowKeyPushed(t.keyCode)||i.populateSuggestions(),e.$(i.element).removeClass("coveo-error")}),this.textBox.fastClick(function(){i.populateSuggestions()}),this.textBox},n.prototype.buildAddIcon=function(){var t=this;return e.$("<div></div>").addClass("coveo-add-tag-tick-icon").append(e.$("<span></span>")).fastClick(function(){return t.doAddTag()})},n.prototype.buildClearIcon=function(){var t=this;return e.$("<div></div>").addClass("coveo-clear-icon").append(e.$("<span></span>")).fastClick(function(){return t.textBox.val("")})},n.prototype.bindFacetEventOnValue=function(i,n){var o=this,s=e.Models.QueryStateModel.getFacetId(this.options.field),r=this.queryStateModel.get(s),a=this.componentStateModel.get(s),l=e._.filter(a,function(e){return!e.disabled}).length>0;null!=r&&l&&(e.$(i).on("click",function(){e._.contains(r,n)?o.queryStateModel.set(s,e._.without(r,n)):o.queryStateModel.set(s,e._.union(r,[n])),o.queryController.deferExecuteQuery({beforeExecuteQuery:function(){return o.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.documentTag,{facetId:o.options.field,facetValue:n})}})}),e._.contains(r,n)&&e.$(i).addClass("coveo-selected"),e.$(i).addClass("coveo-clickable"))},n.prototype.clearPopup=function(){this.autoCompletePopup.hide(),this.autoCompletePopup.empty()},n.prototype.showPopup=function(){this.autoCompletePopup.show()},n.prototype.populateSuggestions=function(){var t=this;this.autoCompletePopup.width(this.textBox.innerWidth());{var i=this.queryController.getEndpoint(),n=this.textBox.val(),o={field:this.options.field,ignoreAccents:!0,sortCriteria:"occurences",maximumNumberOfValues:this.options.suggestBoxSize,queryOverride:"@sysuri",pattern:this.buildRegEx(n),patternType:"RegularExpression"};i.listFieldValues(o).done(function(i){t.clearPopup(),e._.each(i,function(e){t.autoCompletePopup.append(t.buildSelectableValue(e.lookupValue))}),t.showPopup()})}},n.prototype.manageAutocompleteAutoHide=function(){var t,i=this;this.textBox.on("mouseover",function(){window.clearTimeout(t)}),this.autoCompletePopup.mouseout(function(o){e.$(o.target).hasClass(n.AUTO_COMPLETE_CLASS)&&(t=window.setTimeout(e.$.proxy(i.clearPopup,i),i.options.autoCompleteTimer))}),this.autoCompletePopup.mouseenter(function(){window.clearTimeout(t)}),e.$(this.element).mouseenter(function(){i.clearPopup(),e.$(i.element).addClass("coveo-opened")}),e.$(this.element).closest(".CoveoResult").mouseleave(function(){i.clearPopup(),""==i.textBox.val()&&e.$(i.element).removeClass("coveo-opened")}),e.$(this.element).closest(".CoveoResult").focusout(function(t){""!=i.textBox.val()&&e.$(t.target).closest(".CoveoResult")!=e.$(i.element).closest(".CoveoResult")&&e.$(i.element).addClass("coveo-error")}),e.$(this.element).closest(".CoveoResult").focusin(function(){e.$(i.element).removeClass("coveo-error")})},n.prototype.buildRegEx=function(t){var i=this;return"(?=.*"+t+")"+e._.map(this.tags,function(e){return i.buildTermToExclude(e)}).join("")+".*"},n.prototype.buildTermToExclude=function(e){return"(?!^"+e+"$)"},n.prototype.manageUpDownEnter=function(t){var i=e.$(this.element).find(".coveo-selectable");if(13==t)return this.doAddTag(),void 0;if(i.length>0){var n=this.computeNextIndex(t,i);n=Math.max(0,n),n=Math.min(i.length-1,n);var o=e.$(i.get(n));o.addClass("coveo-selected"),this.textBox.val(o.text())}},n.prototype.computeNextIndex=function(t,i){var n=0;return e._.each(i,function(i,o){e.$(i).hasClass("coveo-selected")&&(38==t?n=o-1:40==t&&(n=o+1),e.$(i).removeClass("coveo-selected"))}),n},n.prototype.buildSelectableValue=function(t){var i=this,n=e.$("<div></div>").append(this.buildShortenedTagWithTitle(t));return n.addClass("coveo-selectable"),n.fastClick(function(){i.doAddTagWithValue(t)}),n},n.prototype.doRemoveTag=function(t,i){var n=this,o={fieldName:this.options.field,fieldValue:i,doAdd:!1,uniqueId:this.result.uniqueId},s=this.queryController.getEndpoint().tagDocument(o);s.done(function(){n.tags.splice(e.$.inArray(i,n.tags),1),t.remove()})},n.prototype.doAddTagWithValue=function(t){var i=this;e._.each(t.split(","),function(e){i.doAddSingleTagValue(e)})},n.prototype.doAddSingleTagValue=function(t){var i=this;if(this.clearPopup(),e.$.inArray(t,this.tags)>-1)return e.$(this.element).addClass("coveo-error"),void 0;this.tags.push(t);var n={fieldName:this.options.field,fieldValue:t,doAdd:!0,uniqueId:this.result.uniqueId},o=this.queryController.getEndpoint().tagDocument(n);o.done(function(){i.tagZone.append(i.buildTagValue(t)),i.textBox.val(""),e.$(i.element).removeClass("coveo-error")}).fail(function(){i.tags=e._.without(i.tags,e._.findWhere(i.tags,t))})},n.prototype.doAddTag=function(){var e=this.textBox.val().toLowerCase().trim();this.doAddTagWithValue(e)},n.ID="ResultTagging",n.options={field:t.ComponentOptions.buildStringOption(),suggestBoxSize:t.ComponentOptions.buildNumberOption({defaultValue:5}),autoCompleteTimer:t.ComponentOptions.buildNumberOption({defaultValue:2e3})},n.AUTO_COMPLETE_CLASS="coveo-auto-complete",n}(t.Component);t.ResultTagging=i,t.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r){i.call(this,o,n.ID,r),this.element=o,this.options=s,this.options=t.ComponentOptions.initComponentOptions(o,n,s),e.$(this.root).on(e.Events.InitializationEvents.afterInitialization,e.$.proxy(this.init,this))}return __extends(n,i),n.prototype.init=function(){var t=this;this.menu=this.buildMenu(),e.$("<span/>").addClass("coveo-settings-icon").appendTo(this.element),e.$(this.element).fastClick(function(){t.toggleMenu()}),this.settingsButton=e.$(this.element);var i;e.$([this.settingsButton[0],this.menu[0]]).mouseleave(function(){i=setTimeout(function(){t.menu.detach()},t.options.menuDelay)}).mouseenter(function(){clearTimeout(i)})},n.prototype.buildMenu=function(){var t=e.$("<div/>").addClass("coveo-advanced-menu"),i=e._.map(this.options.includeInMenu,function(t){return e.$(t).coveo()});return t.append(this.buildSection(i)),t},n.prototype.buildSection=function(t){var i=this,n=e._.map(t,function(n){var o=e._.filter(t,function(t){return!e.Utils.objectEqual(t,n)});if(void 0!=n){var s=e.$("<div/>").addClass("coveo-section").addClass(n.getCssClass());e.$("<div/>").addClass("coveo-icon").appendTo(s);var r=e.$("<div>").addClass("coveo-items").appendTo(s);e._.each(n.getMenuItems(),function(t){var s=e._.filter(n.getMenuItems(),function(e){return e.text!=t.text});r.append(i.buildLine(t.text,t.onOpen,o,s))})}return s});return e._.reduce(n,function(e,t){return e.add(t)},e.$())},n.prototype.buildLine=function(t,i,n,o){var s=this,r=o.concat(e._.compact(e._.flatten(e._.map(n,function(e){return e?e.getMenuItems():void 0}),!0)));return e.$("<div/>").addClass("coveo-item").text(t).fastClick(function(){s.menu.detach(),i(),e._.invoke(r,"onClose")})},n.prototype.toggleMenu=function(){this.menu.is(":visible")?this.menu.detach():e.JQueryUtils.positionPopup(this.menu,e.$(this.element),e.$(this.root),e.$(this.root),this.getPopupPositioning())},n.prototype.getPopupPositioning=function(){return{horizontal:4,vertical:2,verticalOffset:8}},n.ID="Settings",n.options={includeInMenu:t.ComponentOptions.buildListOption({defaultValue:[]}),menuDelay:t.ComponentOptions.buildNumberOption({defaultValue:300})},n}(t.Component);t.Settings=i,t.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(t,o,s){i.call(this,t,n.ID,s),this.element=t,this.options=o,this.dialogBoxContent=this.buildContent(),e.$(t).append(this.dialogBoxContent),e.$(this.root).on(e.Events.QueryEvents.querySuccess,e.$.proxy(this.handleProcessNewQueryResults,this))}return __extends(n,i),n.prototype.open=function(){e.$("."+t.Component.computeMemberNameForType(n.ID)).height(137)},n.prototype.close=function(){e.$(this.element).height(0)},n.prototype.getCssClass=function(){return"coveo-share-query"},n.prototype.getMenuItems=function(){var e=this;return[{text:t.l("ShareQuery"),onOpen:function(){return e.open()},onClose:function(){return e.close()}}]},n.prototype.handleProcessNewQueryResults=function(t,i){e.Assert.exists(i),e.Assert.exists(i.results);var n=i.query;this.linkToThisQuery.val(window.location.href),this.completeQuery.val(e.$.trim(this.outputIfNotNull(n.q)+" "+this.outputIfNotNull(n.aq)+" "+this.outputIfNotNull(n.cq))),this.logger.trace("Received query results from new query",n)},n.prototype.outputIfNotNull=function(e){return e?"("+e+")":""},n.prototype.buildContent=function(){var i=this,n=e.$("<div/>").addClass("coveo-query-summary-info");n.append(e.$("<span/>").addClass("coveo-query-summary-info-title").text(t.l("ShareQuery")));var o=e.$("<div/>").addClass("coveo-query-summary-info-close").append("<span/>");o.fastClick(function(){return i.close()}),n.append(o);var s=e.$("<div/>").addClass("coveo-query-summary-info-boxes");return this.linkToThisQuery=e.$("<input/>").attr("type","text").addClass("coveo-query-summary-info-input"),this.linkToThisQuery.fastClick(function(){return i.linkToThisQuery.select()}),this.completeQuery=e.$("<input/>").attr("type","text").addClass("coveo-query-summary-info-input"),s.append(this.buildTextBoxWithLabel(t.l("Link")+":",this.linkToThisQuery)),s.append(this.buildTextBoxWithLabel(t.l("CompleteQuery")+":",this.completeQuery)),s.appendTo(n),t.Component.pointElementsToDummyForm(n),n},n.prototype.buildTextBoxWithLabel=function(t,i){var n=e.$("<span/>").addClass("coveo-query-summary-info-label").text(t);return e.$("<div/>").append(n).append(i)},n.create=function(t,i,o){return e.Assert.exists(t),new n(t,i,o)},n.ID="ShareQuery",n.options={},n}(t.Component);t.ShareQuery=i,t.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r){i.call(this,o,n.ID,r),this.element=o,this.options=s,this.options=t.ComponentOptions.initComponentOptions(o,n,s),e.Assert.isLargerOrEqualsThan(1,this.options.sortCriteria.length);var a=this.queryStateModel.getEventName(e.Models.Model.eventTypes.changeOne)+e.Models.QueryStateModel.attributesEnum.sort;e.$(this.root).on(a,e.$.proxy(this.handleQueryStateChanged,this)),e.$(this.root).on(e.Events.QueryEvents.buildingQuery,e.$.proxy(this.handleBuildingQuery,this)),this.bind.fastClick(e.$(this.element),this.handleClick),this.isToggle()&&e.$(this.element).append('<span class="coveo-icon" />'),this.updateAppearance()}return __extends(n,i),n.prototype.select=function(t,i){if(void 0===i&&(i=!1),t)this.currentCriteria=e._.find(this.options.sortCriteria,function(e){return e.direction==t});else if(e.Utils.exists(this.currentCriteria)){var n=e._.indexOf(this.options.sortCriteria,this.currentCriteria);e.Assert.check(n>=0),this.currentCriteria=this.options.sortCriteria[(n+1)%this.options.sortCriteria.length]}else this.currentCriteria=this.options.sortCriteria[0];this.queryStateModel.set(e.Models.QueryStateModel.attributesEnum.sort,this.currentCriteria.toString(),{silent:i})},n.prototype.disable=function(){e.$(this.element).addClass("coveo-tab-disabled"),i.prototype.disable.call(this)},n.prototype.enable=function(){e.$(this.element).removeClass("coveo-tab-disabled"),i.prototype.enable.call(this)},n.prototype.getCurrentCriteria=function(){return this.currentCriteria},n.prototype.handleQueryStateChanged=function(){var i=this.queryStateModel.get(e.Models.QueryStateModel.attributesEnum.sort);if(e.Utils.isNonEmptyString(i)){var n=t.SortCriteria.parse(i);this.currentCriteria=e._.find(this.options.sortCriteria,function(e){return n.equals(e)})}else this.currentCriteria=null;this.updateAppearance()},n.prototype.handleBuildingQuery=function(t,i){e.Assert.exists(i);var n=this.queryStateModel.get(e.Models.QueryStateModel.attributesEnum.sort);(n==e.Models.QueryStateModel.defaultAttributes.sort||this.isSelected())&&this.currentCriteria&&this.currentCriteria.putInQueryBuilder(i.queryBuilder)},n.prototype.handleClick=function(){var e=this,i=this.currentCriteria;this.select(),i!=this.currentCriteria&&this.queryController.deferExecuteQuery({beforeExecuteQuery:function(){return e.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.resultsSort,{resultsSortBy:e.currentCriteria.sort+e.currentCriteria.direction})}})},n.prototype.isToggle=function(){return this.options.sortCriteria.length>1},n.prototype.isSelected=function(){return e.Utils.exists(this.currentCriteria)},n.prototype.updateAppearance=function(){if(e.$(this.element).toggleClass("coveo-selected",this.isSelected()),this.isToggle()){var t=this.currentCriteria?this.currentCriteria.direction:this.options.sortCriteria[0].direction;e.$(this.element).toggleClass("coveo-ascending","ascending"==t)}},n.prototype.match=function(t){return e._.any(this.options.sortCriteria,function(e){return t==e.toString()})},n.ID="Sort",n.options={sortCriteria:t.ComponentOptions.buildCustomListOption(function(i){return e._.map(i,function(e){return t.SortCriteria.parse(e)})})},n}(t.Component);t.Sort=i,t.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r){i.call(this,o,t.ComponentOptions.initComponentOptions(o,n,s),r,n.ID),this.element=o,this.options=s,e.$(this.element).hide(),this.options.includeDemoSection&&this.buildAllDemo(),this.submit()}return __extends(n,i),n.prototype.getOrCreateContainerForDemo=function(){return this.demoContainer||(this.demoContainer=e.$("<div class='coveo-demo-section-container'></div>"),e.$(this.root).append(this.demoContainer)),this.demoContainer},n.prototype.buildAllDemo=function(){this.buildNewToCoveoSection(),this.buildDemoSection(),this.hideDemoSection()},n.prototype.buildDemoSection=function(){var i=this;this.demoCoveoSection=e.$("<div class='coveo-demo-section'></div>"),this.hideDemoSection();var n=e.$("<div class='coveo-demo-section-back-to-login'><span class='coveo-demo-section-arrow-backward'></span>"+t.l("GoBack")+"</div>");n.fastClick(function(){i.hideDemoSection()});var o=e.$("<div class='coveo-demo-section-logo'></div>"),s=e.$("<div class='coveo-demo-section-explanation'>"+t.l("AppIntro")+"</div>"),r=e.$("<button class='coveo-demo-section-try-it'>"+t.l("TryDemo")+"</button>");r.fastClick(function(){window.location.href="demo.html"});var a=e.$("<button class='coveo-demo-section-contact'>"+t.l("ContactUs")+"</button>");a.fastClick(function(){window.open("http://www.coveo.com/company/contact-us","_system")}),this.demoCoveoSection.append(n,o,s,r,a),this.getOrCreateContainerForDemo().append(this.demoCoveoSection)},n.prototype.buildNewToCoveoSection=function(){var i=this;this.newToCoveoSection=e.$("<div class='coveo-new-to-coveo-section'><h2>"+t.l("NewToCoveo")+"</h2><h3>"+t.l("LetUsHelpGetStarted")+"</h3><span class='coveo-demo-section-arrow-forward'></span></div>"),this.newToCoveoSection.fastClick(function(){return i.showDemoSection()}),this.getOrCreateCombined().append(this.newToCoveoSection)},n.prototype.showDemoSection=function(){this.getOrCreateContainerForDemo().addClass("coveo-active"),this.getOrCreateCombined().removeClass("coveo-active")},n.prototype.hideDemoSection=function(){this.getOrCreateContainerForDemo().removeClass("coveo-active"),this.getOrCreateCombined().addClass("coveo-active")},n.ID="StandaloneLogin",n.options={requirePageSettings:t.ComponentOptions.buildBooleanOption({defaultValue:!0}),includeDemoSection:t.ComponentOptions.buildBooleanOption({defaultValue:!0})},n}(t.Login);t.StandaloneLogin=i,t.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(){function i(i,n,o){this.searchInterface=i,this.result=o,this.element=n.instantiateToElement(o),e.$(this.element).data("CoveoResult",o),t.Component.bindResultToElement(this.element,o)}return i.prototype.initialize=function(){var i=this.searchInterface.options,n=e.$.extend({},{options:i},this.searchInterface.getBindings(),{result:this.result});t.CoveoJQuery.automaticallyCreateComponentsInside(this.element,n)},i}();t.StandaloneResult=i}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r){i.call(this,o,n.ID,r),this.options=s,this.menuIsOpen=!1,this.menuItemsContainerTemplate=e._.template("<div class='coveo-menu-item-container'></div>"),this.activeMenuItemTemplate=e._.template("<a class='coveo-menu-item-active'><%= itemIcon %><%= caption %><%= showMoreIcon %> </a>"),this.activeMenuItemIconTemplate=e._.template("<span class='coveo-icon <%= _class %>'></span>"),this.activeMenuItemCaptionTemplate=e._.template("<span class='coveo-caption'><%= text %></span>"),this.options=t.ComponentOptions.initComponentOptions(o,n,s),this.initQueryStateEvents(),this.initMiscEvents()}return __extends(n,i),n.prototype.open=function(){this.renderMenu(),this.menuItemsContainer.css("min-width",this.activeMenuItemDisplay.outerWidth()),this.menuItemsContainer.show(),this.activeMenuItemDisplay.addClass("coveo-menu-open"),this.menuIsOpen=!0},n.prototype.close=function(){this.menuItemsContainer.hide(),this.activeMenuItemDisplay.removeClass("coveo-menu-open"),this.menuIsOpen=!1},n.prototype.handleClick=function(e){this.targetIsAMenuItem(e)?this.handleClickOnMenuItem(e):this.handleClickOnMenu()},n.prototype.handleClickOnMenuItem=function(e){var i=t.Component.get(this.getCorrectTarget(e).get(0),t.TabGroup);this.selectMenuItem(this.getItemInMenuById(i.getId())),this.close(),this.queryController.deferExecuteQuery()},n.prototype.handleClickOnMenu=function(){this.menuIsOpen?this.close():this.open()},n.prototype.handleMouseLeave=function(){this.close()},n.prototype.handleAfterInitialization=function(){this.initMenuItems();var t=this.queryStateModel.get(e.Models.QueryStateModel.attributesEnum.tg);this.selectMenuItem(this.getItemInMenuById(t))},n.prototype.handleQueryStateChange=function(t,i){e.Assert.exists(i),this.selectMenuItem(this.getItemInMenuById(i.value))},n.prototype.initMenuItems=function(){var i=this;this.menuItemsContainer=e.$(this.menuItemsContainerTemplate()).hide(),this.activeMenuItemDisplay=e.$("<div></div>"),e.$(this.element).append(this.activeMenuItemDisplay,this.menuItemsContainer),this.menuItems=e._.map(e.$(this.element).find("."+t.Component.computeCssClassNameForType(t.TabGroup.ID)),function(t){return i.menuItemsContainer.append(t),{tabGroup:e.$(t).coveo(),element:e.$(t)}})},n.prototype.initQueryStateEvents=function(){var t=this.queryStateModel.getEventName(e.Models.Model.eventTypes.changeOne+e.Models.QueryStateModel.attributesEnum.tg);e.$(this.root).on(t,e.$.proxy(this.handleQueryStateChange,this))},n.prototype.initMiscEvents=function(){var t=this;e.$(this.root).on(e.Events.InitializationEvents.afterInitialization,function(){return t.handleAfterInitialization()}),e.$(this.element).fastClick(function(e){t.handleClick(e)}),e.$(this.element).mouseleave(function(e){setTimeout(function(){t.handleMouseLeave(e)},t.options.menuDelay)})},n.prototype.renderDisplayActiveMenuItem=function(){this.activeMenuItemDisplay.empty(),this.activeMenuItemDisplay.html(this.activeMenuItemTemplate({itemIcon:this.activeMenuItemIconTemplate({_class:this.activeMenuItem.tabGroup.getIcon()}),caption:this.activeMenuItemCaptionTemplate({text:this.activeMenuItem.tabGroup.getTitle()}),showMoreIcon:this.activeMenuItemIconTemplate({_class:"coveo-show-more"})}))},n.prototype.renderMenu=function(){e._.each(this.getInactiveMenuItems(),function(e){e.element.show()}),this.activeMenuItem.element.hide()},n.prototype.selectMenuItem=function(e){void 0!=this.menuItems&&(void 0==e&&(e=this.menuItems[0]),this.activeMenuItem=e,this.activeMenuItem.tabGroup.select(),this.renderDisplayActiveMenuItem())},n.prototype.getItemInMenuById=function(t){return e._.find(this.menuItems,function(e){return e.tabGroup.getId()==t})},n.prototype.getItemInMenuByElement=function(t){return e._.find(this.menuItems,function(i){return e.Utils.objectEqual(t,i.element)})},n.prototype.getInactiveMenuItems=function(){var t=this;return e._.reject(this.menuItems,function(i){return e.Utils.objectEqual(i,t.activeMenuItem)})},n.prototype.getItemMenuClass=function(){return t.Component.computeCssClassNameForType(t.TabGroup.ID)},n.prototype.getCorrectTarget=function(t){return e.$(t.target).parent().hasClass(this.getItemMenuClass())?e.$(t.target).parent():e.$(t.target)},n.prototype.targetIsAMenuItem=function(e){return this.getCorrectTarget(e).hasClass(this.getItemMenuClass())},n.ID="TabGroupMenu",n.options={menuDelay:t.ComponentOptions.buildNumberOption({defaultValue:300})},n}(t.Component);t.TabGroupMenu=i,e.Ui.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r){i.call(this,o,n.ID,r),this.options=s,this.isSelected=!1,this.iconTemplate=e._.template("<span class='coveo-icon <%= _class %>'></span>"),this.options=t.ComponentOptions.initComponentOptions(o,n,s),this.title=e.$(this.element).text(),this.initQueryEvents(),this.initQueryStateEvents(),e.$(this.element).prepend(this.iconTemplate({_class:this.options.icon}))}return __extends(n,i),n.prototype.select=function(){this.actionOnSelect(),this.updateQueryStateModel()},n.prototype.getTitle=function(){return this.title},n.prototype.getIcon=function(){return this.options.icon},n.prototype.getId=function(){return this.options.id},n.prototype.actionOnSelect=function(){this.hideTabsNotInThisGroup(),this.isSelected=!0},n.prototype.actionOnUnSelect=function(){this.isSelected=!1},n.prototype.updateQueryStateModel=function(){this.queryStateModel.set(e.Models.QueryStateModel.attributesEnum.tg,this.options.id)},n.prototype.initQueryEvents=function(){e.$(this.root).on(e.Events.QueryEvents.buildingQuery,e.$.proxy(this.handleBuildingQueryEvents,this))},n.prototype.initQueryStateEvents=function(){var t=this.queryStateModel.getEventName(e.Models.Model.eventTypes.changeOne+e.Models.QueryStateModel.attributesEnum.tg);e.$(this.root).on(t,e.$.proxy(this.handleQueryStateChange,this))},n.prototype.handleBuildingQueryEvents=function(t,i){e.Assert.exists(i),this.isSelected&&e.Utils.isNonEmptyString(this.options.expression)&&i.queryBuilder.advancedExpression.add(this.options.expression)},n.prototype.handleQueryStateChange=function(t,i){e.Assert.exists(i),i.value==this.options.id?this.actionOnSelect():this.actionOnUnSelect()},n.prototype.hideTabsNotInThisGroup=function(){var t=this,i=this.getAllTabs();e._.each(i,function(e){t.isElementIncludedInTabGroup(e.element)?e.enable():e.disable()})},n.prototype.getAllVisibleTab=function(){return e._.filter(this.getAllTabs(),function(t){return e.$(t.element).is(":visible")})},n.prototype.getAllTabs=function(){return this.searchInterface.components(t.Tab.ID)},n.prototype.isElementIncludedInTabGroup=function(t){var i=e.$(t).attr("data-tab-group");return void 0==i||e._.contains(i.split(","),this.options.id)},n.ID="TabGroup",n.options={id:t.ComponentOptions.buildStringOption(),icon:t.ComponentOptions.buildIconOption(),expression:t.ComponentOptions.buildStringOption()},n}(t.Component);t.TabGroup=i,e.Ui.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r){var a=this;i.call(this,o,n.ID,r),this.element=o,this.options=s,this.options=t.ComponentOptions.initComponentOptions(o,n,s),e.Assert.exists(o),e.Assert.exists(this.options),this.classToToggle=this.options.toggleClass,this.target=this.options.target,this.activateGlass=this.options.activateGlass,this.activateGlass&&this.buildGlass(),e.$(o).fastClick(function(){return a.handleClick()}),"A"==o.tagName&&e.$(o).attr("href","javascript:");var l=this.queryStateModel.getEventName(e.Models.Model.eventTypes.changeOne+e.Models.QueryStateModel.attributesEnum.t);this.bind.onRoot(l,this.handleTabChanged)}return __extends(n,i),n.prototype.handleClick=function(){e.$("."+this.target).hasClass(this.classToToggle)?this.removeToggleClass():this.addToggleClass()},n.prototype.handleTabChanged=function(){this.removeToggleClass()},n.prototype.addToggleClass=function(){e.MobileUtils.addToggleClassOnSearchInterface(this.classToToggle.substr(6),e.DeviceUtils.isPhonegap())},n.prototype.removeToggleClass=function(){e.MobileUtils.removeToggleClassOnSearchInterface(e.DeviceUtils.isPhonegap())},n.prototype.getGlass=function(){return e.$(".coveo-glass")},n.prototype.buildGlass=function(){if(0==this.getGlass().length){var i=e.$("<div></div>").addClass("coveo-glass");i.fastClick(function(){e.MobileUtils.removeToggleClassOnSearchInterface()});var n=e.$("."+t.Component.computeCssClassNameForType(t.SearchInterface.ID));e.$(n).append(i)}},n.ID="ToggleButton",n.options={toggleClass:t.ComponentOptions.buildStringOption(),target:t.ComponentOptions.buildStringOption(),activateGlass:t.ComponentOptions.buildBooleanOption({defaultValue:!0})},n}(t.Component);t.ToggleButton=i,t.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r){i.call(this,o,n.ID,r),this.options=s,this.topAnalyticsElementHeaderTemplate=e._.template("<div class='coveo-top-analytics-suggestion-header'>        <span class='coveo-icon-top-analytics'></span>         <span class='coveo-caption'><%= headerTitle %></span>       </div>"),this.topAnalyticsElementRowTemplate=e._.template("<div class='coveo-omnibox-selectable coveo-top-analytics-suggestion-row'>         <%= data %>       </div>"),null==this.options.omniboxSuggestionOptions&&(this.options.omniboxSuggestionOptions={}),t.ComponentOptions.initComponentOptions(o,n,this.options.omniboxSuggestionOptions),this.options.omniboxSuggestionOptions.onSelect=this.options.omniboxSuggestionOptions.onSelect||this.onRowSelection;var a={header:{template:this.topAnalyticsElementHeaderTemplate,title:this.options.omniboxSuggestionOptions.headerTitle},row:this.topAnalyticsElementRowTemplate};this.suggestionForOmniBox=new t.SuggestionForOmniBox(a,e.$.proxy(this.options.omniboxSuggestionOptions.onSelect,this)),e.$(this.root).on(e.Events.OmniBoxEvents.populateOmniBox,e.$.proxy(this.handlePopulateOmnibox,this))}return __extends(n,i),n.prototype.handlePopulateOmnibox=function(t,i){var n=this;if(e.Assert.exists(i),!this.disabled){var o=e.$.Deferred(),s=this.usageAnalytics.getTopQueries({pageSize:this.options.omniboxSuggestionOptions.numberOfSuggestions,queryText:i.completeQueryExpression.word});s.done(function(t){var s=e._.map(t,function(e){return{value:e}}),r=n.suggestionForOmniBox.buildOmniBoxElement(s,i);o.resolve({element:void 0==r?void 0:r.get(0),zIndex:n.options.omniboxSuggestionOptions.omniboxZIndex})}),s.fail(function(){n.resolveWithUndefined(o)}),i.rows.push({deferred:o})}},n.prototype.onRowSelection=function(i,n){var o=this;n.clear(),n.closeOmniBox(),this.queryStateModel.set(e.Models.QueryStateModel.attributesEnum.q,i),this.queryController.deferExecuteQuery({beforeExecuteQuery:function(){return o.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.omniboxAnalytics,{})}})},n.prototype.resolveWithUndefined=function(e){e.resolve({element:void 0})},n.ID="TopAnalyticsSuggestions",n.options={omniboxZIndex:t.ComponentOptions.buildNumberOption({defaultValue:52}),headerTitle:t.ComponentOptions.buildLocalizedStringOption({defaultValue:t.l("SuggestedQueries")}),numberOfSuggestions:t.ComponentOptions.buildNumberOption({defaultValue:5})},n}(e.Ui.Component);t.TopAnalyticsSuggestions=i,e.Ui.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var i=function(i){function n(o,s,r){i.call(this,o,n.ID,r),this.options=s,this.topFieldElementHeaderTemplate=e._.template("<div class='coveo-top-field-suggestion-header'>        <span class='coveo-icon-top-field'></span>         <span class='coveo-caption'><%= headerTitle %></span>       </div>"),this.topFieldElementRowTemplate=e._.template("<div class='coveo-omnibox-selectable coveo-top-field-suggestion-row'>         <%= data %>       </div>"),this.options=t.ComponentOptions.initComponentOptions(o,n,s),e.Assert.check(e.Utils.isCoveoField(this.options.field),this.options.field+" is not a valid field"),this.options.onSelect=this.options.onSelect||this.onRowSelection;var a={header:{template:this.topFieldElementHeaderTemplate,title:this.options.headerTitle},row:this.topFieldElementRowTemplate};this.suggestionForOmniBox=new t.SuggestionForOmniBox(a,e.$.proxy(this.options.onSelect,this)),e.$(this.root).on(e.Events.OmniBoxEvents.populateOmniBox,e.$.proxy(this.handlePopulateOmniBox,this))}return __extends(n,i),n.prototype.handlePopulateOmniBox=function(t,i){var n=this;if(e.Assert.exists(i),!this.disabled){var o=i.completeQueryExpression.word,s=e.$.Deferred(),r=this.queryController.getEndpoint().listFieldValues(this.buildListFieldValueRequest(o));r.done(function(e){var t=n.suggestionForOmniBox.buildOmniBoxElement(e,i);s.resolve({element:void 0==t?void 0:t.get(0),zIndex:n.options.omniboxZIndex})}),r.fail(function(){n.resolveWithUndefined(s)}),i.rows.push({deferred:s})}},n.prototype.resolveWithUndefined=function(e){e.resolve({element:void 0})},n.prototype.onRowSelection=function(i,n){var o=this;n.clear(),n.closeOmniBox(),this.queryStateModel.set(e.Models.QueryStateModel.attributesEnum.q,i),this.queryController.deferExecuteQuery({beforeExecuteQuery:function(){return o.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.omniboxField,{})}})},n.prototype.buildListFieldValueRequest=function(e){return{field:this.options.field,ignoreAccents:!0,sortCriteria:"occurrences",maximumNumberOfValues:this.options.numberOfSuggestions,patternType:"Wildcards",pattern:"*"+e+"*",queryOverride:this.options.queryOverride}},n.ID="TopFieldSuggestions",n.options={field:t.ComponentOptions.buildFieldOption({required:!0}),queryOverride:t.ComponentOptions.buildStringOption({defaultValue:""}),omniboxZIndex:t.ComponentOptions.buildNumberOption({defaultValue:51}),headerTitle:t.ComponentOptions.buildLocalizedStringOption({defaultValue:t.l("SuggestedResults")}),numberOfSuggestions:t.ComponentOptions.buildNumberOption({defaultValue:5})},n}(e.Ui.Component);t.TopFieldSuggestions=i,e.Ui.CoveoJQuery.registerAutoCreateComponent(i)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));
Coveo.Logger.disable();