var secretFeatureVariable1309=!1,Coveo;!function(e){e.version={lib : "0.9.993.8",product:"0.0.0.0"}}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){function n(){for(var t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];return e.L10N.format.apply(this,arguments)}t.l=n}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={})),function(){var e={Unknown:"Unknown",And:"AND",Authenticating:"Authenticating {0}...",Clear:"Clear {0}",CompleteQuery:"Complete Query",Exclude:"Exclude {0}",EnterTag:"Add Tag",Next:"Next",Last:"Last",Link:"Link",Or:"OR",Previous:"Previous",QueryDidntMatchAnyDocuments:"Your query did not match any documents.",QueryException:"Your query has an error: {0}.",Me:"Me",Remove:"Remove",Search:"Search",SearchFor:"Search for {0}",ShareQuery:"Share Query",Preferences:"Preferences",LinkOpeningSettings:"Link Opening Settings",Reauthenticate:"Reauthenticate {0}",ResultsFilteringExpression:"Results Filtering Expressions",FiltersInYourPreferences:"Filters in your preferences",Create:"Create",SearchIn:"Search in {0}",Seconds:"in {0} second<pl>s</pl>",ShowingResultsOf:"Result<pl>s</pl> {0}<pl>-{1}</pl> of {2}",SwitchTo:"Switch to {0}",Unexclude:"Unexclude {0}",ClearAllFilters:"Clear All Filters",SkipLogin:"Skip login",LoginInProgress:"Login in progress, please wait ...",Login:"Log In",GetStarted:"Get Started",More:"More",Less:"Fewer",Settings:"Settings",Score:"Score",ScoreDescription:"The score is computed from the number of occurrences as well as from the position in the result set.",Occurrences:"Occurrences",OccurrencesDescription:"Sort by number of occurrences, with values having the highest number appearing first.",Label:"Label",Of:"of",LabelDescription:"Sort alphabetically on the field values.",Value:"Value",ValueDescription:"Sort on the values of the first computed field",AlphaAscending:"Value Ascending",AlphaDescending:"Value Descending",ChiSquare:"Chi Square",Nosort:"No Sort",RelativeFrequency:"Relative Frequency",RelativeFrequencyDescription:"Sort based on the relative frequency of values. Less common values will appear higher",Custom:"Custom",CustomDescription:"Sort based on a custom order",ComputedField:"Computed Field",Ascending:"Ascending",Descending:"Descending",noResultFor:"No results for {0}",autoCorrectedQueryTo:"Query was automatically corrected to {0}",didYouMean:"Did you mean: {0}",SuggestedResults:"Suggested Results",SuggestedQueries:"Suggested Queries",MostRelevantItems:"Most relevant items:",AllItems:"All items:",ShowLess:"Show less",ShowMore:"Show more",HideFacet:"Hide Facet",ShowFacet:"Show Facet",AndOthers:"and {0} other<pl>s</pl>",MostRelevantPosts:"Most Relevant Posts:",CompleteThread:"Complete Thread:",ShowCompleteThread:"Show Complete Thread",ShowOnlyTopMatchingPosts:"Show Only Top Matching Posts",MostRelevantReplies:"Most Relevant Replies:",AllConversation:"All Conversation:",ShowAllConversation:"Show All Conversation",ShowAllReplies:"Show All Replies",ShowOnlyMostRelevantReplies:"Show Only Most Relevant Replies",Close:"Close",Open:"Open",OpenInOutlookWhenPossible:"Open in Outlook (when possible)",AlwaysOpenInNewWindow:"Always open results in new window",QuickView:"Quick View",ErrorReport:"Error Report",OopsError:"Oops! Something went wrong on the server.",ProblemPersists:"If the problem persists contact the administrator.",GoBack:"Go Back",Reset:"Reset",Retry:"Retry",MoreInfo:"More Information",Username:"Username",Password:"Password",CannotConnect:"Cannot connect to the server address.",BadUserPass:"Password does not match with user name.",PleaseEnterYourCredentials:"Please enter your credentials for {0}.",PleaseEnterYourSearchPage:"Please enter your search page URL",Collapse:"Collapse",Expand:"Expand",Today:"Today",Yesterday:"Yesterday",Tomorrow:"Tomorrow",Duration:"Duration: {0}",IndexDuration:"Index Duration: {0}",ProxyDuration:"Proxy Duration: {0}",ClientDuration:"Client Duration: {0}",Unavailable:"Unavailable",Reply:"Reply",ReplyAll:"Reply All",Forward:"Forward",From:"From",Caption:"Caption",Expression:"Expression",Tab:"Tab",Tabs:"Tabs",EnterExpressionName:"Enter Expression Name",EnterExpressionToFilterWith:"Enter Expression To Filter Results With",SelectTab:"Select Tab",SelectAll:"Select All",PageUrl:"Search page URL",ErrorSavingToDevice:"Error while saving the information to your device",ErrorReadingFromDevice:"Error while reading the information from your device",AppIntro:"Speak with a product specialist who can answer your questions about Coveo and help your decide which Coveo solution is right for you. Or, try a live demo !",TryDemo:"Try the demo",ContactUs:"Contact us",NewToCoveo:"New to Coveo ?",LetUsHelpGetStarted:"Let us help you get started",CannotConnectSearchPage:"Cannot connect to your search page",AreYouSureDeleteFilter:"Are you sure you want to delete the filter {0} with the expression {1}",OnlineHelp:"Online Help",Done:"Done",SaveFacetState:"Save this facet state",ClearFacetState:"Clear facet state",DisplayingTheOnlyMessage:"Displaying the only message in this conversation",NoNetworkConnection:"No network connection",UnknownConnection:"Unknown connection",EthernetConnection:"Ethernet connection",WiFi:"WiFi connection",CELL:"Cellular connection",CELL_2G:"Cellular 2G connection",CELL_3G:"Cellular 3G connection",CELL_4G:"Cellular 4G connection",QueryExceptionNoException:"No exception",QueryExceptionInvalidSyntax:"Invalid syntax",QueryExceptionInvalidCustomField:"Invalid custom field",QueryExceptionInvalidDate:"Invalid date",QueryExceptionInvalidExactPhrase:"Invalid exact phrase",QueryExceptionInvalidDateOp:"Invalid date operator",QueryExceptionInvalidNear:"Invalid Near",QueryExceptionInvalidWeightedNear:"Invalid weighted near",QueryExceptionInvalidTerm:"Invalid term",QueryExceptionTooManyTerms:"Too many terms",QueryExceptionWildcardTooGeneral:"Wildcard too general",QueryExceptionInvalidSortField:"Invalid sort field",QueryExceptionInvalidSmallStringOp:"Invalid small string operator",QueryExceptionRequestedResultsMax:"Requested results maximum",QueryExceptionAggregatedMirrorDead:"Aggregated mirror is offline",QueryExceptionAggregatedMirrorQueryTimeOut:"Aggregated mirror query timeout",QueryExceptionAggregatedMirrorInvalidBuildNumber:"Aggregated mirror invalid build number",QueryExceptionAggregatedMirrorCannotConnect:"Aggregated mirror cannot connect",QueryExceptionNotEnoughLeadingCharsWildcard:"Not enough leading character wildcard",QueryExceptionSecurityInverterNotFound:"Security inverter not found",QueryExceptionSecurityInverterAccessDenied:"Security inverter access denied",QueryExceptionAggregatedMirrorCannotImpersonate:"Aggregated mirror cannot impersonate",QueryExceptionUnexpected:"Unexpected",QueryExceptionAccessDenied:"Access denied",QueryExceptionSuperUserTokenInvalid:"Super user token invalid",QueryExceptionSuperUserTokenExpired:"Super user token is expired",QueryExceptionLicenseQueriesExpired:"Queries license expired",QueryExceptionLicenseSuperUserTokenNotSupported:"License super user token not supported",QueryExceptionInvalidSession:"Invalid session",QueryExceptionInvalidDocument:"Invalid document",QueryExceptionSearchDisabled:"Search disabled",objecttype_people:"People",objecttype_message:"Message",objecttype_feed:"RSS Feed",objecttype_thread:"Thread",objecttype_board:"",objecttype_category:"",objecttype_account:"Account",objecttype_campaign:"Campaign",objecttype_case:"Case",objecttype_contact:"Contact",objecttype_contract:"Contract",objecttype_event:"Event",objecttype_lead:"Lead",objecttype_solution:"Solution",objecttype_task:"Task",objecttype_user:"User",objecttype_attachment:"Attachment",objecttype_casecomment:"Case Comment",objecttype_opportunity:"Opportunity",objecttype_note:"Note",objecttype_product:"Product",objecttype_partner:"Partner",objecttype_kbdocumentation:"Documentation",objecttype_kbsolution:"Solution",objecttype_kbknowledgearticle:"Knowledge Article",objecttype_kbattachment:"Attachment",sysfiletype_html:"HTML File",sysfiletype_image:"Image",sysfiletype_folder:"Folder",sysfiletype_txt:"Text",sysfiletype_zip:"Zip File",sysfiletype_pdf:"PDF File",sysfiletype_xml:"XML File",sysfiletype_doc:"Word Document",sysfiletype_xls:"Excel Document",sysfiletype_ppt:"PowerPoint Document",sysfiletype_video:"Video",sysfiletype_exchangemessage:"Message",sysfiletype_exchangeappointment:"Appointment",sysfiletype_exchangenote:"Note",sysfiletype_exchangetask:"Task",sysfiletype_exchangeperson:"Exchange user",sysfiletype_activedirperson:"Active Directory user",sysfiletype_exchangeactivity:"Activity",sysfiletype_exchangecalendarmessage:"Calendar message",sysfiletype_exchangedocument:"Exchange document",sysfiletype_exchangerssfeed:"RSS Feed",sysfiletype_exchangejunkmessage:"Junk email",sysfiletype_exchangeofficecom:"Communications",sysfiletype_spportal:"Portal",sysfiletype_spsite:"Site",sysfiletype_spuserprofile:"SharePoint User",sysfiletype_sparea:"Area",sysfiletype_spannouncement:"Announcement",sysfiletype_spannouncementlist:"Announcements",sysfiletype_spcontact:"Contact",sysfiletype_spcontactlist:"Contacts",sysfiletype_spcustomlist:"Custom Lists",sysfiletype_spdiscussionboard:"Discussion Board",sysfiletype_spdiscussionboardlist:"Discussion Boards",sysfiletype_spdocumentlibrarylist:"Document Library",sysfiletype_spevent:"Event",sysfiletype_speventlist:"Events",sysfiletype_spformlibrarylist:"Form Library",sysfiletype_spissue:"Issue",sysfiletype_spissuelist:"Issues",sysfiletype_splink:"Link",sysfiletype_splinklist:"Links",sysfiletype_sppicturelibrarylist:"Picture Library",sysfiletype_spsurvey:"Survey",sysfiletype_spsurveylist:"Surveys",sysfiletype_sptask:"Task",sysfiletype_sptasklist:"Tasks",sysfiletype_spagenda:"Agenda",sysfiletype_spagendalist:"Agendas",sysfiletype_spattendee:"Attendee",sysfiletype_spattendeelist:"Attendees",sysfiletype_spcustomgridlist:"Custom Grids",sysfiletype_spdecision:"Decision",sysfiletype_spdecisionlist:"Decisions",sysfiletype_spobjective:"Objective",sysfiletype_spobjectivelist:"Objectives",sysfiletype_sptextbox:"Textbox",sysfiletype_sptextboxlist:"Textbox list",sysfiletype_spthingstobring:"Thing To Bring",sysfiletype_spthingstobringlist:"Things To Bring",sysfiletype_sparealisting:"Area Listing",sysfiletype_spmeetingserie:"Meeting series",sysfiletype_spmeetingserielist:"Meeting Series List",sysfiletype_spsitedirectory:"Site Directory Item",sysfiletype_spsitedirectorylist:"Site Directory",sysfiletype_spdatasource:"Data Source",sysfiletype_spdatasourcelist:"Data Source List",sysfiletype_splisttemplatecataloglist:"List Template Catalog List",sysfiletype_spwebpartcataloglist:"WebPart catalog list",sysfiletype_spwebtemplatecataloglist:"Web Template Catalog List",sysfiletype_spworkspacepagelist:"Workspace Page List",sysfiletype_spunknownlist:"Custom List",sysfiletype_spadministratortask:"Administrator Task",sysfiletype_spadministratortasklist:"Administrator Tasks",sysfiletype_spareadocumentlibrarylist:"Area Document Library",sysfiletype_spblogcategory:"Blog Category",sysfiletype_spblogcategorylist:"Blog Category",sysfiletype_spblogcomment:"Blog Comment",sysfiletype_spblogcommentlist:"Blog Comments",sysfiletype_spblogpost:"Blog Post",sysfiletype_spblogpostlist:"Blog Posts",sysfiletype_spdataconnectionlibrarylist:"Data Connection Library",sysfiletype_spdistributiongroup:"Distribution Group",sysfiletype_spdistributiongrouplist:"Distribution Groups",sysfiletype_spipfslist:"InfoPath Form Servers",sysfiletype_spkeyperformanceindicator:"Key Performance Indicator",sysfiletype_spkeyperformanceindicatorlist:"Key Performance Indicators",sysfiletype_splanguagesandtranslator:"Languages and Translator",sysfiletype_splanguagesandtranslatorlist:"Languages and Translators",sysfiletype_spmasterpagescataloglist:"Master Pages Library",sysfiletype_spnocodeworkflowlibrarylist:"No Code Workflow Library",sysfiletype_spprojecttask:"Project Task",sysfiletype_spprojecttasklist:"Project Tasks",sysfiletype_sppublishingpageslibrarylist:"Page Library",sysfiletype_spreportdocumentlibrarylist:"Report Document Library",sysfiletype_spreportlibrarylist:"Report Library",sysfiletype_spslidelibrarylist:"Slide Library",sysfiletype_sptab:"Tabs",sysfiletype_sptablist:"Tabs List",sysfiletype_sptranslationmanagementlibrarylist:"Translation Management Library",sysfiletype_spuserinformation:"User Information",sysfiletype_spuserinformationlist:"User Information List",sysfiletype_spwikipagelibrarylist:"Wiki Page Library",sysfiletype_spworkflowhistory:"Workflow History",sysfiletype_spworkflowhistorylist:"Workflow Histories",sysfiletype_spworkflowprocess:"Custom Workflow Process",sysfiletype_spworkflowprocesslist:"Custom Workflow Processes",sysfiletype_sppublishingimageslibrarylist:"Publishing Image Library",sysfiletype_spcirculation:"Circulation",sysfiletype_spcirculationlist:"Circulations",sysfiletype_spdashboardslibrarylist:"Dashboard Library",sysfiletype_spdataconnectionforperformancepointlibrarylist:"Data Connection for Performance Point Library",sysfiletype_sphealthreport:"Health Report",sysfiletype_sphealthreportlist:"Health Reports",sysfiletype_sphealthrule:"Health Rule",sysfiletype_sphealthrulelist:"Health Rules",sysfiletype_spimedictionary:"IME Dictionary",sysfiletype_spimedictionarylist:"IME Dictionaries",sysfiletype_spperformancepointcontent:"Performance Point Content",sysfiletype_spperformancepointcontentlist:"Performance Point Contents",sysfiletype_spphonecallmemo:"Phone Call Memo",sysfiletype_spphonecallmemolist:"Phone Call Memos",sysfiletype_sprecordlibrarylist:"Record Library",sysfiletype_spresource:"Resource",sysfiletype_spresourcelist:"Resources",sysfiletype_spprocessdiagramslibrarylist:"Process Diagram Library",sysfiletype_spsitethemeslibrarylist:"Site Theme Library",sysfiletype_spsolutionslibrarylist:"Solution Library",sysfiletype_spwfpublibrarylist:"WFPUB Library",sysfiletype_spwhereabout:"Whereabout",sysfiletype_spwhereaboutlist:"Whereabouts",sysfiletype_spdocumentlink:"Link to a Document",sysfiletype_spdocumentset:"Document Set",sysfiletype_spmicrofeedpost:"Microfeed Post",sysfiletype_spmicrofeedlist:"Microfeed",sysfiletype_splistfolder:"List Folder"},t=String.locales||(String.locales={});t.en=e,String.toLocaleString.call(this,{en:e}),String.locale="en",String.defaultLocale="en"}(),function(e){var t;t="undefined"!=typeof e.require&&"undefined"!=typeof e.exports&&"undefined"!=typeof e.module?e.require("globalize"):e.Globalize,t.addCultureInfo("en-US","default",{name:"en-US",englishName:"English (United States)"})}(this);var Coveo;!function(e){var t=/<pl>(((?!<\/pl>).)*)<\/pl>/g,n=/<sn>(((?!<\/sn>).)*)<\/sn>/g;e.L10N={format:function(t){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var i=t.toLocaleString();if(n.length>0){var r=e._.last(n);e._.isNumber(r)&&(n.pop(),i=e.L10N.formatPlSn(i,r));for(var s in n)i=i.replace("{"+s+"}",n[s])}return i},formatPlSn:function(e,o){return e=o>1?e.replace(t,"$1").replace(n,""):e.replace(t,"").replace(n,"$1")}}}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(e){this.owner=e}return e.prototype.trace=function(){for(var t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];e.level<=e.TRACE&&this.log("TRACE",t)},e.prototype.debug=function(){for(var t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];e.level<=e.DEBUG&&this.log("DEBUG",t)},e.prototype.info=function(){for(var t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];e.level<=e.INFO&&this.log("INFO",t)},e.prototype.warn=function(){for(var t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];e.level<=e.WARN&&this.log("WARN",t)},e.prototype.error=function(){for(var t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];e.level<=e.ERROR&&this.log("ERROR",t)},e.prototype.log=function(t,n){window.console&&console.log&&(console.log([t,this.owner].concat(n)),e.executionTime&&(console.timeEnd("Execution time"),console.time("Execution time")))},e.enable=function(){e.level=e.TRACE},e.disable=function(){e.level=e.NOTHING},e.TRACE=1,e.DEBUG=2,e.INFO=3,e.WARN=4,e.ERROR=5,e.NOTHING=6,e.level=e.INFO,e.executionTime=!1,e}();e.Logger=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.fail=function(e){t.failureHandler(e)},t.check=function(e,n){e||t.fail(n)},t.isUndefined=function(n){t.check(e.Utils.isUndefined(n),"Value should be undefined.")},t.isNotUndefined=function(n){t.check(!e.Utils.isUndefined(n),"Value should not be undefined.")},t.isNull=function(n){t.check(e.Utils.isNull(n),"Value should be null.")},t.isNotNull=function(n){t.check(!e.Utils.isNull(n),"Value should not be null.")},t.exists=function(n){t.check(!e.Utils.isNullOrUndefined(n),"Value should not be null or undefined")},t.doesNotExists=function(n){t.check(e.Utils.isNullOrUndefined(n),"Value should be null or undefined")},t.isString=function(n){t.check(e._.isString(n),"Value should be a string.")},t.stringStartsWith=function(e,n){t.isNonEmptyString(e),t.isNonEmptyString(n),t.check(0==e.indexOf(n),"Value should start with "+n)},t.isNonEmptyString=function(n){t.check(e.Utils.isNonEmptyString(n),"Value should be a non-empty string.")},t.isNumber=function(n){t.check(e._.isNumber(n),"Value should be a number.")},t.isLargerThan=function(e,n){t.check(n>e,"Value "+n+" should be larger than "+e)},t.isLargerOrEqualsThan=function(e,n){t.check(n>=e,"Value "+n+" should be larger or equal than "+e)},t.isSmallerThan=function(e,n){t.check(e>n,"Value "+n+" should be smaller than "+e)},t.isSmallerOrEqualsThan=function(e,n){t.check(e>=n,"Value "+n+" should be smaller or equal than "+e)},t.logger=new e.Logger("Assert"),t.failureHandler=function(o){throw t.logger.error("Assertion Failed!",o),void 0!=console.trace&&console.trace(),e.Utils.isNonEmptyString(o)?new n(o):new n("Assertion Failed!")},t}();e.Assert=t;var n=function(){function e(e){this.message=e}return e.prototype.toString=function(){return this.message},e}();e.PreconditionFailedException=n}(Coveo||(Coveo={}));var Coveo;!function(e){e.$=jQuery}(Coveo||(Coveo={}));var Coveo;!function(e){e._=window._}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.defer=function(e){t.functions.push(e),t.arm()},t.flush=function(){for(;t.popOne(););},t.arm=function(){e._.defer(function(){t.popOne()&&t.arm()})},t.popOne=function(){if(t.functions.length>0){var n=t.functions[0];return t.functions=e._.rest(t.functions),n(),t.functions.length>0}return!1},t.functions=[],t}();e.Defer=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function e(e){this.onEmpty=e,this.cache=[]}return e.prototype.get=function(){return 0==this.cache.length?this.onEmpty():this.cache.pop()},e.prototype.push=function(e){this.cache.push(e)},e}();e.Cache=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(t,n,o,i){void 0===o&&(o=10),void 0===i&&(i=500),this.element=t,this.handler=n,this.distanceThreshold=o,this.timeThreshold=i,t.hasClass(e.Ui.Component.computeCssClassNameForType(e.Ui.SearchInterface.ID))?t.click(n):(this.setTouchHandlers(),this.preventMouseHandlers())}return t.prototype.setTouchHandlers=function(){var e=this;this.element.on("touchstart",function(t){return e.handleTouchStart(t)}),this.element.on("touchmove",function(t){return e.handleTouchMove(t)})},t.prototype.preventMouseHandlers=function(){this.element.on("mousedown",function(e){return e.preventDefault()}),this.element.on("mouseup",function(e){return e.preventDefault()}),this.element.on("click",function(e){return e.preventDefault()})},t.prototype.handleTouchStart=function(e){var t=this;this.reset(),this.initStartVariables(e),this.startTarget=e.target,this.startElement=this.getStartElement(),this.element.one("touchend",function(e){return t.handleTouchEnd(e)})},t.prototype.handleTouchMove=function(e){this.endX=e.originalEvent?e.originalEvent.touches[0].clientX:0,this.endY=e.originalEvent?e.originalEvent.touches[0].clientY:0,this.moved=!0},t.prototype.handleTouchEnd=function(t){this.preventGhostClickIfAndroid(t),this.mustCallHandler(t)&&(this.hideIOSKeyboardIfNecessary(t.target),this.isGhostClick(t)||e.MobileUtils.showClickFeedback(this.element,400),e.MobileUtils.showClickCancelingOverlay(400),t.clientX=this.startX,t.clientY=this.startY,this.handler.call(this,t))},t.prototype.isGhostClick=function(e){return e.originalEvent?!1:!0},t.prototype.initStartVariables=function(e){this.startTime=(new Date).getTime(),this.startX=e.originalEvent?e.originalEvent.touches[0].clientX:0,this.startY=e.originalEvent?e.originalEvent.touches[0].clientY:0,this.endX=this.startX,this.endY=this.startY},t.prototype.getStartElement=function(){return document.elementFromPoint(this.startX,this.startY)},t.prototype.mustCallHandler=function(e){return!this.scrolled(e)&&!this.held()},t.prototype.scrolled=function(e){var t=e.target,n=Math.abs(this.endX-this.startX),o=Math.abs(this.endY-this.startY),i=document.elementFromPoint(this.endX,this.endY);return!(this.startElement==i&&this.startTarget==t&&(!this.moved||n<this.distanceThreshold&&o<this.distanceThreshold))},t.prototype.held=function(){this.endTime=(new Date).getTime();var e=this.endTime-this.startTime;return e>=this.timeThreshold},t.prototype.reset=function(){this.startX=0,this.startY=0,this.endX=0,this.endY=0,this.startTime=0,this.endTime=0,this.moved=!1},t.prototype.hideIOSKeyboardIfNecessary=function(t){e.DeviceUtils.isIos()&&!e.$(t).is("input[type=text]")&&e.$(document.activeElement).is("input[type=text]")&&e.MobileUtils.hideIOSKeyboard(document.activeElement)},t.prototype.preventGhostClickIfAndroid=function(t){e.DeviceUtils.isAndroid()&&t.preventDefault()},t}();e.FastClick=t,e.$.fn.fastClick=function(n){if(n){if(e.DeviceUtils.isMobileDevice()){var o=e.$(this);return new t(o,n),o}return this.filter("a").data("href",this.filter("a").attr("href")).attr("href","javascript:"),this.click(n)}return e.DeviceUtils.isMobileDevice()?(this.trigger("touchstart"),this.trigger("touchend")):this.click()}}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){function n(e){return"undefined"==typeof e}function o(e){return null===e}function i(e){return t.isUndefined(e)||t.isNull(e)}function r(e){return!t.isNullOrUndefined(e)}function s(t){return e._.isString(t)?t:""}function a(e){return e?e.toString():""}function l(e){return t.isNullOrUndefined(e)||!t.isNonEmptyString(e)}function u(t){return e._.isString(t)&&""!==t}function c(e,t){return e.slice(0,t.length)==t}function p(t){return e._.isArray(t)&&t.length>0}function d(e){return!t.isNonEmptyArray(e)}function h(e){return void 0!=window.HTMLElement?e instanceof HTMLElement:e&&e.nodeType&&1==e.nodeType}function f(e){return t.isNonEmptyString(e)?parseInt(e,10):void 0}function m(e){return t.isNonEmptyString(e)?parseFloat(e):void 0}function y(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)}function g(e){if(!t.isNonEmptyString(e))return void 0;switch(e.toLowerCase()){case"true":case"1":case"yes":return!0;case"false":case"0":case"no":return!1;default:return void 0}}function v(e){return null==e?null:e.replace(/^\s+|\s+$/g,"")}function C(t,n,o){if(void 0===o&&(o=!0),o)return e._.isEqual(t,n);var i=[t,n];return e._.all(i,function(t){return t.length==i[0].length&&0==e._.difference(t,i[0]).length})}function b(t,n){return e._.isEqual(t,n)}function E(e){return/^@[a-zA-Z0-9]+$/.test(e)}function S(t){var n=t.match(/^@([a-zA-Z0-9]+)$/);return e.Assert.check(null!=n,t+" is not a vaild field"),n[1].toLowerCase()}function x(e){var t=e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");return t}function A(e,t,n,o,i){void 0===n&&(n={});var r,s=null,a=0,l=function(){a=n.leading===!1?0:(new Date).getTime(),s=null,r=e.apply(o,i)};return function(){var u=(new Date).getTime();a||n.leading!==!1||(a=u);var c=t-(u-a);return o=this,i=arguments,0>=c?(clearTimeout(s),s=null,a=u,r=e.apply(o,i)):s||n.trailing===!1||(s=setTimeout(l,c)),r}}function T(t,n){var o=this,i=e._.isArray(n),r=i&&[]||{};return i?(t=t||[],r=r.concat(t),e._.each(n,function(e,n){"undefined"==typeof t[n]?r[n]=e:"object"==typeof e?r[n]=o.extendDeep(t[n],e):-1===t.indexOf(e)&&r.push(e)})):(t&&"object"==typeof t&&e._.each(e._.keys(t),function(e){r[e]=t[e]}),e._.each(e._.keys(n),function(e){r[e]="object"==typeof n[e]&&n[e]?t[e]?o.extendDeep(t[e],n[e]):n[e]:n[e]})),r}function O(e,t){return void 0===t&&(t=window.location.search),t.replace(new RegExp("^(?:.*[&\\?]"+e.replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1")}t.isUndefined=n,t.isNull=o,t.isNullOrUndefined=i,t.exists=r,t.toNotNullString=s,t.anyTypeToString=a,t.isNullOrEmptyString=l,t.isNonEmptyString=u,t.stringStartsWith=c,t.isNonEmptyArray=p,t.isEmptyArray=d,t.isHtmlElement=h,t.parseIntIfNotUndefined=f,t.parseFloatIfNotUndefined=m,t.round=y,t.parseBooleanIfNotUndefined=g,t.trim=v,t.arrayEqual=C,t.objectEqual=b,t.isCoveoField=E,t.getCoveoFieldKey=S,t.escapeRegexCharacter=x,t.throttle=A,t.extendDeep=T,t.getQueryStringValue=O}(t=e.Utils||(e.Utils={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(e){this.milliseconds=e}return t.prototype.getMilliseconds=function(){return this.milliseconds},t.prototype.getSeconds=function(){return this.getMilliseconds()/1e3},t.prototype.getMinutes=function(){return this.getSeconds()/60},t.prototype.getHours=function(){return this.getMinutes()/60},t.prototype.getDays=function(){return this.getHours()/24},t.prototype.getWeeks=function(){return this.getDays()/7},t.fromDates=function(n,o){return e.Assert.exists(n),e.Assert.exists(o),new t(o.valueOf()-n.valueOf())},t}();e.TimeSpan=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){function t(){var e=navigator.userAgent;return e.match(/Android/i)?"Android":e.match(/BlackBerry/i)?"BlackBerry":e.match(/iPhone/i)?"iPhone":e.match(/iPad/i)?"iPad":e.match(/iPod/i)?"iPod":e.match(/Opera Mini/i)?"Opera Mini":e.match(/IEMobile/i)?"IE Mobile":e.match(/Chrome/i)?"Chrome":e.match(/MSIE/i)||e.match(/Trident/i)?"IE":e.match(/Opera/i)?"Opera":e.match(/Firefox/i)?"Firefox":e.match(/Safari/i)?"Safari":"Others"}function n(){return"Android"==t()}function o(){var e=t();return"iPhone"==e||"iPad"==e||"iPod"==e}function i(){var e=navigator.userAgent.toLowerCase();return-1==e.indexOf("msie")?!1:parseInt(e.split("msie")[1])<10}function r(){return u}function s(){return c}function a(){return screen.width<=480}function l(){return screen.height<=640}var u=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),c=/^file:\/\/\/.*_asset/i.test(document.URL)||/^file:\/\/\/.*var\/mobile/i.test(document.URL)||/^file:\/\/\/.*\/CoreSimulator/.test(document.URL);e.getDeviceName=t,e.isAndroid=n,e.isIos=o,e.isIE8or9=i,e.isMobileDevice=r,e.isPhonegap=s,e.isSmallScreenWidth=a,e.isSmallScreenHeight=l}(t=e.DeviceUtils||(e.DeviceUtils={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.createGuid=function(){return"undefined"!=typeof crypto&&"undefined"!=typeof crypto.getRandomValues?t.generateWithCrypto():t.generateWithRandom()},t.generateWithRandom=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)})},t.generateWithCrypto=function(){var e=new Uint16Array(8);crypto.getRandomValues(e);var t=function(e){for(var t=e.toString(16);t.length<4;)t="0"+t;return t};return t(e[0])+t(e[1])+"-"+t(e[2])+"-"+t(e[3])+"-"+t(e[4])+"-"+t(e[5])+t(e[6])+t(e[7])},t.setStateObjectOnQueryResults=function(e,n){t.setPropertyOnResult(n,"state",e)},t.setIndexAndUidOnQueryResults=function(n,o,i){e.Assert.exists(n),e.Assert.exists(o);var r=n.firstResult;t.setPropertyOnResult(o,"queryUid",i),t.setPropertyOnResult(o,"index",r,function(){return++r})},t.setTermsToHighlightOnQueryResults=function(e,n){t.setPropertyOnResult(n,"termsToHighlight",n.termsToHighlight),t.setPropertyOnResult(n,"phrasesToHighlight",n.phrasesToHighlight)},t.splitFlags=function(t,n){return void 0===n&&(n=";"),e.Assert.exists(t),t.split(n)},t.isAttachment=function(n){return e._.contains(t.splitFlags(n.flags),"IsAttachment")},t.containsAttachment=function(n){return e._.contains(t.splitFlags(n.flags),"ContainsAttachment")},t.hasHTMLVersion=function(n){return e._.contains(t.splitFlags(n.flags),"HasHtmlVersion")},t.hasThumbnail=function(n){return e._.contains(t.splitFlags(n.flags),"HasThumbnail")},t.quoteAndEscapeIfNeeded=function(n){return e.Assert.isString(n),t.isAtomicString(n)||t.isRangeString(n)||t.isRangeWithoutOuterBoundsString(n)?n:t.quoteAndEscape(n)},t.quoteAndEscape=function(n){return e.Assert.isString(n),'"'+t.escapeString(n)+'"'},t.escapeString=function(t){return e.Assert.isString(t),t.replace(/"/g," ")},t.isAtomicString=function(t){return e.Assert.isString(t),/^\d+(\.\d+)?$|^[\d\w]+$/.test(t)},t.isRangeString=function(t){return e.Assert.isString(t),/^\d+(\.\d+)?\.\.\d+(\.\d+)?$|^\d{4}\/\d{2}\/\d{2}@\d{2}:\d{2}:\d{2}\.\.\d{4}\/\d{2}\/\d{2}@\d{2}:\d{2}:\d{2}$/.test(t)},t.isRangeWithoutOuterBoundsString=function(t){return e.Assert.isString(t),/^\d+(\.\d+)?$|^\d{4}\/\d{2}\/\d{2}@\d{2}:\d{2}:\d{2}$/.test(t)},t.buildFieldExpression=function(n,o,i){return e.Assert.isNonEmptyString(n),e.Assert.stringStartsWith(n,"@"),e.Assert.isNonEmptyString(o),e.Assert.isLargerOrEqualsThan(1,i.length),1==i.length?n+o+t.quoteAndEscapeIfNeeded(i[0]):n+o+"("+e._.map(i,function(e){return t.quoteAndEscapeIfNeeded(e)}).join(",")+")"},t.buildFieldNotEqualExpression=function(n,o){e.Assert.isNonEmptyString(n),e.Assert.stringStartsWith(n,"@"),e.Assert.isLargerOrEqualsThan(1,o.length);var i;return i=1==o.length?n+"=="+t.quoteAndEscapeIfNeeded(o[0]):n+"==("+e._.map(o,function(e){return t.quoteAndEscapeIfNeeded(e)}).join(",")+")","(NOT "+i+")"},t.mergeQueryString=function(e,t){var n=e.indexOf("?");return e+=-1!=n?"&"+t:"?"+t},t.mergePath=function(e,t){var n=e.split("?");return n[0]+t+"?"+(n[1]||"")},t.setPropertyOnResult=function(t,n,o,i){e._.each(t.results,function(t){t[n]=o,e._.each(t.childResults,function(e){e[n]=o}),e.Utils.isNullOrUndefined(t.parentResult)||(t.parentResult[n]=o),o=i?i():o})},t}();e.QueryUtils=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.javascriptEncode=function(t){return e.Assert.isString(t),t=t.replace(/\\/g,"\\\\"),t=t.replace(/'/g,"\\'"),t=t.replace(/"/g,'\\"')},t.htmlEncode=function(t){return e.Assert.isString(t),e.$("<div/>").text(t).html()},t.splice=function(e,t,n,o){return e.slice(0,t)+o+e.slice(t+Math.abs(n))},t.removeMiddle=function(e,n,o){if(e.length<n)return e;var i=e.length-n,r=Math.floor(n/2);return t.splice(e,r,i,o)},t.regexEncode=function(t){return e.Assert.isString(t),t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},t.wildcardsToRegex=function(n){e.Assert.isString(n);var o=t.regexEncode(n);return o=o.replace(/\\\*/,".*"),o=o.replace(/\\\?/,".")},t.getHighlights=function(t,n,o){for(var i,r=[];i=n.exec(t);){var s=i[2],a=i[1],l=i.index+1;if(0==i.index&&""==a&&(l=0),r.push({offset:l,length:s.length,dataHighlightGroupTerm:o}),!n.global)break}return e._.isEmpty(r)?void 0:r},t}();e.StringUtils=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){function n(e,t,a,c,p,d){void 0===d&&(d=0),e.appendTo(a),p.verticalOffset=p.verticalOffset?p.verticalOffset:0,p.horizontalOffset=p.horizontalOffset?p.horizontalOffset:0;var h=t.offset();i(h,e,t,p),r(h,e,t,p),o(e.offset(),h,e,p);var f=l(e),m=l(c);if(2>d){var y=u(f,m);if("ok"!=y.vertical||"ok"!=y.horizontal){var g=s(p,y);n(e,t,a,c,g,d+1)}}}function o(e,t,n,o){var i=n.position();n.css({position:"absolute",top:i.top+o.verticalOffset-(e.top-t.top)+"px",left:i.left+o.horizontalOffset-(e.left-t.left)+"px"})}function i(e,t,n,o){switch(o.vertical){case 0:e.top-=t.outerHeight();break;case 2:e.top+=n.outerHeight();break;case 1:e.top-=t.outerHeight()/3;case 3:break;case 4:e.top-=t.outerHeight()-n.outerHeight()}}function r(e,t,n,o){switch(o.horizontal){case 0:e.left-=t.outerWidth();break;case 2:e.left+=n.outerWidth();break;case 1:e.left+=a(t,n);break;case 3:break;case 4:e.left-=t.outerWidth()-n.outerWidth()}}function s(e,t){var n=e;return"left"==t.horizontal&&(n.horizontal=2),"right"==t.horizontal&&(n.horizontal=0),"top"==t.vertical&&(n.vertical=2),"bottom"==t.vertical&&(n.vertical=0),n}function a(e,t){return(t.outerWidth()-e.outerWidth())/2
}function l(e){var t=e.offset();return{top:t.top,left:t.left,right:t.left+e.outerWidth(),bottom:t.top+e.outerHeight()}}function u(e,t){var n={vertical:"ok",horizontal:"ok"};return e.top<t.top&&(n.vertical="top"),e.bottom>t.bottom&&(n.vertical="bottom"),e.left<t.left&&(n.horizontal="left"),e.right>t.right&&(n.horizontal="right"),n}function c(e,t){return"<span class='coveo-close-button'><span class='coveo-icon coveo-sprites-quickView-close'></span>"+e+"</span><span class='coveo-pop-up-reminder' >"+t+"</span>"}function p(){var t="coveo-loading-dot";return e.$("<div class='coveo-first-loading-animation' ><div class='coveo-logo' ></div><div class='coveo-loading-container'><div class='"+t+"' ></div><div class='"+t+"' ></div><div class='"+t+"' ></div><div class='"+t+"' ></div></div></div>")}function d(){var t="coveo-loading-dot";return e.$("<div class='coveo-generic-loading-animation coveo-loading-animation'><div class='coveo-loading-container'><div class='"+t+"' ></div><div class='"+t+"' ></div><div class='"+t+"' ></div><div class='"+t+"' ></div></div></div>")}function h(t,n){var o=new RegExp(e.Utils.escapeRegexCharacter(n),"i"),i=t.search(o),r=i+n.length;return e.StringUtils.htmlEncode(t.slice(0,i))+"<span class='coveo-highlight'>"+e.StringUtils.htmlEncode(t.slice(i,r))+"</span>"+e.StringUtils.htmlEncode(t.slice(r))}function f(t){for(var n=e.$(t);!n.is(document)&&0!=n.length;){if(m(n))return n.is("body")?e.$(window).get(0):n.get(0);n=n.parent()}return e.$(window).get(0)}function m(e){return"scroll"==e.css("overflow-y")}function y(t){var n=e.$("<div>").html(t);return 1==n.children().length?n.children().get(0):n.get(0)}!function(e){e[e.top=0]="top",e[e.middle=1]="middle",e[e.bottom=2]="bottom",e[e.innerTop=3]="innerTop",e[e.innerBottom=4]="innerBottom"}(t.VerticalAlignment||(t.VerticalAlignment={}));t.VerticalAlignment;!function(e){e[e.left=0]="left",e[e.center=1]="center",e[e.right=2]="right",e[e.innerLeft=3]="innerLeft",e[e.innerRight=4]="innerRight"}(t.HorizontalAlignment||(t.HorizontalAlignment={}));t.HorizontalAlignment;t.positionPopup=n,t.getPopUpCloseButton=c,t.getBasicLoadingAnimation=p,t.getBasicLoadingDots=d,t.highlightElement=h,t.findScrollingParent=f,t.htmlToDom=y,e.$.fn.fastToggle=function(e){return this.css("display",e?"":"none")}}(t=e.JQueryUtils||(e.JQueryUtils={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t=function(){function t(){}return t.getHash=function(n){void 0===n&&(n=window),e.Assert.exists(n);var o="#"+(n.location.href.split("#")[1]||"");return t.getAjaxcrawlableHash(o)},t.getValue=function(n,o){e.Assert.isNonEmptyString(n),e.Assert.exists(o),o=t.getAjaxcrawlableHash(o);var i=t.getRawValue(n,o);return void 0!=i&&(i=t.getValueDependingOnType(i)),i},t.encodeValues=function(n){var o=[];return e._.each(n,function(n,i){var r="";r=e.Utils.isNonEmptyArray(n)?t.encodeArray(n):e._.isObject(n)&&e.Utils.isNonEmptyArray(e._.keys(n))?t.encodeObject(n):encodeURIComponent(n.toString()),""!=r&&o.push(i+"="+r)}),o.join("&")},t.getAjaxcrawlableHash=function(e){return void 0!=e[1]&&"!"==e[1]?e.substring(0,1)+e.substring(2):e},t.getRawValue=function(t,n){e.Assert.exists(t),e.Assert.exists(n),e.Assert.check(0==n.indexOf("#")||""==n);for(var o=n.substr(1).split("&"),i=0,r=!0,s=void 0;r;){var a=o[i].split("=");a[0]==t?(r=!1,s=a[1]):(i++,i>=o.length&&(i=void 0,r=!1))}return s},t.getValueDependingOnType=function(e){var n,o=t.getValueType(e);return n="object"==o?t.decodeObject(e):"array"==o?t.decodeArray(e):decodeURIComponent(e)},t.getValueType=function(e){return e.substr(0,1)==t.Delimiter.objectStart&&e.substr(e.length-1)==t.Delimiter.objectEnd?"object":e.substr(0,1)==t.Delimiter.arrayStart&&e.substr(e.length-1)==t.Delimiter.arrayEnd?"array":"other"},t.encodeArray=function(n){var o=[];return e._.each(n,function(e){o.push(encodeURIComponent(e))}),t.Delimiter.arrayStart+o.join(",")+t.Delimiter.arrayEnd},t.encodeObject=function(n){var o=t.Delimiter.objectStart,i=[];return e._.each(n,function(n,o){var r="";r+='"'+encodeURIComponent(o)+'" : ',r+=e._.isArray(n)?t.encodeArray(n):e._.isObject(n)?t.encodeObject(n):e._.isNumber(n)||e._.isBoolean(n)?encodeURIComponent(n):'"'+encodeURIComponent(n)+'"',i.push(r)}),o+=i.join(" , "),o+t.Delimiter.objectEnd},t.decodeObject=function(e){return JSON.parse(decodeURIComponent(e))},t.decodeArray=function(t){t=t.substr(1),t=t.substr(0,t.length-1);for(var n=t.split(","),o=0;o<n.length;o++){var i=decodeURIComponent(n[o]),r="0"==i[0]&&i.length>1?0/0:Number(i),s=e.Utils.parseBooleanIfNotUndefined(i);n[o]=i,isNaN(r)?void 0!=s&&(n[o]=s):n[o]=r}return n},t.Delimiter={objectStart:"{",objectEnd:"}",arrayStart:"[",arrayEnd:"]",objectStartRegExp:"^{",objectEndRegExp:"}+$",arrayStartRegExp:"^[",arrayEndRegExp:"]+$"},t}();e.HashUtils=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){function n(e){c.addClass("active"),setTimeout(function(){c.removeClass("active")},e)}function o(e,t){e.addClass("coveo-clicked"),setTimeout(function(){e.removeClass("coveo-clicked")},t)}function i(n,o){void 0===o&&(o=!1);var i="."+e.Ui.Component.computeCssClassNameForType(e.Ui.SearchInterface.ID);e.$(i+",.coveo-glass").addClass("coveo-"+n),e.$(".coveo-glass").addClass("coveo-active-glass"),o&&"Android"==e.DeviceUtils.getDeviceName()&&e.$(document).on("backbutton",e.$.proxy(t.removeToggleClassOnSearchInterface,this,!0))}function r(t){void 0===t&&(t=!1);var n="."+e.Ui.Component.computeCssClassNameForType(e.Ui.SearchInterface.ID);e.$(n+",.coveo-glass").removeClass("coveo-slide-right").removeClass("coveo-slide-left").removeClass("coveo-active-glass"),e.$(".coveo-tab-section").removeClass("coveo-opened-by-current-tab");var o=e.Ui.CurrentTab?e.Ui.CurrentTab.ID:void 0;o&&e.$("."+o).removeClass("coveo-opening-tab-section"),t&&"Android"==e.DeviceUtils.getDeviceName()&&e.$(document).off("backbutton")}function s(){e.$("."+e.Ui.Component.computeCssClassNameForType(e.Ui.SearchInterface.ID)).append(c)}function a(t){e.$(window).focus(),e.$(t).blur()}function l(){e.DeviceUtils.isIos()&&e.$(window).on("touchstart",function(n){!e.$(n.target).is("input")&&e.$(document.activeElement).is("input")&&t.hideIOSKeyboard(document.activeElement)})}function u(){e.DeviceUtils.isMobileDevice()&&(e.$(function(){return s()}),l())}var c=e.$(document.createElement("div")).addClass("coveo-click-canceling-overlay");t.showClickCancelingOverlay=n,t.showClickFeedback=o,t.addToggleClassOnSearchInterface=i,t.removeToggleClassOnSearchInterface=r,t.hideIOSKeyboard=a,u()}(t=e.MobileUtils||(e.MobileUtils={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var n=function(){function t(t,n){this.message=t,this.status=n,e.Assert.exists(t),e.Assert.exists(n),this.type="Ajax Error (status: "+n+")"}return t}();t.AjaxError=n}(t=e.Rest||(e.Rest={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){var t=function(){function e(e){this.provider=e,this.isMissingAuthentication=!0,this.type=this.message="Missing Authentication (provider: "+e+")"}return e}();e.MissingAuthenticationError=t}(t=e.Rest||(e.Rest={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var n=function(){function t(t){this.status=t.statusCode,this.message=t.data.message,this.type=t.data.type,this.queryExecutionReport=t.data.executionReport,e.Assert.isNumber(this.status),e.Assert.isNonEmptyString(this.message),e.Assert.isNonEmptyString(this.type)}return t}();t.QueryError=n}(t=e.Rest||(e.Rest={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var n;!function(e){e[e.OPENED=XMLHttpRequest.OPENED||1]="OPENED",e[e.DONE=XMLHttpRequest.DONE||4]="DONE"}(n||(n={}));var o=function(){function t(t){void 0===t&&(t={}),this.options=t,this.useJsonp=!1,this.logger=new e.Logger(this)}return t.prototype.call=function(n){e.Assert.isNonEmptyString(n.url);var o={url:n.url,queryString:n.errorsAsSuccess?n.queryString.concat(["errorsAsSuccess=1"]):n.queryString,requestData:n.requestData,deferred:e.$.Deferred(),begun:new Date,method:n.method};this.logger.trace("Performing REST request",o);var i=t.parseURL(o.url),r=window.location.hostname===i.hostname||""===i.hostname,s=""!=window.location.port?window.location.port:"https:"==window.location.protocol?"443":"80",a=s==i.port,l=!(r&&a);return this.useJsonp?this.callUsingAjaxJsonP(o):this.isCORSSupported()||!l?this.callUsingXMLHttpRequest(o,n.responseType):this.isXDomainRequestSupported()?this.callUsingXDomainRequest(o):this.callUsingAjaxJsonP(o),o.deferred},t.parseURL=function(e){var t=document.createElement("a");return t.href=e,t},t.convertJsonToQueryString=function(t){e.Assert.exists(t);var n=[];return e._.each(t,function(t,o){null!=t&&(e._.isObject(t)?n.push(o+"="+encodeURIComponent(JSON.stringify(t))):n.push(o+"="+encodeURIComponent(t.toString())))}),n},t.convertJsonToFormBody=function(e){return t.convertJsonToQueryString(e).join("&")},t.prototype.callUsingXMLHttpRequest=function(o,i){var r=this;void 0===i&&(i="text");var s=new XMLHttpRequest,a=!1;s.onreadystatechange=function(){if(s.readyState!=n.OPENED||a){if(s.readyState==n.DONE){var l,u=s.status;"text"==i?l=r.tryParseResponseText(s.responseText,s.getResponseHeader("Content-Type")):(l=s.response,void 0==l&&(l=r.tryParseResponseText(s.responseText,s.getResponseHeader("Content-Type")))),r.isSuccessHttpStatus(u)?r.handleSuccessfulResponseThatMightBeAnError(o,l):r.handleError(o,s.status,void 0)}}else a=!0,r.options.anonymous===!1&&(s.withCredentials=!0),r.options.accessToken?s.setRequestHeader("Authorization","Bearer "+r.options.accessToken):r.options.username&&r.options.password&&s.setRequestHeader("Authorization","Basic "+btoa(r.options.username+":"+r.options.password)),e.DeviceUtils.isPhonegap()&&s.setRequestHeader("Basic-Auth-Challenge-Client","Phonegap"),"GET"==o.method?s.send():(s.setRequestHeader("Content-Type",'application/x-www-form-urlencoded; charset="UTF-8"'),s.send(t.convertJsonToFormBody(o.requestData))),s.responseType=i};var l=o.queryString;"GET"==o.method&&(l=l.concat(t.convertJsonToQueryString(o.requestData))),s.open(o.method,this.combineUrlAndQueryString(o.url,l))},t.prototype.callUsingXDomainRequest=function(n){var o=this,i=n.queryString.concat([]);this.options.accessToken&&i.push("access_token="+encodeURIComponent(this.options.accessToken));var r=new XDomainRequest;"GET"==n.method&&(i=i.concat(t.convertJsonToQueryString(n.requestData))),r.open(n.method,this.combineUrlAndQueryString(n.url,i)),r.onload=function(){var e=o.tryParseResponseText(r.responseText,r.contentType);o.handleSuccessfulResponseThatMightBeAnError(n,e)},r.onerror=function(){var e=o.tryParseResponseText(r.responseText,r.contentType);o.handleError(n,0,e)},r.ontimeout=function(){return o.logger.error("Request timeout",r,n.requestData)},r.onprogress=function(){return o.logger.trace("Request progress",r,n.requestData)},e._.defer(function(){"GET"==n.method?r.send():r.send(t.convertJsonToFormBody(n.requestData))})},t.prototype.callUsingAjaxJsonP=function(n){var o=this,i=n.queryString.concat(t.convertJsonToQueryString(n.requestData));this.options.accessToken&&i.push("access_token="+encodeURIComponent(this.options.accessToken)),i.push("callback=?"),e.$.jsonp({url:this.combineUrlAndQueryString(n.url,i),success:function(e){return o.handleSuccessfulResponseThatMightBeAnError(n,e)},error:function(){return o.handleError(n,0,void 0)}})},t.prototype.handleSuccessfulResponseThatMightBeAnError=function(e,t){this.isErrorResponseBody(t)?this.handleError(e,t.statusCode,t):this.handleSuccess(e,t)},t.prototype.handleSuccess=function(t,n){var o={duration:e.TimeSpan.fromDates(t.begun,new Date).getMilliseconds(),data:n};this.logger.trace("REST request successful",n,t),t.deferred.resolve(o)},t.prototype.handleError=function(e,t,n){var o={statusCode:t,data:n};this.logger.error("REST request failed",t,n,e),e.deferred.reject(o)},t.prototype.combineUrlAndQueryString=function(e,t){return e+(t.length>0?"?"+t.join("&"):"")},t.prototype.isXDomainRequestSupported=function(){return"XDomainRequest"in window},t.prototype.isCORSSupported=function(){return"withCredentials"in new XMLHttpRequest},t.prototype.isSuccessHttpStatus=function(e){return e>=200&&300>e||304===e},t.prototype.tryParseResponseText=function(t,n){if(null==n||-1==n.indexOf("application/json"))return t;if(!e.Utils.isNonEmptyString(t))return void 0;try{return JSON.parse(t)}catch(o){return void 0}},t.prototype.isErrorResponseBody=function(e){return e&&e.statusCode?!this.isSuccessHttpStatus(e.statusCode):!1},t}();t.EndpointCaller=o}(t=e.Rest||(e.Rest={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var n=function(){function e(){this.queryStringArguments={},this.anonymous=!1,this.isOldRestAPI=!1}return e}();t.DefaultSearchEndpointOptions=n;var o=function(){function o(t){this.options=t,this._batchListFieldValues=[],e.Assert.exists(t);var o=new n;o.anonymous=e.Utils.isNonEmptyString(t.accessToken),this.options=e.$.extend({},o,t),e.$(window).on("beforeunload",e.$.proxy(this.handleUnload,this)),this.logger=new e.Logger(this),this.createEndpointCaller()}return o.configureSampleEndpoint=function(){o.endpoints["default"]=new o({restUri:"https://cloudplatform.coveo.com/rest/search",accessToken:"52d806a2-0f64-4390-a3f2-e0f41a4a73ec"})},o.configureCloudEndpoint=function(e,t,n,i){void 0===n&&(n="https://cloudplatform.coveo.com/rest/search");var r=o.mergeConfigOptions({restUri:n,accessToken:t,queryStringArguments:{workgroup:e}},i);o.endpoints["default"]=new o(o.removeUndefinedConfigOption(r))},o.configureOnPremiseEndpoint=function(e,t,n){var i=o.mergeConfigOptions({restUri:e,accessToken:t},n);o.endpoints["default"]=new o(o.removeUndefinedConfigOption(i))},o.removeUndefinedConfigOption=function(t){return e._.each(e._.keys(t),function(e){void 0==t[e]&&delete t[e]}),t},o.mergeConfigOptions=function(t,n){return t=o.removeUndefinedConfigOption(t),n=o.removeUndefinedConfigOption(n),e.$.extend({},t,n)},o.prototype.handleUnload=function(){this.isRedirecting=!0},o.prototype.getBaseUri=function(){return this.options.restUri},o.prototype.getAuthenticationProviderUri=function(t,n,o){var i=this.buildBaseUri("/login/"+t)+"?";return e.Utils.isNonEmptyString(n)?i+="redirectUri="+encodeURIComponent(n):e.Utils.isNonEmptyString(o)&&(i+="message="+encodeURIComponent(o)),i},o.prototype.isJsonp=function(){return this.caller.useJsonp},o.prototype.search=function(t,n){var o=this;e.Assert.exists(t),this.logger.info("Performing REST query",t),n=e._.extend({},n);var i={url:this.buildBaseUri("/"),queryString:this.buildBaseQueryString(n),requestData:t,errorsAsSuccess:!0,responseType:"text",method:"POST"},r=this.callWithErrorHandling(i);return r.done(function(n){o.logger.info("REST query successful",n,t),e.Utils.isNullOrEmptyString(n.searchUid)&&(n.searchUid=e.QueryUtils.createGuid())}),r},o.prototype.getRawDataStream=function(t,n,o){var i=this;e.Assert.exists(t),o=e._.extend({},o);var r={url:this.buildBaseUri("/datastream"),queryString:this.buildViewAsHtmlQueryString(t,o).concat(["dataStream="+n]),requestData:{},errorsAsSuccess:!1,method:"GET",responseType:"arraybuffer"},s=this.callWithErrorHandling(r);return this.logger.info("Performing REST query for datastream "+n+" on document uniqueID"+t),s.done(function(e){return i.logger.info("REST query successful",e,t)}),s},o.prototype.getDocumentText=function(t,n){n=e._.extend({},n);var o={url:this.buildBaseUri("/text"),queryString:this.buildViewAsHtmlQueryString(t,n),method:"GET",requestData:{},responseType:"text",errorsAsSuccess:!0};return this.callWithErrorHandling(o)},o.prototype.getDocumentHtml=function(t,n){n=e._.extend({},n);var o={url:this.buildBaseUri("/html"),queryString:this.buildViewAsHtmlQueryString(t,n),method:"GET",requestData:{},responseType:"document",errorsAsSuccess:!0};return this.callWithErrorHandling(o)},o.prototype.getViewAsHtmlUri=function(t,n){return n=e._.extend({},n),this.buildViewAsHtmlUri("/html",t,n)},o.prototype.getViewAsDatastreamUri=function(t,n,o){return o=e._.extend({},o),this.buildViewAsHtmlUri("/datastream",t,o)+"&dataStream="+encodeURIComponent(n)},o.prototype.batchFieldValues=function(t,n){var o=this;e.Assert.exists(t),n=e._.extend({},n),this.logger.info("Listing field values",t);var i=e.$.Deferred(),r={url:this.buildBaseUri("/values"),queryString:this.buildBaseQueryString(n),method:"POST",requestData:t,errorsAsSuccess:!0,responseType:"text"};return this.callWithErrorHandling(r).done(function(e){return i.resolve(e.values)}).fail(function(e,t){return i.reject(null,t)}),i.done(function(e){return o.logger.info("REST list field values successful",e,t)}),i},o.prototype.listFieldValues=function(t,n){var o=this;e.Assert.exists(t),n=e._.extend({},n),this.logger.info("Listing field values",t);var i=e.$.Deferred(),r={url:this.buildBaseUri("/values"),queryString:this.buildBaseQueryString(n),method:"POST",requestData:t,errorsAsSuccess:!0,responseType:"text"};return this.callWithErrorHandling(r).done(function(e){return i.resolve(e.values)}).fail(function(e,t){return i.reject(null,t)}),i.done(function(e){return o.logger.info("REST list field values successful",e,t)}),i},o.prototype.listFields=function(t){t=e._.extend({},t),this.logger.info("Listing fields");var n=e.$.Deferred(),o={url:this.buildBaseUri("/fields"),queryString:this.buildBaseQueryString(t),requestData:{},method:"GET",responseType:"text",errorsAsSuccess:!0};return this.callWithErrorHandling(o).done(function(e){return n.resolve(e.fields)}).fail(function(e,t){return n.reject(null,t)}),n},o.prototype.tagDocument=function(t,n){n=e._.extend({},n),this.logger.info("Tagging a document",t);var o=e.$.Deferred(),i={url:this.buildBaseUri("/tag"),queryString:this.buildBaseQueryString(n),method:"POST",requestData:t,errorsAsSuccess:!1,responseType:"text"};return this.callWithErrorHandling(i).done(function(){return o.resolve(!0)}).fail(function(){return o.reject(!1)}),o},o.prototype.createEndpointCaller=function(){this.caller=new t.EndpointCaller(this.options)},o.prototype.buildBaseUri=function(t){e.Assert.isString(t);var n=this.options.restUri;return n=this.removeTrailingSlash(n),n+=t,this.options.isOldRestAPI&&(n=this.addTrailingSlash(n)),n},o.prototype.buildBaseQueryString=function(t){var n=[];for(var o in this.options.queryStringArguments)n.push(o+"="+encodeURIComponent(this.options.queryStringArguments[o]));return e._.isArray(t.authentication)&&0!=t.authentication.length&&n.push("authentication="+t.authentication.join(",")),n},o.prototype.buildViewAsHtmlUri=function(t,n,o){e.Assert.isNonEmptyString(n);var i=this.buildViewAsHtmlQueryString(n,o);e.Utils.isNonEmptyString(this.options.accessToken)&&i.push("access_token="+encodeURIComponent(this.options.accessToken));var r=this.buildBaseUri(t);return r+"?"+i.join("&")},o.prototype.buildViewAsHtmlQueryString=function(e,t){var n=this.buildBaseQueryString(t);return n.push("uniqueId="+encodeURIComponent(e)),null!=t.query&&(n.push("q="+encodeURIComponent(t.query)),n.push("enableNavigation=true")),t.requestedOutputSize&&n.push("requestedOutputSize="+encodeURIComponent(t.requestedOutputSize.toString())),t.contentType&&n.push("contentType="+encodeURIComponent(t.contentType)),n},o.prototype.callWithErrorHandling=function(t){var n=e.$.Deferred();return this.performOneCall(t,n,!0),n},o.prototype.performOneCall=function(t,n,o){var i=this;this.caller.call(t).done(function(e){e.data.clientDuration=e.duration,n.resolve(e.data,t.requestData)}).fail(function(r){o&&i.canRenewAccessToken()&&i.isAccessTokenExpiredStatus(r.statusCode)?i.renewAccessToken().done(function(){return i.performOneCall(t,n,!1)}).fail(function(){return i.handleErrorResponse(r,n)}):0==r.statusCode&&i.isRedirecting?e._.defer(function(){n.resolve()}):i.handleErrorResponse(r,n)})},o.prototype.handleErrorResponse=function(e,n){this.isMissingAuthenticationProviderStatus(e.statusCode)?n.reject(null,new t.MissingAuthenticationError(e.data.provider)):e.data&&e.data.message?n.reject(null,new t.QueryError(e)):n.reject(null,new t.AjaxError("Request Error",e.statusCode))},o.prototype.canRenewAccessToken=function(){return e.Utils.isNonEmptyString(this.options.accessToken)&&e._.isFunction(this.options.renewAccessToken)},o.prototype.isAccessTokenExpiredStatus=function(e){return 419==e},o.prototype.renewAccessToken=function(){var t=this;return this.logger.info("Renewing expired access token"),this.options.renewAccessToken().done(function(n){e.Assert.isNonEmptyString(n),t.options.accessToken=n,t.createEndpointCaller()}).fail(function(e){t.logger.error("Failed to renew access token",e)})},o.prototype.isMissingAuthenticationProviderStatus=function(e){return 402==e},o.prototype.addTrailingSlash=function(e){return this.hasTrailingSlash(e)||(e+="/"),e},o.prototype.removeTrailingSlash=function(e){return this.hasTrailingSlash(e)&&(e=e.substr(0,e.length-1)),e},o.prototype.hasTrailingSlash=function(e){return"/"==e.charAt(e.length-1)},o.endpoints={},o}();t.SearchEndpoint=o}(t=e.Rest||(e.Rest={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var n=function(){function t(e,t){this.endpoint=e,this.callOptions=t,this.options=e.options}return t.prototype.getBaseUri=function(){return this.endpoint.getBaseUri()},t.prototype.getAuthenticationProviderUri=function(e,t,n){return this.endpoint.getAuthenticationProviderUri(e,t,n)},t.prototype.isJsonp=function(){return this.endpoint.isJsonp()},t.prototype.search=function(e,t){return this.endpoint.search(e,this.enrichCallOptions(t))},t.prototype.tagDocument=function(e){return this.endpoint.tagDocument(e,this.enrichCallOptions(e))},t.prototype.getRawDataStream=function(e,t,n){return this.endpoint.getRawDataStream(e,t,this.enrichCallOptions(n))},t.prototype.getDocumentText=function(e,t){return this.endpoint.getDocumentText(e,this.enrichCallOptions(t))},t.prototype.getDocumentHtml=function(e,t){return this.endpoint.getDocumentHtml(e,this.enrichCallOptions(t))},t.prototype.getViewAsHtmlUri=function(e,t){return this.endpoint.getViewAsHtmlUri(e,this.enrichCallOptions(t))},t.prototype.getViewAsDatastreamUri=function(e,t,n){return this.endpoint.getViewAsDatastreamUri(e,t,this.enrichCallOptions(n))},t.prototype.listFieldValues=function(e,t){return this.endpoint.listFieldValues(e,this.enrichCallOptions(t))},t.prototype.listFields=function(e){return this.endpoint.listFields(this.enrichCallOptions(e))},t.prototype.enrichCallOptions=function(t){return e._.extend({},t,this.callOptions)},t}();t.SearchEndpointWithDefaultCallOptions=n}(t=e.Rest||(e.Rest={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){e._.templateSettings={evaluate:/(?:<%|{{)([\s\S]+?)(?:%>|}})/g,interpolate:/(?:<%|{{)=([\s\S]+?)(?:%>|}})/g,escape:/(?:<%|{{)-([\s\S]+?)(?:%>|}})/g};var n=function(){function t(t){if(this.logger=new e.Logger(this),e.Utils.isHtmlElement(t)){e.Assert.exists(t);var n=e.$(t).html();this.template=e._.template(n)}else t instanceof Function&&(this.template=t)}return t.prototype.instantiateToString=function(n){var o=e._.extend({},n,t.templateHelpers);return this.template(o)},t.prototype.instantiateToElement=function(t){var n=this.instantiateToString(t),o=e.JQueryUtils.htmlToDom(n);return this.logger.trace("Instantiated result template",t,o),o},t.create=function(n){return e.Assert.exists(n),new t(n)},t.registerTemplateHelper=function(e,n){t.templateHelpers[e]=n},t.isLibraryAvailable=function(){return e.Utils.exists(window._)},t.templateHelpers={},t.mimeTypes=["text/underscore","text/underscore-template","text/x-underscore","text/x-underscore-template"],t}();t.UnderscoreTemplate=n}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var n=function(){function t(n){this.template=n,e.Assert.check(t.isLibraryAvailable(),"The JsRender library must be loaded within the page"),e.Assert.exists(n),this.logger=new e.Logger(this)}return t.prototype.instantiateToString=function(t){return e.$(this.template).render(t)},t.prototype.instantiateToElement=function(t){var n=e.$(this.template).render(t),o=e.JQueryUtils.htmlToDom(n);return this.logger.trace("Instantiated result template",t,o),o},t.create=function(n){return e.Assert.exists(n),new t(n)},t.isLibraryAvailable=function(){return e.Utils.exists(e.$.views)},t.mimeTypes=["text/jsrender","text/jsrender-template","text/x-jsrender","text/x-jsrender-template"],t}();t.JsRenderTemplate=n}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var n=function(){function t(n){e.Assert.check(t.isLibraryAvailable(),"The Handlebars library must be loaded within the page"),e.Assert.exists(n),this.logger=new e.Logger(this);var o=e.$(n).html();this.template=Handlebars.compile(o)}return t.prototype.instantiateToString=function(e){return this.template(e)},t.prototype.instantiateToElement=function(t){var n=this.template(t),o=e.JQueryUtils.htmlToDom(n);return this.logger.trace("Instantiated result template",t,o),o},t.create=function(n){return e.Assert.exists(n),new t(n)},t.isLibraryAvailable=function(){return e.Utils.exists(window.Handlebars)},t.mimeTypes=["text/handlebars","text/handlebars-template","text/x-handlebars","text/x-handlebars-template"],t}();t.HandlebarsTemplate=n}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var n=function(){function n(){}return n.registerTemplate=function(t,o){e.Assert.isNonEmptyString(t),e.Assert.exists(o),n.templates[t]=o},n.getTemplate=function(t){return e.Assert.exists(n.templates[t]),n.templates[t]},n.getTemplateNames=function(){return e._.keys(n.templates)},n.scanAndRegisterTemplates=function(){t.UnderscoreTemplate.isLibraryAvailable()&&n.scanAndRegisterUnderscoreTemplates(),t.JsRenderTemplate.isLibraryAvailable()&&(n.scanAndRegisterJsRenderTemplates(),n.scanAndRegisterJsonTemplates()),t.HandlebarsTemplate.isLibraryAvailable()&&n.scanAndRegisterHandlebarsTemplates()},n.scanAndRegisterUnderscoreTemplates=function(){e._.each(t.UnderscoreTemplate.mimeTypes,function(o){e.$("script[id][type='"+o+"']").each(function(o,i){var r=new t.UnderscoreTemplate(i);n.registerTemplate(e.$(i).attr("id"),function(e){return r.instantiateToString(e)})})})},n.scanAndRegisterJsRenderTemplates=function(){e._.each(t.JsRenderTemplate.mimeTypes,function(o){e.$("script[id][type='"+o+"']").each(function(o,i){var r=new t.JsRenderTemplate(i);n.registerTemplate(e.$(i).attr("id"),function(e){return r.instantiateToString(e)})})})},n.scanAndRegisterHandlebarsTemplates=function(){e._.each(t.HandlebarsTemplate.mimeTypes,function(o){e.$("script[id][type='"+o+"']").each(function(o,i){var r=new t.HandlebarsTemplate(i);n.registerTemplate(e.$(i).attr("id"),function(e){return r.instantiateToString(e)})})})},n.scanAndRegisterJsonTemplates=function(){e._.each(t.JsonTemplate.mimeTypes,function(o){e.$("script[id][type='"+o+"']").each(function(o,i){var r=new t.JsonTemplate(i);n.registerTemplate(e.$(i).attr("id"),function(e){return r.instantiateToString(e)})})})},n.templates={},n}();t.TemplateCache=n,e.$(function(){n.scanAndRegisterTemplates()})}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var n=function(){function n(n){var o;if(e.Utils.isHtmlElement(n)){e.Assert.exists(n);var i=e.$(n).html();o=e.Utils.isNullOrEmptyString(i)?null:JSON.parse(i)}else n instanceof Object&&(o=n);this.template=new t.JsRenderTemplate(e.$(this.renderTemplate(o).result).get(0))}return n.prototype.instantiateToString=function(e){return this.template.instantiateToString(e)},n.prototype.instantiateToElement=function(e){return this.template.instantiateToElement(e)},n.prototype.renderTemplate=function(e){if(null==e&&(e={type:"list",containers:[],leftContainers:[],rightContainers:[]}),"list"==e.type){var t='<script type="text/x-jsrender"><div class="item result">';return e.leftContainers&&e.leftContainers.length>0&&(t+='<div style="float: left;">'+this.renderContainers(e.leftContainers)+"</div>"),e.rightContainers&&e.rightContainers.length>0&&(t+='<div style="float: right;">'+this.renderContainers(e.rightContainers)+"</div>"),e.containers.length>0&&(t+='<div style="overflow: hidden;">'+this.renderContainers(e.containers)+"</div>"),t+="</div></script>",{result:t}}for(var n="<thead><tr>",t='<script type="text/x-jsrender"><tr class="item result">',o=0;o<e.containers.length;o++){var i=e.containers[o],r=this.cleanWidth(i.settings.width);n+='<th width="'+r+'">'+this.plainText(i.settings.header)+"</th>";for(var s=[],a=0;a<i.contents.length;a++)s.push(this.renderContent(i.contents[a]));t+='<td width="'+r+'">'+s.join(" ")+"</td>"}return n+="</tr></thead>",t+="</tr></script>",{header:n,result:t}},n.prototype.renderContainers=function(e){for(var t="",n=0;n<e.length;n++){for(var o=e[n],i=[],r=0;r<o.contents.length;r++)i.push(this.renderContent(o.contents[r]));t+="<div>"+i.join(" ")+"</div>"}return t},n.prototype.renderContent=function(e){return"field"==e.type?this.renderField(e):"code"==e.type?this.renderCode(e):"link"==e.type?this.renderLink(e):"thumbnail"==e.type?this.renderThumbnail(e):"badge"==e.type?this.renderBadge(e):"quickview"==e.type?this.renderQuickView(e):"custom_component"==e.type?this.renderCustomComponent(e):"field_table"==e.type?this.renderFieldTable(e):""},n.prototype.renderField=function(e){var t="",n=this.cleanText(e.settings.name);n=this.lowercaseFirstLetter(n);var o="span",i=n.split("."),r={};switch(e.settings.renderAs){case"link":var s=this.cleanText(e.settings.text);""==s&&(s=n),o="a",r.href="{{url:"+n+"}}",r["data-href"]="{{>"+n+"}}",r.target=null!=e.settings.sameTab&&"true"==e.settings.sameTab?"_self":"_blank";var a=this.lowercaseFirstLetter(s);t=a.indexOf("'")>=0?"{{>"+a+"}}":"{{if "+a+"Highlights}}{{:~highlight("+a+", "+a+"Highlights)}}{{else}}{{>"+s+"}}{{/if}}",i.push("CoveoResultLink"),i.push("coveo-link");break;case"email":t="true"==e.settings.toHyperlinks?"{{:~email("+n+")}}":"{{>"+n+"}}",i.push("coveo-email");break;case"date":var l=e.settings.format;"dateToString"==l&&(l="date"),"timeToString"==l&&(l="time"),"dateTimeToString"==l&&(l="dateTime"),"emailDateTimeToString"==l&&(l="emailDateTime"),(null==l||"time"!=l&&"dateTime"!=l&&"emailDateTime"!=l)&&(l="date"),t="{{>~"+l+"("+n+")}}",i.push("coveo-date");break;default:t="true"==e.settings.emailList?"{{:~email("+n+")}}":"{{if "+n+"Highlights}}{{:~highlight("+n+", "+n+"Highlights)}}{{else}}{{>"+n+"}}{{/if}}"}return r["class"]=i.join(" "),t=this.renderStyleSettings(e.settings,t,o,r),t=this.renderEllipsis(e.settings,t),null==e.settings.label||e.settings.label.match("^\\s*$")||(t='<span class="coveo-label">'+this.plainText(e.settings.label)+"</span>"+t),"{{if "+n+"}}"+t+"{{/if}}"},n.prototype.renderEllipsis=function(e,t){return null!=e.ellipsis&&"true"==e.ellipsis?'<div class="coveo-ellipsis">'+t+"</div>":t},n.prototype.renderStyleSettings=function(e,t,n,o){var i={};null!=e.color&&""!=e.color&&(i.color=this.cleanColor(e.color)),null!=e.bold&&"true"==e.bold&&(i["font-weight"]="bold"),null!=e.italic&&"true"==e.italic&&(i["font-style"]="italic"),null!=e.underline&&"true"==e.underline&&(i["text-decoration"]="underline");var r=" ";for(var s in o)r+=s+'="'+o[s]+'" ';var a="";for(var s in i)a+=s+":"+i[s]+";";return"<"+n+r+'style="'+a+'">'+t+"</"+n+">"},n.prototype.renderCustomComponent=function(e){var t="{{if "+this.jsRenderEncode(e.settings.condition)+"}}";return t+='     <span class="'+this.jsRenderEncode(e.settings.component)+'" href="javascript:void(0);"></span>',t+="{{/if}}"},n.prototype.renderCode=function(e){return"<span>{{html:"+this.jsRenderEncode(e.settings.value)+"}}</span>"},n.prototype.renderLink=function(e){var t=this.jsRenderEncode(e.settings.value),n=this.jsRenderEncode(e.settings.text);(null==n||""==n)&&(n=t),n=this.lowercaseFirstLetter(n);var o,i=null!=e.settings.sameTab&&"true"==e.settings.sameTab?"_self":"_blank";return o=n.indexOf("'")>=0?"{{>"+n+"}}":"{{if "+n+"Highlights}}{{:~highlight("+n+", "+n+"Highlights)}}{{else}}{{html:"+n+"}}{{/if}}",'<a href="{{url:'+t+'}}" data-href="{{>'+t+'}}" target="'+i+'">'+o+"</a>"},n.prototype.renderThumbnail=function(e){var t=this.jsRenderEncode(e.settings.url);return'<img class="coveo-sf-thumb" src="{{url:'+t+'}}" style="height: '+e.settings.height+'px"/>'},n.prototype.renderBadge=function(e){var t=this.jsRenderEncode(e.settings.fieldName),n="{{html:"+t+"}}";
return n=this.renderStyleSettings(e.settings,n,"span",{"class":"coveo-badge"}),"{{if "+t+" != undefined}}"+n+"{{/if}}"},n.prototype.renderQuickView=function(e){return'<div class="CoveoQuickView" data-title="{{html:'+this.jsRenderEncode(e.settings.title)+'}}"><div class="CoveoQuickViewDocument"></div></div>'},n.prototype.renderFieldTable=function(t){var n,o=this;try{n=JSON.parse(t.settings.rows)}catch(i){n=[]}return'<table class="CoveoFieldTable">'+e._.map(n,function(e){var t=[];return t.push('data-field="'+o.jsRenderEncode(e.field)+'"'),e.caption&&t.push('data-caption="'+o.jsRenderEncode(e.caption)+'"'),"<tr "+t.join(" ")+"></tr>"}).join("")+"</div>"},n.prototype.cleanText=function(e){return null==e?"":e.replace(/[^A-Za-z0-9_\.]/g,"")},n.prototype.lowercaseFirstLetter=function(e){return e&&e.length>0?e.charAt(0).toLowerCase()+e.slice(1):""},n.prototype.cleanColor=function(e){return null==e?"":e.match(/^#[0-9A-Fa-f]{3,6}$/)||e.match(/^[a-z]+$/)?e:""},n.prototype.cleanWidth=function(e){return null==e?"":e.match(/^[0-9]{1,2}?%|[0-9]+$/)?e:""},n.prototype.plainText=function(e){return this.jsRenderEncode(this.htmlEncode(e))},n.prototype.htmlEncode=function(e){return null==e?"":e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},n.prototype.jsRenderEncode=function(e){return null==e?"":e.replace(/\}\}/g,"}}")},n.create=function(t){return e.Assert.exists(t),new n(t)},n.isLibraryAvailable=function(){return e.Utils.exists(window.TemplateEditorUtils)&&t.JsRenderTemplate.isLibraryAvailable()},n.mimeTypes=["text/json-template"],n}();t.JsonTemplate=n}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var n=function(){function n(){}return n.registerTemplateHelper=function(o,i){e.Assert.isNonEmptyString(o),e.Assert.exists(i),t.UnderscoreTemplate.isLibraryAvailable()&&n.registerTemplateHelperInUnderscore(o,i),t.JsRenderTemplate.isLibraryAvailable()&&n.registerTemplateHelperInJsRender(o,i),t.HandlebarsTemplate.isLibraryAvailable()&&n.registerTemplateHelperInHandlebars(o,i),n.helpers[o]=i},n.getHelper=function(e){return n.helpers[e]},n.registerTemplateHelperInJsRender=function(t,n){e.Assert.isNonEmptyString(t),e.Assert.exists(n);var o={};o[t]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return n.apply(this.data,e)},e.$.views.helpers(o)},n.registerTemplateHelperInHandlebars=function(n,o){e.Assert.isNonEmptyString(n),e.Assert.exists(o),e.Assert.check(t.HandlebarsTemplate.isLibraryAvailable()),Handlebars.registerHelper(n,function(){for(var t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];var i=t[t.length-1];return e._.isObject(i)&&e.Utils.exists(i.hash)&&(t[t.length-1]=i.hash),new Handlebars.SafeString(o.apply(this,t))})},n.registerTemplateHelperInUnderscore=function(n,o){e.Assert.isNonEmptyString(n),e.Assert.exists(o),e.Assert.check(t.UnderscoreTemplate.isLibraryAvailable()),t.UnderscoreTemplate.registerTemplateHelper(n,o)},n.helpers={},n}();t.TemplateHelpers=n}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var n=function(){function n(){}return n.registerDefaultOptions=function(t,n){var o=e.$(t).data("CoveoDefaultOptions")||{},i=e.$.extend(!0,{},o,n);e.$(t).data("CoveoDefaultOptions",i)},n.resolveDefaultOptions=function(t,o){var i,r=e.$(t).data("CoveoDefaultOptions");return i=e.Utils.exists(r)?e.$.extend(!0,{},r,o):o,t.parentElement?n.resolveDefaultOptions(t.parentElement,i):i},n.registerAutoCreateComponent=function(t){e.Assert.exists(t),e.Assert.exists(t.ID),e.Assert.doesNotExists(n.autoCreateComponents[t.ID]),e.Assert.doesNotExists(n.namedMethods[t.ID]),n.autoCreateComponents[t.ID]=t},n.isComponentClassIdRegistered=function(t){return e.Utils.exists(n.autoCreateComponents[t])},n.getListOfRegistredComponents=function(){return e._.keys(n.autoCreateComponents)},n.getRegistredComponent=function(e){return n.autoCreateComponents[e]},n.initializeSearchInterface=function(o,i){e.Assert.exists(o),this.logger.info("Internal Coveo JQuery version",e.$.fn.jquery),e.DeviceUtils.isIE8or9()&&e.$("html").addClass("ie8or9"),i=n.resolveDefaultOptions(o,i),n.performInitFunctionsOption(i,e.Events.InitializationEvents.beforeInitialization),e.$(o).trigger(e.Events.InitializationEvents.beforeInitialization),n.initComponents(o,i),n.initExternalComponents(o,i),n.performInitFunctionsOption(i,e.Events.InitializationEvents.afterComponentsInitialization),e.$(o).trigger(e.Events.InitializationEvents.afterComponentsInitialization),e.$(o).trigger(e.Events.InitializationEvents.restoreHistoryState),n.performInitFunctionsOption(i,e.Events.InitializationEvents.afterInitialization),e.$(o).trigger(e.Events.InitializationEvents.afterInitialization);var r=t.Component.get(o,t.SearchInterface);e.$(".coveo-hide-until-loaded").removeClass("coveo-hide-until-loaded").addClass("coveo-show-after-loaded"),r.options.autoTriggerQuery&&t.Component.get(o,e.Controllers.QueryController).executeQuery()},n.initializeSearchInterfaceForSearchBox=function(t,o,i){e.Assert.isNonEmptyString(o);var r={};r.searchPageUri=o,r.autoTriggerQuery=!1,r.hideUntilFirstQuery=!1,r.enableHistory=!1,i=e._.extend({},i,{SearchInterface:r}),n.initializeSearchInterface(t,i)},n.performInitFunctionsOption=function(t,o){e.Utils.exists(t)&&n.performFunctions(t[o])},n.performPreInitFunctions=function(t){e.Utils.exists(t)&&n.performFunctions(t[e.Events.InitializationEvents.beforeInitialization])},n.performPostInitFunction=function(t){e.Utils.exists(t)&&n.performFunctions(t[e.Events.InitializationEvents.afterInitialization])},n.performFunctions=function(t){e.Utils.exists(t)&&e._.each(t,function(e){"function"==typeof e&&e()})},n.initComponents=function(o,i){void 0===i&&(i={}),i.SearchInterface=i.SearchInterface||{},i.SearchInterface.initOptions=i;var r=new t.SearchInterface(o,i.SearchInterface,i.Analytics),s=e.$.extend({},{options:i},r.getBindings());n.automaticallyCreateComponentsInside(o,s)},n.initExternalComponents=function(t,o){if(o&&o.externalComponents){var i=e.$(t).coveo(e.Ui.SearchInterface),r=e.$(t).coveo(e.Models.QueryStateModel),s=e.$(t).coveo(e.Models.ComponentStateModel),a=e.$(t).coveo(e.Controllers.QueryController),l=e.$(t).coveo(e.Models.ComponentOptionsModel),u=i.usageAnalytics;e.Assert.exists(i),e.Assert.exists(r),e.Assert.exists(a),e.Assert.exists(s),e.Assert.exists(u);var c={options:o,searchInterface:i,queryStateModel:r,queryController:a,usageAnalytics:u,componentStateModel:s,componentOptionsModel:l,root:t};e._.each(o.externalComponents,function(t){var o=t;o instanceof e.$&&(o=e.$(o).get(0)),e.Utils.isHtmlElement(o)&&n.automaticallyCreateComponentsInside(o,c)})}},n.automaticallyCreateComponentsInside=function(o,i,r){e.Assert.exists(o);var s=[];for(var a in n.autoCreateComponents)if(!e._.contains(r,a)){var l=n.autoCreateComponents[a],u=t.Component.computeCssClassNameForType(l.ID),c=e.$(o).find("."+u);e.$(o).hasClass(u)&&(c=c.add(o)),0!=c.length&&s.push(n.createFunctionThatInitializesComponentOnElements(c,a,l,i))}e._.each(s,function(e){return e()})},n.createFunctionThatInitializesComponentOnElements=function(t,o,i,r){return function(){t.each(function(t,s){var a=void 0;if(e.Utils.exists(r.options)){var l=r.options[o],u=r.options[s.id],c=r.options.initOptions?r.options.initOptions[o]:{};a=e.$.extend({},l,u,c)}var p=e.$.extend({},r,{options:a});n.createComponentOfThisClassOnElement(i.ID,s,p)})}},n.createComponentOfThisClassOnElement=function(t,o,i){e.Assert.isNonEmptyString(t),e.Assert.exists(o);var r=n.autoCreateComponents[t];e.Assert.exists(r);var s={},a={},l=void 0;return void 0!=i&&(s={queryController:i.queryController,queryStateModel:i.queryStateModel,componentStateModel:i.componentStateModel,root:i.root,searchInterface:i.searchInterface,usageAnalytics:i.usageAnalytics,componentOptionsModel:i.componentOptionsModel},a=i.options,l=i.result),n.logger.trace("Creating component of class "+t,o,a),new r(o,a,s,l)},n.registerNamedMethod=function(t,o){e.Assert.isNonEmptyString(t),e.Assert.doesNotExists(n.autoCreateComponents[t]),e.Assert.doesNotExists(n.namedMethods[t]),e.Assert.exists(o),n.namedMethods[t]=o},n.isNamedMethodRegistered=function(t){return e.Utils.exists(n.namedMethods[t])},n.dispatchNamedMethodCall=function(t,o,i){e.Assert.isNonEmptyString(t),e.Assert.exists(o);var r=n.namedMethods[t];return e.Assert.exists(r),n.logger.trace("Dispatching named method call of "+t,o,i),r.apply(null,[o].concat(i))},n.isThereASingleComponentBoundToThisElement=function(n){return e.Assert.exists(n),e.Utils.exists(t.Component.get(n))},n.dispatchMethodCallOnBoundComponent=function(n,o,i){e.Assert.isNonEmptyString(n),e.Assert.exists(o);var r=t.Component.get(o);e.Assert.exists(r);var s=r[n];return e.Utils.exists(s)?s.apply(r,i):(e.Assert.fail("No method named "+n+" exist on component "+r.type),void 0)},n.dispatchNamedMethodCallOrComponentCreation=function(t,o,i){return e.Assert.isNonEmptyString(t),e.Assert.exists(o),n.isNamedMethodRegistered(t)?n.dispatchNamedMethodCall(t,o,i):n.isComponentClassIdRegistered(t)?n.createComponentOfThisClassOnElement(t,o,i[0]):n.isThereASingleComponentBoundToThisElement(o)?n.dispatchMethodCallOnBoundComponent(t,o,i):(e.Assert.fail("No method or component named "+t+" are registered."),void 0)},n.monkeyPatchComponentMethod=function(n,o,i){e.Assert.isNonEmptyString(n),e.Assert.exists(i);var r;if(n.indexOf(".")>0){var s=n.split(".");e.Assert.check(2==s.length,"Invalid method name, correct syntax is CoveoComponent.methodName."),r=s[0],n=s[1]}var a=t.Component.get(o,r);e.Assert.exists(a),e.Assert.exists(a[n]);var l="__"+n;e.Utils.exists(a[l])||(a[l]=a[n]),a[n]=i},n.noConflict=function(){e.$=jQuery.noConflict(!0),window.$.fn.coveo=e.$.fn.coveo},n.logger=new e.Logger("JQuery"),n.autoCreateComponents={},n.namedMethods={},n}();t.CoveoJQuery=n}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={})),$.fn.coveo=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];var n;return this.each(function(t,o){var i;if(_.isString(e[0])){var r=e[0];i=Coveo.Ui.CoveoJQuery.dispatchNamedMethodCallOrComponentCreation(r,o,e.slice(1))}else i=Coveo.Ui.CoveoJQuery.dispatchNamedMethodCall("get",o,e);n=n||i}),n},Coveo.$.fn.getCursorPosition=function(){var e=this.get(0);if(e){if("selectionStart"in e)return e.selectionStart;if(document.selection){e.focus();var t=document.selection.createRange(),n=document.selection.createRange().text.length;return t.moveStart("character",-e.value.length),t.text.length-n}}},Coveo.Ui.CoveoJQuery.registerNamedMethod("options",function(e,t){Coveo.Ui.CoveoJQuery.registerDefaultOptions(e,t)}),Coveo.Ui.CoveoJQuery.registerNamedMethod("init",function(e,t){Coveo.Ui.CoveoJQuery.initializeSearchInterface(e,t)}),Coveo.Ui.CoveoJQuery.registerNamedMethod("initSearchBox",function(e,t,n){Coveo.Ui.CoveoJQuery.initializeSearchInterfaceForSearchBox(e,t,n)}),Coveo.Ui.CoveoJQuery.registerNamedMethod("patch",function(e,t,n){Coveo.Ui.CoveoJQuery.monkeyPatchComponentMethod(t,e,n)}),Coveo.Ui.CoveoJQuery.registerNamedMethod("noConflict",function(){Coveo.Ui.CoveoJQuery.noConflict()});var Coveo;!function(e){var t;!function(t){var n=function(){function n(o,i,r){var s=this;void 0===r&&(r={}),this.element=o,this.type=i,this.disabled=!1,this.bind=new t.ComponentEvents(this),e.Assert.exists(o),e.Assert.isNonEmptyString(i),n.bindComponentToElement(this.element,this),this.logger=new e.Logger(this),this.root=r.root||this.resolveRoot(),this.queryStateModel=r.queryStateModel||this.resolveQueryStateModel(),this.componentStateModel=r.componentStateModel||this.resolveComponentStateModel(),this.queryController=r.queryController||this.resolveQueryController(),this.searchInterface=r.searchInterface||this.resolveSearchInterface(),this.usageAnalytics=r.usageAnalytics||this.resolveUA(),this.componentOptionsModel=r.componentOptionsModel||this.resolveComponentOptionsModel(),this.ensureDom=e._.once(function(){return s.createDom()}),null!=this.searchInterface&&this.searchInterface.attachComponent(i,this)}return n.prototype.getBindings=function(){return{root:this.root,queryStateModel:this.queryStateModel,queryController:this.queryController,searchInterface:this.searchInterface,componentStateModel:this.componentStateModel,componentOptionsModel:this.componentOptionsModel,usageAnalytics:this.usageAnalytics}},n.prototype.enable=function(){this.disabled=!1},n.prototype.disable=function(){this.disabled=!0},n.prototype.createDom=function(){},n.prototype.resolveSearchInterface=function(){return n.resolveBinding(this.element,t.SearchInterface)},n.prototype.resolveRoot=function(e){var o=n.resolveBinding(this.element,t.SearchInterface);return o?o.element:e},n.prototype.resolveQueryController=function(t){return n.resolveBinding(this.element,e.Controllers.QueryController)||t},n.prototype.resolveComponentStateModel=function(t){return n.resolveBinding(this.element,e.Models.ComponentStateModel)||t},n.prototype.resolveQueryStateModel=function(t){return n.resolveBinding(this.element,e.Models.QueryStateModel)||t},n.prototype.resolveComponentOptionsModel=function(t){return n.resolveBinding(this.element,e.Models.ComponentOptionsModel)||t},n.prototype.resolveUA=function(){var e=this.resolveSearchInterface();return e&&e.usageAnalytics?e.usageAnalytics:new t.NoopAnalyticsClient},n.prototype.resolveResult=function(){var t=e.$(this.element).closest(".CoveoResult");return e.Assert.check(1==t.length),t.get(0).CoveoResult},n.prototype.isInstanceOf=function(t){return n.getComponentRef(t)&&this instanceof e.Ui[t]},n.getComponentRef=function(t){return e.Ui[t]},n.get=function(t,o,i){if(e.Assert.exists(t),e._.isString(o))return t[n.computeMemberNameForType(o)];if(e.Utils.exists(o))return e.Assert.exists(o.ID),t[n.computeMemberNameForType(o.ID)];var r=n.getBoundComponentsForElement(t);return i||e.Assert.check(r.length<=1,"More than one component is bound to this element. You need to specify the component type."),r[0]},n.bindComponentToElement=function(t,o){e.Assert.exists(t),e.Assert.exists(o),e.Assert.isNonEmptyString(o.type),t[n.computeMemberNameForType(o.type)]=o,e.$(t).addClass(n.computeCssClassNameForType(o.type)),n.getBoundComponentsForElement(t).push(o)},n.bindResultToElement=function(t,n){e.Assert.exists(t),e.Assert.exists(n),e.$(t).addClass("CoveoResult"),t.CoveoResult=n},n.resolveBinding=function(t,o){e.Assert.exists(t),e.Assert.exists(o),e.Assert.exists(o.ID);var i=e.$(t).closest("."+n.computeCssClassNameForType(o.ID));return 0==i.length?void 0:i.get(0)[n.computeMemberNameForType(o.ID)]},n.computeCssClassNameForType=function(t){return e.Assert.isNonEmptyString(t),"Coveo"+t},n.computeSelectorForType=function(t){return e.Assert.isNonEmptyString(t),"."+n.computeCssClassNameForType(t)},n.computeMemberNameForType=function(t){return e.Assert.isNonEmptyString(t),"Coveo"+t},n.pointElementsToDummyForm=function(e){e.add(e.find("*")).filter("input").attr("form","coveo-dummy-form")},n.getBoundComponentsForElement=function(t){return e.Assert.exists(t),null==t.CoveoBoundComponents&&(t.CoveoBoundComponents=[]),t.CoveoBoundComponents},n}();t.Component=n,t.CoveoJQuery.registerNamedMethod("get",function(t,o){return e.Assert.exists(t),n.get(t,o)})}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var n=function(){function t(t){this.owner=t,e.Assert.exists(t)}return t.prototype.on=function(e,t,n){e.on(t,this.wrapToCallIfEnabled(n))},t.prototype.onRoot=function(t,n){this.on(e.$(this.owner.root),t,n)},t.prototype.fastClick=function(e,t){e.fastClick(this.wrapToCallIfEnabled(t))},t.prototype.trigger=function(e,t,n){this.wrapToCallIfEnabled(function(){e.trigger(t,n)})},t.prototype.wrapToCallIfEnabled=function(e){var t=this;return function(){for(var n=[],o=0;o<arguments.length;o++)n[o-0]=arguments[o];return t.owner.disabled?void 0:e.apply(t.owner,n)}},t}();t.ComponentEvents=n}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var n;!function(n){function o(e){return y(0,O,e)}function i(e){return y(1,A,e)}function r(e){return y(2,E,e)}function s(e){return y(9,E,e)}function a(e){return y(3,x,e)}function l(e){return y(8,S,e)}function u(e){return y(4,U,e)}function c(e){return y(5,_,e)}function p(e){return y(6,R,e)}function d(e){return y(7,M,e)}function h(e,t){var n=function(t,n,o){var i=E(t,n,o);return e(i)};return y(2,n,t)}function f(e,t){var n=function(t,n,o){var i=U(t,n,o);return e(i)};return y(4,n,t)}function m(t){var n=function(n,o){for(var i=e._.keys(t.subOptions),r={},s={},a=0;a<i.length;a++){var l=i[a],u=o+l.substr(0,1).toUpperCase()+l.substr(1);r[u]=t.subOptions[l]}b(n,r,s);for(var c={},a=0;a<i.length;a++){var l=i[a],u=o+l.substr(0,1).toUpperCase()+l.substr(1);null!=s[u]&&(c[l]=s[u])}return e._.keys(c).length>0?c:null};return y(10,n,t)}function y(e,t,n){void 0===n&&(n={});var o=n;return o.type=e,o.load=t,o}function g(e,t){return t.attrName?t.attrName:"data-"+e.replace(/([A-Z])/g,"-$1").toLowerCase()}function v(e){var t=e.split("-");t.shift();for(var n=1;n<t.length;n++)t[n]=t[n].substr(0,1).toUpperCase()+t[n].substr(1);return t.join("")}function C(e,t,n){return b(e,t.options,n)}function b(t,n,o){null==o&&(o={});for(var i=e._.keys(n),r=0;r<i.length;r++){var s,a=i[r],l=n[a],u=(l.attrName||g(a,l),l.load);null!=u&&(s=u(t,a,l)),null==s&&void 0==o[a]&&(null!=l.defaultValue?s=4==l.type?e._.extend([],l.defaultValue):10==l.type?e._.extend({},l.defaultValue):l.defaultValue:null!=l.defaultFunction&&(s=l.defaultFunction(t))),null!=s&&(o[a]=s)}for(var r=0;r<i.length;r++){var a=i[r],l=n[a];l.postProcessing&&(o[a]=l.postProcessing(o[a],o))}return o}function E(t,n,o){return e.$(t).attr(g(n,o))}function S(t,n,o){var i=E(t,n,o);return e.Assert.check(!e.Utils.isNonEmptyString(i)||e.Utils.isCoveoField(i),i+" is not a valid field"),null!=i?i.toLowerCase():null}function x(t,n,o){var i=E(t,n,o),r=String.locale||String.defaultLocale;if(null!=r&&null!=i){var s=r.toLowerCase().split("-"),a=e._.map(s,function(e,t){return s.slice(0,t+1).join("-")}),l=i.match(L);if(null!=l)for(var u=0;u<l.length;u++){var c=L.exec(l[u]);if(null!=c){var p=c[1].toLowerCase();if(e._.contains(a,p))return c[2].replace(/^\s+|\s+$/g,"")}}return null!=i?i.toLocaleString():null}return i}function A(t,n,o){return e.Utils.parseIntIfNotUndefined(E(t,n,o))}function T(t,n,o){return e.Utils.parseFloatIfNotUndefined(E(t,n,o))}function O(t,n,o){return e.Utils.parseBooleanIfNotUndefined(E(t,n,o))}function U(t,n,o){var i=o.separator||/\s*,\s*/,r=E(t,n,o);return e.Utils.isNonEmptyString(r)?r.split(i):null}function w(e,t,n,o){var i=E(e,t,n);return null!=i?o[i]:null}function _(t,n,o){var i=E(t,n,o);return e.Utils.isNonEmptyString(i)?e.$(i).get(0):null}function R(t,n,o){var i,r=o.selectorAttr||g(n,o)+"-selector",s=e.$(t).attr(r);if(i=e.$(s).get(0),null==i){var a=o.childSelector;null==a&&(a="."+n),i=I(t,a)}return i}function I(t,n){if(e.Assert.isNonEmptyString(n),e.$(t).is(n))return t;var o=e.$(t).find(n);return 0!=o.length?o.get(0):null}function M(t,n,o){var i,r=o.selectorAttr||g(n,o)+"-selector",s=e.$(t).attr(r),a=e.$(s).get(0);if(null!=a&&(i=k(a)),null==i){var l=o.idAttr||g(n,o)+"-id",u=e.$(t).attr(l);null!=u&&(i=D(u))}if(null==i){var c=o.childSelector;null==c&&(c="."+n.replace(/([A-Z])/g,"-$1").toLowerCase()),i=Q(t,c)}return i}function D(n){return e.Utils.isNonEmptyString(n)?new t.UnderscoreTemplate(t.TemplateCache.getTemplate(n)):null}function Q(e,t){var n=I(e,t);return null!=n?k(n):null}function N(t){for(var n=e.$(t);!n.is(document)&&0!=n.length;){if(B(n))return n.is("body")?e.$(window).get(0):n.get(0);n=n.parent()}return e.$(window).get(0)}function B(e){return"scroll"==e.css("overflow-y")}function k(n){e.Assert.exists(n);var o=e.$(n).attr("type");return e.Assert.check(e.Utils.isNonEmptyString(o),"You must specify the type of template"),-1!=e._.indexOf(t.UnderscoreTemplate.mimeTypes,o)?t.UnderscoreTemplate.create(n):-1!=e._.indexOf(t.JsRenderTemplate.mimeTypes,o)?t.JsRenderTemplate.create(n):-1!=e._.indexOf(t.HandlebarsTemplate.mimeTypes,o)?t.HandlebarsTemplate.create(n):-1!=e._.indexOf(t.JsonTemplate.mimeTypes,o)?t.JsonTemplate.create(n):(e.Assert.fail("Cannot guess template type from attribute: "+o),void 0)}!function(e){e[e.BOOLEAN=0]="BOOLEAN",e[e.NUMBER=1]="NUMBER",e[e.STRING=2]="STRING",e[e.LOCALIZED_STRING=3]="LOCALIZED_STRING",e[e.LIST=4]="LIST",e[e.SELECTOR=5]="SELECTOR",e[e.CHILD_HTML_ELEMENT=6]="CHILD_HTML_ELEMENT",e[e.TEMPLATE=7]="TEMPLATE",e[e.FIELD=8]="FIELD",e[e.ICON=9]="ICON",e[e.OBJECT=10]="OBJECT",e[e.NONE=11]="NONE"}(n.Type||(n.Type={}));n.Type;n.buildBooleanOption=o,n.buildNumberOption=i,n.buildStringOption=r,n.buildIconOption=s,n.buildLocalizedStringOption=a,n.buildFieldOption=l,n.buildListOption=u,n.buildSelectorOption=c,n.buildChildHtmlElementOption=p,n.buildTemplateOption=d,n.buildCustomOption=h,n.buildCustomListOption=f,n.buildObjectOption=m,n.buildOption=y,n.attrNameFromName=g,n.nameFromattrName=v,n.initComponentOptions=C,n.initOptions=b,n.loadStringOption=E,n.loadFieldOption=S;var L=/([a-zA-Z\-]+)\s*:\s*(([^,]|,\s*(?!([a-zA-Z\-]+)\s*:))+)/g;n.loadLocalizedStringOption=x,n.loadNumberOption=A,n.loadFloatOption=T,n.loadBooleanOption=O,n.loadListOption=U,n.loadEnumOption=w,n.loadSelectorOption=_,n.loadChildHtmlElementOption=R,n.loadChildHtmlElementFromSelector=I,n.loadTemplateOption=M,n.loadResultTemplateFromId=D,n.loadChildResultTemplateFromSelector=Q,n.findParentScrolling=N,n.isElementScrollable=B,n.createResultTemplateFromElement=k}(n=t.ComponentOptions||(t.ComponentOptions={}))}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var n=function(){function n(){this.expression=new t.ExpressionBuilder,this.advancedExpression=new t.ExpressionBuilder,this.constantExpression=new t.ExpressionBuilder,this.disjunctionExpression=new t.ExpressionBuilder,this.firstResult=0,this.numberOfResults=10,this.enableDidYouMean=!1,this.enableDebug=!0,this.sortCriteria="relevancy",this.retrieveFirstSentences=!0,this.queryUid=e.QueryUtils.createGuid(),this.queryFunctions=[],this.rankingFunctions=[],this.groupByRequests=[],this.enableDuplicateFiltering=!1}return n.prototype.build=function(){var e={q:this.expression.build(),aq:this.advancedExpression.build(),cq:this.constantExpression.build(),dq:this.disjunctionExpression.build(),wildcards:this.enableWildcards,questionMarks:this.enableQuestionMarks,lowercaseOperators:this.enableLowercaseOperators,partialMatch:this.enablePartialMatch,partialMatchKeywords:this.partialMatchKeywords,partialMatchThreshold:this.partialMatchThreshold,firstResult:this.firstResult,numberOfResults:this.numberOfResults,excerptLength:this.excerptLength,filterField:this.filterField,filterFieldRange:this.filterFieldRange,parentField:this.parentField,childField:this.childField,fieldsToInclude:this.fieldsToInclude,fieldsToExclude:this.fieldsToExclude,enableDidYouMean:this.enableDidYouMean,sortCriteria:this.sortCriteria,sortField:this.sortField,queryFunctions:this.queryFunctions,rankingFunctions:this.rankingFunctions,groupBy:this.groupByRequests,retrieveFirstSentences:this.retrieveFirstSentences,timezone:this.timezone,enableDuplicateFiltering:this.enableDuplicateFiltering};return e},n.prototype.computeCompleteExpression=function(){return this.computeCompleteExpressionParts().full},n.prototype.computeCompleteExpressionParts=function(){var e=t.ExpressionBuilder.merge(this.expression,this.advancedExpression);return{full:t.ExpressionBuilder.mergeUsingOr(t.ExpressionBuilder.merge(e,this.constantExpression),this.disjunctionExpression).build(),withoutConstant:t.ExpressionBuilder.mergeUsingOr(e,this.disjunctionExpression).build(),constant:t.ExpressionBuilder.mergeUsingOr(this.constantExpression,this.disjunctionExpression).build()}},n.prototype.computeCompleteExpressionExcept=function(e){return this.computeCompleteExpressionPartsExcept(e).full},n.prototype.computeCompleteExpressionPartsExcept=function(e){var n=t.ExpressionBuilder.merge(this.expression,this.advancedExpression);return n.remove(e),{full:t.ExpressionBuilder.mergeUsingOr(t.ExpressionBuilder.merge(n,this.constantExpression),this.disjunctionExpression).build(),withoutConstant:t.ExpressionBuilder.mergeUsingOr(n,this.disjunctionExpression).build(),constant:t.ExpressionBuilder.mergeUsingOr(this.constantExpression,this.disjunctionExpression).build()}},n}();t.QueryBuilder=n}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var n=function(){function t(){this.parts=[],this.wrapParts=!0}return t.prototype.add=function(t){e.Assert.isNonEmptyString(t),this.parts.push(t)},t.prototype.addFieldExpression=function(t,n,o){e.Assert.isNonEmptyString(t),e.Assert.stringStartsWith(t,"@"),e.Assert.isNonEmptyString(n),e.Assert.isLargerOrEqualsThan(1,o.length),this.add(e.QueryUtils.buildFieldExpression(t,n,o))},t.prototype.addFieldNotEqualExpression=function(t,n){e.Assert.isNonEmptyString(t),e.Assert.stringStartsWith(t,"@"),e.Assert.isLargerOrEqualsThan(1,n.length),this.add(e.QueryUtils.buildFieldNotEqualExpression(t,n))},t.prototype.remove=function(t){e.Assert.isNonEmptyString(t);var n=e._.indexOf(this.parts,t);-1!=n&&this.parts.splice(e._.indexOf(this.parts,t),1)},t.prototype.isEmpty=function(){return 0==this.parts.length},t.prototype.build=function(){return 0==this.parts.length?void 0:1==this.parts.length?this.parts[0]:this.wrapParts?"("+this.parts.join(") (")+")":this.parts.join(" ")},t.merge=function(){for(var n=[],o=0;o<arguments.length;o++)n[o-0]=arguments[o];var i=new t;return e._.each(n,function(e){i.parts=i.parts.concat(e.parts)}),i},t.mergeUsingOr=function(){for(var n=[],o=0;o<arguments.length;o++)n[o-0]=arguments[o];var i=e._.filter(n,function(e){return!e.isEmpty()}),r=new t;if(1==i.length)r.parts=[].concat(i[0].parts);else if(i.length>1){var s=e._.map(i,function(e){return e.build()});r.add("("+s.join(") OR (")+")")}return r},t}();t.ExpressionBuilder=n}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){e.AnalyticsActionCauseList={interfaceLoad:{name:"interfaceLoad",type:"interface"},interfaceChange:{name:"interfaceChange",type:"interface",metaMap:{interfaceChangeTo:1}},contextRemove:{name:"contextRemove",type:"misc",metaMap:{contextName:1}},didyoumeanAutomatic:{name:"didyoumeanAutomatic",type:"misc"},didyoumeanClick:{name:"didyoumeanClick",type:"misc"},resultsSort:{name:"resultsSort",type:"misc",metaMap:{resultsSortBy:1}},searchboxSubmit:{name:"searchboxSubmit",type:"search box"},searchboxClear:{name:"searchboxClear",type:"search box"},searchboxAsYouType:{name:"searchboxAsYouType",type:"search box"},breadcrumbFacet:{name:"breadcrumbFacet",type:"breadcrumb",metaMap:{facetId:1,facetValue:2}},breadcrumbResetAll:{name:"breadcrumbResetAll",type:"breadcrumb"},documentTag:{name:"documentTag",type:"document",metaMap:{facetId:1,facetValue:2}},documentField:{name:"documentField",type:"document",metaMap:{facetId:1,facetValue:2}},documentQuickView:{name:"documentQuickView",type:"document",metaMap:{documentTitle:1,documentURL:2}},documentOpen:{name:"documentOpen",type:"document",metaMap:{documentTitle:1,documentURL:2}},omniboxFacet:{name:"omniboxFacet",type:"omnibox",metaMap:{facetId:1,facetValue:2}},omniboxAnalytics:{name:"omniboxAnalytics",type:"omnibox"},omniboxField:{name:"omniboxField",type:"omnibox"},facetClearAll:{name:"facetClearAll",type:"facet",metaMap:{facetId:1}},facetSearch:{name:"facetSearch",type:"facet",metaMap:{facetId:1}},facetToggle:{name:"facetToggle",type:"facet",metaMap:{facetId:1,facetOperatorBefore:2,facetOperatorAfter:3}},facetRangeSlider:{name:"facetRangeSlider",type:"facet",metaMap:{facetId:1,facetRangeStart:2,facetRangeEnd:3}},facetRangeGraph:{name:"facetRangeGraph",type:"facet",metaMap:{facetId:1,facetRangeStart:2,facetRangeEnd:3}},facetSelect:{name:"facetSelect",type:"facet",metaMap:{facetId:1,facetValue:2}},facetSelectAll:{name:"facetSelectAll",type:"facet",metaMap:{facetId:1,facetValue:2}},facetDeselect:{name:"facetDeselect",type:"facet",metaMap:{facetId:1,facetValue:2}},facetExclude:{name:"facetExclude",type:"facet",metaMap:{facetId:1,facetValue:2}},facetUnexclude:{name:"facetUnexclude",type:"facet",metaMap:{facetId:1,facetValue:2}},facetSortValues:{name:"facetSortValues",type:"facet",metaMap:{facetId:1,facetSortBy:2}},errorBack:{name:"errorBack",type:"errors"},errorClearQuery:{name:"errorClearQuery",type:"errors"},errorRetry:{name:"errorRetry",type:"errors"},expandToFullUI:{name:"expandToFullUI",type:"interface"},caseCreate:{name:"caseCreate",type:"case"},casecontextAdd:{name:"casecontextAdd",type:"casecontext",metaMap:{caseID:5}},casecontextRemove:{name:"casecontextRemove",type:"casecontext",metaMap:{caseID:5}},preferencesChange:{name:"preferencesChange",type:"preferences",metaMap:{preferenceName:1,preferenceType:2}},caseAttach:{name:"caseAttach",type:"case",metaMap:{documentTitle:1,resultUriHash:3,articleID:4,caseID:5}},caseDetach:{name:"caseDetach",type:"case",metaMap:{documentTitle:1,resultUriHash:3,articleID:4,caseID:5}},customfiltersChange:{name:"customfiltersChange",type:"customfilters",metaMap:{customFilterName:1,customFilterType:2,customFilterExpression:3}},pagerNumber:{name:"pagerNumber",type:"getMoreResults",metaMap:{pagerNumber:1}},pagerNext:{name:"pagerNext",type:"getMoreResults",metaMap:{pagerNumber:1}},pagerPrevious:{name:"pagerPrevious",type:"getMoreResults",metaMap:{pagerNumber:1}},pagerScrolling:{name:"pagerScrolling",type:"getMoreResults"},searchFromLink:{name:"searchFromLink",type:"interface"}}}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var n=function(){function t(){this.isContextual=!1}return t.prototype.isActivated=function(){return!1},t.prototype.getCurrentEventCause=function(){return null},t.prototype.getCurrentEventMeta=function(){return{}},t.prototype.logSearchEvent=function(){},t.prototype.logSearchAsYouType=function(){},t.prototype.logClickEvent=function(){},t.prototype.logCustomEvent=function(){},t.prototype.getTopQueries=function(){var t=e.$.Deferred();return t.resolve([]),t},t.prototype.sendAllPendingEvents=function(){},t}();t.NoopAnalyticsClient=n}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var __extends=this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);n.prototype=t.prototype,e.prototype=new n},Coveo;!function(e){var t;!function(t){var n=function(t){function n(n,o,i,r){t.call(this,n,o,r),this.eventNameSpace=o,this.defaultAttributes=e.$.extend(!0,{},this.defaultAttributes,i),this.attributes=i,this.logger.debug("Creating model")}return __extends(n,t),n.prototype.set=function(e,t,n){var o={};o[e]=t,this.setMultiple(o,n)},n.prototype.setMultiple=function(t,n){var o=this,i=!1;this.preprocessEvent(t),e._.each(t,function(e,t){n&&n.customAttribute||o.checkIfAttributeExists(t),e=o.parseToCorrectType(t,e),(!n||n.validateType)&&o.validateType(t,e),o.checkIfAttributeChanged(t,e)&&(o.attributes[t]=e,i=!0,null!=n&&n.silent||o.attributeHasChangedEvent(t))}),!i||null!=n&&n.silent||(this.attributesHasChangedEvent(),this.anyEvent())},n.prototype.setNewDefault=function(e,t,n){n&&n.customAttribute||this.checkIfAttributeExists(e),this.defaultAttributes[e]=t},n.prototype.setDefault=function(e){this.set(e,this.defaultAttributes[e])},n.prototype.get=function(e){return void 0==e?this.attributes:this.attributes[e]},n.prototype.getDefault=function(e){return void 0==e?this.defaultAttributes:this.defaultAttributes[e]},n.prototype.reset=function(){this.setMultiple(this.defaultAttributes),this.modelWasResetEvent()},n.prototype.registerNewAttribute=function(e,t){this.defaultAttributes[e]=t,this.attributes[e]=t},n.prototype.getEventName=function(e){return this.eventNameSpace+":"+e},n.prototype.attributesHasChangedEvent=function(){e.$(this.element).trigger(this.getEventName(n.eventTypes.change),this.createAttributesChangedArgument())},n.prototype.attributeHasChangedEvent=function(t){e.$(this.element).trigger(this.getEventName(n.eventTypes.changeOne)+t,this.createAttributeChangedArgument(t))},n.prototype.preprocessEvent=function(t){e.$(this.element).trigger(this.getEventName(n.eventTypes.preprocess),t)},n.prototype.modelWasResetEvent=function(){e.$(this.element).trigger(this.getEventName(n.eventTypes.reset),this.createModelChangedArgument())
},n.prototype.anyEvent=function(){e.$(this.element).trigger(this.getEventName(n.eventTypes.all),this.createModelChangedArgument())},n.prototype.createAttributeChangedArgument=function(e){return{attribute:e,value:this.attributes[e]}},n.prototype.createAttributesChangedArgument=function(){return{attributes:this.attributes}},n.prototype.createModelChangedArgument=function(){return{model:this}},n.prototype.checkIfAttributeExists=function(t){e.Assert.check(e._.has(this.attributes,t))},n.prototype.validateType=function(t,n){e.Utils.isNullOrUndefined(this.attributes[t])||e.Utils.isUndefined(n)||(e._.isNumber(this.attributes[t])?e.Assert.check(e._.isNumber(n)&&!isNaN(n),"Non-matching type"):e._.isBoolean(this.attributes[t])?e.Assert.check(e._.isBoolean(n)||void 0!==e.Utils.parseBooleanIfNotUndefined(n),"Non-matching type"):e.Utils.isNullOrUndefined(this.defaultAttributes[t])||e.Assert.check(typeof n==typeof this.defaultAttributes[t],"Non-matching type"))},n.prototype.parseToCorrectType=function(t,n){return e._.isNumber(this.attributes[t])?parseInt(n,10):e._.isBoolean(this.attributes[t])?e._.isBoolean(n)?n:e.Utils.parseBooleanIfNotUndefined(n):n},n.prototype.checkIfAttributeChanged=function(t,n){var o=this.attributes[t];return e._.isNumber(o)||e._.isString(o)||e._.isBoolean(o)?o!==n:e._.isArray(o)?!e.Utils.arrayEqual(o,n):e._.isObject(o)?!e.Utils.objectEqual(o,n):!0},n.eventTypes={preprocess:"preprocess",changeOne:"change:",change:"change",reset:"reset",all:"all"},n}(e.Ui.Component);t.Model=n}(t=e.Models||(e.Models={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var n=function(t){function n(o,i,r){var s=e._.extend({},n.defaultAttributes,i);t.call(this,o,n.ID,s,r)}return __extends(n,t),n.getFacetId=function(e,t){return void 0===t&&(t=!0),"f:"+e+(t?"":":not")},n.getFacetOperator=function(e){return"f:"+e+":operator"},n.getFacetLookupValue=function(e){return n.getFacetId(e)+":lookupvalues"},n.prototype.set=function(e,n,o){this.validate(e,n),t.prototype.set.call(this,e,n,o)},n.prototype.validate=function(t,o){t==n.attributesEnum.first&&e.Assert.isLargerOrEqualsThan(0,o)},n.prototype.getAttributes=function(){var t=this,n={};return e._.each(this.queryStateModel.attributes,function(o,i){e._.isObject(o)?e.Utils.objectEqual(o,t.queryStateModel.defaultAttributes[i])||(n[i]=o):o!=t.queryStateModel.defaultAttributes[i]&&(n[i]=o)}),n},n.ID="state",n.defaultAttributes={q:"",first:0,t:"",hd:"",hq:"",sort:"",tg:""},n.attributesEnum={q:"q",first:"first",t:"t",sort:"sort",hd:"hd",hq:"hq",tg:"tg"},n}(t.Model);t.QueryStateModel=n,e.Ui.CoveoJQuery.registerNamedMethod("state",function(t){for(var o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];e.Assert.exists(t);var r=e.Ui.Component.resolveBinding(t,n);if(e.Assert.exists(r),0==o.length)return r;if(1==o.length&&e.Utils.isNonEmptyString(o[0]))return r.get(o[0]);if(e._.isObject(o[0])){var s=o[0],a=e.$.extend({customAttribute:!0},o[1]);return r.setMultiple(s,a)}if(o.length>1){var l=o[0],u=o[1],a=e.$.extend({customAttribute:!0},o[2]);return e.Assert.isNonEmptyString(l),r.set(l,u,a)}})}(t=e.Models||(e.Models={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){var t=function(e){function t(n){e.call(this,n,t.ID,{})}return __extends(t,e),t.prototype.registerComponent=function(e,t){var n=this.attributes[e];void 0==n?this.attributes[e]=[t]:this.attributes[e].push(t)},t.ID="ComponentState",t}(e.Model);e.ComponentStateModel=t}(t=e.Models||(e.Models={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var n=function(t){function n(o,i){var r=e._.extend({},n.defaultAttributes,i);t.call(this,o,n.ID,r)}return __extends(n,t),n.ID="ComponentOptions",n.defaultAttributes={resultLink:void 0},n.attributesEnum={resultLink:"resultLink"},n}(t.Model);t.ComponentOptionsModel=n}(t=e.Models||(e.Models={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var n=function(t){function n(o,i,r,s){var a=this;t.call(this,o,n.ID),this._window=i,this.queryStateModel=r,this.queryController=s,this.ignoreNextHashChange=!1,this.initialHashChange=!1,this.willUpdateHash=!1,this._window=this._window||window,this.queryStateModel=r||this.resolveQueryStateModel(),this.queryController=s||this.resolveQueryController(),e.Assert.exists(this.queryStateModel),e.Assert.exists(this.queryController),e.$(this.element).on(e.Events.InitializationEvents.restoreHistoryState,function(){return a.updateModelFromHash()}),e.$(this.element).on(this.queryStateModel.getEventName(e.Models.Model.eventTypes.all),function(){return a.updateHashFromModel()}),e.$(this._window).on("hashchange",e.$.proxy(this.handleHashChange,this))}return __extends(n,t),n.prototype.handleHashChange=function(){return this.ignoreNextHashChange?(this.ignoreNextHashChange=!1,void 0):(this.updateModelFromHash(),this.queryController.executeQuery(),void 0)},n.prototype.updateHashFromModel=function(){var t=this;this.willUpdateHash||(e.Defer.defer(function(){var e=t.queryStateModel.getAttributes();t.setHashValues(e),t.logger.debug("Saving state to hash",e),t.willUpdateHash=!1}),this.willUpdateHash=!0)},n.prototype.updateModelFromHash=function(){var t=this,n={};e._.each(this.queryStateModel.attributes,function(e,o){var i=t.getHashValue(o);void 0==i&&(i=t.queryStateModel.defaultAttributes[o]),n[o]=i}),this.initialHashChange=!0,this.queryStateModel.setMultiple(n)},n.prototype.getHashValue=function(t){return e.Assert.isNonEmptyString(t),e.HashUtils.getValue(t,e.HashUtils.getHash(this._window))},n.prototype.setHashValues=function(t){var n="#"+e.HashUtils.encodeValues(t);this.ignoreNextHashChange=this._window.location.hash!=n,this.ignoreNextHashChange&&(this.initialHashChange?(this.initialHashChange=!1,this._window.location.replace(n)):this._window.location.hash=n)},n.ID="HistoryController",n}(e.Ui.Component);t.HistoryController=n}(t=e.Controllers||(e.Controllers={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var n=function(){function e(){this.searchAsYouType=!1}return e}(),o=function(t){function o(n,i){t.call(this,n,o.ID),this.options=i,this.showingExecutingQueryAnimation=!1,e.Assert.exists(n),e.Assert.exists(i),this.firstQuery=!0}return __extends(o,t),o.prototype.setEndpoint=function(e){this.overrideEndpoint=e,this.logger.debug("Endpoint set",e)},o.prototype.getEndpoint=function(){var t=this.overrideEndpoint||this.options.endpoint;return new e.Rest.SearchEndpointWithDefaultCallOptions(t,this.getCallOptions())},o.prototype.executeQuery=function(t){var o=this;e.ModalBox.close(!0),this.logger.debug("Executing new query",l);var t=e._.extend(new n,t);if(this.cancelAnyCurrentPendingQuery(),null!=t.beforeExecuteQuery&&t.beforeExecuteQuery(),this.isStandaloneSearchBox()&&!t.searchAsYouType)return this.redirectToSearchPage(),e.$.Deferred();this.showExecutingQueryAnimation();var i=e.$.Deferred();if(this.currentPendingQuery=i,this.firstQuery){var r=e.HashUtils.getValue("firstQueryCause",e.HashUtils.getHash());if(null!=r){var s=e.HashUtils.getValue("firstQueryMeta",e.HashUtils.getHash())||{};this.usageAnalytics.logSearchEvent(e.Ui.AnalyticsActionCauseList[r],s)}else e.Utils.isNonEmptyString(this.getBindings().queryStateModel.get("q"))?this.usageAnalytics.logSearchEvent(e.Ui.AnalyticsActionCauseList.searchFromLink,{}):this.usageAnalytics.logSearchEvent(e.Ui.AnalyticsActionCauseList.interfaceLoad,{})}e.$(this.element).trigger(e.Events.QueryEvents.newQuery,{deferred:i});var a=this.createQueryBuilder(t),l=a.build(),u=this.getEndpoint(),c=u.search(l);c.done(function(n){if(e.Assert.exists(n),o.firstQuery&&(o.firstQuery=!1),i===o.currentPendingQuery){o.logger.debug("Query results received",l,n),o.lastSearchUid=n.searchUid,e.QueryUtils.setIndexAndUidOnQueryResults(l,n,o.lastSearchUid),e.QueryUtils.setStateObjectOnQueryResults(o.queryStateModel.get(),n),e.QueryUtils.setTermsToHighlightOnQueryResults(l,n);var r={queryBuilder:a,query:l,results:n,searchAsYouType:t.searchAsYouType};o.preprocessResultsEvent(r);var s={queryBuilder:a,query:l,results:n,searchAsYouType:t.searchAsYouType,retryTheQuery:!1};if(0==n.results.length&&o.noResultEvent(s),s.retryTheQuery)o.executeQuery().done(function(e){i.resolve(e)}).fail(function(e,t){i.reject(e,t)});else{o.lastQueryBuilder=a,o.currentPendingQuery.resolve(n),o.currentPendingQuery=void 0;var u={queryBuilder:a,query:l,results:n,searchAsYouType:t.searchAsYouType};o.querySuccessEvent(u),e.Defer.defer(function(){o.deferredQuerySuccessEvent(u),o.hideExecutingQueryAnimation()})}}}),c.fail(function(e,n){if(i===o.currentPendingQuery){o.logger.error("Query triggered an error",l,n),o.currentPendingQuery.reject(n),o.currentPendingQuery=void 0;var r={queryBuilder:a,endpoint:u,query:l,error:n,searchAsYouType:t.searchAsYouType};o.queryError(r),o.hideExecutingQueryAnimation()}});var p={queryBuilder:a,query:l,deferred:i,searchAsYouType:t.searchAsYouType};return this.duringQueryEvent(p),i},o.prototype.deferExecuteQuery=function(t){var n=this;this.showExecutingQueryAnimation(),e.Defer.defer(function(){return n.executeQuery(t)})},o.prototype.fetchMore=function(t){var n=this;if(void 0!=this.currentPendingQuery)return void 0;var o=this.currentPendingQuery=e.$.Deferred(),i=new e.Ui.QueryBuilder;this.continueLastQueryBuilder(i,t);var r=i.build();o=this.getEndpoint().search(r);var s={queryBuilder:i,query:r,deferred:o,searchAsYouType:!1};return e.$(this.element).trigger(e.Events.QueryEvents.duringFetchMoreQuery,s),this.lastQueryBuilder=i,o.done(function(t){e.QueryUtils.setIndexAndUidOnQueryResults(r,t,n.lastSearchUid),e.QueryUtils.setStateObjectOnQueryResults(n.queryStateModel.get(),t),e.QueryUtils.setTermsToHighlightOnQueryResults(r,t),n.currentPendingQuery=void 0;var o={queryBuilder:i,query:r,results:t,searchAsYouType:!1};n.preprocessResultsEvent(o)}),o},o.prototype.isStandaloneSearchBox=function(){return e.Utils.isNonEmptyString(this.options.searchPageUri)},o.prototype.continueLastQueryBuilder=function(t,n){e.$.extend(t,this.lastQueryBuilder),t.firstResult=t.firstResult+t.numberOfResults,t.numberOfResults=n},o.prototype.createQueryBuilder=function(t){e.Assert.exists(t);var n=new e.Ui.QueryBuilder;n.firstResult=n.firstResult||0,n.numberOfResults=this.options.resultsPerPage,n.filterField=this.options.filterField,n.excerptLength=this.options.excerptLength,e.Utils.isNonEmptyString(this.options.hiddenExpression)&&n.advancedExpression.add(this.options.hiddenExpression),e.Utils.isNonEmptyString(this.options.timezone)&&(n.timezone=this.options.timezone);var o={queryBuilder:n,searchAsYouType:t.searchAsYouType};this.buildingQueryEvent(o);var i={queryBuilder:n,searchAsYouType:t.searchAsYouType};return this.doneBuildingQueryEvent(i),n},o.prototype.cancelAnyCurrentPendingQuery=function(){return e.Utils.exists(this.currentPendingQuery)?(this.logger.debug("Cancelling current pending query"),this.currentPendingQuery.reject(),this.currentPendingQuery=void 0,!0):!1},o.prototype.showExecutingQueryAnimation=function(){this.showingExecutingQueryAnimation||(e.$(this.root).addClass("coveo-executing-query"),this.showingExecutingQueryAnimation=!0)},o.prototype.hideExecutingQueryAnimation=function(){this.showingExecutingQueryAnimation&&(e.$(this.root).removeClass("coveo-executing-query"),this.showingExecutingQueryAnimation=!1)},o.prototype.redirectToSearchPage=function(){var t=this.queryStateModel.getAttributes(),n=this.usageAnalytics.getCurrentEventCause();null!=n&&(t.firstQueryCause=n);var o=this.usageAnalytics.getCurrentEventMeta();null!=o&&(t.firstQueryMeta=o),window.location.href=this.options.searchPageUri+"#"+e.HashUtils.encodeValues(t)},o.prototype.getCallOptions=function(){var t={options:{authentication:[]}};return e.$(this.element).trigger(e.Events.QueryEvents.buildingCallOptions,t),t.options},o.prototype.buildingQueryEvent=function(t){e.$(this.element).trigger(e.Events.QueryEvents.buildingQuery,t)},o.prototype.doneBuildingQueryEvent=function(t){e.$(this.element).trigger(e.Events.QueryEvents.doneBuildingQuery,t)},o.prototype.duringQueryEvent=function(t){e.$(this.element).trigger(e.Events.QueryEvents.duringQuery,t)},o.prototype.querySuccessEvent=function(t){e.$(this.element).trigger(e.Events.QueryEvents.querySuccess,t)},o.prototype.deferredQuerySuccessEvent=function(t){e.$(this.element).trigger(e.Events.QueryEvents.deferredQuerySuccess,t)},o.prototype.queryError=function(t){e.$(this.element).trigger(e.Events.QueryEvents.queryError,t)},o.prototype.preprocessResultsEvent=function(t){e.$(this.element).trigger(e.Events.QueryEvents.preprocessResults,t)},o.prototype.noResultEvent=function(t){e.$(this.element).trigger(e.Events.QueryEvents.noResults,t)},o.ID="QueryController",o}(e.Ui.Component);t.QueryController=o,e.Ui.CoveoJQuery.registerNamedMethod("executeQuery",function(t){e.Assert.exists(t);var n=e.Ui.Component.resolveBinding(t,o);e.Assert.exists(n),n.executeQuery()})}(t=e.Controllers||(e.Controllers={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){var t=function(){function e(){}return e.newQuery="newQuery",e.buildingQuery="buildingQuery",e.doneBuildingQuery="doneBuildingQuery",e.duringQuery="duringQuery",e.duringFetchMoreQuery="duringFetchMoreQuery",e.querySuccess="querySuccess",e.deferredQuerySuccess="deferredQuerySuccess",e.queryError="queryError",e.preprocessResults="preprocessResults",e.noResults="noResults",e.buildingCallOptions="buildingCallOptions",e}();e.QueryEvents=t}(t=e.Events||(e.Events={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){var t=function(){function e(){}return e.beforeInitialization="beforeInitialization",e.afterComponentsInitialization="afterComponentsInitialization",e.restoreHistoryState="restoreHistoryState",e.afterInitialization="afterInitialization",e}();e.InitializationEvents=t}(t=e.Events||(e.Events={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){var t=function(){function e(){}return e.newResultsDisplayed="newResultsDisplayed",e.newResultDisplayed="newResultDisplayed",e}();e.ResultListEvents=t}(t=e.Events||(e.Events={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){var t=function(){function e(){}return e.imageResultsLayoutComplete="imageResultsLayoutComplete",e}();e.ImageResultListEvents=t}(t=e.Events||(e.Events={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){var t=function(){function e(){}return e.enterOnSearchBox="enterOnSearchBox",e.quickViewLoaded="quickViewLoaded",e}();e.UserActionEvents=t}(t=e.Events||(e.Events={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){var t=function(){function e(){}return e.savePreferences="savePreferences",e.exitPreferencesWithoutSave="exitPreferencesWithoutSave",e}();e.PreferencesPanelEvents=t}(t=e.Events||(e.Events={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var n=function(n){function o(i,r,s,a){var l=this;void 0===a&&(a=window),n.call(this,i,o.ID),this.element=i,this.options=r,this.analyticsOptions=s,this.options=t.ComponentOptions.initComponentOptions(i,o,r),e.Assert.exists(i),e.Assert.exists(this.options),this.options.hideUntilFirstQuery&&this.showAndHideFirstQueryAnimation(),this.root=i,this.usageAnalytics=this.initializeAnalytics(),this.queryStateModel=new e.Models.QueryStateModel(i),this.componentStateModel=new e.Models.ComponentStateModel(i),this.componentOptionsModel=new e.Models.ComponentOptionsModel(i),this.queryController=new e.Controllers.QueryController(i,this.options),this.searchInterface=this;var u=this.queryStateModel.getEventName(e.Models.Model.eventTypes.preprocess);if(e.$(this.element).on(u,function(e,t){return l.handlePreprocessQueryStateModel(t)}),this.options.enableHistory?new e.Controllers.HistoryController(i,a,this.queryStateModel,this.queryController):e.$(this.element).on(e.Events.InitializationEvents.restoreHistoryState,function(){return l.queryStateModel.setMultiple(l.queryStateModel.defaultAttributes)}),this.options.enableDebugInfo){var c=t.Component.getComponentRef("Debug");c?setTimeout(function(){return new c(i)}):this.logger.warn("Options to enable debug component was true, but not present in the Coveo object (not compiled)")}}return __extends(o,n),o.prototype.initializeAnalytics=function(){var e=t.Component.getComponentRef("Analytics");return e?e.makeSingleton(this.element,this.analyticsOptions,this.getBindings()):new t.NoopAnalyticsClient},o.prototype.showAndHideFirstQueryAnimation=function(){var t=this;this.displayFirstQueryWaitAnimation(),e.$(this.element).one(e.Events.QueryEvents.querySuccess,function(){e._.defer(function(){return t.hideFirstQueryWaitAnimation()})}),e.$(this.element).on(e.Events.QueryEvents.queryError,function(){e._.defer(function(){return t.hideFirstQueryWaitAnimation()})})},o.prototype.displayFirstQueryWaitAnimation=function(){e.$(this.options.firstLoadingAnimation).remove(),e.$(this.element).addClass("coveo-waiting-for-first-query"),e.$(this.element).append(this.options.firstLoadingAnimation)},o.prototype.hideFirstQueryWaitAnimation=function(){e.$(this.options.firstLoadingAnimation).remove(),e.$(this.element).removeClass("coveo-waiting-for-first-query")},o.prototype.handlePreprocessQueryStateModel=function(t){var n=this.queryStateModel.get(e.Models.QueryStateModel.attributesEnum.tg),o=this.queryStateModel.get(e.Models.QueryStateModel.attributesEnum.t),i=n,r=o;void 0!==t.tg&&(t.tg=this.getTabGroupId(t.tg),i!=t.tg&&(t.t=t.t||e.Models.QueryStateModel.defaultAttributes.t,t.sort=t.sort||e.Models.QueryStateModel.defaultAttributes.sort,i=t.tg)),void 0!==t.t&&(t.t=this.getTabId(i,t.t),r!=t.t&&(t.sort=t.sort||e.Models.QueryStateModel.defaultAttributes.sort,r=t.t)),void 0!==t.sort&&(t.sort=this.getSort(r,t.sort))},o.prototype.getTabGroupId=function(n){var o=t.Component.getComponentRef("TabGroup");if(o){var i=this.searchInterface.components(o.ID);if(n!=e.Models.QueryStateModel.defaultAttributes.tg&&e._.any(i,function(e){return!e.disabled&&n==e.options.id}))return n;if(i.length>0)return i[0].options.id}return e.Models.QueryStateModel.defaultAttributes.tg},o.prototype.getTabId=function(n,o){var i=t.Component.getComponentRef("Tab"),r=t.Component.getComponentRef("TabGroup");if(i){var s=this.searchInterface.components(i.ID);if(r&&n!=e.Models.QueryStateModel.defaultAttributes.tg){var a=this.searchInterface.components(r.ID),l=e._.find(a,function(e){return n==e.options.id});if(o!=e.Models.QueryStateModel.defaultAttributes.t&&e._.any(s,function(e){return o==e.options.uniqueId&&l.isElementIncludedInTabGroup(e.element)}))return o;var u=e._.find(s,function(e){return l.isElementIncludedInTabGroup(e.element)});return null!=u?u.options.uniqueId:e.Models.QueryStateModel.defaultAttributes.t}if(o!=e.Models.QueryStateModel.defaultAttributes.t&&e._.any(s,function(e){return o==e.options.uniqueId}))return o;if(s.length>0)return s[0].options.uniqueId}return e.Models.QueryStateModel.defaultAttributes.t},o.prototype.getSort=function(n,o){var i=t.Component.getComponentRef("Sort");if(i){var r=this.searchInterface.components(i.ID),s=t.Component.getComponentRef("Tab");if(s&&n!=e.Models.QueryStateModel.defaultAttributes.t){var a=this.searchInterface.components(s.ID),l=e._.find(a,function(e){return n==e.options.uniqueId}),u=l.options.sort;if(o!=e.Models.QueryStateModel.defaultAttributes.sort&&e._.any(r,function(e){return l.isElementIncludedInTab(e.element)&&e.match(o)}))return o;if(null!=u)return u.toString();var c=e._.find(r,function(e){return l.isElementIncludedInTab(e.element)});return null!=c?c.options.sortCriteria[0].toString():e.Models.QueryStateModel.defaultAttributes.sort}if(o!=e.Models.QueryStateModel.defaultAttributes.sort&&e._.any(r,function(e){return e.match(o)}))return o;if(r.length>0)return r[0].options.sortCriteria[0].toString()}return e.Models.QueryStateModel.defaultAttributes.sort},o.prototype.attachComponent=function(e,t){this.components(e).push(t)},o.prototype.detachComponent=function(t,n){var o=this.components(t),i=e._.indexOf(o,n);i>-1&&o.splice(i,1)},o.prototype.components=function(e){return null==this.attachedComponents&&(this.attachedComponents={}),e in this.attachedComponents||(this.attachedComponents[e]=[]),this.attachedComponents[e]},o.ID="SearchInterface",o.options={searchPageUri:t.ComponentOptions.buildStringOption(),enableHistory:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),resultsPerPage:t.ComponentOptions.buildNumberOption({defaultValue:10}),excerptLength:t.ComponentOptions.buildNumberOption({defaultValue:200}),hiddenExpression:t.ComponentOptions.buildStringOption({defaultValue:""}),filterField:t.ComponentOptions.buildStringOption({defaultValue:""}),hideUntilFirstQuery:t.ComponentOptions.buildBooleanOption({defaultValue:!0}),firstLoadingAnimation:t.ComponentOptions.buildChildHtmlElementOption({childSelector:".coveo-first-loading-animation",defaultFunction:function(){return e.JQueryUtils.getBasicLoadingAnimation().get(0)}}),autoTriggerQuery:t.ComponentOptions.buildBooleanOption({defaultValue:!0}),endpoint:t.ComponentOptions.buildCustomOption(function(t){return null!=t&&t in e.Rest.SearchEndpoint.endpoints?e.Rest.SearchEndpoint.endpoints[t]:null},{defaultFunction:function(){return e.Rest.SearchEndpoint.endpoints["default"]}}),timezone:t.ComponentOptions.buildStringOption({defaultFunction:function(){return jstz.determine().name()}}),enableDebugInfo:t.ComponentOptions.buildBooleanOption({defaultValue:!0})},o}(t.Component);t.SearchInterface=n}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){!function(e){e[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.ENTER=13]="ENTER",e[e.SHIFT=16]="SHIFT",e[e.CTRL=17]="CTRL",e[e.ALT=18]="ALT",e[e.ESCAPE=27]="ESCAPE",e[e.SPACEBAR=32]="SPACEBAR",e[e.PAGE_UP=33]="PAGE_UP",e[e.PAGE_DOWN=34]="PAGE_DOWN",e[e.HOME=36]="HOME",e[e.LEFT_ARROW=37]="LEFT_ARROW",e[e.UP_ARROW=38]="UP_ARROW",e[e.RIGHT_ARROW=39]="RIGHT_ARROW",e[e.DOWN_ARROW=40]="DOWN_ARROW",e[e.INSERT=45]="INSERT",e[e.DELETE=46]="DELETE"}(e.KEYBOARD||(e.KEYBOARD={}));var t=(e.KEYBOARD,function(){function t(){}return t.keysEqual=function(t,n){return e.Utils.isNullOrUndefined(t.keyCode)?e.Utils.isNullOrUndefined(t.which)?!1:t.which==n:t.keyCode==n},t.isAllowedKeyForOmniBox=function(e){var n=e.keyCode,o=t.isNumberKeyPushed(n)||32==n||13==n||t.isLetterKeyPushed(n)||n>95&&112>n||n>185&&193>n||n>218&&223>n||8==n||46==n||t.isArrowKeyPushed(n);return o},t.isAllowedKeyForSearchAsYouType=function(e){return t.isAllowedKeyForOmniBox(e)&&!t.isArrowKeyPushed(e.keyCode)},t.isDeleteOrBackspace=function(e){return t.keysEqual(e,8)||t.keysEqual(e,46)},t.isArrowKeyPushed=function(e){return 37==e||38==e||39==e||40==e},t.isNumberKeyPushed=function(e){return e>47&&58>e},t.isLetterKeyPushed=function(e){return e>64&&91>e},t}());e.KeyboardUtils=t}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var n=function(n){function o(i,r,s){var a=this;n.call(this,i,o.ID,s),this.element=i,this.options=r,this.options=t.ComponentOptions.initComponentOptions(i,o,r),t.Component.pointElementsToDummyForm(e.$(i)),e.$(i).change(function(e){a._handleChange(e)}),e.$(i).keyup(function(e){a._handleKeyUp(e)});var l=e.Models;e.$(this.root).on(e.Events.QueryEvents.buildingQuery,e.$.proxy(this.handleBuildingQuery,this)),e.$(this.root).on(e.Events.QueryEvents.newQuery,e.$.proxy(this._handleNewQuery,this));var u=this.queryStateModel.getEventName(l.Model.eventTypes.changeOne+l.QueryStateModel.attributesEnum.q);e.$(this.queryStateModel.element).on(u,e.$.proxy(this._handleQueryStateChanged,this)),this._clearElement=e.$("<span></span>").addClass("coveo-query-box-clear").hide();e.$("<span></span>").addClass("coveo-icon").appendTo(this._clearElement);if(this._clearElement.fastClick(function(){a.clear(),a._hideClearElement(),a.updateQueryState(),e.DeviceUtils.isMobileDevice()||e.$(a.element).focus(),a.queryController.isStandaloneSearchBox()||a.queryController.deferExecuteQuery({beforeExecuteQuery:function(){return a.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.searchboxClear,{})}})}),e.DeviceUtils.isSmallScreenWidth()&&e.$(this.element).focus(function(){e.MobileUtils.removeToggleClassOnSearchInterface()}),e.$(this.element).after(this._clearElement),this.options.autoFocus)try{e.$(this.element).focus()}catch(c){}}return __extends(o,n),o.prototype.clear=function(){e.$(this.element).val(""),this.updateQueryState()},o.prototype.replace=function(t,n){e.$(this.element).val(e.$(this.element).val().replace(t,n)),this.updateQueryState()},o.prototype.replaceCurrentExpression=function(e){this.replace(this.getCurrentQueryExpression(),e),this.updateQueryState()},o.prototype.clearCurrentExpression=function(){this.replace(this.getCurrentQueryExpression(),""),this.updateQueryState()},o.prototype.getCurrentQueryExpression=function(){var t=e.$(this.element).getCursorPosition(),n=e.$(this.element).val(),o=n.length,i=t,r=t;for(" "==n[i]&&i--;i>0&&" "!=n[i];)i--;for(;o>r&&" "!=n[r];)r++;return n.substring(i,r)},o.prototype.insertAt=function(t,n){var o=e.$(this.element).val(),i=[o.slice(0,t),n,o.slice(t)].join("");e.$(this.element).val(i),this.updateQueryState()},o.prototype._handleChange=function(){return this._addClearElement(),this.updateQueryState(),void 0},o.prototype._handleQueryStateChanged=function(t,n){e.Assert.exists(n);var o=n.value;e.$(this.element).val(o),this._addClearElement()},o.prototype._handleKeyUp=function(t){e.Assert.exists(t),this._addClearElement(),13==t.which?(this.logger.debug("Performing query because user pressed Enter"),this.updateQueryState(),this.enterOnSearchBox(),t.stopPropagation(),e.DeviceUtils.isMobileDevice()&&e.$(this.element).blur()):this.options.enableSearchAsYouType&&e.KeyboardUtils.isAllowedKeyForSearchAsYouType(t)&&this.startNewSearchAsYouTypeTimeout()},o.prototype._addClearElement=function(){""==e.$(this.element).val()?this._hideClearElement():this._showClearElement()},o.prototype._hideClearElement=function(){this._clearElement.hide()},o.prototype._showClearElement=function(){this._clearElement.show()},o.prototype.startNewSearchAsYouTypeTimeout=function(){var e=this;this.cancelAnyPendingSearchAsYouTypeTimeout(),this.searchAsYouTypeTimeout=setTimeout(function(){e.triggerNewQuery(function(){return e.usageAnalytics.logSearchAsYouType(t.AnalyticsActionCauseList.searchboxAsYouType,{})},!0)},this.options.searchAsYouTypeDelay)},o.prototype._handleNewQuery=function(){o.queryBoxIsAlreadyAddedToQuery=!1},o.prototype.handleBuildingQuery=function(t,n){e.Assert.exists(n),e.Assert.exists(n.queryBuilder);var i=e.$(this.element).val();this.options.enableWildcards&&(n.queryBuilder.enableWildcards=!0),this.options.enableQuestionMarks&&(n.queryBuilder.enableQuestionMarks=!0),this.options.enableLowercaseOperators&&(n.queryBuilder.enableLowercaseOperators=!0),this.options.enablePartialMatch&&(n.queryBuilder.enablePartialMatch=!0,n.queryBuilder.partialMatchKeywords=this.options.partialMatchKeywords,n.queryBuilder.partialMatchThreshold=this.options.partialMatchThreshold),e.Utils.isNonEmptyString(i)&&!o.queryBoxIsAlreadyAddedToQuery&&(this.options.disableQuerySyntax?n.queryBuilder.expression.add("<@- "+i+" -@>"):n.queryBuilder.expression.add(i),this.logger.trace("Adding query to QueryBuilder",i),o.queryBoxIsAlreadyAddedToQuery=!0)},o.prototype.enterOnSearchBox=function(){var n=this;e.$(this.element).trigger(e.Events.UserActionEvents.enterOnSearchBox),this.triggerNewQuery(function(){return n.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.searchboxSubmit,{})},!1)},o.prototype.triggerNewQuery=function(e,t){this.cancelAnyPendingSearchAsYouTypeTimeout(),this.queryController.deferExecuteQuery({beforeExecuteQuery:e,searchAsYouType:t})},o.prototype.updateQueryState=function(){var t=e.$(this.element).val();this.queryStateModel.set(e.Models.QueryStateModel.attributesEnum.q,t)},o.prototype.cancelAnyPendingSearchAsYouTypeTimeout=function(){e.Utils.exists(this.searchAsYouTypeTimeout)&&(clearTimeout(this.searchAsYouTypeTimeout),this.searchAsYouTypeTimeout=void 0)},o.ID="QueryBox",o.options={enableSearchAsYouType:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),searchAsYouTypeDelay:t.ComponentOptions.buildNumberOption({defaultValue:500}),disableQuerySyntax:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableWildcards:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableQuestionMarks:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableLowercaseOperators:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),enablePartialMatch:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),partialMatchKeywords:t.ComponentOptions.buildNumberOption({defaultValue:5}),partialMatchThreshold:t.ComponentOptions.buildStringOption({defaultValue:"50%"}),autoFocus:t.ComponentOptions.buildBooleanOption({defaultValue:!0})},o.queryBoxIsAlreadyAddedToQuery=!1,o}(e.Ui.Component);t.QueryBox=n,e.Ui.CoveoJQuery.registerAutoCreateComponent(n)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){var t=function(){function e(){}return e.populateOmniBox="populateOmniBox",e.openOmniBox="openOmniBox",e.closeOmniBox="closeOmniBox",e}();e.OmniBoxEvents=t}(t=e.Events||(e.Events={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var n=function(n){function o(i,r,s){var a=this;n.call(this,i,r,s),this.element=i,this.options=r,this.omniBoxHeaderSearchForTemplate=e._.template("<div class='coveo-omnibox-selectable coveo-omnibox-section coveo-omnibox-header'><div class='coveo-text'>"+t.l("SearchFor","<strong><%- data %></strong>")+"</div></div>"),this.omniBoxIsOpen=!1,this.isLoadingData=!1,this.headerIsCurrentlyRendered=!1,this.options=t.ComponentOptions.initComponentOptions(i,o,r),e.$(i).keyup(function(e){return a._handleKeyUp(e)}),this.renderOmniBoxDiv(),this.omniBoxDiv.hide(),this.prepareThrottledCall(),e.$(this.root).fastClick(function(t){a.omniBoxIsOpen&&!e.$.contains(a.omniBoxDiv.get(0),e.$(t.target).get(0))&&a.escapeEvent()});var l=this.queryStateModel.getEventName(e.Models.Model.eventTypes.changeOne+e.Models.QueryStateModel.attributesEnum.q);e.$(this.queryStateModel.element).on(l,e.$.proxy(this._handleQueryStateChanged,this)),e.$(window).on("resize",function(){a.omniBoxIsOpen&&a.setWidthOnOmniBoxDiv()})}return __extends(o,n),o.prototype.close=function(){e.$(this.root).trigger(e.Events.OmniBoxEvents.closeOmniBox),this.omniBoxDiv&&(this.omniBoxDiv.children().remove(),this.omniBoxDiv.hide()),this.clearLastOmniBoxRows(),e.Utils.isNullOrUndefined(this.lastOmniBoxData)||this.rejectAllPendingDeferred(this.lastOmniBoxData),this.resetOmniBoxInternalData(),this.omniBoxIsOpen=!1},o.prototype.open=function(){""!=e.$(this.element).val()?(this.throttledCallForOmniBoxBody(),e.$(this.root).trigger(e.Events.OmniBoxEvents.openOmniBox)):this.escapeEvent()},o.prototype.getDataForOmniboxBody=function(){if(this.addSearchAnimation(),this.isCurrentlyBeingRendered)this.throttledCallForOmniBoxBody();else{var e=this.buildOmniBoxRequestObject(),t=this.requestOmniBoxData(e);this.processNewOmniBoxData(t)}},o.prototype.buildOmniBoxRequestObject=function(){var t=this,n=this.getCurrentQueryExpression(),o={completeQueryExpression:{word:e.$(this.element).val(),regex:this.getRegexToSearch()},currentQueryExpression:{word:n,regex:this.getRegexToSearch(n)},allQueryExpressions:this.getQueryExpressionBreakDown(),cursorPosition:e.$(this.element).getCursorPosition(),clear:function(){t.clear()},clearCurrentExpression:function(){t.clearCurrentExpression()},replace:function(e,n){t.replace(e,n)},replaceCurrentExpression:function(e){t.replaceCurrentExpression(e)},insertAt:function(e,n){t.insertAt(e,n)},closeOmniBox:function(){t.close()}};return o},o.prototype.prepareThrottledCall=function(){this.throttledCallForOmniBoxBody=e.Utils.throttle(this.getDataForOmniboxBody,this.options.omniBoxDelay,void 0,this)},o.prototype.requestOmniBoxData=function(t){e.Assert.exists(t),this.logger.info("Requesting omnibox data to all components");var n=e.$.extend({rows:[]},t);return e.$(this.root).trigger(e.Events.OmniBoxEvents.populateOmniBox,n),n},o.prototype.getQueryExpressionBreakDown=function(){var t=this,n=[],o=e.$(this.element).val().split(" ");return e._.each(o,function(e){n.push({word:e,regex:t.getRegexToSearch(e)})}),n},o.prototype._handleNewQuery=function(e,t){n.prototype._handleNewQuery.call(this,e,t),this.omniBoxIsOpen&&e.stopPropagation()
},o.prototype._handleKeyUp=function(n){var o=this;n.stopImmediatePropagation();var i=e.$(this.element).val().length;!e.Utils.isNullOrUndefined(this.lastOmniBoxData)&&!e.Utils.isNullOrUndefined(this.lastNumberOfLettersInOmniBox)&&Math.abs(i-this.lastNumberOfLettersInOmniBox)>this.options.omniBoxChangeLimit&&(this.rejectAllPendingDeferred(this.lastOmniBoxData),this.prepareThrottledCall()),e.KeyboardUtils.keysEqual(n,27)&&this.omniBoxIsOpen?this.escapeEvent():e.KeyboardUtils.keysEqual(n,13)?this.omniBoxIsOpen?this.selectionEvent():(this.escapeEvent(),this.triggerNewQuery(function(){return o.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.searchboxSubmit,{})})):e.KeyboardUtils.isArrowKeyPushed(n.keyCode)&&this.omniBoxIsOpen?this.navigationEvent(n):e.KeyboardUtils.isAllowedKeyForOmniBox(n)&&(""==e.$(this.element).val()?this.escapeEvent():this.open())},o.prototype._handleChange=function(e){return e.stopImmediatePropagation(),!1},o.prototype.handleHover=function(e){var t=this.getCorrectTarget(e);t&&this.toggleSelected(t)},o.prototype.bindOmniBoxEvent=function(){this.bindHoverEvent()},o.prototype.bindHoverEvent=function(){var t=this;e.$(this.omniBoxDiv).find(".coveo-omnibox-selectable").hover(function(e){t.handleHover(e)})},o.prototype.escapeEvent=function(){this.clearLastOmniBoxRows(),this.close(),this.removeSearchAnimation()},o.prototype.selectionEvent=function(){var e=this;this.isFirstValueSelected(this.findSelected())?this.triggerNewQuery(function(){return e.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.searchboxSubmit,{})}):this.keyBoardSelection()},o.prototype.navigationEvent=function(e){var t=this.findSelected();0==t.length?this.navigationEventWhenNoSelection(e):this.navigationEventWhenSelection(e,t)},o.prototype.navigationEventWhenNoSelection=function(t){e.KeyboardUtils.keysEqual(t,40)&&this.findSelectable().first().addClass("coveo-omnibox-selected")},o.prototype.navigationEventWhenSelection=function(e,t){if(!this.isLoadingData)switch(e.keyCode){case 38:this.isFirstValueSelected(t)||(this.unselectValueInOmnibox(t),this.selectValueBeforeAlreadySelected(t));break;case 40:this.isLastValueSelected(t)||(this.unselectValueInOmnibox(t),this.selectValueAfterAlreadySelected(t))}},o.prototype.keyBoardSelection=function(){this.logger.trace("Selecting facet value because of omnibox selection");var e=this.findSelected();e.trigger("keyboardSelect"),this.escapeEvent()},o.prototype.triggerNewQuery=function(t){this.logger.info("Triggering new query because of omnibox selection"),this.escapeEvent(),this.queryStateModel.set(e.Models.QueryStateModel.attributesEnum.q,e.$(this.element).val()),this.queryController.deferExecuteQuery({beforeExecuteQuery:t})},o.prototype.processNewOmniBoxData=function(e){this.logger.trace("Processing omnibox data"),this.isCurrentlyBeingRendered=!0,this.numberOfPendingQueries=0,this.renderOmniBoxBody(e),this.omniBoxIsOpen=!0},o.prototype.renderHeader=function(){this.buildHeader(),this.setWidthOnOmniBoxDiv(),this.omniBoxDiv.show(),this.findSelectable().first().addClass("coveo-omnibox-selected"),this.headerIsCurrentlyRendered=!0},o.prototype.renderOmniBoxDiv=function(){this.omniBoxDiv=e.$("<div class='coveo-omnibox'></div>"),e.$(this.element).after(this.omniBoxDiv)},o.prototype.setWidthOnOmniBoxDiv=function(){this.omniBoxDiv.width(this.getWidth())},o.prototype.buildHeader=function(){var n=this;void 0!=this.omniBoxHeader&&this.omniBoxHeader.remove(),this.omniBoxHeader=e.$(this.omniBoxHeaderSearchForTemplate({data:e.$(this.element).val()})),this.omniBoxHeader.fastClick(function(){n.triggerNewQuery(function(){return n.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.searchboxSubmit,{})})}),this.omniBoxDiv.prepend(this.omniBoxHeader)},o.prototype.renderOmniBoxBody=function(t){var n=this;this.omniBoxRows=[],this.lastOmniBoxData=t,this.lastNumberOfLettersInOmniBox=e.$(this.element).val().length;e._.find(t.rows,function(t){return!e.Utils.isNullOrUndefined(t.element)});e._.each(t.rows,function(t){e.Utils.isNullOrUndefined(t.element)?e.Utils.isNullOrUndefined(t.deferred)||(n.numberOfPendingQueries++,n.renderOmniBoxForOneElementDeferred(t)):n.renderOmniBoxForOneElement(t)}),0==this.numberOfPendingQueries&&this.allDeferredHaveArrived(),setTimeout(function(){n.rejectAllPendingDeferred(t)},this.options.omniBoxTimeout)},o.prototype.rejectAllPendingDeferred=function(t){e._.each(t.rows,function(t){e.Utils.isNullOrUndefined(t.deferred)||"pending"!=t.deferred.state()||t.deferred.reject()})},o.prototype.allDeferredHaveArrived=function(){this.appendOmniBoxSections(),this.resetOmniBoxInternalData(),this.removeSearchAnimation()},o.prototype.clearLastOmniBoxRows=function(){void 0!=this.lastOmniBoxRows&&e._.each(this.lastOmniBoxRows,function(t){e.$(t.element).remove()})},o.prototype.appendOmniBoxSections=function(){if(this.omniBoxRows.length>0&&""!=e.$(this.element).val()){this.renderHeader(),this.clearLastOmniBoxRows(),this.omniBoxRows=e._.sortBy(this.omniBoxRows,function(e){return e.zIndex}).reverse();for(var t=0;t<this.omniBoxRows.length;t++)this.omniBoxDiv.append(this.omniBoxRows[t].element);this.bindOmniBoxEvent(),this.resetOmniBoxInternalData()}else this.close()},o.prototype.resetOmniBoxInternalData=function(){this.lastOmniBoxRows=this.omniBoxRows,this.isCurrentlyBeingRendered=!1,this.headerIsCurrentlyRendered=!1},o.prototype.renderOmniBoxForOneElement=function(t){var n=t.zIndex||-1;e.$(t.element).addClass("coveo-omnibox-section"),this.omniBoxRows.push({zIndex:n,element:t.element})},o.prototype.renderOmniBoxForOneElementDeferred=function(t){var n=this;t.deferred.done(function(t){n.headerIsCurrentlyRendered||void 0==t.element||n.renderHeader(),n.numberOfPendingQueries--,e.Utils.isNullOrUndefined(t.element)||n.renderOmniBoxForOneElement(t),0==n.numberOfPendingQueries&&n.allDeferredHaveArrived()}),t.deferred.fail(function(){n.numberOfPendingQueries--,0==n.numberOfPendingQueries&&n.allDeferredHaveArrived()})},o.prototype.isFirstValueSelected=function(e){return e.get(0)==this.findSelectable().first().get(0)},o.prototype.isLastValueSelected=function(e){return e.get(0)==this.findSelectable().last().get(0)},o.prototype.unselectValueInOmnibox=function(e){e.removeClass("coveo-omnibox-selected")},o.prototype.selectValueBeforeAlreadySelected=function(t){e.$(this.findSelectable().get(this.findPosOfAlreadySelected(t)-1)).addClass("coveo-omnibox-selected")},o.prototype.selectValueAfterAlreadySelected=function(t){e.$(this.findSelectable().get(this.findPosOfAlreadySelected(t)+1)).addClass("coveo-omnibox-selected")},o.prototype.findPosOfAlreadySelected=function(t){var n=-1,o=this.findSelectable();return e._.find(o,function(e){return n++,e==t.get(0)}),n},o.prototype.findSelectable=function(){return this.omniBoxDiv.find(".coveo-omnibox-selectable")},o.prototype.findSelected=function(){return this.findSelectable().closest(".coveo-omnibox-selected")},o.prototype.toggleSelected=function(e){this.omniBoxDiv.find(".coveo-omnibox-selected").removeClass("coveo-omnibox-selected"),e.addClass("coveo-omnibox-selected")},o.prototype.getWidth=function(){var t=e.$(this.element);return t.outerWidth()+this.getSearchButtonWidth()},o.prototype.getSearchButtonWidth=function(){var n=e.$(this.element).closest("."+t.Component.computeCssClassNameForType(t.SearchBox.ID));if(0!=n.length){var o=n.coveo(t.SearchBox);return void 0!=o.searchButton?e.$(o.searchButton.element).outerWidth():0}return 0},o.prototype.getRegexToSearch=function(t){return void 0===t&&(t=e.$(this.element).val()),new RegExp(e.Utils.escapeRegexCharacter(t),"i")},o.prototype.getCorrectTarget=function(t){var n=e.$(t.target);return n.closest(".coveo-omnibox-selectable")},o.prototype.addSearchAnimation=function(){this._hideClearElement(),e.$(this.element).addClass("coveo-loading"),this.isLoadingData=!0},o.prototype.removeSearchAnimation=function(){e.$(this.element).removeClass("coveo-loading"),this._addClearElement(),this.isLoadingData=!1},o.ID="OmniBox",o.options={omniBoxDelay:t.ComponentOptions.buildNumberOption({defaultValue:500}),omniBoxTimeout:t.ComponentOptions.buildNumberOption({defaultValue:2e3}),omniBoxChangeLimit:t.ComponentOptions.buildNumberOption({defaultValue:3}),omniBoxMinimumLetters:t.ComponentOptions.buildNumberOption({defaultValue:1})},o.parent=t.QueryBox,o}(t.QueryBox);t.OmniBox=n,e.Ui.CoveoJQuery.registerAutoCreateComponent(n)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var n=function(n){function o(i,r,s){n.call(this,i,o.ID,s),this.element=i,this.options=r,this.bind.fastClick(e.$(i),this.handleClick),""==e.$.trim(e.$(i).text())&&e.$("<span/>").text(t.l("Search")).addClass("coveo-icon").appendTo(i)}return __extends(o,n),o.prototype.handleClick=function(){var e=this;this.logger.debug("Performing query following button click"),this.queryController.deferExecuteQuery({beforeExecuteQuery:function(){return e.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.searchboxSubmit,{})}})},o.ID="SearchButton",o}(t.Component);t.SearchButton=n,t.CoveoJQuery.registerAutoCreateComponent(n)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var n=function(n){function o(i,r,s){n.call(this,i,o.ID,s),this.element=i,this.options=r,this.options=t.ComponentOptions.initComponentOptions(i,o,r),this.searchButton=new t.SearchButton(e.$("<a/>").appendTo(this.element).get(0),void 0,s);var a=e.$("<div/>").appendTo(this.element),l=this.buildInputTag();l.appendTo(a),this.searchBox=this.options.activateOmniBox?new t.OmniBox(l.get(0),this.options,s):new t.QueryBox(l.get(0),this.options,s)}return __extends(o,n),o.prototype.buildInputTag=function(){var t=this;return e.$('<input type="text" autocapitalize="off" autocorrect="off" />').blur(function(n){t.queryStateModel.set(e.Models.QueryStateModel.attributesEnum.q,e.$(n.target).val())})},o.ID="SearchBox",o.parent=t.OmniBox,o.options={activateOmniBox:t.ComponentOptions.buildBooleanOption({attrName:"data-activate-omnibox",defaultValue:!1,postProcessing:function(t,n){return n.enableSearchAsYouType?(t&&new e.Logger(document).warn("Cannot initialize omnibox and search as you type at the same time : Disabling omnibox functionnality"),!1):t}}),enableSearchAsYouType:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),searchAsYouTypeDelay:t.ComponentOptions.buildNumberOption({defaultValue:500}),disableQuerySyntax:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableWildcards:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableQuestionMarks:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableLowercaseOperators:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),enablePartialMatch:t.ComponentOptions.buildBooleanOption({defaultValue:!1}),partialMatchKeywords:t.ComponentOptions.buildNumberOption({defaultValue:5}),partialMatchThreshold:t.ComponentOptions.buildStringOption({defaultValue:"50%"}),autoFocus:t.ComponentOptions.buildBooleanOption({defaultValue:!0})},o}(e.Ui.Component);t.SearchBox=n,e.Ui.CoveoJQuery.registerAutoCreateComponent(n)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var n=function(){function t(t){this.options=t,this.logger=new e.Logger(this)}return t.prototype.sendSearchEvents=function(e){e.length>0&&(this.logger.info("Logging analytics search events",e),this.sendEventToApi(e,"searches","searchEvents"))},t.prototype.sendDocumentViewEvent=function(t){e.Assert.exists(t),this.logger.info("Logging analytics document view",t),this.sendEventToApi(t,"click","clickEvent")},t.prototype.sendCustomEvent=function(t){e.Assert.exists(t),this.logger.info("Logging analytics custom event",t),this.sendEventToApi(t,"custom","customEvent")},t.prototype.getTopQueries=function(n){var o=e.QueryUtils.mergePath(this.options.serviceUrl,"/rest/"+(t.CUSTOM_ANALYTICS_VERSION||t.DEFAULT_ANALYTICS_VERSION)+"/stats/topQueries");return this.getFromService(o,n)},t.prototype.sendEventToApi=function(n,o,i){var r=e.QueryUtils.mergePath(this.options.serviceUrl,"/rest/"+(t.CUSTOM_ANALYTICS_VERSION||t.DEFAULT_ANALYTICS_VERSION)+"/analytics/"+o);return r=this.appendUrlParamSign(r),r+=i+"="+encodeURIComponent(JSON.stringify(n)),this.options.token&&""!=this.options.token&&(r+="&access_token="+encodeURIComponent(this.options.token)),e.Utils.isNonEmptyString(this.options.userId)&&(r+="&user="+encodeURIComponent(this.options.userId)),e.$.ajax({url:r,dataType:"jsonp"})},t.prototype.appendUrlParamSign=function(e){return"?"==e.charAt(e.length-1)?e:e+"?"},t.prototype.getFromService=function(t,n){var o=this.options.token&&""!=this.options.token?e.$.extend({access_token:this.options.token},n):n;return e.$.ajax({url:this.appendUrlParamSign(t)+this.buildQueryStringFromParam(o),dataType:"jsonp"})},t.prototype.buildQueryStringFromParam=function(t){var n=e._.map(e._.pairs(t),function(e){return e[0]+"="+e[1]});return n.join("&")},t.DEFAULT_ANALYTICS_URI="https://usageanalytics.coveo.com",t.DEFAULT_ANALYTICS_VERSION="v10",t.CUSTOM_ANALYTICS_VERSION=void 0,t}();t.AnalyticsEndpoint=n}(t=e.Rest||(e.Rest={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var n=function(){function n(t,n,o,i){this._root=t,this._endpoint=n,this._templateSearchEvent=o,this._sendToCloud=i,this.searchDeferred=[],this.searchEvents=[],this.results=[],this._cancelled=!1,this._finished=!1,e.Assert.exists(t),e.Assert.exists(n),e.Assert.exists(o),this.handler=e.$.proxy(this._handleDuringQuery,this),e.$(t).on(e.Events.QueryEvents.duringQuery+" "+e.Events.QueryEvents.duringFetchMoreQuery,this.handler)}return n.prototype.getEventCause=function(){return this._templateSearchEvent.actionCause},n.prototype.getEventMeta=function(){return this._templateSearchEvent.customData},n.prototype.cancel=function(){this._stopRecording(),this._cancelled=!0},n.prototype._handleDuringQuery=function(n,o){var i=this;e.Assert.check(!this._finished),e.Assert.check(!this._cancelled),this.searchDeferred.push(o.deferred);var r=t.Component.get(n.target,t.SearchInterface);e.Assert.exists(r);var s=t.Component.get(n.target,e.Controllers.QueryController);e.Assert.exists(s),o.deferred.done(function(t){e.Assert.exists(t),e.Assert.check(!i._finished);var n=e._.extend({},i._templateSearchEvent);i.fillSearchEvent(n,r,o.query,t),i.searchEvents.push(n),i.results.push(t)}).always(function(){var t=e._.indexOf(i.searchDeferred,o.deferred);i.searchDeferred.splice(t,1),0==i.searchDeferred.length&&i.flush()})},n.prototype._stopRecording=function(){this.handler&&(e.$(this._root).off(e.Events.QueryEvents.duringQuery+" "+e.Events.QueryEvents.duringFetchMoreQuery,this.handler),this.handler=void 0)},n.prototype.flush=function(){var t=this;this._cancelled||(this._stopRecording(),this._finished=!0,e.Assert.check(this.searchEvents.length==this.results.length),e.Defer.defer(function(){t._sendToCloud&&t._endpoint.sendSearchEvents(t.searchEvents);var n=e._.map(t.searchEvents,function(t){return e.Rest.APIAnalyticsBuilder.convertSearchEventToAPI(t)});e.$(t._root).trigger(e.Events.AnalyticsEvents.searchEvent,{searchEvents:n})}))},n.prototype.fillSearchEvent=function(t,n,o,i){e.Assert.exists(t),e.Assert.exists(n),e.Assert.exists(o),e.Assert.exists(i);var r=n.queryStateModel.get(e.Models.QueryStateModel.attributesEnum.q);t.originLevel2=t.originLevel2||n.queryStateModel.get("t")||"default",t.queryText=r||o.q||"",t.advancedQuery=o.aq||"",t.didYouMean=o.enableDidYouMean,t.results=this.convertResults(i),t.responseTime=i.duration,t.pageNumber=o.firstResult/o.numberOfResults,t.resultsPerPage=o.numberOfResults,t.facets=this.convertFacets(),t.searchQueryUid=i.searchUid},n.prototype.convertResults=function(t){e.Assert.exists(t);var n=[];return e.$.each(t.results,function(e,t){n.push({clickUri:t.clickUri,documentUri:t.uri,documentUriHash:t.raw.sysurihash})}),n},n.prototype.convertFacets=function(){var n=this,o=[],i=t.Component.getComponentRef("Facet");return i&&e.$.each(e.$(this.getFacetSelector(i)),function(t,i){var i=e.$(i).coveo();i.disabled||o.push({fieldName:i.options.field,mode:i.options.useAnd?"and":"or",name:i.options.title,sort:i.options.sortCriteria,selections:n.convertFacetValues(i)})}),o},n.prototype.getFacetSelector=function(e){return["."+t.Component.computeCssClassNameForType(e.ID),"."+t.Component.computeCssClassNameForType(e.ID)].join(", ")},n.prototype.convertFacetValues=function(t){return e.Assert.exists(t),this.convertClassicFacetValues(t)},n.prototype.convertClassicFacetValues=function(t){var n=[];return t.disabled||(e.$.each(t.getSelectedValues(),function(e,t){n.push({entryName:t,status:"INCLUDE"})}),e.$.each(t.getExcludedValues(),function(e,t){n.push({entryName:t,status:"EXCLUDE"})})),n},n}();t.PendingSearchEvent=n}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var n=function(t){function n(n,o,i,r){t.call(this,n,o,i,r),this._root=n,this._endpoint=o,this._templateSearchEvent=i,this._sendToCloud=r,this.delayBeforeSending=5e3,this.armBatchDelay=50,this.beforeUnloadHandler=e.$.proxy(this.onWindowUnload,this),e.$(window).on("beforeunload",this.beforeUnloadHandler)}return __extends(n,t),n.prototype._handleDuringQuery=function(n,o){var i=this;this.toSendRightNow=function(){i.isCancelledOrFinished()||t.prototype._handleDuringQuery.call(i,n,o)},e._.delay(function(){i.toSendRightNow()},this.delayBeforeSending)},n.prototype.sendRightNow=function(){this.toSendRightNow&&this.toSendRightNow()},n.prototype._stopRecording=function(){t.prototype._stopRecording.call(this),this.beforeUnloadHandler&&(e.$(window).off("beforeunload",this.beforeUnloadHandler),this.beforeUnloadHandler=void 0)},n.prototype.onWindowUnload=function(){this.isCancelledOrFinished()||(this.armBatchDelay=0,this.sendRightNow())},n.prototype.isCancelledOrFinished=function(){return this._cancelled?!0:this._finished?(this.cancel(),!0):!1},n}(t.PendingSearchEvent);t.PendingSearchAsYouTypeSearchEvent=n}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(e){var t=function(){function e(){}return e.searchEvent="analyticsSearchEvent",e.documentViewEvent="analyticsDocumentViewEvent",e.customEvent="analyticsCustomEvent",e.changeAnalyticsCustomData="changeAnalyticsCustomData",e}();e.AnalyticsEvents=t}(t=e.Events||(e.Events={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var n=function(){function t(){}return t.convertSearchEventToAPI=function(e){var n={advancedQuery:e.advancedQuery,customMetadatas:e.customData,device:e.device,didYouMean:e.didYouMean,facets:t.convertFacetToAPI(e.facets),language:e.language,pageNumber:e.pageNumber,queryText:e.queryText,responseTime:e.responseTime,results:t.convertResultsToAPI(e.results),resultsPerPage:e.resultsPerPage,searchHub:e.originLevel1,searchInterface:e.originLevel2,searchQueryUid:e.searchQueryUid,type:e.actionType,actionCause:e.actionCause};return n},t.convertFacetToAPI=function(n){var o=e._.map(n,function(e){return{fieldName:e.fieldName,mode:e.mode,name:e.name,selections:t.convertFacetSelectionToAPI(e.selections),sort:e.sort}});return o},t.convertFacetSelectionToAPI=function(t){var n=e._.map(t,function(e){return{entryName:e.entryName,status:e.status}});return n},t.convertResultsToAPI=function(t){var n=e._.map(t,function(e){return{clickUri:e.clickUri,documentUri:e.documentUri,documentUriHash:e.documentUriHash}});return n},t.convertDocumentViewToAPI=function(e){var t={collectionName:e.collectionName,device:e.device,documentPosition:e.documentPosition,title:e.customMetadata1,documentClickUri:e.customMetadata2,documentUri:e.documentUri,documentUriHash:e.documentUriHash,language:e.language,responseTime:e.responseTime,searchHub:e.originLevel1,searchInterface:e.originLevel2,searchQueryUid:e.searchQueryUid,sourceName:e.sourceName,viewMethod:e.viewMethod,customMetadatas:e.customData,actionCause:e.actionCause};return t},t.convertCustomEventToAPI=function(e){var t={actionCause:e.actionCause,actionType:e.actionType,device:e.device,language:e.language,responseTime:e.responseTime,searchHub:e.originLevel1,searchInterface:e.originLevel2,customMetadatas:e.customData};return t},t}();t.APIAnalyticsBuilder=n}(t=e.Rest||(e.Rest={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var n=function(){function n(t,n,o,i){this.endpoint=t,this.rootElement=n,this.originLevel1=o,this.sendToCloud=i,this.isContextual=!1,this.language=String.locale,this.device=e.DeviceUtils.getDeviceName(),e.Assert.exists(t),e.Assert.exists(n),e.Assert.isNonEmptyString(this.language),e.Assert.isNonEmptyString(this.device),e.Assert.isNonEmptyString(this.originLevel1)}return n.prototype.isActivated=function(){return!0},n.prototype.getCurrentEventCause=function(){return null!=this.pendingSearchEvent?this.pendingSearchEvent.getEventCause():null!=this.pendingSearchAsYouTypeSearchEvent?this.pendingSearchAsYouTypeSearchEvent.getEventCause():null},n.prototype.getCurrentEventMeta=function(){return null!=this.pendingSearchEvent?this.pendingSearchEvent.getEventMeta():null!=this.pendingSearchAsYouTypeSearchEvent?this.pendingSearchAsYouTypeSearchEvent.getEventMeta():null},n.prototype.logSearchEvent=function(e,t){var n=this.buildMetaObject(e,t);this.pushSearchEvent(e,n)},n.prototype.logSearchAsYouType=function(e,t){var n=this.buildMetaObject(e,t);this.pushSearchAsYouTypeEvent(e,n)},n.prototype.logClickEvent=function(e,t,n,o){var i=this.buildMetaObject(e,t);this.pushClickEvent(e,i,n,o)},n.prototype.logCustomEvent=function(e,t,n){var o=this.buildMetaObject(e,t);this.pushCustomEvent(e,o,n)},n.prototype.getTopQueries=function(e){return this.endpoint.getTopQueries(e)},n.prototype.sendAllPendingEvents=function(){this.pendingSearchAsYouTypeSearchEvent&&this.pendingSearchAsYouTypeSearchEvent.sendRightNow()},n.prototype.pushCustomEvent=function(t,n,o){var i=this,r=this.buildCustomEvent(t,n,o);this.triggerChangeAnalyticsCustomData("CustomEvent",n,r),this.checkToSendAnyPendingSearchAsYouType(t),e.Defer.defer(function(){i.sendToCloud&&i.endpoint.sendCustomEvent(r),e.$(i.rootElement).trigger(e.Events.AnalyticsEvents.customEvent,{customEvent:e.Rest.APIAnalyticsBuilder.convertCustomEventToAPI(r)})})},n.prototype.pushSearchEvent=function(n,o){var i=this;if(e.Assert.exists(n),this.pendingSearchEvent&&this.pendingSearchEvent.getEventCause()!==n.name&&(this.pendingSearchEvent._stopRecording(),this.pendingSearchEvent=null),this.checkToSendAnyPendingSearchAsYouType(n),!this.pendingSearchEvent){var r=this.buildSearchEvent(n,o);this.triggerChangeAnalyticsCustomData("SearchEvent",o,r);var s=this.pendingSearchEvent=new t.PendingSearchEvent(this.rootElement,this.endpoint,r,this.sendToCloud);e.Defer.defer(function(){i.pendingSearchEvent=void 0,s._stopRecording()})}},n.prototype.checkToSendAnyPendingSearchAsYouType=function(e){this.eventIsNotRelatedToSearchBox(e.name)?this.sendAllPendingEvents():this.cancelAnyPendingSearchAsYouTypeEvent()},n.prototype.pushSearchAsYouTypeEvent=function(e,n){this.cancelAnyPendingSearchAsYouTypeEvent();var o=this.buildSearchEvent(e,n);this.triggerChangeAnalyticsCustomData("SearchEvent",n,o),this.pendingSearchAsYouTypeSearchEvent=new t.PendingSearchAsYouTypeSearchEvent(this.rootElement,this.endpoint,o,this.sendToCloud)},n.prototype.pushClickEvent=function(t,n,o,i){var r=this,s=this.buildClickEvent(t,n,o,i);this.triggerChangeAnalyticsCustomData("ClickEvent",n,s),e.Assert.isNonEmptyString(s.searchQueryUid),e.Assert.isNonEmptyString(s.collectionName),e.Assert.isNonEmptyString(s.sourceName),e.Assert.isNumber(s.documentPosition),e.Defer.defer(function(){r.sendToCloud&&r.endpoint.sendDocumentViewEvent(s),e.$(r.rootElement).trigger(e.Events.AnalyticsEvents.documentViewEvent,{documentViewEvent:e.Rest.APIAnalyticsBuilder.convertDocumentViewToAPI(s)})})},n.prototype.buildAnalyticsEvent=function(t,n){return{actionCause:t.name,actionType:t.type,device:this.device,language:this.language,responseTime:void 0,originLevel1:this.originLevel1,originLevel2:this.resolveActiveTabFromElement(this.rootElement),customData:e._.keys(n.metaDataAsString).length>0?n.metaDataAsString:void 0,customMetadata1:n.metaDataAsNumber.customMetadata1,customMetadata2:n.metaDataAsNumber.customMetadata2,customMetadata3:n.metaDataAsNumber.customMetadata3,customMetadata4:n.metaDataAsNumber.customMetadata4,customMetadata5:n.metaDataAsNumber.customMetadata5,userAgent:navigator.userAgent}},n.prototype.buildSearchEvent=function(t,n){return this.merge(this.buildAnalyticsEvent(t,n),{mobile:e.DeviceUtils.isMobileDevice(),queryText:void 0,advancedQuery:void 0,results:void 0,resultsPerPage:void 0,searchQueryUid:void 0,pageNumber:void 0,didYouMean:void 0,facets:void 0,contextual:this.isContextual})},n.prototype.buildClickEvent=function(e,t,n,o){return this.merge(this.buildAnalyticsEvent(e,t),{searchQueryUid:n.queryUid,documentUri:n.uri,originLevel2:this.resolveActiveTabFromElement(o)||"default",documentUriHash:n.raw.sysurihash,collectionName:n.raw.syscollection,sourceName:n.raw.syssource,documentPosition:n.index,responseTime:0,viewMethod:e.name})},n.prototype.buildCustomEvent=function(e,t,n){return this.merge(this.buildAnalyticsEvent(e,t),{eventType:e.type,eventValue:e.name,originLevel2:this.resolveActiveTabFromElement(n)||"default",responseTime:0})},n.prototype.buildMetaObject=function(t,n){var o={metaDataAsNumber:{},metaDataAsString:{}};return e._.each(n,function(e,n){if(void 0!=t.metaMap&&void 0!=t.metaMap[n]){var i=t.metaMap[n];o.metaDataAsNumber["customMetadata"+i.toString()]=e}o.metaDataAsString[n]=e}),o.metaDataAsString.JSUIVersion=e.version.lib+";"+e.version.product,o},n.prototype.cancelAnyPendingSearchAsYouTypeEvent=function(){this.pendingSearchAsYouTypeSearchEvent&&(this.pendingSearchAsYouTypeSearchEvent.cancel(),this.pendingSearchAsYouTypeSearchEvent=void 0)},n.prototype.resolveActiveTabFromElement=function(t){e.Assert.exists(t);var n=this.resolveQueryStateModel(t);return n&&n.get(e.Models.QueryStateModel.attributesEnum.t)},n.prototype.resolveQueryStateModel=function(n){return t.Component.resolveBinding(n,e.Models.QueryStateModel)},n.prototype.eventIsNotRelatedToSearchBox=function(e){return e!==t.AnalyticsActionCauseList.searchboxSubmit.name&&e!==t.AnalyticsActionCauseList.searchboxClear.name},n.prototype.triggerChangeAnalyticsCustomData=function(t,n,o){var i={language:o.language,originLevel1:o.originLevel1,originLevel2:o.originLevel2,originLevel3:o.originLevel3},r=e.$.extend({},{type:t,metaObject:n},i);e.$(this.rootElement).trigger(e.Events.AnalyticsEvents.changeAnalyticsCustomData,r),o.language=r.language,o.originLevel1=r.originLevel1,o.originLevel2=r.originLevel2,o.originLevel3=r.originLevel3,o.customData=n.metaDataAsString,e._.each(e._.keys(n.metaDataAsNumber),function(e){o[e]=n.metaDataAsNumber[e]})},n.prototype.merge=function(t,n){return e.$.extend({},t,n)},n}();t.LiveAnalyticsClient=n}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var n=function(){function t(e){void 0===e&&(e=[]),this.analyticsClients=e,this.isContextual=!1}return t.prototype.isActivated=function(){return e._.some(this.analyticsClients,function(e){return e.isActivated()})},t.prototype.getCurrentEventCause=function(){return e._.find(e._.map(this.analyticsClients,function(e){return e.getCurrentEventCause()}),function(e){return null!=e})},t.prototype.getCurrentEventMeta=function(){return e._.find(e._.map(this.analyticsClients,function(e){return e.getCurrentEventMeta()}),function(e){return null!=e})},t.prototype.logSearchEvent=function(t,n){e._.each(this.analyticsClients,function(e){return e.logSearchEvent(t,n)})},t.prototype.logSearchAsYouType=function(t,n){e._.each(this.analyticsClients,function(e){return e.logSearchEvent(t,n)})},t.prototype.logClickEvent=function(t,n,o,i){e._.each(this.analyticsClients,function(e){return e.logClickEvent(t,n,o,i)})},t.prototype.logCustomEvent=function(t,n,o){e._.each(this.analyticsClients,function(e){return e.logCustomEvent(t,n,o)})},t.prototype.getTopQueries=function(t){var n=this,o=e.$.Deferred(),i=[];return e._.forEach(this.analyticsClients,function(e){e.getTopQueries(t).done(function(e){i[s]=e;for(var r=!0,s=0;s<n.analyticsClients.length&&r;s++)r=r&&void 0!=i[s];r&&o.resolve(n.mergeTopQueries(i,t.pageSize))})}),o},t.prototype.sendAllPendingEvents=function(){e._.each(this.analyticsClients,function(e){return e.sendAllPendingEvents()})},t.prototype.mergeTopQueries=function(t,n){var o=[];return e._.each(t,function(t){return e._.each(t,function(e){return o.push(e)})}),o.length=Math.min(o.length,n),o},t}();t.MultiAnalyticsClient=n}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var n=function(n){function o(i,r,s){if(void 0===r&&(r={}),n.call(this,i,o.ID,s),this.element=i,this.options=r,this.options=t.ComponentOptions.initComponentOptions(i,o,r),null==this.options.token){var a=e.Rest.SearchEndpoint.endpoints["default"];a&&(this.options.token=a.options.accessToken)}this.initializeAnalyticsClient(),e.Assert.exists(this.client)}return __extends(o,n),o.makeSingleton=function(n,i){if(!o.analyticsSingleton){var r=t.Component.computeSelectorForType(o.ID),s=e.$(n),a=s.find(r).add(s.closest(r));o.analyticsSingleton=1==a.length?new o(a.get(0),i).client:a.length>1?new t.MultiAnalyticsClient(e._.map(a,function(e){return new o(e,i).client})):new t.NoopAnalyticsClient}return o.analyticsSingleton},o.prototype.initializeAnalyticsClient=function(){if(e.Utils.isNonEmptyString(this.options.endpoint)){var n=new e.Rest.AnalyticsEndpoint({token:this.options.token,userId:this.options.user,serviceUrl:this.options.endpoint});this.client=new t.LiveAnalyticsClient(n,this.root||this.element,this.options.searchHub,this.options.sendToCloud)}else this.client=new t.NoopAnalyticsClient},o.ID="Analytics",o.options={user:t.ComponentOptions.buildStringOption(),token:t.ComponentOptions.buildStringOption(),endpoint:t.ComponentOptions.buildStringOption({defaultValue:e.Rest.AnalyticsEndpoint.DEFAULT_ANALYTICS_URI}),searchHub:t.ComponentOptions.buildStringOption({defaultValue:"default"}),sendToCloud:t.ComponentOptions.buildBooleanOption({defaultValue:!0})},o}(t.Component);t.Analytics=n}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var n=function(){function t(e,t){this.structure=e,this.onSelect=t}return t.prototype.buildOmniBoxElement=function(t,n){var o;if(0!=t.length){o=e.$("<div></div>");var i=this.buildElementHeader();o.append(i);var r=this.buildRowElements(t,n);e._.each(r,function(e){o.append(e)})}return o},t.prototype.buildElementHeader=function(){return e.$(this.structure.header.template({headerTitle:this.structure.header.title}))},t.prototype.buildRowElements=function(t,n){var o=this,i=[];return e._.each(t,function(t){var r=e.$(o.structure.row({rawValue:t.value,data:e.JQueryUtils.highlightElement(t.value,n.completeQueryExpression.word)}));r.fastClick(function(){o.onSelect.call(o,t.value,n)}),r.on("keyboardSelect",function(){o.onSelect.call(o,t.value,n)}),i.push(r)}),i},t}();t.SuggestionForOmniBox=n}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var n=function(n){function o(i,r,s){n.call(this,i,o.ID,s),this.options=r,this.topFieldElementHeaderTemplate=e._.template("<div class='coveo-top-field-suggestion-header'>        <span class='coveo-icon-top-field'></span>         <span class='coveo-caption'><%= headerTitle %></span>       </div>"),this.topFieldElementRowTemplate=e._.template("<div class='coveo-omnibox-selectable coveo-top-field-suggestion-row'>         <%= data %>       </div>"),this.options=t.ComponentOptions.initComponentOptions(i,o,r),e.Assert.check(e.Utils.isCoveoField(this.options.field),this.options.field+" is not a valid field"),this.options.onSelect=this.options.onSelect||this.onRowSelection;var a={header:{template:this.topFieldElementHeaderTemplate,title:this.options.headerTitle},row:this.topFieldElementRowTemplate};this.suggestionForOmniBox=new t.SuggestionForOmniBox(a,e.$.proxy(this.options.onSelect,this)),e.$(this.root).on(e.Events.OmniBoxEvents.populateOmniBox,e.$.proxy(this.handlePopulateOmniBox,this))}return __extends(o,n),o.prototype.handlePopulateOmniBox=function(t,n){var o=this;if(e.Assert.exists(n),!this.disabled){var i=n.completeQueryExpression.word,r=e.$.Deferred(),s=this.queryController.getEndpoint().listFieldValues(this.buildListFieldValueRequest(i));
s.done(function(e){var t=o.suggestionForOmniBox.buildOmniBoxElement(e,n);r.resolve({element:void 0==t?void 0:t.get(0),zIndex:o.options.omniboxZIndex})}),s.fail(function(){o.resolveWithUndefined(r)}),n.rows.push({deferred:r})}},o.prototype.resolveWithUndefined=function(e){e.resolve({element:void 0})},o.prototype.onRowSelection=function(n,o){var i=this;o.clear(),o.closeOmniBox(),this.queryStateModel.set(e.Models.QueryStateModel.attributesEnum.q,n),this.queryController.deferExecuteQuery({beforeExecuteQuery:function(){return i.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.omniboxField,{})}})},o.prototype.buildListFieldValueRequest=function(e){return{field:this.options.field,ignoreAccents:!0,sortCriteria:"occurrences",maximumNumberOfValues:this.options.numberOfSuggestions,patternType:"Wildcards",pattern:"*"+e+"*",queryOverride:this.options.queryOverride}},o.ID="TopFieldSuggestions",o.options={field:t.ComponentOptions.buildFieldOption({required:!0}),queryOverride:t.ComponentOptions.buildStringOption({defaultValue:""}),omniboxZIndex:t.ComponentOptions.buildNumberOption({defaultValue:51}),headerTitle:t.ComponentOptions.buildLocalizedStringOption({defaultValue:t.l("SuggestedResults")}),numberOfSuggestions:t.ComponentOptions.buildNumberOption({defaultValue:5})},o}(e.Ui.Component);t.TopFieldSuggestions=n,e.Ui.CoveoJQuery.registerAutoCreateComponent(n)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var n=function(n){function o(i,r,s){n.call(this,i,o.ID,s),this.options=r,this.topAnalyticsElementHeaderTemplate=e._.template("<div class='coveo-top-analytics-suggestion-header'>        <span class='coveo-icon-top-analytics'></span>         <span class='coveo-caption'><%= headerTitle %></span>       </div>"),this.topAnalyticsElementRowTemplate=e._.template("<div class='coveo-omnibox-selectable coveo-top-analytics-suggestion-row'>         <%= data %>       </div>"),null==this.options.omniboxSuggestionOptions&&(this.options.omniboxSuggestionOptions={}),t.ComponentOptions.initComponentOptions(i,o,this.options.omniboxSuggestionOptions),this.options.omniboxSuggestionOptions.onSelect=this.options.omniboxSuggestionOptions.onSelect||this.onRowSelection;var a={header:{template:this.topAnalyticsElementHeaderTemplate,title:this.options.omniboxSuggestionOptions.headerTitle},row:this.topAnalyticsElementRowTemplate};this.suggestionForOmniBox=new t.SuggestionForOmniBox(a,e.$.proxy(this.options.omniboxSuggestionOptions.onSelect,this)),e.$(this.root).on(e.Events.OmniBoxEvents.populateOmniBox,e.$.proxy(this.handlePopulateOmnibox,this))}return __extends(o,n),o.prototype.handlePopulateOmnibox=function(t,n){var o=this;if(e.Assert.exists(n),!this.disabled){var i=e.$.Deferred(),r=this.usageAnalytics.getTopQueries({pageSize:this.options.omniboxSuggestionOptions.numberOfSuggestions,queryText:n.completeQueryExpression.word});r.done(function(t){var r=e._.map(t,function(e){return{value:e}}),s=o.suggestionForOmniBox.buildOmniBoxElement(r,n);i.resolve({element:void 0==s?void 0:s.get(0),zIndex:o.options.omniboxSuggestionOptions.omniboxZIndex})}),r.fail(function(){o.resolveWithUndefined(i)}),n.rows.push({deferred:i})}},o.prototype.onRowSelection=function(n,o){var i=this;o.clear(),o.closeOmniBox(),this.queryStateModel.set(e.Models.QueryStateModel.attributesEnum.q,n),this.queryController.deferExecuteQuery({beforeExecuteQuery:function(){return i.usageAnalytics.logSearchEvent(t.AnalyticsActionCauseList.omniboxAnalytics,{})}})},o.prototype.resolveWithUndefined=function(e){e.resolve({element:void 0})},o.ID="TopAnalyticsSuggestions",o.options={omniboxZIndex:t.ComponentOptions.buildNumberOption({defaultValue:52}),headerTitle:t.ComponentOptions.buildLocalizedStringOption({defaultValue:t.l("SuggestedQueries")}),numberOfSuggestions:t.ComponentOptions.buildNumberOption({defaultValue:5})},o}(e.Ui.Component);t.TopAnalyticsSuggestions=n,e.Ui.CoveoJQuery.registerAutoCreateComponent(n)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));var Coveo;!function(e){var t;!function(t){var n=function(n){function o(i,r,s){var a=this;n.call(this,i,o.ID,s),this.element=i,this.options=r,this.options=t.ComponentOptions.initComponentOptions(i,o,r),e.$(this.root).on(e.Events.ResultListEvents.newResultsDisplayed,function(){return a.handleNewResultsDisplayed()})}return __extends(o,n),o.prototype.handleNewResultsDisplayed=function(){var t=this;e.$(this.root).find(".CoveoResult").dblclick(function(e){return t.handleResultDoubleClick(e)})},o.prototype.handleResultDoubleClick=function(n){var o=t.Component.computeCssClassNameForType(e.Ui.ResultLink.ID),i=e.$(n.target).hasClass(o);if(n.altKey&&!i){var r=e.$(n.currentTarget).data("CoveoResult"),s=this.buildResultInfo(r),a=e.ModalBox.open(s,{title:"Debug",className:"coveo-debug"});e.$(a.wrapper.find(".coveo-title")).fastClick(function(){return a.close()}),e.$(a.overlay).fastClick(function(){return a.close()}),n.cancelBubble=!0,n.result=!1}},o.prototype.buildResultInfo=function(t){e.Assert.exists(t);var n=e.$("<div/>");return n.append(e.$("<div/>").append(e.$("<a/>").attr("href",t.clickUri).text(t.title||t.uri))),e.$("<div>Properties</div>").addClass("coveo-debug-title").appendTo(n),this.buildPropertyTable(t).appendTo(n),e.$("<div>Fields</div>").addClass("coveo-debug-title").appendTo(n),this.buildFieldTable(t).appendTo(n),e.$("<div>Ranking Info</div>").addClass("coveo-debug-title").appendTo(n),this.buildRankingInfo(t).appendTo(n),n},o.prototype.buildPropertyTable=function(t){var n=this;e.Assert.exists(t);var o=e.$("<table/>").addClass("coveo-debug-property-table"),i=e._.keys(t).sort();return e._.each(i,function(i){if("raw"!=i&&i[0]==i.toLowerCase()[0]){var r=e.$("<tr/>").appendTo(o);e.$("<td/>").addClass("coveo-debug-property-name").text(i).appendTo(r),e.$("<td/>").addClass("coveo-debug-property-value").append(n.formatValue(t[i])).appendTo(r)}}),o},o.prototype.buildFieldTable=function(t){var n=this;e.Assert.exists(t);var o=e.$("<table/>").addClass("coveo-debug-fields-table"),i=e._.keys(t.raw).sort();return e._.each(i,function(i){var r=e.$("<tr/>").appendTo(o);e.$("<td/>").addClass("coveo-debug-field-name").text("@"+i).appendTo(r),e.$("<td/>").addClass("coveo-debug-field-value").append(n.formatValue(t.raw[i])).appendTo(r)}),o},o.prototype.buildRankingInfo=function(t){return e.Assert.exists(t),e.$("<div/>").addClass("coveo-debug-ranking-info").text(t.rankingInfo)},o.prototype.formatValue=function(t){return e.Utils.isNonEmptyString(t)&&0==t.indexOf("http")?e.$("<a/>").attr("href",t).text(t):e.$("<span/>").text(t)},o.ID="Debug",o.options={},o}(t.Component);t.Debug=n,t.CoveoJQuery.registerAutoCreateComponent(n)}(t=e.Ui||(e.Ui={}))}(Coveo||(Coveo={}));
Coveo.Logger.disable();